# Alerting & Detection Strategy (ADS) Report: Detect Adversarial Attempts to Bypass Security Monitoring Using Containers

## Goal
The goal of this strategy is to detect adversarial attempts to bypass security monitoring by leveraging container technologies. Adversaries often exploit containers due to their dynamic nature and potential for isolation, which can obscure malicious activities from traditional detection mechanisms.

## Categorization
- **MITRE ATT&CK Mapping:** T1136 - Create Account
- **Tactic / Kill Chain Phases:** Persistence
- **Platforms:** Windows, Azure AD, Office 365, IaaS, Linux, macOS, Google Workspace

For more information on MITRE ATT&CK T1136:
[MITRE ATT&CK Reference](https://attack.mitre.org/techniques/T1136)

## Strategy Abstract
The detection strategy involves monitoring container orchestration environments for anomalous activities that indicate unauthorized account creation or usage. Key data sources include:

- **Container Logs:** Analyzing Kubernetes, Docker logs for unusual container creation and deletion patterns.
- **Access Control Lists (ACLs):** Monitoring changes in user access permissions within cloud platforms.
- **Network Traffic:** Observing network traffic originating from containers to identify abnormal communication patterns.

Patterns analyzed include:
- Creation of new accounts or service principal objects without prior authorization.
- Containers communicating with suspicious external IPs or domains.
- Unusual account activities, such as logins at odd hours or from unexpected locations.

## Technical Context
Adversaries exploit container environments by deploying malicious workloads that create unauthorized accounts to maintain persistence. This is achieved through techniques like:
- **API Misuse:** Using cloud platform APIs to programmatically create service principals.
- **Image Tampering:** Embedding malicious code in container images to execute unauthorized actions upon deployment.

### Adversary Emulation Details
Adversaries may use commands such as `kubectl` or `docker` CLI tools to deploy containers with embedded scripts that perform account creation. Test scenarios might involve:

1. Deploying a benign container that mimics adversary behavior by executing scripts to create service accounts.
2. Monitoring the environment for alerts triggered by these activities.

## Blind Spots and Assumptions
- **Blind Spots:**
  - Detection may not cover all types of container orchestration platforms.
  - Sophisticated adversaries might use obfuscation techniques to evade detection.

- **Assumptions:**
  - The environment has comprehensive logging enabled for containers and cloud services.
  - Security teams have baseline knowledge of normal account creation activities.

## False Positives
Potential benign activities that might trigger false alerts include:
- Legitimate deployments during maintenance windows or software updates.
- Automated scripts used by DevOps teams to create temporary accounts for testing purposes.

## Priority
**High.**
Justification: The use of containers for persistence is a growing trend among adversaries due to the complexity and dynamic nature of containerized environments, making it crucial to detect such attempts promptly.

## Validation (Adversary Emulation)
Currently, no specific adversary emulation steps are available. However, organizations should consider:

1. Setting up a controlled test environment with container orchestration tools.
2. Simulating account creation activities using legitimate and malicious scripts.
3. Monitoring the alerts generated by these activities to refine detection rules.

## Response
When an alert is triggered:
- **Immediate Actions:**
  - Isolate affected containers and environments to prevent further unauthorized access.
  - Review logs for detailed activity traces related to the suspicious account creation.

- **Investigation Steps:**
  - Verify if the detected activity aligns with scheduled maintenance or known operations.
  - Assess the scope of potential impact on other accounts and systems.

- **Remediation:**
  - Revoke unauthorized accounts immediately.
  - Enhance monitoring rules based on insights gained from the incident.

## Additional Resources
Additional resources are currently not available. Organizations should refer to platform-specific security documentation and community forums for further guidance on container security best practices.

---

This report provides a comprehensive framework for detecting adversarial attempts to bypass security monitoring using containers, aligning with Palantir's ADS approach.