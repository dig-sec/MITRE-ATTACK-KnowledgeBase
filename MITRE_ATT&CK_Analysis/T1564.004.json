{
    "id": "T1564.004",
    "name": "NTFS File Attributes",
    "description": "Adversaries may use NTFS file attributes to hide their malicious data in order to evade detection. Every New Technology File System (NTFS) formatted partition contains a Master File Table (MFT) that maintains a record for every file/directory on the partition. (Citation: SpectorOps Host-Based Jul 2017) Within MFT entries are file attributes, (Citation: Microsoft NTFS File Attributes Aug 2010) such as Extended Attributes (EA) and Data [known as Alternate Data Streams (ADSs) when more than one Data attribute is present], that can be used to store arbitrary data (and even complete files). (Citation: SpectorOps Host-Based Jul 2017) (Citation: Microsoft File Streams) (Citation: MalwareBytes ADS July 2015) (Citation: Microsoft ADS Mar 2014)\nAdversaries may store malicious data or binaries in file attribute metadata instead of directly in files. This may be done to evade some defenses, such as static indicator scanning tools and anti-virus. (Citation: Journey into IR ZeroAccess NTFS EA) (Citation: MalwareBytes ADS July 2015)",
    "platforms": "Windows",
    "kill_chain_phases": "Defense Evasion",
    "data_sources": "Process: OS API Execution, File: File Metadata, File: File Modification, Command: Command Execution",
    "detection": "Forensic techniques exist to identify information stored in NTFS EA. (Citation: Journey into IR ZeroAccess NTFS EA) Monitor calls to the `ZwSetEaFile` and `ZwQueryEaFile` Windows API functions as well as binaries used to interact with EA, (Citation: Oddvar Moe ADS1 Jan 2018) (Citation: Oddvar Moe ADS2 Apr 2018) and consider regularly scanning for the presence of modified information. (Citation: SpectorOps Host-Based Jul 2017)\nThere are many ways to create and interact with ADSs using Windows utilities. Monitor for operations (execution, copies, etc.) with file names that contain colons. This syntax (ex: `file.ext:ads[.ext]`) is commonly associated with ADSs. (Citation: Microsoft ADS Mar 2014) (Citation: Oddvar Moe ADS1 Jan 2018) (Citation: Oddvar Moe ADS2 Apr 2018) For a more exhaustive list of utilities that can be used to execute and create ADSs, see https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f.\nThe Streams tool of Sysinternals can be used to uncover files with ADSs. The `dir /r` command can also be used to display ADSs. (Citation: Symantec ADS May 2009) Many PowerShell commands (such as Get-Item, Set-Item, Remove-Item, and Get-ChildItem) can also accept a `-stream` parameter to interact with ADSs. (Citation: MalwareBytes ADS July 2015) (Citation: Microsoft ADS Mar 2014)",
    "url": "https://attack.mitre.org/techniques/T1564/004",
    "enrichments": {
        "attack_rule_map": [],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "ae02ed70-11aa-4a22-b397-c0d0e8f6ea99",
                    "025bd229-fd1f-4fdb-97ab-20006e1a5368",
                    "45a594aa-1fbd-4972-a809-ff5a99dd81b8",
                    "0d7a9363-af70-4e7b-a3b7-1a176b7fbe84",
                    "dd6b39d9-d9be-4a3b-8fe0-fe3c6a5c1795",
                    "f2857333-11d4-45bf-b064-2c28d8525be5",
                    "bf6c39fc-e203-45b9-9538-05397c1b4f3f",
                    "6b369ced-4b1d-48f1-b427-fdc0de0790bd",
                    "b69888d4-380c-45ce-9cf9-d9ce46e67821",
                    "a699b30e-d010-46c8-bbd1-ee2e26765fe9",
                    "4b13db67-0c45-40f1-aba8-66a1a7198a1e",
                    "9248c7e1-2bf3-4661-a22c-600a8040b446",
                    "52182dfb-afb7-41db-b4bc-5336cb29b464",
                    "19b041f6-e583-40dc-b842-d6fa8011493f",
                    "a96970af-f126-420d-90e1-d37bf25e50e1",
                    "7f43c430-5001-4f8b-aaa9-c3b88f18fa5c",
                    "349d891d-fef0-4fe4-bc53-eee623a15969",
                    "8c521530-5169-495d-a199-0a3a881ad24e",
                    "cafeeba3-01da-4ab4-b6c4-a31b1d9730c7",
                    "3ef5605c-9eb9-47b0-9a71-b727e6aa5c3b",
                    "70e68156-6571-427b-a6e9-4476a173a9b6"
                ],
                "lookup_results": [
                    {
                        "uuid": "ae02ed70-11aa-4a22-b397-c0d0e8f6ea99",
                        "lookup_data": {
                            "description": "Detects the download of suspicious file type from a well-known file and paste sharing domain",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/08/24\ndescription: Detects the download of suspicious file type from a well-known file and\n  paste sharing domain\ndetection:\n  condition: all of selection*\n  selection_domain:\n    Contents|contains:\n    - transfer.sh\n    - raw.githubusercontent.com\n    - gist.githubusercontent.com\n    - pastebin.com\n    - cdn.discordapp.com/attachments/\n    - mediafire.com\n    - mega.nz\n    - ddns.net\n    - .paste.ee\n    - .hastebin.com\n    - .ghostbin.co/\n    - ufile.io\n    - storage.googleapis.com\n    - anonfiles.com\n    - send.exploit.in\n    - privatlab.net\n    - privatlab.com\n    - sendspace.com\n    - pastetext.net\n    - pastebin.pl\n    - paste.ee\n  selection_extension:\n    TargetFilename|contains:\n    - .ps1:Zone\n    - .bat:Zone\nfalsepositives:\n- Unknown\nfields:\n- TargetFilename\n- Image\nid: ae02ed70-11aa-4a22-b397-c0d0e8f6ea99\nlevel: medium\nlogsource:\n  category: create_stream_hash\n  definition: 'Requirements: Sysmon config with Imphash logging activated'\n  product: windows\nmodified: 2023/01/19\nreferences:\n- https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90015\n- https://www.cisa.gov/uscert/ncas/alerts/aa22-321a\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.s0139\n- attack.t1564.004\ntitle: Unusual File Download from File Sharing Domain\n",
                            "sigma:id": "ae02ed70-11aa-4a22-b397-c0d0e8f6ea99",
                            "title": "Unusual File Download from File Sharing Domain",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "025bd229-fd1f-4fdb-97ab-20006e1a5368",
                        "lookup_data": {
                            "description": "Detects the download of suspicious file type from URLs with IP",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems), Florian Roth\ndate: 2022/09/07\ndescription: Detects the download of suspicious file type from URLs with IP\ndetection:\n  condition: selection\n  selection:\n    Contents|re: http[s]?://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\n    TargetFilename|contains:\n    - .ps1:Zone\n    - .bat:Zone\n    - .exe:Zone\n    - .vbe:Zone\n    - .vbs:Zone\n    - .dll:Zone\nfalsepositives:\n- Unknown\nid: 025bd229-fd1f-4fdb-97ab-20006e1a5368\nlevel: high\nlogsource:\n  category: create_stream_hash\n  product: windows\nmodified: 2022/12/05\nreferences:\n- https://github.com/trustedsec/SysmonCommunityGuide/blob/adcdfee20999f422b974c8d4149bf4c361237db7/chapters/file-stream-creation-hash.md\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1564.004\ntitle: Unusual File Download from Direct IP Address\n",
                            "sigma:id": "025bd229-fd1f-4fdb-97ab-20006e1a5368",
                            "title": "Unusual File Download from Direct IP Address",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "45a594aa-1fbd-4972-a809-ff5a99dd81b8",
                        "lookup_data": {
                            "description": "Detects PowerShell script execution from Alternate Data Stream (ADS)",
                            "raw": "author: Sergey Soldatov, Kaspersky Lab, oscd.community\ndate: 2019/10/30\ndescription: Detects PowerShell script execution from Alternate Data Stream (ADS)\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - Get-Content\n    - -Stream\n    Image|endswith:\n    - \\powershell.exe\n    - \\pwsh.exe\n    ParentImage|endswith:\n    - \\powershell.exe\n    - \\pwsh.exe\nfalsepositives:\n- Unknown\nid: 45a594aa-1fbd-4972-a809-ff5a99dd81b8\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/07/14\nreferences:\n- https://github.com/p0shkatz/Get-ADS/blob/1c3a3562e713c254edce1995a7d9879c687c7473/Get-ADS.ps1\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1564.004\ntitle: Run PowerShell Script from ADS\n",
                            "sigma:id": "45a594aa-1fbd-4972-a809-ff5a99dd81b8",
                            "title": "Run PowerShell Script from ADS",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "0d7a9363-af70-4e7b-a3b7-1a176b7fbe84",
                        "lookup_data": {
                            "description": "Exports the target Registry key and hides it in the specified alternate data stream.",
                            "raw": "author: Oddvar Moe, Sander Wiebing, oscd.community\ndate: 2020/10/07\ndescription: Exports the target Registry key and hides it in the specified alternate\n  data stream.\ndetection:\n  condition: selection\n  selection:\n    Image|endswith: \\regedit.exe\nfalsepositives:\n- Unknown\nfields:\n- TargetFilename\nid: 0d7a9363-af70-4e7b-a3b7-1a176b7fbe84\nlevel: high\nlogsource:\n  category: create_stream_hash\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/Regedit/\n- https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1564.004\ntitle: Exports Registry Key To an Alternate Data Stream\n",
                            "sigma:id": "0d7a9363-af70-4e7b-a3b7-1a176b7fbe84",
                            "title": "Exports Registry Key To an Alternate Data Stream",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "dd6b39d9-d9be-4a3b-8fe0-fe3c6a5c1795",
                        "lookup_data": {
                            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid command-line detection",
                            "raw": "author: frack113, Nasreddine Bencherchali\ndate: 2022/08/05\ndescription: Detect use of the Windows 8.3 short name. Which could be used as a method\n  to avoid command-line detection\ndetection:\n  condition: selection and not filter\n  filter:\n  - ParentImage|endswith:\n    - \\WebEx\\WebexHost.exe\n    - \\thor\\thor64.exe\n  - CommandLine|contains: C:\\xampp\\vcredist\\VCREDI~1.EXE\n  selection:\n    CommandLine|contains:\n    - ~1.exe\n    - ~1.bat\n    - ~1.msi\n    - ~1.vbe\n    - ~1.vbs\n    - ~1.dll\n    - ~1.ps1\n    - ~1.js\n    - ~1.hta\n    - ~2.exe\n    - ~2.bat\n    - ~2.msi\n    - ~2.vbe\n    - ~2.vbs\n    - ~2.dll\n    - ~2.ps1\n    - ~2.js\n    - ~2.hta\nfalsepositives:\n- Applications could use this notation occasionally which might generate some false\n  positives. In that case Investigate the parent and child process.\nid: dd6b39d9-d9be-4a3b-8fe0-fe3c6a5c1795\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/09/21\nreferences:\n- https://www.acunetix.com/blog/articles/windows-short-8-3-filenames-web-security-problem/\n- https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc959352(v=technet.10)?redirectedfrom=MSDN\n- https://twitter.com/jonasLyk/status/1555914501802921984\nrelated:\n- id: 3ef5605c-9eb9-47b0-9a71-b727e6aa5c3b\n  type: similar\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1564.004\ntitle: Use NTFS Short Name in Command Line\n",
                            "sigma:id": "dd6b39d9-d9be-4a3b-8fe0-fe3c6a5c1795",
                            "title": "Use NTFS Short Name in Command Line",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f2857333-11d4-45bf-b064-2c28d8525be5",
                        "lookup_data": {
                            "mitre-attack-id": "T1564.004",
                            "mitre-cti:description": "Adversaries may use NTFS file attributes to hide their malicious data in order to evade detection. Every New Technology File System (NTFS) formatted partition contains a Master File Table (MFT) that maintains a record for every file/directory on the partition. (Citation: SpectorOps Host-Based Jul 2017) Within MFT entries are file attributes, (Citation: Microsoft NTFS File Attributes Aug 2010) such as Extended Attributes (EA) and Data [known as Alternate Data Streams (ADSs) when more than one Data attribute is present], that can be used to store arbitrary data (and even complete files). (Citation: SpectorOps Host-Based Jul 2017) (Citation: Microsoft File Streams) (Citation: MalwareBytes ADS July 2015) (Citation: Microsoft ADS Mar 2014)\n\nAdversaries may store malicious data or binaries in file attribute metadata instead of directly in files. This may be done to evade some defenses, such as static indicator scanning tools and anti-virus. (Citation: Journey into IR ZeroAccess NTFS EA) (Citation: MalwareBytes ADS July 2015)",
                            "mitre-cti:name": "NTFS File Attributes",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'x_mitre_platforms': ['Windows'], 'x_mitre_domains': ['enterprise-attack'], 'x_mitre_contributors': ['Oddvar Moe, @oddvarmoe', 'Red Canary'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'attack-pattern--f2857333-11d4-45bf-b064-2c28d8525be5', 'type': 'attack-pattern', 'created': '2020-03-13T20:33:00.009Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'source_name': 'mitre-attack', 'external_id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004'}, {'url': 'https://posts.specterops.io/host-based-threat-modeling-indicator-design-a9dbbb53d5ea', 'description': 'Atkinson, J. (2017, July 18). Host-based Threat Modeling & Indicator Design. Retrieved March 21, 2018.', 'source_name': 'SpectorOps Host-Based Jul 2017'}, {'url': 'https://blogs.technet.microsoft.com/askcore/2010/08/25/ntfs-file-attributes/', 'description': 'Hughes, J. (2010, August 25). NTFS File Attributes. Retrieved March 21, 2018.', 'source_name': 'Microsoft NTFS File Attributes Aug 2010'}, {'url': 'http://msdn.microsoft.com/en-us/library/aa364404', 'description': 'Microsoft. (n.d.). File Streams. Retrieved December 2, 2014.', 'source_name': 'Microsoft File Streams'}, {'url': 'https://blog.malwarebytes.com/101/2015/07/introduction-to-alternate-data-streams/', 'description': 'Arntz, P. (2015, July 22). Introduction to Alternate Data Streams. Retrieved March 21, 2018.', 'source_name': 'MalwareBytes ADS July 2015'}, {'url': 'https://blogs.technet.microsoft.com/askcore/2013/03/24/alternate-data-streams-in-ntfs/', 'description': 'Marlin, J. (2013, March 24). Alternate Data Streams in NTFS. Retrieved March 21, 2018.', 'source_name': 'Microsoft ADS Mar 2014'}, {'url': 'http://journeyintoir.blogspot.com/2012/12/extracting-zeroaccess-from-ntfs.html', 'description': 'Harrell, C. (2012, December 11). Extracting ZeroAccess from NTFS Extended Attributes. Retrieved June 3, 2016.', 'source_name': 'Journey into IR ZeroAccess NTFS EA'}, {'url': 'https://oddvar.moe/2018/01/14/putting-data-in-alternate-data-streams-and-how-to-execute-it/', 'description': 'Moe, O. (2018, January 14). Putting Data in Alternate Data Streams and How to Execute It. Retrieved June 30, 2018.', 'source_name': 'Oddvar Moe ADS1 Jan 2018'}, {'url': 'https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/', 'description': 'Moe, O. (2018, April 11). Putting Data in Alternate Data Streams and How to Execute It - Part 2. Retrieved June 30, 2018.', 'source_name': 'Oddvar Moe ADS2 Apr 2018'}, {'url': 'https://www.symantec.com/connect/articles/what-you-need-know-about-alternate-data-streams-windows-your-data-secure-can-you-restore', 'description': 'Pravs. (2009, May 25). What you need to know about alternate data streams in windows? Is your Data secure? Can you restore that?. Retrieved March 21, 2018.', 'source_name': 'Symantec ADS May 2009'}], 'modified': '2020-03-29T22:46:56.308Z', 'name': 'NTFS File Attributes', 'description': 'Adversaries may use NTFS file attributes to hide their malicious data in order to evade detection. Every New Technology File System (NTFS) formatted partition contains a Master File Table (MFT) that maintains a record for every file/directory on the partition. (Citation: SpectorOps Host-Based Jul 2017) Within MFT entries are file attributes, (Citation: Microsoft NTFS File Attributes Aug 2010) such as Extended Attributes (EA) and Data [known as Alternate Data Streams (ADSs) when more than one Data attribute is present], that can be used to store arbitrary data (and even complete files). (Citation: SpectorOps Host-Based Jul 2017) (Citation: Microsoft File Streams) (Citation: MalwareBytes ADS July 2015) (Citation: Microsoft ADS Mar 2014)\\n\\nAdversaries may store malicious data or binaries in file attribute metadata instead of directly in files. This may be done to evade some defenses, such as static indicator scanning tools and anti-virus. (Citation: Journey into IR ZeroAccess NTFS EA) (Citation: MalwareBytes ADS July 2015)', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'defense-evasion'}], 'x_mitre_detection': 'Forensic techniques exist to identify information stored in NTFS EA. (Citation: Journey into IR ZeroAccess NTFS EA) Monitor calls to the <code>ZwSetEaFile</code> and <code>ZwQueryEaFile</code> Windows API functions as well as binaries used to interact with EA, (Citation: Oddvar Moe ADS1 Jan 2018) (Citation: Oddvar Moe ADS2 Apr 2018) and consider regularly scanning for the presence of modified information. (Citation: SpectorOps Host-Based Jul 2017)\\n\\nThere are many ways to create and interact with ADSs using Windows utilities. Monitor for operations (execution, copies, etc.) with file names that contain colons. This syntax (ex: <code>file.ext:ads[.ext]</code>) is commonly associated with ADSs. (Citation: Microsoft ADS Mar 2014) (Citation: Oddvar Moe ADS1 Jan 2018) (Citation: Oddvar Moe ADS2 Apr 2018) For a more exhaustive list of utilities that can be used to execute and create ADSs, see https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f.\\n\\nThe Streams tool of Sysinternals can be used to uncover files with ADSs. The <code>dir /r</code> command can also be used to display ADSs. (Citation: Symantec ADS May 2009) Many PowerShell commands (such as Get-Item, Set-Item, Remove-Item, and Get-ChildItem) can also accept a <code>-stream</code> parameter to interact with ADSs. (Citation: MalwareBytes ADS July 2015) (Citation: Microsoft ADS Mar 2014)', 'x_mitre_is_subtechnique': True, 'x_mitre_version': '1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'x_mitre_data_sources': ['Command: Command Execution', 'File: File Metadata', 'File: File Modification', 'Process: OS API Execution'], 'x_mitre_defense_bypassed': ['Anti-virus', 'Host forensic analysis', 'Signature-based detection'], 'x_mitre_system_requirements': ['NTFS partitioned hard drive']}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "bf6c39fc-e203-45b9-9538-05397c1b4f3f",
                        "lookup_data": {
                            "description": "Attackers can use findstr to hide their artifacts or search specific strings and evade defense mechanism",
                            "raw": "author: Furkan CALISKAN, @caliskanfurkan_, @oscd_initiative, Nasreddine Bencherchali\ndate: 2020/10/05\ndescription: Attackers can use findstr to hide their artifacts or search specific\n  strings and evade defense mechanism\ndetection:\n  condition: selection_findstr and (all of selection_cli_download* or all of selection_cli_creds*)\n  selection_cli_creds_1:\n    CommandLine|contains:\n    - ' /s '\n    - ' -s '\n  selection_cli_creds_2:\n    CommandLine|contains:\n    - ' /i '\n    - ' -i '\n  selection_cli_download_1:\n    CommandLine|contains:\n    - ' /v '\n    - ' -v '\n  selection_cli_download_2:\n    CommandLine|contains:\n    - ' /l '\n    - ' -l '\n  selection_findstr:\n  - CommandLine|contains: findstr\n  - Image|endswith: findstr.exe\n  - OriginalFileName: FINDSTR.EXE\nfalsepositives:\n- Administrative findstr usage\nid: bf6c39fc-e203-45b9-9538-05397c1b4f3f\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/10/11\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/Findstr/\n- https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/\n- https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1218\n- attack.t1564.004\n- attack.t1552.001\n- attack.t1105\ntitle: Abusing Findstr for Defense Evasion\n",
                            "sigma:id": "bf6c39fc-e203-45b9-9538-05397c1b4f3f",
                            "title": "Abusing Findstr for Defense Evasion",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "6b369ced-4b1d-48f1-b427-fdc0de0790bd",
                        "lookup_data": {
                            "description": "Compress target file into a cab file stored in the Alternate Data Stream (ADS) of the target file.",
                            "raw": "author: frack113\ndate: 2021/11/26\ndescription: Compress target file into a cab file stored in the Alternate Data Stream\n  (ADS) of the target file.\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - diantz.exe\n    - .cab\n    CommandLine|re: :[^\\\\]\nfalsepositives:\n- Very Possible\nid: 6b369ced-4b1d-48f1-b427-fdc0de0790bd\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/31\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/Diantz/\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1564.004\ntitle: Suspicious Diantz Alternate Data Stream Execution\n",
                            "sigma:id": "6b369ced-4b1d-48f1-b427-fdc0de0790bd",
                            "title": "Suspicious Diantz Alternate Data Stream Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b69888d4-380c-45ce-9cf9-d9ce46e67821",
                        "lookup_data": {
                            "description": "Detects the creation of an ADS data stream that contains an executable (non-empty imphash)",
                            "raw": "author: Florian Roth (Nextron Systems), @0xrawsec\ndate: 2018/06/03\ndescription: Detects the creation of an ADS data stream that contains an executable\n  (non-empty imphash)\ndetection:\n  condition: selection and not filter\n  filter:\n    Hash|contains: IMPHASH=00000000000000000000000000000000\n  selection:\n    Hash|contains: IMPHASH=\nfalsepositives:\n- Unknown\nfields:\n- TargetFilename\n- Image\nid: b69888d4-380c-45ce-9cf9-d9ce46e67821\nlevel: medium\nlogsource:\n  category: create_stream_hash\n  definition: 'Requirements: Sysmon config with Imphash logging activated'\n  product: windows\nmodified: 2022/12/30\nreferences:\n- https://twitter.com/0xrawsec/status/1002478725605273600?s=21\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.s0139\n- attack.t1564.004\ntitle: Executable in ADS\n",
                            "sigma:id": "b69888d4-380c-45ce-9cf9-d9ce46e67821",
                            "title": "Executable in ADS",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "a699b30e-d010-46c8-bbd1-ee2e26765fe9",
                        "lookup_data": {
                            "description": "Storing files in Alternate Data Stream (ADS) similar to Astaroth malware.",
                            "raw": "author: frack113\ndate: 2021/09/02\ndescription: Storing files in Alternate Data Stream (ADS) similar to Astaroth malware.\ndetection:\n  condition: selection_compspec\n  selection_compspec:\n    ScriptBlockText|contains|all:\n    - Start-Process\n    - '-FilePath \"$env:comspec\" '\n    - '-ArgumentList '\n    - '>'\nfalsepositives:\n- Unknown\nid: a699b30e-d010-46c8-bbd1-ee2e26765fe9\nlevel: medium\nlogsource:\n  category: ps_script\n  definition: 'Requirements: Script Block Logging must be enabled'\n  product: windows\nmodified: 2022/12/25\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.004/T1564.004.md\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1564.004\ntitle: Powershell Store File In Alternate Data Stream\n",
                            "sigma:id": "a699b30e-d010-46c8-bbd1-ee2e26765fe9",
                            "title": "Powershell Store File In Alternate Data Stream",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4b13db67-0c45-40f1-aba8-66a1a7198a1e",
                        "lookup_data": {
                            "description": "Extract data from cab file and hide it in an alternate data stream",
                            "raw": "author: frack113\ndate: 2021/11/26\ndescription: Extract data from cab file and hide it in an alternate data stream\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - extrac32.exe\n    - .cab\n    CommandLine|re: :[^\\\\]\nfalsepositives:\n- Unknown\nid: 4b13db67-0c45-40f1-aba8-66a1a7198a1e\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/30\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/Extrac32/\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1564.004\ntitle: Suspicious Extrac32 Alternate Data Stream Execution\n",
                            "sigma:id": "4b13db67-0c45-40f1-aba8-66a1a7198a1e",
                            "title": "Suspicious Extrac32 Alternate Data Stream Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "9248c7e1-2bf3-4661-a22c-600a8040b446",
                        "lookup_data": {
                            "description": "Detects execution of rundll32 where the DLL being called is stored in an Alternate Data Stream (ADS).",
                            "raw": "author: Harjot Singh, '@cyb3rjy0t'\ndate: 2023/01/21\ndescription: Detects execution of rundll32 where the DLL being called is stored in\n  an Alternate Data Stream (ADS).\ndetection:\n  condition: selection\n  selection:\n    CommandLine|re: '[Rr][Uu][Nn][Dd][Ll][Ll]32(\\.[Ee][Xx][Ee])? \\S+?\\w:\\S+?:'\n    Image|endswith: \\rundll32.exe\nfalsepositives:\n- Unknown\nid: 9248c7e1-2bf3-4661-a22c-600a8040b446\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/23\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/Rundll32\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1564.004\ntitle: Potential Rundll32 Execution With DLL Stored In ADS\n",
                            "sigma:id": "9248c7e1-2bf3-4661-a22c-600a8040b446",
                            "title": "Potential Rundll32 Execution With DLL Stored In ADS",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "52182dfb-afb7-41db-b4bc-5336cb29b464",
                        "lookup_data": {
                            "description": "Detects the download of suspicious file type from a well-known file and paste sharing domain",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/08/24\ndescription: Detects the download of suspicious file type from a well-known file and\n  paste sharing domain\ndetection:\n  condition: all of selection*\n  selection_domain:\n    Contents|contains:\n    - https://transfer.sh/\n    - raw.githubusercontent.com\n    - gist.githubusercontent.com\n    - pastebin.com\n    - cdn.discordapp.com/attachments/\n    - mediafire.com\n    - mega.nz\n    - ddns.net\n    - .paste.ee\n    - .hastebin.com\n    - .ghostbin.co/\n    - ufile.io\n    - storage.googleapis.com\n    - anonfiles.com\n    - send.exploit.in\n    - privatlab.net\n    - privatlab.com\n    - sendspace.com\n    - pastetext.net\n    - pastebin.pl\n    - paste.ee\n  selection_extension:\n    TargetFilename|contains:\n    - .exe:Zone\n    - .vbs:Zone\n    - .dll:Zone\nfalsepositives:\n- Unknown\nfields:\n- TargetFilename\n- Image\nid: 52182dfb-afb7-41db-b4bc-5336cb29b464\nlevel: high\nlogsource:\n  category: create_stream_hash\n  definition: 'Requirements: Sysmon config with Imphash logging activated'\n  product: windows\nmodified: 2023/01/19\nreferences:\n- https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90015\n- https://www.cisa.gov/uscert/ncas/alerts/aa22-321a\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.s0139\n- attack.t1564.004\ntitle: Suspicious File Download from File Sharing Domain\n",
                            "sigma:id": "52182dfb-afb7-41db-b4bc-5336cb29b464",
                            "title": "Suspicious File Download from File Sharing Domain",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "19b041f6-e583-40dc-b842-d6fa8011493f",
                        "lookup_data": {
                            "description": "Detects the creation of a file on disk that has an imphash of a well-known hack tool",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/08/24\ndescription: Detects the creation of a file on disk that has an imphash of a well-known\n  hack tool\ndetection:\n  condition: selection\n  selection:\n  - Imphash:\n    - bcca3c247b619dcd13c8cdff5f123932\n    - 3a19059bd7688cb88e70005f18efc439\n    - bf6223a49e45d99094406777eb6004ba\n    - 0c106686a31bfe2ba931ae1cf6e9dbc6\n    - 0d1447d4b3259b3c2a1d4cfb7ece13c3\n    - 1b0369a1e06271833f78ffa70ffb4eaf\n    - 4c1b52a19748428e51b14c278d0f58e3\n    - 4d927a711f77d62cebd4f322cb57ec6f\n    - 66ee036df5fc1004d9ed5e9a94a1086a\n    - 672b13f4a0b6f27d29065123fe882dfc\n    - 6bbd59cea665c4afcc2814c1327ec91f\n    - 725bb81dc24214f6ecacc0cfb36ad30d\n    - 9528a0e91e28fbb88ad433feabca2456\n    - 9da6d5d77be11712527dcab86df449a3\n    - a6e01bc1ab89f8d91d9eab72032aae88\n    - b24c5eddaea4fe50c6a96a2a133521e4\n    - d21bbc50dcc169d7b4d0f01962793154\n    - fcc251cceae90d22c392215cc9a2d5d6\n    - 23867a89c2b8fc733be6cf5ef902f2d1\n    - a37ff327f8d48e8a4d2f757e1b6e70bc\n    - f9a28c458284584a93b14216308d31bd\n    - 6118619783fc175bc7ebecff0769b46e\n    - 959a83047e80ab68b368fdb3f4c6e4ea\n    - 563233bfa169acc7892451f71ad5850a\n    - 87575cb7a0e0700eb37f2e3668671a08\n    - 13f08707f759af6003837a150a371ba1\n    - 1781f06048a7e58b323f0b9259be798b\n    - 233f85f2d4bc9d6521a6caae11a1e7f5\n    - 24af2584cbf4d60bbe5c6d1b31b3be6d\n    - 632969ddf6dbf4e0f53424b75e4b91f2\n    - 713c29b396b907ed71a72482759ed757\n    - 749a7bb1f0b4c4455949c0b2bf7f9e9f\n    - 8628b2608957a6b0c6330ac3de28ce2e\n    - 8b114550386e31895dfab371e741123d\n    - 94cb940a1a6b65bed4d5a8f849ce9793\n    - 9d68781980370e00e0bd939ee5e6c141\n    - b18a1401ff8f444056d29450fbc0a6ce\n    - cb567f9498452721d77a451374955f5f\n    - 730073214094cd328547bf1f72289752\n    - 17b461a082950fc6332228572138b80c\n    - dc25ee78e2ef4d36faa0badf1e7461c9\n    - 819b19d53ca6736448f9325a85736792\n    - 829da329ce140d873b4a8bde2cbfaa7e\n    - c547f2e66061a8dffb6f5a3ff63c0a74\n    - 0588081ab0e63ba785938467e1b10cca\n    - 0d9ec08bac6c07d9987dfd0f1506587c\n    - bc129092b71c89b4d4c8cdf8ea590b29\n    - 4da924cf622d039d58bce71cdf05d242\n    - e7a3a5c377e2d29324093377d7db1c66\n    - 9a9dbec5c62f0380b4fa5fd31deffedf\n    - af8a3976ad71e5d5fdfb67ddb8dadfce\n    - 0c477898bbf137bbd6f2a54e3b805ff4\n    - 0ca9f02b537bcea20d4ea5eb1a9fe338\n    - 3ab3655e5a14d4eefc547f4781bf7f9e\n    - e6f9d5152da699934b30daab206471f6\n    - 3ad59991ccf1d67339b319b15a41b35d\n    - ffdd59e0318b85a3e480874d9796d872\n    - 0cf479628d7cc1ea25ec7998a92f5051\n    - 07a2d4dcbd6cb2c6a45e6b101f0b6d51\n    - d6d0f80386e1380d05cb78e871bc72b1\n    - 38d9e015591bbfd4929e0d0f47fa0055\n    - 0e2216679ca6e1094d63322e3412d650\n    - ada161bf41b8e5e9132858cb54cab5fb\n    - 2a1bc4913cd5ecb0434df07cb675b798\n    - 11083e75553baae21dc89ce8f9a195e4\n    - a23d29c9e566f2fa8ffbb79267f5df80\n    - 4a07f944a83e8a7c2525efa35dd30e2f\n    - 767637c23bb42cd5d7397cf58b0be688\n    - 14c4e4c72ba075e9069ee67f39188ad8\n    - 3c782813d4afce07bbfc5a9772acdbdc\n    - 7d010c6bb6a3726f327f7e239166d127\n    - 89159ba4dd04e4ce5559f132a9964eb3\n    - 6f33f4a5fc42b8cec7314947bd13f30f\n    - 5834ed4291bdeb928270428ebbaf7604\n    - 5a8a8a43f25485e7ee1b201edcbc7a38\n    - dc7d30b90b2d8abf664fbed2b1b59894\n    - 41923ea1f824fe63ea5beb84db7a3e74\n    - 3de09703c8e79ed2ca3f01074719906b\n    - a53a02b997935fd8eedcb5f7abab9b9f\n    - e96a73c7bf33a464c510ede582318bf2\n    - 32089b8851bbf8bc2d014e9f37288c83\n    - 09D278F9DE118EF09163C6140255C690\n    - 03866661686829d806989e2fc5a72606\n    - e57401fbdadcd4571ff385ab82bd5d6d\n    - 84B763C45C0E4A3E7CA5548C710DB4EE\n    - 19584675d94829987952432e018d5056\n    - 330768a4f172e10acb6287b87289d83b\n    - 885c99ccfbe77d1cbfcb9c4e7c1a3313\n    - 22a22bc9e4e0d2f189f1ea01748816ac\n    - 7fa30e6bb7e8e8a69155636e50bf1b28\n  - Hash|contains:\n    - IMPHASH=BCCA3C247B619DCD13C8CDFF5F123932\n    - IMPHASH=3A19059BD7688CB88E70005F18EFC439\n    - IMPHASH=bf6223a49e45d99094406777eb6004ba\n    - IMPHASH=0C106686A31BFE2BA931AE1CF6E9DBC6\n    - IMPHASH=0D1447D4B3259B3C2A1D4CFB7ECE13C3\n    - IMPHASH=1B0369A1E06271833F78FFA70FFB4EAF\n    - IMPHASH=4C1B52A19748428E51B14C278D0F58E3\n    - IMPHASH=4D927A711F77D62CEBD4F322CB57EC6F\n    - IMPHASH=66EE036DF5FC1004D9ED5E9A94A1086A\n    - IMPHASH=672B13F4A0B6F27D29065123FE882DFC\n    - IMPHASH=6BBD59CEA665C4AFCC2814C1327EC91F\n    - IMPHASH=725BB81DC24214F6ECACC0CFB36AD30D\n    - IMPHASH=9528A0E91E28FBB88AD433FEABCA2456\n    - IMPHASH=9DA6D5D77BE11712527DCAB86DF449A3\n    - IMPHASH=A6E01BC1AB89F8D91D9EAB72032AAE88\n    - IMPHASH=B24C5EDDAEA4FE50C6A96A2A133521E4\n    - IMPHASH=D21BBC50DCC169D7B4D0F01962793154\n    - IMPHASH=FCC251CCEAE90D22C392215CC9A2D5D6\n    - IMPHASH=23867A89C2B8FC733BE6CF5EF902F2D1\n    - IMPHASH=A37FF327F8D48E8A4D2F757E1B6E70BC\n    - IMPHASH=F9A28C458284584A93B14216308D31BD\n    - IMPHASH=6118619783FC175BC7EBECFF0769B46E\n    - IMPHASH=959A83047E80AB68B368FDB3F4C6E4EA\n    - IMPHASH=563233BFA169ACC7892451F71AD5850A\n    - IMPHASH=87575CB7A0E0700EB37F2E3668671A08\n    - IMPHASH=13F08707F759AF6003837A150A371BA1\n    - IMPHASH=1781F06048A7E58B323F0B9259BE798B\n    - IMPHASH=233F85F2D4BC9D6521A6CAAE11A1E7F5\n    - IMPHASH=24AF2584CBF4D60BBE5C6D1B31B3BE6D\n    - IMPHASH=632969DDF6DBF4E0F53424B75E4B91F2\n    - IMPHASH=713C29B396B907ED71A72482759ED757\n    - IMPHASH=749A7BB1F0B4C4455949C0B2BF7F9E9F\n    - IMPHASH=8628B2608957A6B0C6330AC3DE28CE2E\n    - IMPHASH=8B114550386E31895DFAB371E741123D\n    - IMPHASH=94CB940A1A6B65BED4D5A8F849CE9793\n    - IMPHASH=9D68781980370E00E0BD939EE5E6C141\n    - IMPHASH=B18A1401FF8F444056D29450FBC0A6CE\n    - IMPHASH=CB567F9498452721D77A451374955F5F\n    - IMPHASH=730073214094CD328547BF1F72289752\n    - IMPHASH=17B461A082950FC6332228572138B80C\n    - IMPHASH=DC25EE78E2EF4D36FAA0BADF1E7461C9\n    - IMPHASH=819B19D53CA6736448F9325A85736792\n    - IMPHASH=829DA329CE140D873B4A8BDE2CBFAA7E\n    - IMPHASH=C547F2E66061A8DFFB6F5A3FF63C0A74\n    - IMPHASH=0588081AB0E63BA785938467E1B10CCA\n    - IMPHASH=0D9EC08BAC6C07D9987DFD0F1506587C\n    - IMPHASH=BC129092B71C89B4D4C8CDF8EA590B29\n    - IMPHASH=4DA924CF622D039D58BCE71CDF05D242\n    - IMPHASH=E7A3A5C377E2D29324093377D7DB1C66\n    - IMPHASH=9A9DBEC5C62F0380B4FA5FD31DEFFEDF\n    - IMPHASH=AF8A3976AD71E5D5FDFB67DDB8DADFCE\n    - IMPHASH=0C477898BBF137BBD6F2A54E3B805FF4\n    - IMPHASH=0CA9F02B537BCEA20D4EA5EB1A9FE338\n    - IMPHASH=3AB3655E5A14D4EEFC547F4781BF7F9E\n    - IMPHASH=E6F9D5152DA699934B30DAAB206471F6\n    - IMPHASH=3AD59991CCF1D67339B319B15A41B35D\n    - IMPHASH=FFDD59E0318B85A3E480874D9796D872\n    - IMPHASH=0CF479628D7CC1EA25EC7998A92F5051\n    - IMPHASH=07A2D4DCBD6CB2C6A45E6B101F0B6D51\n    - IMPHASH=D6D0F80386E1380D05CB78E871BC72B1\n    - IMPHASH=38D9E015591BBFD4929E0D0F47FA0055\n    - IMPHASH=0E2216679CA6E1094D63322E3412D650\n    - IMPHASH=ADA161BF41B8E5E9132858CB54CAB5FB\n    - IMPHASH=2A1BC4913CD5ECB0434DF07CB675B798\n    - IMPHASH=11083E75553BAAE21DC89CE8F9A195E4\n    - IMPHASH=A23D29C9E566F2FA8FFBB79267F5DF80\n    - IMPHASH=4A07F944A83E8A7C2525EFA35DD30E2F\n    - IMPHASH=767637C23BB42CD5D7397CF58B0BE688\n    - IMPHASH=14C4E4C72BA075E9069EE67F39188AD8\n    - IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC\n    - IMPHASH=7D010C6BB6A3726F327F7E239166D127\n    - IMPHASH=89159BA4DD04E4CE5559F132A9964EB3\n    - IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F\n    - IMPHASH=5834ED4291BDEB928270428EBBAF7604\n    - IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38\n    - IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894\n    - IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74\n    - IMPHASH=3DE09703C8E79ED2CA3F01074719906B\n    - IMPHASH=A53A02B997935FD8EEDCB5F7ABAB9B9F\n    - IMPHASH=E96A73C7BF33A464C510EDE582318BF2\n    - IMPHASH=32089B8851BBF8BC2D014E9F37288C83\n    - IMPHASH=09D278F9DE118EF09163C6140255C690\n    - IMPHASH=03866661686829d806989e2fc5a72606\n    - IMPHASH=e57401fbdadcd4571ff385ab82bd5d6d\n    - IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE\n    - IMPHASH=19584675D94829987952432E018D5056\n    - IMPHASH=330768A4F172E10ACB6287B87289D83B\n    - IMPHASH=885C99CCFBE77D1CBFCB9C4E7C1A3313\n    - IMPHASH=22A22BC9E4E0D2F189F1EA01748816AC\n    - IMPHASH=7FA30E6BB7E8E8A69155636E50BF1B28\nfalsepositives:\n- Unknown\nfields:\n- TargetFilename\n- Image\nid: 19b041f6-e583-40dc-b842-d6fa8011493f\nlevel: high\nlogsource:\n  category: create_stream_hash\n  definition: Requirements Sysmon config with Imphash logging activated\n  product: windows\nmodified: 2022/12/30\nreferences:\n- https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90015\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.s0139\n- attack.t1564.004\ntitle: Hacktool Download\n",
                            "sigma:id": "19b041f6-e583-40dc-b842-d6fa8011493f",
                            "title": "Hacktool Download",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "a96970af-f126-420d-90e1-d37bf25e50e1",
                        "lookup_data": {
                            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid Image detection",
                            "raw": "author: frack113, Nasreddine Bencherchali\ndate: 2022/08/07\ndescription: Detect use of the Windows 8.3 short name. Which could be used as a method\n  to avoid Image detection\ndetection:\n  condition: selection and not 1 of filter*\n  filter1:\n  - ParentImage:\n    - C:\\Windows\\System32\\Dism.exe\n    - C:\\Windows\\System32\\cleanmgr.exe\n  - ParentImage|endswith:\n    - \\WebEx\\WebexHost.exe\n    - \\thor\\thor64.exe\n  - Product: InstallShield (R)\n  - Description: InstallShield (R) Setup Engine\n  - Company: InstallShield Software Corporation\n  filter_installers:\n  - Image|contains|all:\n    - \\AppData\\\n    - \\Temp\\\n  - Image|endswith:\n    - ~1\\unzip.exe\n    - ~1\\7zG.exe\n  selection:\n    Image|contains:\n    - ~1\\\n    - ~2\\\nfalsepositives:\n- Applications could use this notation occasionally which might generate some false\n  positives. In that case Investigate the parent and child process.\nid: a96970af-f126-420d-90e1-d37bf25e50e1\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/09/18\nreferences:\n- https://www.acunetix.com/blog/articles/windows-short-8-3-filenames-web-security-problem/\n- https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc959352(v=technet.10)?redirectedfrom=MSDN\n- https://twitter.com/frack113/status/1555830623633375232\nrelated:\n- id: 349d891d-fef0-4fe4-bc53-eee623a15969\n  type: similar\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1564.004\ntitle: Use Short Name Path in Image\n",
                            "sigma:id": "a96970af-f126-420d-90e1-d37bf25e50e1",
                            "title": "Use Short Name Path in Image",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "7f43c430-5001-4f8b-aaa9-c3b88f18fa5c",
                        "lookup_data": {
                            "description": "Detects execution from an Alternate Data Stream (ADS). Adversaries may use NTFS file attributes to hide their malicious data in order to evade detection",
                            "raw": "author: frack113\ndate: 2021/09/01\ndescription: Detects execution from an Alternate Data Stream (ADS). Adversaries may\n  use NTFS file attributes to hide their malicious data in order to evade detection\ndetection:\n  condition: selection_stream and (1 of selection_tools_*)\n  selection_stream:\n    CommandLine|contains: 'txt:'\n  selection_tools_esentutl:\n    CommandLine|contains|all:\n    - 'esentutl '\n    - ' /y '\n    - ' /d '\n    - ' /o '\n  selection_tools_makecab:\n    CommandLine|contains|all:\n    - 'makecab '\n    - .cab\n  selection_tools_reg:\n    CommandLine|contains|all:\n    - 'reg '\n    - ' export '\n  selection_tools_regedit:\n    CommandLine|contains|all:\n    - 'regedit '\n    - ' /E '\n  selection_tools_type:\n    CommandLine|contains|all:\n    - 'type '\n    - ' > '\nfalsepositives:\n- Unknown\nid: 7f43c430-5001-4f8b-aaa9-c3b88f18fa5c\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.004/T1564.004.md\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1564.004\ntitle: Execute From Alternate Data Streams\n",
                            "sigma:id": "7f43c430-5001-4f8b-aaa9-c3b88f18fa5c",
                            "title": "Execute From Alternate Data Streams",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "349d891d-fef0-4fe4-bc53-eee623a15969",
                        "lookup_data": {
                            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid command-line detection",
                            "raw": "author: frack113, Nasreddine Bencherchali\ndate: 2022/08/07\ndescription: Detect use of the Windows 8.3 short name. Which could be used as a method\n  to avoid command-line detection\ndetection:\n  condition: selection and not filter\n  filter:\n  - ParentImage:\n    - C:\\Windows\\System32\\Dism.exe\n    - C:\\Windows\\System32\\cleanmgr.exe\n    - C:\\Program Files\\GPSoftware\\Directory Opus\\dopus.exe\n  - ParentImage|endswith:\n    - \\WebEx\\WebexHost.exe\n    - \\thor\\thor64.exe\n    - \\veam.backup.shell.exe\n    - \\winget.exe\n    - \\Everything\\Everything.exe\n  - ParentImage|contains: \\AppData\\Local\\Temp\\WinGet\\\n  - CommandLine|contains:\n    - \\appdata\\local\\webex\\webex64\\meetings\\wbxreport.exe\n    - C:\\Program Files\\Git\\post-install.bat\n    - C:\\Program Files\\Git\\cmd\\scalar.exe\n  selection:\n    CommandLine|contains:\n    - ~1\\\n    - ~2\\\nfalsepositives:\n- Applications could use this notation occasionally which might generate some false\n  positives. In that case investigate the parent and child process.\nid: 349d891d-fef0-4fe4-bc53-eee623a15969\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/10/26\nreferences:\n- https://www.acunetix.com/blog/articles/windows-short-8-3-filenames-web-security-problem/\n- https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc959352(v=technet.10)?redirectedfrom=MSDN\n- https://twitter.com/frack113/status/1555830623633375232\nrelated:\n- id: a96970af-f126-420d-90e1-d37bf25e50e1\n  type: similar\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1564.004\ntitle: Use Short Name Path in Command Line\n",
                            "sigma:id": "349d891d-fef0-4fe4-bc53-eee623a15969",
                            "title": "Use Short Name Path in Command Line",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "8c521530-5169-495d-a199-0a3a881ad24e",
                        "lookup_data": {
                            "description": "Detects writing data into NTFS alternate data streams from powershell. Needs Script Block Logging.",
                            "raw": "author: Sami Ruohonen\ndate: 2018/07/24\ndescription: Detects writing data into NTFS alternate data streams from powershell.\n  Needs Script Block Logging.\ndetection:\n  condition: all of selection*\n  selection_content:\n    ScriptBlockText|contains:\n    - set-content\n    - add-content\n  selection_stream:\n    ScriptBlockText|contains: -stream\nfalsepositives:\n- Unknown\nid: 8c521530-5169-495d-a199-0a3a881ad24e\nlevel: high\nlogsource:\n  category: ps_script\n  definition: 'Requirements: Script Block Logging must be enabled'\n  product: windows\nmodified: 2022/12/25\nreferences:\n- http://www.powertheshell.com/ntfsstreams/\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.004/T1564.004.md\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1564.004\n- attack.execution\n- attack.t1059.001\ntitle: NTFS Alternate Data Stream\n",
                            "sigma:id": "8c521530-5169-495d-a199-0a3a881ad24e",
                            "title": "NTFS Alternate Data Stream",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "cafeeba3-01da-4ab4-b6c4-a31b1d9730c7",
                        "lookup_data": {
                            "description": "Detects the execution of the LOLBIN PrintBrm.exe, which can be used to create or extract ZIP files. PrintBrm.exe should not be run on a normal workstation.",
                            "raw": "author: frack113\ndate: 2022/05/02\ndescription: Detects the execution of the LOLBIN PrintBrm.exe, which can be used to\n  create or extract ZIP files. PrintBrm.exe should not be run on a normal workstation.\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - ' -f'\n    - .zip\n    Image|endswith: \\PrintBrm.exe\nfalsepositives:\n- Unknown\nid: cafeeba3-01da-4ab4-b6c4-a31b1d9730c7\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/PrintBrm/\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1105\n- attack.defense_evasion\n- attack.t1564.004\ntitle: PrintBrm ZIP Creation of Extraction\n",
                            "sigma:id": "cafeeba3-01da-4ab4-b6c4-a31b1d9730c7",
                            "title": "PrintBrm ZIP Creation of Extraction",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "3ef5605c-9eb9-47b0-9a71-b727e6aa5c3b",
                        "lookup_data": {
                            "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid Image based detection",
                            "raw": "author: frack113, Nasreddine Bencherchali\ndate: 2022/08/06\ndescription: Detect use of the Windows 8.3 short name. Which could be used as a method\n  to avoid Image based detection\ndetection:\n  condition: selection and not filter\n  filter:\n  - ParentImage|endswith:\n    - \\WebEx\\WebexHost.exe\n    - \\thor\\thor64.exe\n    - -installer.exe\n  - Image|contains: \\vcredi\n  - ParentImage: C:\\Windows\\explorer.exe\n  selection:\n    Image|contains:\n    - ~1.exe\n    - ~1.bat\n    - ~1.msi\n    - ~1.vbe\n    - ~1.vbs\n    - ~1.dll\n    - ~1.ps1\n    - ~1.js\n    - ~1.hta\n    - ~2.exe\n    - ~2.bat\n    - ~2.msi\n    - ~2.vbe\n    - ~2.vbs\n    - ~2.dll\n    - ~2.ps1\n    - ~2.js\n    - ~2.hta\nfalsepositives:\n- Unknown\nid: 3ef5605c-9eb9-47b0-9a71-b727e6aa5c3b\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/12\nreferences:\n- https://www.acunetix.com/blog/articles/windows-short-8-3-filenames-web-security-problem/\n- https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc959352(v=technet.10)?redirectedfrom=MSDN\n- https://twitter.com/jonasLyk/status/1555914501802921984\nrelated:\n- id: dd6b39d9-d9be-4a3b-8fe0-fe3c6a5c1795\n  type: similar\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1564.004\ntitle: Use NTFS Short Name in Image\n",
                            "sigma:id": "3ef5605c-9eb9-47b0-9a71-b727e6aa5c3b",
                            "title": "Use NTFS Short Name in Image",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "70e68156-6571-427b-a6e9-4476a173a9b6",
                        "lookup_data": {
                            "description": "Detects the redirection of an alternate data stream (ADS) of / within a Windows command line session",
                            "raw": "author: frack113\ndate: 2022/02/04\ndescription: Detects the redirection of an alternate data stream (ADS) of / within\n  a Windows command line session\ndetection:\n  condition: selection and not filter\n  filter:\n    CommandLine|contains: :\\\n  selection:\n    CommandLine|contains|all:\n    - '> '\n    - ':'\n    Image|endswith: \\cmd.exe\nfalsepositives:\n- Unknown\nid: 70e68156-6571-427b-a6e9-4476a173a9b6\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/07/14\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.004/T1564.004.md#atomic-test-3---create-ads-command-prompt\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1564.004\ntitle: Cmd Stream Redirection\n",
                            "sigma:id": "70e68156-6571-427b-a6e9-4476a173a9b6",
                            "title": "Cmd Stream Redirection",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": [
            {
                "attack_technique": "T1564.004",
                "display_name": "Hide Artifacts: NTFS File Attributes",
                "atomic_tests": [
                    {
                        "name": "Alternate Data Streams (ADS)",
                        "auto_generated_guid": "8822c3b0-d9f9-4daf-a043-49f4602364f4",
                        "description": "Execute from Alternate Streams\n\n[Reference - 1](https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f)\n\n[Reference - 2](https://oddvar.moe/2018/01/14/putting-data-in-alternate-data-streams-and-how-to-execute-it/)\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "path": {
                                "description": "Path of ADS file",
                                "type": "path",
                                "default": "c:\\ADS\\"
                            }
                        },
                        "executor": {
                            "command": "type C:\\temp\\evil.exe > \"C:\\Program Files (x86)\\TeamViewer\\TeamViewer12_Logfile.log:evil.exe\"\nextrac32 #{path}\\procexp.cab #{path}\\file.txt:procexp.exe\nfindstr /V /L W3AllLov3DonaldTrump #{path}\\procexp.exe > #{path}\\file.txt:procexp.exe\ncertutil.exe -urlcache -split -f https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1564.004/src/test.ps1 c:\\temp:ttt\nmakecab #{path}\\autoruns.exe #{path}\\cabtest.txt:autoruns.cab\nprint /D:#{path}\\file.txt:autoruns.exe #{path}\\Autoruns.exe\nreg export HKLM\\SOFTWARE\\Microsoft\\Evilreg #{path}\\file.txt:evilreg.reg\nregedit /E #{path}\\file.txt:regfile.reg HKEY_CURRENT_USER\\MyCustomRegKey\nexpand \\\\webdav\\folder\\file.bat #{path}\\file.txt:file.bat\nesentutl.exe /y #{path}\\autoruns.exe /d #{path}\\file.txt:autoruns.exe /o \n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Store file in Alternate Data Stream (ADS)",
                        "auto_generated_guid": "2ab75061-f5d5-4c1a-b666-ba2a50df5b02",
                        "description": "Storing files in Alternate Data Stream (ADS) similar to Astaroth malware.\nUpon execution cmd will run and attempt to launch desktop.ini. No windows remain open after the test\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "payload_path": {
                                "description": "Path of file to hide in ADS",
                                "type": "path",
                                "default": "c:\\windows\\system32\\cmd.exe"
                            },
                            "ads_file_path": {
                                "description": "Path of file to create an ADS under",
                                "type": "path",
                                "default": "C:\\Users\\Public\\Libraries\\yanki\\desktop.ini"
                            },
                            "ads_name": {
                                "description": "Name of ADS",
                                "type": "string",
                                "default": "desktop.ini"
                            }
                        },
                        "executor": {
                            "command": "if (!(Test-Path C:\\Users\\Public\\Libraries\\yanki -PathType Container)) {\n    New-Item -ItemType Directory -Force -Path C:\\Users\\Public\\Libraries\\yanki\n    }\nStart-Process -FilePath \"$env:comspec\" -ArgumentList \"/c,type,#{payload_path},>,`\"#{ads_file_path}:#{ads_name}`\"\"\n",
                            "cleanup_command": "Remove-Item \"#{ads_file_path}\" -Force -ErrorAction Ignore\n",
                            "name": "powershell"
                        }
                    },
                    {
                        "name": "Create ADS command prompt",
                        "auto_generated_guid": "17e7637a-ddaf-4a82-8622-377e20de8fdb",
                        "description": "Create an Alternate Data Stream with the command prompt. Write access is required. Upon execution, run \"dir /a-d /s /r | find \":$DATA\"\" in the %temp%\nfolder to view that the alternate data stream exists. To view the data in the alternate data stream, run \"notepad T1564.004_has_ads.txt:adstest.txt\"\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "file_name": {
                                "description": "File name of file to create ADS on.",
                                "type": "string",
                                "default": "%temp%\\T1564.004_has_ads_cmd.txt"
                            },
                            "ads_filename": {
                                "description": "Name of ADS.",
                                "type": "string",
                                "default": "adstest.txt"
                            }
                        },
                        "executor": {
                            "command": "echo cmd /c echo \"Shell code execution.\"> #{file_name}:#{ads_filename}\nfor /f \"usebackq delims=?\" %i in (#{file_name}:#{ads_filename}) do %i\n",
                            "cleanup_command": "del #{file_name} >nul 2>&1\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Create ADS PowerShell",
                        "auto_generated_guid": "0045ea16-ed3c-4d4c-a9ee-15e44d1560d1",
                        "description": "Create an Alternate Data Stream with PowerShell. Write access is required. To verify execution, the the command \"ls -Recurse | %{ gi $_.Fullname -stream *} | where stream -ne ':$Data' | Select-Object pschildname\"\nin the %temp% direcotry to view all files with hidden data streams. To view the data in the alternate data stream, run \"notepad.exe T1564.004_has_ads_powershell.txt:adstest.txt\" in the %temp% folder.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "file_name": {
                                "description": "File name of file to create ADS on.",
                                "type": "string",
                                "default": "$env:TEMP\\T1564.004_has_ads_powershell.txt"
                            },
                            "ads_filename": {
                                "description": "Name of ADS file.",
                                "type": "string",
                                "default": "adstest.txt"
                            }
                        },
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "The file must exist on disk at specified location (#{file_name})\n",
                                "prereq_command": "if (Test-Path #{file_name}) { exit 0 } else { exit 1 }\n",
                                "get_prereq_command": "New-Item -Path #{file_name} | Out-Null\n"
                            }
                        ],
                        "executor": {
                            "command": "echo \"test\" > #{file_name} | set-content -path test.txt -stream #{ads_filename} -value \"test\"\nset-content -path #{file_name} -stream #{ads_filename} -value \"test2\"\nset-content -path . -stream #{ads_filename} -value \"test3\"\n",
                            "cleanup_command": "Remove-Item -Path #{file_name} -ErrorAction Ignore\n",
                            "name": "powershell"
                        }
                    },
                    {
                        "name": "Create Hidden Directory via $index_allocation",
                        "auto_generated_guid": "3e6791e7-232c-481c-a680-a52f86b83fdf",
                        "description": "Create an Alternate Data Stream Directory and File with the command prompt. Write access is required. Upon execution, \nrun \"dir /A /Q /R\" in the %temp% folder to view that the alternate data stream folder exists. To view the data in the  \nalternate data stream, run \"type %temp%\\...$.......::$index_allocation\\secrets.txt\"\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "folder_name": {
                                "description": "File name of file to create inside the folder.",
                                "type": "string",
                                "default": "%temp%\\...$.......::$index_allocation"
                            },
                            "hidden_filename": {
                                "description": "Name of the files containing the hidden information",
                                "type": "string",
                                "default": "secrets.txt"
                            }
                        },
                        "executor": {
                            "command": "md #{folder_name}\necho too many secrets > #{folder_name}\\#{hidden_filename}\n",
                            "cleanup_command": "rmdir /S /Q #{folder_name} >nul 2>&1\n",
                            "name": "command_prompt"
                        }
                    }
                ]
            }
        ]
    },
    "timestamp": "2025-02-28 16:55:25"
}