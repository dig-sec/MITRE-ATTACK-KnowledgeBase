{
    "id": "T1078",
    "name": "Valid Accounts",
    "description": "Adversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop. Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.\nThe overlap of permissions for local, domain, and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise. (Citation: TechNet Credential Theft)",
    "platforms": "Windows, Azure AD, Office 365, SaaS, IaaS, Linux, macOS, Google Workspace, Containers",
    "kill_chain_phases": "Defense Evasion, Persistence, Privilege Escalation, Initial Access",
    "data_sources": "Logon Session: Logon Session Metadata, User Account: User Account Authentication, Logon Session: Logon Session Creation",
    "detection": "Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services. (Citation: TechNet Audit Policy) Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).\nPerform regular audits of domain and local system accounts to detect accounts that may have been created by an adversary for persistence. Checks on these accounts could also include whether default accounts such as Guest have been activated. These audits should also include checks on any appliances and applications for default credentials or SSH keys, and if any are discovered, they should be updated immediately.",
    "url": "https://attack.mitre.org/techniques/T1078",
    "enrichments": {
        "attack_rule_map": [],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "5d9b516c-e5f0-4e7c-a958-5d8c0a019371",
                    "352a54e1-74ba-4929-9d47-8193d67aba1e",
                    "8366030e-7216-476b-9927-271d79f13cf3",
                    "0f63e1ef-1eb9-4226-9d54-8927ca08520a",
                    "a61a3c56-4ce2-4351-a079-88ae4cbd2b58",
                    "9eb99343-d336-4020-a3cd-67f3819e68ee",
                    "3ff152b2-1388-4984-9cd9-a323323fdadf",
                    "83e15192-96d8-476c-aa39-0317de8dba80",
                    "5e78dc2c-afc8-411f-94a5-40bb950d210f",
                    "56fa3cd6-f8d6-4520-a8c7-607292971886",
                    "f272fb46-25f2-422c-b667-45837994980f",
                    "c265cf08-3f99-46c1-8d59-328247057d57",
                    "8ad1600d-e9dc-4251-b0ee-a65268f29add",
                    "39698b3f-da92-4bc6-bfb5-645a98386e45",
                    "259a9cdf-c4dd-4fa2-b243-2269e5ab18a2",
                    "6309ffc4-8fa2-47cf-96b8-a2f72e58e538",
                    "d914951b-52c8-485f-875e-86abab710c0b",
                    "50e606bf-04ce-4ca7-9d54-3449494bbd4b",
                    "a7c0ae48-8df8-42bf-91bd-2ea57e2f9d43",
                    "a557ffe6-ac54-43d2-ae69-158027082350",
                    "e1d02b53-c03c-4948-b11d-4d00cca49d03",
                    "aeaef14c-e5bf-4690-a9c8-835caad458bd",
                    "248649b7-d64f-46f0-9fb2-a52774166fb5",
                    "e98374a6-e2d9-4076-9b5c-11bdb2569995",
                    "c191e2fa-f9d6-4ccf-82af-4f2aba08359f",
                    "78d5cab4-557e-454f-9fb9-a222bd0d5edc",
                    "6f583da0-3a90-4566-a4ed-83c09fe18bbf",
                    "5f17a0c6-7b04-4f05-9fda-b5d435a8d6a4",
                    "941e5c45-cda7-4864-8cea-bbb7458d194a",
                    "ca9bf243-465e-494a-9e54-bf9fc239057d",
                    "d45f03a8-790a-4f90-b956-cd7e5b8886bf",
                    "55695bc0-c8cf-461f-a379-2535f563c854",
                    "67d5f8fc-8325-44e4-8f5f-7c0ac07cb5ae",
                    "f88e112a-21aa-44bd-9b01-6ee2a2bbbed1",
                    "4ad97bf5-a514-41a4-abd3-4f3455ad4865",
                    "572b12d4-9062-11ed-a1eb-0242ac120002",
                    "5ee3822c-6828-418c-b619-62de950d210f",
                    "5cccb246-0da0-4c93-a463-61fe0a016219",
                    "6ad91e31-53df-4826-bd27-0166171c8040",
                    "b17a1a56-e99c-403c-8948-561df0cffe81",
                    "d7eab125-5f94-43df-8710-795b80fa1189",
                    "e3818659-5016-4811-a73c-dde4679169d2",
                    "ebbeb024-5b1d-4e16-9c0c-917f86c708a7",
                    "f43f5d2f-3f2a-4cc8-b1af-81fde7dbaf0e"
                ],
                "lookup_results": [
                    {
                        "uuid": "5d9b516c-e5f0-4e7c-a958-5d8c0a019371",
                        "lookup_data": {
                            "description": "Operation Ghost - White Paper",
                            "link": "http://www.botvrij.eu/data/feed-osint/5d9b516c-e5f0-4e7c-a958-5d8c0a019371.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1571855044",
                            "uuid": "5d9b516c-e5f0-4e7c-a958-5d8c0a019371",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "352a54e1-74ba-4929-9d47-8193d67aba1e",
                        "lookup_data": {
                            "description": "Identifies when an user or application modified the federation settings on the domain.",
                            "raw": "author: Austin Songer\ndate: 2021/09/06\ndescription: Identifies when an user or application modified the federation settings\n  on the domain.\ndetection:\n  condition: selection\n  selection:\n    ActivityDisplayName: Set federation settings on domain\nfalsepositives:\n- Federation Settings being modified or deleted may be performed by a system administrator.\n- Verify whether the user identity, user agent, and/or hostname should be making changes\n  in your environment.\n- Federation Settings modified from unfamiliar users should be investigated. If known\n  behavior is causing false positives, it can be exempted from the rule.\nid: 352a54e1-74ba-4929-9d47-8193d67aba1e\nlevel: medium\nlogsource:\n  product: azure\n  service: auditlogs\nmodified: 2022/06/08\nreferences:\n- https://docs.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-monitor-federation-changes\nstatus: experimental\ntags:\n- attack.initial_access\n- attack.t1078\ntitle: Azure Domain Federation Settings Modified\n",
                            "sigma:id": "352a54e1-74ba-4929-9d47-8193d67aba1e",
                            "title": "Azure Domain Federation Settings Modified",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "8366030e-7216-476b-9927-271d79f13cf3",
                        "lookup_data": {
                            "description": "Detects when there is a interruption in the authentication process.",
                            "raw": "author: Austin Songer @austinsonger\ndate: 2021/11/26\ndescription: Detects when there is a interruption in the authentication process.\ndetection:\n  condition: 1 of selection_*\n  selection_50097:\n    ResultDescription: Device authentication is required\n    ResultType: 50097\n  selection_50155:\n    ResultDescription: DeviceAuthenticationFailed\n    ResultType: 50155\n  selection_50158:\n    ResultDescription: ExternalSecurityChallenge - External security challenge was\n      not satisfied\n    ResultType: 50158\nfalsepositives:\n- Unknown\nid: 8366030e-7216-476b-9927-271d79f13cf3\nlevel: medium\nlogsource:\n  product: azure\n  service: signinlogs\nmodified: 2022/12/18\nreferences:\n- https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-privileged-accounts\nstatus: experimental\ntags:\n- attack.initial_access\n- attack.t1078\ntitle: Azure Unusual Authentication Interruption\n",
                            "sigma:id": "8366030e-7216-476b-9927-271d79f13cf3",
                            "title": "Azure Unusual Authentication Interruption",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "0f63e1ef-1eb9-4226-9d54-8927ca08520a",
                        "lookup_data": {
                            "description": "Detect remote login by Administrator user (depending on internal pattern).",
                            "raw": "author: juju4\ndate: 2017/10/29\ndescription: Detect remote login by Administrator user (depending on internal pattern).\ndetection:\n  condition: selection\n  selection:\n    AuthenticationPackageName: Negotiate\n    EventID: 4624\n    LogonType: 10\n    TargetUserName|startswith: Admin\nfalsepositives:\n- Legitimate administrative activity.\nid: 0f63e1ef-1eb9-4226-9d54-8927ca08520a\nlevel: low\nlogsource:\n  definition: 'Requirements: Identifiable administrators usernames (pattern or special\n    unique character. ex: \"Admin-*\"), internal policy mandating use only as secondary\n    account'\n  product: windows\n  service: security\nmodified: 2022/10/09\nreferences:\n- https://car.mitre.org/wiki/CAR-2016-04-005\nstatus: test\ntags:\n- attack.lateral_movement\n- attack.t1078.001\n- attack.t1078.002\n- attack.t1078.003\n- car.2016-04-005\ntitle: Admin User Remote Logon\n",
                            "sigma:id": "0f63e1ef-1eb9-4226-9d54-8927ca08520a",
                            "title": "Admin User Remote Logon",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "a61a3c56-4ce2-4351-a079-88ae4cbd2b58",
                        "lookup_data": {
                            "description": "Identifies when an admission controller is executed in Azure Kubernetes.\nA Kubernetes Admission controller intercepts, and possibly modifies, requests to the Kubernetes API server.\nThe behavior of this admission controller is determined by an admission webhook (MutatingAdmissionWebhook or ValidatingAdmissionWebhook) that the user deploys in the cluster.\nAn adversary can use such webhooks as the MutatingAdmissionWebhook for obtaining persistence in the cluster.\nFor example, attackers can intercept and modify the pod creation operations in the cluster and add their malicious container to every created pod.\nAn adversary can use the webhook ValidatingAdmissionWebhook, which could be used to obtain access credentials.\nAn adversary could use the webhook to intercept the requests to the API server, record secrets, and other sensitive information.\n",
                            "raw": "author: Austin Songer @austinsonger\ndate: 2021/11/25\ndescription: 'Identifies when an admission controller is executed in Azure Kubernetes.\n\n  A Kubernetes Admission controller intercepts, and possibly modifies, requests to\n  the Kubernetes API server.\n\n  The behavior of this admission controller is determined by an admission webhook\n  (MutatingAdmissionWebhook or ValidatingAdmissionWebhook) that the user deploys in\n  the cluster.\n\n  An adversary can use such webhooks as the MutatingAdmissionWebhook for obtaining\n  persistence in the cluster.\n\n  For example, attackers can intercept and modify the pod creation operations in the\n  cluster and add their malicious container to every created pod.\n\n  An adversary can use the webhook ValidatingAdmissionWebhook, which could be used\n  to obtain access credentials.\n\n  An adversary could use the webhook to intercept the requests to the API server,\n  record secrets, and other sensitive information.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    operationName|endswith:\n    - /MUTATINGWEBHOOKCONFIGURATIONS/WRITE\n    - /VALIDATINGWEBHOOKCONFIGURATIONS/WRITE\n    operationName|startswith:\n    - MICROSOFT.KUBERNETES/CONNECTEDCLUSTERS/ADMISSIONREGISTRATION.K8S.IO\n    - MICROSOFT.CONTAINERSERVICE/MANAGEDCLUSTERS/ADMISSIONREGISTRATION.K8S.IO\nfalsepositives:\n- Azure Kubernetes Admissions Controller may be done by a system administrator.\n- If known behavior is causing false positives, it can be exempted from the rule.\nid: a61a3c56-4ce2-4351-a079-88ae4cbd2b58\nlevel: medium\nlogsource:\n  product: azure\n  service: activitylogs\nmodified: 2022/12/18\nreferences:\n- https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations#microsoftkubernetes\nstatus: experimental\ntags:\n- attack.persistence\n- attack.t1078\n- attack.credential_access\n- attack.t1552\n- attack.t1552.007\ntitle: Azure Kubernetes Admission Controller\n",
                            "sigma:id": "a61a3c56-4ce2-4351-a079-88ae4cbd2b58",
                            "title": "Azure Kubernetes Admission Controller",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "9eb99343-d336-4020-a3cd-67f3819e68ee",
                        "lookup_data": {
                            "description": "This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted.",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/02/19\ndescription: This method uses uncommon error codes on failed logons to determine suspicious\n  activity and tampering with accounts that have been disabled or somehow restricted.\ndetection:\n  condition: selection and not filter\n  filter:\n    SubjectUserSid: S-1-0-0\n  selection:\n    EventID:\n    - 4625\n    - 4776\n    Status:\n    - '0xC0000072'\n    - '0xC000006F'\n    - '0xC0000070'\n    - '0xC0000413'\n    - '0xC000018C'\n    - '0xC000015B'\nfalsepositives:\n- User using a disabled account\nid: 9eb99343-d336-4020-a3cd-67f3819e68ee\nlevel: medium\nlogsource:\n  product: windows\n  service: security\nmodified: 2022/06/29\nreferences:\n- https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4625\n- https://twitter.com/SBousseaden/status/1101431884540710913\nstatus: experimental\ntags:\n- attack.persistence\n- attack.defense_evasion\n- attack.privilege_escalation\n- attack.initial_access\n- attack.t1078\ntitle: Account Tampering - Suspicious Failed Logon Reasons\n",
                            "sigma:id": "9eb99343-d336-4020-a3cd-67f3819e68ee",
                            "title": "Account Tampering - Suspicious Failed Logon Reasons",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "3ff152b2-1388-4984-9cd9-a323323fdadf",
                        "lookup_data": {
                            "description": "Detects interactive console logons to Server Systems",
                            "raw": "author: Florian Roth\ndate: 2017/03/17\ndescription: Detects interactive console logons to Server Systems\ndetection:\n  condition: selection and not filter\n  filter:\n    ComputerName: '%Workstations%'\n    LogonProcessName: Advapi\n  selection:\n    ComputerName:\n    - '%ServerSystems%'\n    - '%DomainControllers%'\n    EventID:\n    - 528\n    - 529\n    - 4624\n    - 4625\n    LogonType: 2\nfalsepositives:\n- Administrative activity via KVM or ILO board\nid: 3ff152b2-1388-4984-9cd9-a323323fdadf\nlevel: medium\nlogsource:\n  product: windows\n  service: security\ntags:\n- attack.lateral_movement\n- attack.t1078\ntitle: Interactive Logon to Server Systems\n",
                            "sigma:id": "3ff152b2-1388-4984-9cd9-a323323fdadf",
                            "title": "Interactive Logon to Server Systems",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "83e15192-96d8-476c-aa39-0317de8dba80",
                        "lookup_data": {
                            "description": "OSINT - Uber Breach & Attack Analysis",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/83e15192-96d8-476c-aa39-0317de8dba80.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1666020853",
                            "uuid": "83e15192-96d8-476c-aa39-0317de8dba80",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5e78dc2c-afc8-411f-94a5-40bb950d210f",
                        "lookup_data": {
                            "description": "Trickbot to Ryuk in Two Hours",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5e78dc2c-afc8-411f-94a5-40bb950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1585237597",
                            "uuid": "5e78dc2c-afc8-411f-94a5-40bb950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "56fa3cd6-f8d6-4520-a8c7-607292971886",
                        "lookup_data": {
                            "description": "Detects BGP failures which may be indicative of brute force attacks to manipulate routing",
                            "raw": "author: Tim Brown\ndate: 2023/01/09\ndescription: Detects BGP failures which may be indicative of brute force attacks to\n  manipulate routing\ndetection:\n  condition: keywords_bgp_cisco\n  keywords_bgp_cisco:\n    '|all':\n    - :179\n    - IP-TCP-3-BADAUTH\nfalsepositives:\n- Unlikely. Except due to misconfigurations\nfields:\n- tcpConnLocalAddress\n- tcpConnRemAddress\nid: 56fa3cd6-f8d6-4520-a8c7-607292971886\nlevel: low\nlogsource:\n  definition: 'Requirements: cisco bgp logs need to be enabled and ingested'\n  product: cisco\n  service: bgp\nmodified: 2023/01/23\nreferences:\n- https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf\nstatus: experimental\ntags:\n- attack.initial_access\n- attack.persistence\n- attack.privilege_escalation\n- attack.defense_evasion\n- attack.credential_access\n- attack.collection\n- attack.t1078\n- attack.t1110\n- attack.t1557\ntitle: Cisco BGP Authentication Failures\n",
                            "sigma:id": "56fa3cd6-f8d6-4520-a8c7-607292971886",
                            "title": "Cisco BGP Authentication Failures",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f272fb46-25f2-422c-b667-45837994980f",
                        "lookup_data": {
                            "description": "Detect when authentications to important application(s) only required single-factor authentication",
                            "raw": "author: MikeDuddington, '@dudders1'\ndate: 2022/07/28\ndescription: Detect when authentications to important application(s) only required\n  single-factor authentication\ndetection:\n  condition: selection\n  selection:\n    AppId: Insert Application ID use OR for multiple\n    AuthenticationRequirement: singleFactorAuthentication\n    Status: Success\nfalsepositives:\n- If this was approved by System Administrator.\nid: f272fb46-25f2-422c-b667-45837994980f\nlevel: medium\nlogsource:\n  product: azure\n  service: signinlogs\nreferences:\n- https://docs.microsoft.com/en-gb/azure/active-directory/fundamentals/security-operations-user-accounts\nstatus: experimental\ntags:\n- attack.t1078\ntitle: Authentications To Important Apps Using Single Factor Authentication\n",
                            "sigma:id": "f272fb46-25f2-422c-b667-45837994980f",
                            "title": "Authentications To Important Apps Using Single Factor Authentication",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "c265cf08-3f99-46c1-8d59-328247057d57",
                        "lookup_data": {
                            "description": "This rule triggers on user accounts that are added to the local Administrators group, which could be legitimate activity or a sign of privilege escalation activity",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/03/14\ndescription: This rule triggers on user accounts that are added to the local Administrators\n  group, which could be legitimate activity or a sign of privilege escalation activity\ndetection:\n  condition: selection and (1 of selection_group*) and not filter\n  filter:\n    SubjectUserName|endswith: $\n  selection:\n    EventID: 4732\n    Provider_Name: Microsoft-Windows-Security-Auditing\n  selection_group1:\n    TargetUserName|startswith: Administr\n  selection_group2:\n    TargetSid: S-1-5-32-544\nfalsepositives:\n- Legitimate administrative activity\nid: c265cf08-3f99-46c1-8d59-328247057d57\nlevel: medium\nlogsource:\n  product: windows\n  service: security\nmodified: 2021/01/17\nstatus: stable\ntags:\n- attack.privilege_escalation\n- attack.t1078\n- attack.persistence\n- attack.t1098\ntitle: User Added to Local Administrators\n",
                            "sigma:id": "c265cf08-3f99-46c1-8d59-328247057d57",
                            "title": "User Added to Local Administrators",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "8ad1600d-e9dc-4251-b0ee-a65268f29add",
                        "lookup_data": {
                            "description": "Detects AWS root account usage",
                            "raw": "author: vitaliy0x1\ndate: 2020/01/21\ndescription: Detects AWS root account usage\ndetection:\n  condition: selection_usertype and not selection_eventtype\n  selection_eventtype:\n    eventType: AwsServiceEvent\n  selection_usertype:\n    userIdentity.type: Root\nfalsepositives:\n- AWS Tasks That Require AWS Account Root User Credentials https://docs.aws.amazon.com/general/latest/gr/aws_tasks-that-require-root.html\nid: 8ad1600d-e9dc-4251-b0ee-a65268f29add\nlevel: medium\nlogsource:\n  product: aws\n  service: cloudtrail\nmodified: 2022/10/09\nreferences:\n- https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html\nstatus: test\ntags:\n- attack.privilege_escalation\n- attack.t1078.004\ntitle: AWS Root Credentials\n",
                            "sigma:id": "8ad1600d-e9dc-4251-b0ee-a65268f29add",
                            "title": "AWS Root Credentials",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "39698b3f-da92-4bc6-bfb5-645a98386e45",
                        "lookup_data": {
                            "description": "Detects suspicious computer name samtheadmin-{1..100}$ generated by hacktool",
                            "raw": "author: elhoim\ndate: 2022/09/09\ndescription: Detects suspicious computer name samtheadmin-{1..100}$ generated by hacktool\ndetection:\n  condition: 1 of selection*\n  selection1:\n    SamAccountName|endswith: $\n    SamAccountName|startswith: SAMTHEADMIN-\n  selection2:\n    TargetUserName|endswith: $\n    TargetUserName|startswith: SAMTHEADMIN-\nfalsepositives:\n- Unknown\nfields:\n- EventID\n- SamAccountName\n- SubjectUserName\n- TargetUserName\nid: 39698b3f-da92-4bc6-bfb5-645a98386e45\nlevel: critical\nlogsource:\n  product: windows\n  service: security\nmodified: 2023/01/04\nreferences:\n- https://twitter.com/malmoeb/status/1511760068743766026\n- https://github.com/WazeHell/sam-theadmin/blob/main/sam_the_admin.py\n- https://github.com/helloexp/0day/blob/614227a7b9beb0e91e7e2c6a5e532e6f7a8e883c/00-CVE_EXP/CVE-2021-42287/sam-the-admin/sam_the_admin.py\nstatus: experimental\ntags:\n- cve.2021.42278\n- cve.2021.42287\n- attack.persistence\n- attack.privilege_escalation\n- attack.t1078\ntitle: Win Susp Computer Name Containing Samtheadmin\n",
                            "sigma:id": "39698b3f-da92-4bc6-bfb5-645a98386e45",
                            "title": "Win Susp Computer Name Containing Samtheadmin",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "259a9cdf-c4dd-4fa2-b243-2269e5ab18a2",
                        "lookup_data": {
                            "description": "Detects successful logon from public IP address via RDP. This can indicate a publicly-exposed RDP port.",
                            "raw": "author: Micah Babinski, @micahbabinski\ndate: 2023/01/19\ndescription: Detects successful logon from public IP address via RDP. This can indicate\n  a publicly-exposed RDP port.\ndetection:\n  condition: selection and not filter\n  filter:\n    IpAddress|cidr:\n    - 10.0.0.0/8\n    - 172.16.0.0/12\n    - 192.168.0.0/16\n    - 224.0.0.0/4\n    - 127.0.0.0/8\n    SubjectUserName: '-'\n  selection:\n    EventID: 4624\n    LogonType: 10\nfalsepositives:\n- Legitimate or intentional inbound connections from public IP addresses on the RDP\n  port.\nid: 259a9cdf-c4dd-4fa2-b243-2269e5ab18a2\nlevel: medium\nlogsource:\n  product: windows\n  service: security\nreferences:\n- https://www.inversecos.com/2020/04/successful-4624-anonymous-logons-to.html\n- https://twitter.com/Purp1eW0lf/status/1616144561965002752\nrelated:\n- id: 78d5cab4-557e-454f-9fb9-a222bd0d5edc\n  type: derived\nstatus: experimental\ntags:\n- attack.initial_access\n- attack.credential_access\n- attack.t1133\n- attack.t1078\n- attack.t1110\ntitle: External Remote RDP Logon from Public IP\n",
                            "sigma:id": "259a9cdf-c4dd-4fa2-b243-2269e5ab18a2",
                            "title": "External Remote RDP Logon from Public IP",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "6309ffc4-8fa2-47cf-96b8-a2f72e58e538",
                        "lookup_data": {
                            "description": "Detects suspicious failed logins with different user accounts from a single source system",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/01/10\ndescription: Detects suspicious failed logins with different user accounts from a\n  single source system\ndetection:\n  condition: selection2 | count(TargetUserName) by Workstation > 3\n  selection2:\n    EventID: 4776\n    TargetUserName: '*'\n    Workstation: '*'\n  timeframe: 24h\nfalsepositives:\n- Terminal servers\n- Jump servers\n- Other multiuser systems like Citrix server farms\n- Workstations with frequently changing users\nid: 6309ffc4-8fa2-47cf-96b8-a2f72e58e538\nlevel: medium\nlogsource:\n  product: windows\n  service: security\nmodified: 2022/11/26\nrelated:\n- id: e98374a6-e2d9-4076-9b5c-11bdb2569995\n  type: derived\nstatus: test\ntags:\n- attack.persistence\n- attack.privilege_escalation\n- attack.t1078\ntitle: Failed NTLM Logins with Different Accounts from Single Source System\n",
                            "sigma:id": "6309ffc4-8fa2-47cf-96b8-a2f72e58e538",
                            "title": "Failed NTLM Logins with Different Accounts from Single Source System",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d914951b-52c8-485f-875e-86abab710c0b",
                        "lookup_data": {
                            "description": "Detects when an user creates or invokes a lambda function.",
                            "raw": "author: Austin Songer @austinsonger\ndate: 2021/10/03\ndescription: Detects when an user creates or invokes a lambda function.\ndetection:\n  condition: selection1 | near selection2\n  selection1:\n    eventName: CreateFunction\n    eventSource: lambda.amazonaws.com\n  selection2:\n    eventName: Invoke\n    eventSource: lambda.amazonaws.com\nfalsepositives:\n- Lambda Function created or invoked may be performed by a system administrator. Verify\n  whether the user identity, user agent, and/or hostname should be making changes\n  in your environment.\n- If known behavior is causing false positives, it can be exempted from the rule.\nid: d914951b-52c8-485f-875e-86abab710c0b\nlevel: low\nlogsource:\n  product: aws\n  service: cloudtrail\nmodified: 2022/12/25\nreferences:\n- https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/\nstatus: test\ntags:\n- attack.privilege_escalation\n- attack.t1078\ntitle: AWS Lambda Function Created or Invoked\n",
                            "sigma:id": "d914951b-52c8-485f-875e-86abab710c0b",
                            "title": "AWS Lambda Function Created or Invoked",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "50e606bf-04ce-4ca7-9d54-3449494bbd4b",
                        "lookup_data": {
                            "description": "Detects LDP failures which may be indicative of brute force attacks to manipulate MPLS labels",
                            "raw": "author: Tim Brown\ndate: 2023/01/09\ndescription: Detects LDP failures which may be indicative of brute force attacks to\n  manipulate MPLS labels\ndetection:\n  condition: selection_protocol and selection_keywords\n  selection_keywords:\n  - SOCKET_TCP_PACKET_MD5_AUTHEN_FAIL\n  - TCPMD5AuthenFail\n  selection_protocol:\n  - LDP\nfalsepositives:\n- Unlikely. Except due to misconfigurations\nfields:\n- tcpConnLocalAddress\n- tcpConnRemAddress\nid: 50e606bf-04ce-4ca7-9d54-3449494bbd4b\nlevel: low\nlogsource:\n  definition: 'Requirements: cisco ldp logs need to be enabled and ingested'\n  product: cisco\n  service: ldp\nreferences:\n- https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf\nstatus: experimental\ntags:\n- attack.initial_access\n- attack.persistence\n- attack.privilege_escalation\n- attack.defense_evasion\n- attack.credential_access\n- attack.collection\n- attack.t1078\n- attack.t1110\n- attack.t1557\ntitle: Cisco LDP Authentication Failures\n",
                            "sigma:id": "50e606bf-04ce-4ca7-9d54-3449494bbd4b",
                            "title": "Cisco LDP Authentication Failures",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "a7c0ae48-8df8-42bf-91bd-2ea57e2f9d43",
                        "lookup_data": {
                            "description": "Detects juniper BGP missing MD5 digest. Which may be indicative of brute force attacks to manipulate routing.",
                            "raw": "author: Tim Brown\ndate: 2023/01/09\ndescription: Detects juniper BGP missing MD5 digest. Which may be indicative of brute\n  force attacks to manipulate routing.\ndetection:\n  condition: keywords_bgp_juniper\n  keywords_bgp_juniper:\n    '|all':\n    - :179\n    - missing MD5 digest\nfalsepositives:\n- Unlikely. Except due to misconfigurations\nfields:\n- host\nid: a7c0ae48-8df8-42bf-91bd-2ea57e2f9d43\nlevel: low\nlogsource:\n  definition: 'Requirements: juniper bgp logs need to be enabled and ingested'\n  product: juniper\n  service: bgp\nmodified: 2023/01/23\nreferences:\n- https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf\nstatus: experimental\ntags:\n- attack.initial_access\n- attack.persistence\n- attack.privilege_escalation\n- attack.defense_evasion\n- attack.credential_access\n- attack.collection\n- attack.t1078\n- attack.t1110\n- attack.t1557\ntitle: Juniper BGP Missing MD5\n",
                            "sigma:id": "a7c0ae48-8df8-42bf-91bd-2ea57e2f9d43",
                            "title": "Juniper BGP Missing MD5",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "a557ffe6-ac54-43d2-ae69-158027082350",
                        "lookup_data": {
                            "description": "Detects BGP failures which may be indicative of brute force attacks to manipulate routing.",
                            "raw": "author: Tim Brown\ndate: 2023/01/09\ndescription: Detects BGP failures which may be indicative of brute force attacks to\n  manipulate routing.\ndetection:\n  condition: keywords_bgp_huawei\n  keywords_bgp_huawei:\n    '|all':\n    - :179\n    - BGP_AUTH_FAILED\nfalsepositives:\n- Unlikely. Except due to misconfigurations\nfields:\n- host\n- PeeId\nid: a557ffe6-ac54-43d2-ae69-158027082350\nlevel: low\nlogsource:\n  definition: 'Requirements: huawei bgp logs need to be enabled and ingested'\n  product: huawei\n  service: bgp\nmodified: 2023/01/23\nreferences:\n- https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf\nstatus: experimental\ntags:\n- attack.initial_access\n- attack.persistence\n- attack.privilege_escalation\n- attack.defense_evasion\n- attack.credential_access\n- attack.collection\n- attack.t1078\n- attack.t1110\n- attack.t1557\ntitle: Huawei BGP Authentication Failures\n",
                            "sigma:id": "a557ffe6-ac54-43d2-ae69-158027082350",
                            "title": "Huawei BGP Authentication Failures",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "e1d02b53-c03c-4948-b11d-4d00cca49d03",
                        "lookup_data": {
                            "description": "Detects when sign-ins increased by 10% or greater.",
                            "raw": "author: Mark Morowczynski '@markmorow', MikeDuddington, '@dudders1'\ndate: 2022/08/11\ndescription: Detects when sign-ins increased by 10% or greater.\ndetection:\n  condition: selection\n  selection:\n    Count: <10%\n    Status: failure\nfalsepositives:\n- Unlikely\nid: e1d02b53-c03c-4948-b11d-4d00cca49d03\nlevel: medium\nlogsource:\n  product: azure\n  service: signinlogs\nreferences:\n- https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-user-accounts#monitoring-for-failed-unusual-sign-ins\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1078\ntitle: Increased Failed Authentications Of Any Type\n",
                            "sigma:id": "e1d02b53-c03c-4948-b11d-4d00cca49d03",
                            "title": "Increased Failed Authentications Of Any Type",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "aeaef14c-e5bf-4690-a9c8-835caad458bd",
                        "lookup_data": {
                            "description": "Detects when PIM alerts are set to disabled.",
                            "raw": "author: Mark Morowczynski '@markmorow', Yochana Henderson, '@Yochana-H'\ndate: 2022/08/09\ndescription: Detects when PIM alerts are set to disabled.\ndetection:\n  condition: selection\n  selection:\n    properties.message: Disable PIM Alert\nfalsepositives:\n- Administrator disabling PIM alerts as an active choice.\nid: aeaef14c-e5bf-4690-a9c8-835caad458bd\nlevel: high\nlogsource:\n  product: azure\n  service: auditlogs\nreferences:\n- https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-privileged-identity-management#azure-ad-roles-assignment\nstatus: experimental\ntags:\n- attack.persistence\n- attack.privilege_escalation\n- attack.t1078\ntitle: PIM Alert Setting Changes To Disabled\n",
                            "sigma:id": "aeaef14c-e5bf-4690-a9c8-835caad458bd",
                            "title": "PIM Alert Setting Changes To Disabled",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "248649b7-d64f-46f0-9fb2-a52774166fb5",
                        "lookup_data": {
                            "description": "Device code flow is an OAuth 2.0 protocol flow specifically for input constrained devices and is not used in all environments.\nIf this type of flow is seen in the environment and not being used in an input constrained device scenario, further investigation is warranted.\nThis can be a misconfigured application or potentially something malicious.\n",
                            "raw": "author: Mark Morowczynski '@markmorow', Bailey Bercik '@baileybercik'\ndate: 2022/06/01\ndescription: 'Device code flow is an OAuth 2.0 protocol flow specifically for input\n  constrained devices and is not used in all environments.\n\n  If this type of flow is seen in the environment and not being used in an input constrained\n  device scenario, further investigation is warranted.\n\n  This can be a misconfigured application or potentially something malicious.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    properties.message: Device Code\nfalsepositives:\n- Applications that are input constrained will need to use device code flow and are\n  valid authentications.\nid: 248649b7-d64f-46f0-9fb2-a52774166fb5\nlevel: medium\nlogsource:\n  product: azure\n  service: signinlogs\nreferences:\n- https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-applications#application-authentication-flows\nstatus: experimental\ntags:\n- attack.t1078\n- attack.defense_evasion\n- attack.persistence\n- attack.privilege_escalation\n- attack.initial_access\ntitle: Application Using Device Code Authentication Flow\n",
                            "sigma:id": "248649b7-d64f-46f0-9fb2-a52774166fb5",
                            "title": "Application Using Device Code Authentication Flow",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "e98374a6-e2d9-4076-9b5c-11bdb2569995",
                        "lookup_data": {
                            "description": "Detects suspicious failed logins with different user accounts from a single source system",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/01/10\ndescription: Detects suspicious failed logins with different user accounts from a\n  single source system\ndetection:\n  condition: selection1 | count(TargetUserName) by WorkstationName > 3\n  selection1:\n    EventID:\n    - 529\n    - 4625\n    TargetUserName: '*'\n    WorkstationName: '*'\nfalsepositives:\n- Terminal servers\n- Jump servers\n- Other multiuser systems like Citrix server farms\n- Workstations with frequently changing users\nid: e98374a6-e2d9-4076-9b5c-11bdb2569995\nlevel: medium\nlogsource:\n  product: windows\n  service: security\nmodified: 2022/10/09\nstatus: test\ntags:\n- attack.persistence\n- attack.privilege_escalation\n- attack.t1078\ntitle: Failed Logins with Different Accounts from Single Source System\n",
                            "sigma:id": "e98374a6-e2d9-4076-9b5c-11bdb2569995",
                            "title": "Failed Logins with Different Accounts from Single Source System",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "c191e2fa-f9d6-4ccf-82af-4f2aba08359f",
                        "lookup_data": {
                            "description": "Detects when a Microsoft Cloud App Security reported when a user signs into your sanctioned apps from a risky IP address.",
                            "raw": "author: Austin Songer @austinsonger\ndate: 2021/08/23\ndescription: Detects when a Microsoft Cloud App Security reported when a user signs\n  into your sanctioned apps from a risky IP address.\ndetection:\n  condition: selection\n  selection:\n    eventName: Log on from a risky IP address\n    eventSource: SecurityComplianceCenter\n    status: success\nfalsepositives:\n- Unknown\nid: c191e2fa-f9d6-4ccf-82af-4f2aba08359f\nlevel: medium\nlogsource:\n  product: m365\n  service: threat_management\nmodified: 2022/10/09\nreferences:\n- https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy\n- https://docs.microsoft.com/en-us/cloud-app-security/policy-template-reference\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1078\ntitle: Logon from a Risky IP Address\n",
                            "sigma:id": "c191e2fa-f9d6-4ccf-82af-4f2aba08359f",
                            "title": "Logon from a Risky IP Address",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "78d5cab4-557e-454f-9fb9-a222bd0d5edc",
                        "lookup_data": {
                            "description": "Detects successful logon from public IP address via SMB. This can indicate a publicly-exposed SMB port.",
                            "raw": "author: Micah Babinski, @micahbabinski\ndate: 2023/01/19\ndescription: Detects successful logon from public IP address via SMB. This can indicate\n  a publicly-exposed SMB port.\ndetection:\n  condition: selection and not 1 of filter_*\n  filter_ipv4:\n    IpAddress|cidr:\n    - 10.0.0.0/8\n    - 172.16.0.0/12\n    - 192.168.0.0/16\n    - 224.0.0.0/4\n    - 127.0.0.0/8\n    SubjectUserName: '-'\n  filter_ipv6:\n    IpAddress|startswith:\n    - ::1\n    - 0:0:0:0:0:0:0:1\n    - 'fe80:'\n    - fc\n    - fd\n    SubjectUserName: '-'\n  selection:\n    EventID: 4624\n    LogonType: 3\nfalsepositives:\n- Legitimate or intentional inbound connections from public IP addresses on the SMB\n  port.\nid: 78d5cab4-557e-454f-9fb9-a222bd0d5edc\nlevel: high\nlogsource:\n  product: windows\n  service: security\nmodified: 2023/02/01\nreferences:\n- https://www.inversecos.com/2020/04/successful-4624-anonymous-logons-to.html\n- https://twitter.com/Purp1eW0lf/status/1616144561965002752\nrelated:\n- id: 259a9cdf-c4dd-4fa2-b243-2269e5ab18a2\n  type: derived\nstatus: experimental\ntags:\n- attack.initial_access\n- attack.credential_access\n- attack.t1133\n- attack.t1078\n- attack.t1110\ntitle: External Remote SMB Logon from Public IP\n",
                            "sigma:id": "78d5cab4-557e-454f-9fb9-a222bd0d5edc",
                            "title": "External Remote SMB Logon from Public IP",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "6f583da0-3a90-4566-a4ed-83c09fe18bbf",
                        "lookup_data": {
                            "description": "Detects when an account was created and deleted in a short period of time.",
                            "raw": "author: Mark Morowczynski '@markmorow', MikeDuddington, '@dudders1', Tim Shelton\ndate: 2022/08/11\ndescription: Detects when an account was created and deleted in a short period of\n  time.\ndetection:\n  condition: selection\n  selection:\n    Status: Success\n    properties.message:\n    - Add user\n    - Delete user\nfalsepositives:\n- Legit administrative action\nid: 6f583da0-3a90-4566-a4ed-83c09fe18bbf\nlevel: high\nlogsource:\n  product: azure\n  service: auditlogs\nmodified: 2022/08/18\nreferences:\n- https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-user-accounts#short-lived-accounts\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1078\ntitle: Account Created And Deleted Within A Close Time Frame\n",
                            "sigma:id": "6f583da0-3a90-4566-a4ed-83c09fe18bbf",
                            "title": "Account Created And Deleted Within A Close Time Frame",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5f17a0c6-7b04-4f05-9fda-b5d435a8d6a4",
                        "lookup_data": {
                            "description": "FontOnLake: Previously unknown malware family targeting Linux",
                            "link": "http://www.botvrij.eu/data/feed-osint/5f17a0c6-7b04-4f05-9fda-b5d435a8d6a4.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1633682506",
                            "uuid": "5f17a0c6-7b04-4f05-9fda-b5d435a8d6a4",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "941e5c45-cda7-4864-8cea-bbb7458d194a",
                        "lookup_data": {
                            "description": "Detects suspicious processes logging on with explicit credentials",
                            "raw": "author: oscd.community, Teymur Kheirkhabarov @HeirhabarovT, Zach Stanford @svch0st,\n  Tim Shelton\ndate: 2020/10/05\ndescription: Detects suspicious processes logging on with explicit credentials\ndetection:\n  condition: selection and not 1 of filter*\n  filter1:\n    TargetServerName: localhost\n  filter2:\n    SubjectUserName|endswith: $\n    TargetUserName|endswith: $\n  selection:\n    EventID: 4648\n    ProcessName|endswith:\n    - \\cmd.exe\n    - \\powershell.exe\n    - \\pwsh.exe\n    - \\winrs.exe\n    - \\wmic.exe\n    - \\net.exe\n    - \\net1.exe\n    - \\reg.exe\nfalsepositives:\n- Administrators that use the RunAS command or scheduled tasks\nid: 941e5c45-cda7-4864-8cea-bbb7458d194a\nlevel: medium\nlogsource:\n  product: windows\n  service: security\nmodified: 2022/08/03\nreferences:\n- https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view\nstatus: experimental\ntags:\n- attack.t1078\n- attack.lateral_movement\ntitle: Suspicious Remote Logon with Explicit Credentials\n",
                            "sigma:id": "941e5c45-cda7-4864-8cea-bbb7458d194a",
                            "title": "Suspicious Remote Logon with Explicit Credentials",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ca9bf243-465e-494a-9e54-bf9fc239057d",
                        "lookup_data": {
                            "description": "Detects when a user has been elevated to manage all Azure Subscriptions.\nThis change should be investigated immediately if it isn't planned.\nThis setting could allow an attacker access to Azure subscriptions in your environment.\n",
                            "raw": "author: Austin Songer @austinsonger\ndate: 2021/11/26\ndescription: 'Detects when a user has been elevated to manage all Azure Subscriptions.\n\n  This change should be investigated immediately if it isn''t planned.\n\n  This setting could allow an attacker access to Azure subscriptions in your environment.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    Category: Administrative\n    OperationName: Assigns the caller to user access admin\nfalsepositives:\n- If this was approved by System Administrator.\nid: ca9bf243-465e-494a-9e54-bf9fc239057d\nlevel: high\nlogsource:\n  product: azure\n  service: auditlogs\nmodified: 2022/12/25\nreferences:\n- https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-privileged-accounts#assignment-and-elevation\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1078\ntitle: Azure Subscription Permission Elevation Via AuditLogs\n",
                            "sigma:id": "ca9bf243-465e-494a-9e54-bf9fc239057d",
                            "title": "Azure Subscription Permission Elevation Via AuditLogs",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d45f03a8-790a-4f90-b956-cd7e5b8886bf",
                        "lookup_data": {
                            "mitre-attack-id": "T1078",
                            "mitre-cti:description": "Take measures to detect or prevent techniques such as [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) or installation of keyloggers to acquire credentials through [Input Capture](https://attack.mitre.org/techniques/T1056). Limit credential overlap across systems to prevent access if account credentials are obtained. Ensure that local administrator accounts have complex, unique passwords across all systems on the network. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled and use of accounts is segmented, as this is often equivalent to having a local administrator account with the same password on all systems. \n\nFollow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. (Citation: Microsoft Securing Privileged Access) \n\nAudit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account. (Citation: TechNet Credential Theft) (Citation: TechNet Least Privilege) These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. \n\nApplications and appliances that utilize default username and password should be changed immediately after the installation, and before deployment to a production environment. (Citation: US-CERT Alert TA13-175A Risks of Default Passwords on the Internet) When possible, applications that use SSH keys should be updated periodically and properly secured. ",
                            "mitre-cti:name": "Valid Accounts Mitigation",
                            "mitre-cti:type": "course-of-action",
                            "raw": "{'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'course-of-action--d45f03a8-790a-4f90-b956-cd7e5b8886bf', 'type': 'course-of-action', 'created': '2018-10-17T00:14:20.652Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/mitigations/T1078', 'external_id': 'T1078'}, {'source_name': 'Microsoft Securing Privileged Access', 'description': 'Plett, C., Poggemeyer, L. (12, October 26). Securing Privileged Access Reference Material. Retrieved April 25, 2017.', 'url': 'https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material#a-nameesaebmaesae-administrative-forest-design-approach'}, {'source_name': 'TechNet Credential Theft', 'description': 'Microsoft. (2016, April 15). Attractive Accounts for Credential Theft. Retrieved June 3, 2016.', 'url': 'https://technet.microsoft.com/en-us/library/dn535501.aspx'}, {'source_name': 'TechNet Least Privilege', 'description': 'Microsoft. (2016, April 16). Implementing Least-Privilege Administrative Models. Retrieved June 3, 2016.', 'url': 'https://technet.microsoft.com/en-us/library/dn487450.aspx'}, {'description': 'US-CERT. (n.d.). Risks of Default Passwords on the Internet. Retrieved April 12, 2019.', 'url': 'https://www.us-cert.gov/ncas/alerts/TA13-175A', 'source_name': 'US-CERT Alert TA13-175A Risks of Default Passwords on the Internet'}], 'modified': '2021-04-05T19:21:28.924Z', 'name': 'Valid Accounts Mitigation', 'description': 'Take measures to detect or prevent techniques such as [OS Credential Dumping](https://attack.mitre.org/techniques/T1003) or installation of keyloggers to acquire credentials through [Input Capture](https://attack.mitre.org/techniques/T1056). Limit credential overlap across systems to prevent access if account credentials are obtained. Ensure that local administrator accounts have complex, unique passwords across all systems on the network. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled and use of accounts is segmented, as this is often equivalent to having a local administrator account with the same password on all systems. \\n\\nFollow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. (Citation: Microsoft Securing Privileged Access) \\n\\nAudit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account. (Citation: TechNet Credential Theft) (Citation: TechNet Least Privilege) These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. \\n\\nApplications and appliances that utilize default username and password should be changed immediately after the installation, and before deployment to a production environment. (Citation: US-CERT Alert TA13-175A Risks of Default Passwords on the Internet) When possible, applications that use SSH keys should be updated periodically and properly secured. ', 'x_mitre_deprecated': True, 'x_mitre_version': '1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "55695bc0-c8cf-461f-a379-2535f563c854",
                        "lookup_data": {
                            "description": "Resource owner password credentials (ROPC) should be avoided if at all possible as this requires the user to expose their current password credentials to the application directly.\nThe application then uses those credentials to authenticate the user against the identity provider.\n",
                            "raw": "author: Mark Morowczynski '@markmorow', Bailey Bercik '@baileybercik'\ndate: 2022/06/01\ndescription: 'Resource owner password credentials (ROPC) should be avoided if at all\n  possible as this requires the user to expose their current password credentials\n  to the application directly.\n\n  The application then uses those credentials to authenticate the user against the\n  identity provider.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    properties.message: ROPC\nfalsepositives:\n- Applications that are being used as part of automated testing or a legacy application\n  that cannot use any other modern authentication flow\nid: 55695bc0-c8cf-461f-a379-2535f563c854\nlevel: medium\nlogsource:\n  product: azure\n  service: signinlogs\nreferences:\n- https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-applications#application-authentication-flows\nstatus: experimental\ntags:\n- attack.t1078\n- attack.defense_evasion\n- attack.persistence\n- attack.privilege_escalation\n- attack.initial_access\ntitle: Applications That Are Using ROPC Authentication Flow\n",
                            "sigma:id": "55695bc0-c8cf-461f-a379-2535f563c854",
                            "title": "Applications That Are Using ROPC Authentication Flow",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "67d5f8fc-8325-44e4-8f5f-7c0ac07cb5ae",
                        "lookup_data": {
                            "description": "Detects when successful sign-ins increased by 10% or greater.",
                            "raw": "author: Mark Morowczynski '@markmorow', MikeDuddington, '@dudders1', Tim Shelton\ndate: 2022/08/11\ndescription: Detects when successful sign-ins increased by 10% or greater.\ndetection:\n  condition: selection\n  selection:\n    Count: <10%\n    Status: Success\nfalsepositives:\n- Increase of users in the environment\nid: 67d5f8fc-8325-44e4-8f5f-7c0ac07cb5ae\nlevel: low\nlogsource:\n  product: azure\n  service: signinlogs\nmodified: 2022/08/18\nreferences:\n- https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-user-accounts#monitoring-for-successful-unusual-sign-ins\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1078\ntitle: Measurable Increase Of Successful Authentications\n",
                            "sigma:id": "67d5f8fc-8325-44e4-8f5f-7c0ac07cb5ae",
                            "title": "Measurable Increase Of Successful Authentications",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f88e112a-21aa-44bd-9b01-6ee2a2bbbed1",
                        "lookup_data": {
                            "description": "A login from a public IP can indicate a misconfigured firewall or network boundary.",
                            "raw": "author: NVISO\ndate: 2020/05/06\ndescription: A login from a public IP can indicate a misconfigured firewall or network\n  boundary.\ndetection:\n  condition: selection and not 1 of filter_*\n  filter_ip_privatev4:\n    IpAddress|startswith:\n    - '10.'\n    - 192.168.\n    - 172.16.\n    - 172.17.\n    - 172.18.\n    - 172.19.\n    - 172.20.\n    - 172.21.\n    - 172.22.\n    - 172.23.\n    - 172.24.\n    - 172.25.\n    - 172.26.\n    - 172.27.\n    - 172.28.\n    - 172.29.\n    - 172.30.\n    - 172.31.\n    - '127.'\n    - 169.254.\n  filter_ip_privatev6:\n  - IpAddress: ::1\n  - IpAddress|startswith:\n    - 'fe80::'\n    - 'fc00::'\n  filter_ip_unknown:\n    IpAddress|contains: '-'\n  selection:\n    EventID: 4625\nfalsepositives:\n- Legitimate logon attempts over the internet\n- IPv4-to-IPv6 mapped IPs\nid: f88e112a-21aa-44bd-9b01-6ee2a2bbbed1\nlevel: medium\nlogsource:\n  product: windows\n  service: security\nmodified: 2023/01/11\nstatus: test\ntags:\n- attack.initial_access\n- attack.persistence\n- attack.t1078\n- attack.t1190\n- attack.t1133\ntitle: Failed Logon From Public IP\n",
                            "sigma:id": "f88e112a-21aa-44bd-9b01-6ee2a2bbbed1",
                            "title": "Failed Logon From Public IP",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4ad97bf5-a514-41a4-abd3-4f3455ad4865",
                        "lookup_data": {
                            "description": "Detects guest users being invited to tenant by non-approved inviters",
                            "raw": "author: MikeDuddington, '@dudders1'\ndate: 2022/07/28\ndescription: Detects guest users being invited to tenant by non-approved inviters\ndetection:\n  condition: selection and not filter\n  filter:\n    InitiatedBy|contains: <approved guest inviter use OR for multiple>\n  selection:\n    Category: UserManagement\n    OperationName: Invite external user\nfalsepositives:\n- If this was approved by System Administrator.\nid: 4ad97bf5-a514-41a4-abd3-4f3455ad4865\nlevel: medium\nlogsource:\n  product: azure\n  service: auditlogs\nreferences:\n- https://docs.microsoft.com/en-gb/azure/active-directory/fundamentals/security-operations-user-accounts#monitoring-external-user-sign-ins\nstatus: experimental\ntags:\n- attack.t1078\ntitle: Guest Users Invited To Tenant By Non Approved Inviters\n",
                            "sigma:id": "4ad97bf5-a514-41a4-abd3-4f3455ad4865",
                            "title": "Guest Users Invited To Tenant By Non Approved Inviters",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "572b12d4-9062-11ed-a1eb-0242ac120002",
                        "lookup_data": {
                            "description": "Detects risky authencaition from a non AD registered device without MFA being required.",
                            "raw": "author: Harjot Singh, '@cyb3rjy0t'\ndate: 2023/01/10\ndescription: Detects risky authencaition from a non AD registered device without MFA\n  being required.\ndetection:\n  condition: selection\n  selection:\n    AuthenticationRequirement: singleFactorAuthentication\n    DeviceDetail.trusttype: ''\n    RiskState: atRisk\n    Status: Success\nfalsepositives:\n- Unknown\nid: 572b12d4-9062-11ed-a1eb-0242ac120002\nlevel: high\nlogsource:\n  product: azure\n  service: signinlogs\nreferences:\n- https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-devices#non-compliant-device-sign-in\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1078\ntitle: Suspicious SignIns From A Non Registered Device\n",
                            "sigma:id": "572b12d4-9062-11ed-a1eb-0242ac120002",
                            "title": "Suspicious SignIns From A Non Registered Device",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5ee3822c-6828-418c-b619-62de950d210f",
                        "lookup_data": {
                            "description": "Dharma Ransomware Event",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5ee3822c-6828-418c-b619-62de950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1592742357",
                            "uuid": "5ee3822c-6828-418c-b619-62de950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5cccb246-0da0-4c93-a463-61fe0a016219",
                        "lookup_data": {
                            "description": "ESET Turla LightNeuron Research",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5cccb246-0da0-4c93-a463-61fe0a016219.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1607525139",
                            "uuid": "5cccb246-0da0-4c93-a463-61fe0a016219",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "6ad91e31-53df-4826-bd27-0166171c8040",
                        "lookup_data": {
                            "description": "Identifies when an admission controller is executed in GCP Kubernetes.\nA Kubernetes Admission controller intercepts, and possibly modifies, requests to the Kubernetes API server.\nThe behavior of this admission controller is determined by an admission webhook (MutatingAdmissionWebhook or ValidatingAdmissionWebhook) that the user deploys in the cluster.\nAn adversary can use such webhooks as the MutatingAdmissionWebhook for obtaining persistence in the cluster.\nFor example, attackers can intercept and modify the pod creation operations in the cluster and add their malicious container to every created pod. An adversary can use the webhook ValidatingAdmissionWebhook, which could be used to obtain access credentials.\nAn adversary could use the webhook to intercept the requests to the API server, record secrets, and other sensitive information.\n",
                            "raw": "author: Austin Songer @austinsonger\ndate: 2021/11/25\ndescription: 'Identifies when an admission controller is executed in GCP Kubernetes.\n\n  A Kubernetes Admission controller intercepts, and possibly modifies, requests to\n  the Kubernetes API server.\n\n  The behavior of this admission controller is determined by an admission webhook\n  (MutatingAdmissionWebhook or ValidatingAdmissionWebhook) that the user deploys in\n  the cluster.\n\n  An adversary can use such webhooks as the MutatingAdmissionWebhook for obtaining\n  persistence in the cluster.\n\n  For example, attackers can intercept and modify the pod creation operations in the\n  cluster and add their malicious container to every created pod. An adversary can\n  use the webhook ValidatingAdmissionWebhook, which could be used to obtain access\n  credentials.\n\n  An adversary could use the webhook to intercept the requests to the API server,\n  record secrets, and other sensitive information.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    gcp.audit.method_name|contains:\n    - .mutatingwebhookconfigurations.\n    - .validatingwebhookconfigurations.\n    gcp.audit.method_name|endswith:\n    - create\n    - patch\n    - replace\n    gcp.audit.method_name|startswith: admissionregistration.k8s.io.v\nfalsepositives:\n- Google Cloud Kubernetes Admission Controller may be done by a system administrator.\n- If known behavior is causing false positives, it can be exempted from the rule.\nid: 6ad91e31-53df-4826-bd27-0166171c8040\nlevel: medium\nlogsource:\n  product: gcp\n  service: gcp.audit\nmodified: 2022/12/18\nreferences:\n- https://cloud.google.com/kubernetes-engine/docs\nstatus: experimental\ntags:\n- attack.persistence\n- attack.t1078\n- attack.credential_access\n- attack.t1552\n- attack.t1552.007\ntitle: Google Cloud Kubernetes Admission Controller\n",
                            "sigma:id": "6ad91e31-53df-4826-bd27-0166171c8040",
                            "title": "Google Cloud Kubernetes Admission Controller",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b17a1a56-e99c-403c-8948-561df0cffe81",
                        "lookup_data": {
                            "capec": "CAPEC-560",
                            "mitre-attack-id": "T1078",
                            "mitre-cti:description": "Adversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access, network devices, and remote desktop.(Citation: volexity_0day_sophos_FW) Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.\n\nIn some cases, adversaries may abuse inactive accounts: for example, those belonging to individuals who are no longer part of an organization. Using these accounts may allow the adversary to evade detection, as the original account user will not be present to identify any anomalous activity taking place on their account.(Citation: CISA MFA PrintNightmare)\n\nThe overlap of permissions for local, domain, and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise.(Citation: TechNet Credential Theft)",
                            "mitre-cti:name": "Valid Accounts",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'modified': '2022-10-19T19:57:39.849Z', 'name': 'Valid Accounts', 'description': 'Adversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access, network devices, and remote desktop.(Citation: volexity_0day_sophos_FW) Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.\\n\\nIn some cases, adversaries may abuse inactive accounts: for example, those belonging to individuals who are no longer part of an organization. Using these accounts may allow the adversary to evade detection, as the original account user will not be present to identify any anomalous activity taking place on their account.(Citation: CISA MFA PrintNightmare)\\n\\nThe overlap of permissions for local, domain, and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise.(Citation: TechNet Credential Theft)', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'defense-evasion'}, {'kill_chain_name': 'mitre-attack', 'phase_name': 'persistence'}, {'kill_chain_name': 'mitre-attack', 'phase_name': 'privilege-escalation'}, {'kill_chain_name': 'mitre-attack', 'phase_name': 'initial-access'}], 'x_mitre_detection': 'Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services.(Citation: TechNet Audit Policy) Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).\\n\\nPerform regular audits of domain and local system accounts to detect accounts that may have been created by an adversary for persistence. Checks on these accounts could also include whether default accounts such as Guest have been activated. These audits should also include checks on any appliances and applications for default credentials or SSH keys, and if any are discovered, they should be updated immediately.', 'x_mitre_platforms': ['Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace', 'Containers', 'Network'], 'x_mitre_is_subtechnique': False, 'x_mitre_deprecated': False, 'x_mitre_domains': ['enterprise-attack'], 'x_mitre_version': '2.5', 'x_mitre_contributors': ['Syed Ummar Farooqh, McAfee', 'Prasad Somasamudram, McAfee', 'Sekhar Sarukkai, McAfee', 'Jon Sternstein, Stern Security', 'Yossi Weizman, Azure Defender Research Team', 'Netskope', 'Mark Wee', 'Praetorian'], 'x_mitre_data_sources': ['Logon Session: Logon Session Creation', 'Logon Session: Logon Session Metadata', 'User Account: User Account Authentication'], 'x_mitre_defense_bypassed': ['Firewall', 'Anti-virus', 'Host Intrusion Prevention Systems', 'Network Intrusion Detection System', 'Application Control', 'System Access Controls'], 'x_mitre_permissions_required': ['User', 'Administrator'], 'x_mitre_effective_permissions': ['User', 'Administrator'], 'type': 'attack-pattern', 'id': 'attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81', 'created': '2017-05-31T21:31:00.645Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'revoked': False, 'external_references': [{'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/techniques/T1078', 'external_id': 'T1078'}, {'source_name': 'volexity_0day_sophos_FW', 'description': 'Adair, S., Lancaster, T., Volexity Threat Research. (2022, June 15). DriftingCloud: Zero-Day Sophos Firewall Exploitation and an Insidious Breach. Retrieved July 1, 2022.', 'url': 'https://www.volexity.com/blog/2022/06/15/driftingcloud-zero-day-sophos-firewall-exploitation-and-an-insidious-breach/'}, {'source_name': 'CISA MFA PrintNightmare', 'description': 'Cybersecurity and Infrastructure Security Agency. (2022, March 15). Russian State-Sponsored Cyber Actors Gain Network Access by Exploiting Default Multifactor Authentication Protocols and PrintNightmare Vulnerability. Retrieved March 16, 2022.', 'url': 'https://www.cisa.gov/uscert/ncas/alerts/aa22-074a'}, {'source_name': 'TechNet Credential Theft', 'description': 'Microsoft. (2016, April 15). Attractive Accounts for Credential Theft. Retrieved June 3, 2016.', 'url': 'https://technet.microsoft.com/en-us/library/dn535501.aspx'}, {'source_name': 'TechNet Audit Policy', 'description': 'Microsoft. (2016, April 15). Audit Policy Recommendations. Retrieved June 3, 2016.', 'url': 'https://technet.microsoft.com/en-us/library/dn487457.aspx'}, {'source_name': 'capec', 'url': 'https://capec.mitre.org/data/definitions/560.html', 'external_id': 'CAPEC-560'}], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'x_mitre_attack_spec_version': '2.1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d7eab125-5f94-43df-8710-795b80fa1189",
                        "lookup_data": {
                            "description": "Detects when a Microsoft Cloud App Security reported a risky sign-in attempt due to a login associated with an impossible travel.",
                            "raw": "author: Austin Songer @austinsonger\ndate: 2020/07/06\ndescription: Detects when a Microsoft Cloud App Security reported a risky sign-in\n  attempt due to a login associated with an impossible travel.\ndetection:\n  condition: selection\n  selection:\n    eventName: Impossible travel activity\n    eventSource: SecurityComplianceCenter\n    status: success\nfalsepositives:\n- Unknown\nid: d7eab125-5f94-43df-8710-795b80fa1189\nlevel: medium\nlogsource:\n  product: m365\n  service: threat_management\nmodified: 2021/11/27\nreferences:\n- https://docs.microsoft.com/en-us/cloud-app-security/anomaly-detection-policy\n- https://docs.microsoft.com/en-us/cloud-app-security/policy-template-reference\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1078\ntitle: Microsoft 365 - Impossible Travel Activity\n",
                            "sigma:id": "d7eab125-5f94-43df-8710-795b80fa1189",
                            "title": "Microsoft 365 - Impossible Travel Activity",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "e3818659-5016-4811-a73c-dde4679169d2",
                        "lookup_data": {
                            "description": "The Reset-ComputerMachinePassword cmdlet changes the computer account password that the computers use to authenticate to the domain controllers in the domain.\nYou can use it to reset the password of the local computer.\n",
                            "raw": "author: frack113\ndate: 2022/02/21\ndescription: 'The Reset-ComputerMachinePassword cmdlet changes the computer account\n  password that the computers use to authenticate to the domain controllers in the\n  domain.\n\n  You can use it to reset the password of the local computer.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    ContextInfo|contains: Reset-ComputerMachinePassword\nfalsepositives:\n- Administrator PowerShell scripts\nid: e3818659-5016-4811-a73c-dde4679169d2\nlevel: medium\nlogsource:\n  category: ps_module\n  definition: 'Requirements: PowerShell Module Logging must be enabled'\n  product: windows\nreferences:\n- https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/reset-computermachinepassword?view=powershell-5.1\n- https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1078\ntitle: Suspicious Computer Machine Password by PowerShell\n",
                            "sigma:id": "e3818659-5016-4811-a73c-dde4679169d2",
                            "title": "Suspicious Computer Machine Password by PowerShell",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ebbeb024-5b1d-4e16-9c0c-917f86c708a7",
                        "lookup_data": {
                            "description": "User Added to an Administrator's Azure AD Role",
                            "raw": "author: \"Rapha\\xEBl CALVET, @MetallicHack\"\ndate: 2021/10/04\ndescription: User Added to an Administrator's Azure AD Role\ndetection:\n  condition: selection\n  selection:\n    ModifiedProperties{}.NewValue|endswith:\n    - Admins\n    - Administrator\n    Operation: Add member to role.\n    Workload: AzureActiveDirectory\nfalsepositives:\n- PIM (Privileged Identity Management) generates this event each time 'eligible role'\n  is enabled.\nid: ebbeb024-5b1d-4e16-9c0c-917f86c708a7\nlevel: medium\nlogsource:\n  product: azure\n  service: activitylogs\nmodified: 2022/10/09\nreferences:\n- https://m365internals.com/2021/07/13/what-ive-learned-from-doing-a-year-of-cloud-forensics-in-azure-ad/\nstatus: test\ntags:\n- attack.persistence\n- attack.privilege_escalation\n- attack.t1098.003\n- attack.t1078\ntitle: User Added to an Administrator's Azure AD Role\n",
                            "sigma:id": "ebbeb024-5b1d-4e16-9c0c-917f86c708a7",
                            "title": "User Added to an Administrator's Azure AD Role",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f43f5d2f-3f2a-4cc8-b1af-81fde7dbaf0e",
                        "lookup_data": {
                            "description": "Identifies when suspicious SAML activity has occurred in AWS. An adversary could gain backdoor access via SAML.",
                            "raw": "author: Austin Songer\ndate: 2021/09/22\ndescription: Identifies when suspicious SAML activity has occurred in AWS. An adversary\n  could gain backdoor access via SAML.\ndetection:\n  condition: 1 of selection_*\n  selection_iam:\n    eventName: UpdateSAMLProvider\n    eventSource: iam.amazonaws.com\n  selection_sts:\n    eventName: AssumeRoleWithSAML\n    eventSource: sts.amazonaws.com\nfalsepositives:\n- Automated processes that uses Terraform may lead to false positives.\n- SAML Provider could be updated by a system administrator. Verify whether the user\n  identity, user agent, and/or hostname should be making changes in your environment.\n- SAML Provider being updated from unfamiliar users should be investigated. If known\n  behavior is causing false positives, it can be exempted from the rule.\nid: f43f5d2f-3f2a-4cc8-b1af-81fde7dbaf0e\nlevel: medium\nlogsource:\n  product: aws\n  service: cloudtrail\nmodified: 2022/12/18\nreferences:\n- https://docs.aws.amazon.com/IAM/latest/APIReference/API_UpdateSAMLProvider.html\n- https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1078\n- attack.lateral_movement\n- attack.t1548\n- attack.privilege_escalation\n- attack.t1550\n- attack.t1550.001\ntitle: AWS Suspicious SAML Activity\n",
                            "sigma:id": "f43f5d2f-3f2a-4cc8-b1af-81fde7dbaf0e",
                            "title": "AWS Suspicious SAML Activity",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": []
    },
    "timestamp": "2025-02-28 12:30:25"
}