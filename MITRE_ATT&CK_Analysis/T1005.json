{
    "id": "T1005",
    "name": "Data from Local System",
    "description": "Adversaries may search local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration.\nAdversaries may do this using a [Command and Scripting Interpreter](T1059), such as [cmd](S0106), which has functionality to interact with the file system to gather information. Some adversaries may also use [Automated Collection](T1119) on the local system.",
    "platforms": "Linux, macOS, Windows",
    "kill_chain_phases": "Collection",
    "data_sources": "Script: Script Execution, File: File Access, Command: Command Execution",
    "detection": "Monitor processes and command-line arguments for actions that could be taken to collect files from a system. Remote access tools with built-in features may interact directly with the Windows API to gather data. Data may also be acquired through Windows system management tools such as [Windows Management Instrumentation](T1047) and [PowerShell](T1059.001).",
    "url": "https://attack.mitre.org/techniques/T1005",
    "enrichments": {
        "attack_rule_map": [
            {
                "tech_id": "T1005",
                "atomic_attack_guid": "00cbb875-7ae4-4cf1-b638-e543fd825300",
                "atomic_attack_name": "Find and dump sqlite databases (Linux)",
                "platform": "Linux",
                "splunk_rules": [
                    {
                        "rule_name": "Linux Common Process For Elevation Control",
                        "rule_link": "https://research.splunk.com/endpoint/66ab15c0-63d0-11ec-9e70-acde48001122/"
                    }
                ]
            }
        ],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "e06ac91d-b9e6-443d-8e5b-af749e7aa6b6",
                    "5d9b516c-e5f0-4e7c-a958-5d8c0a019371",
                    "4833155a-4053-4c9c-a997-777fcea0baa7",
                    "24c77512-782b-448a-8950-eddb0785fc71",
                    "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                    "2f47f1fd-0901-466e-a770-3b7092834a1b",
                    "7ee0879d-ce4f-4f54-a96b-c532dfb98ffd",
                    "3c4a2599-71ee-4405-ba1e-0e28414b4bc5",
                    "5eeec9aa-9d88-4ece-9e6f-9d92884ae404",
                    "5ae2129e-15b4-41e9-9428-4f1e02de0b81",
                    "5b9663f7-91d0-4bcb-ad23-4637950d210f",
                    "5c3c4a6d-15f0-4133-baff-3c2c68f8e8cf",
                    "5d498330-f574-4889-bcc9-c53c950d210f",
                    "1ea13e8c-03ea-409b-877d-ce5c3d2c1cb3",
                    "0d47e3f6-357f-4534-928c-202631d065fa",
                    "3ada8ae4-a7bd-4732-ad66-0ff8fc0f80f5",
                    "5ce6aa86-9cd8-4302-9dc9-4a59950d210f",
                    "54b9a76a-3c71-4673-b4b3-2edb4566ea7b",
                    "6a69f62d-ce75-4b57-8dce-6351eb55b362",
                    "b57ba453-b384-4ab9-9f40-1038086b4e53",
                    "cd072b25-a418-4f98-8ebc-5093fb38fe1a",
                    "5cccb246-0da0-4c93-a463-61fe0a016219",
                    "5ced8da1-0960-40bc-b5dc-2fed0a016219",
                    "5de7883b-22bc-4264-995c-4d1f950d210f",
                    "5e5709a4-8850-453e-9f11-275a0a0a020f"
                ],
                "lookup_results": [
                    {
                        "uuid": "e06ac91d-b9e6-443d-8e5b-af749e7aa6b6",
                        "lookup_data": {
                            "description": "Detects URL pattern used by iOS Implant",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2019/08/30\ndescription: Detects URL pattern used by iOS Implant\ndetection:\n  condition: selection\n  selection:\n    c-uri|contains: /list/suc\\?name=\nfalsepositives:\n- Unknown\nfields:\n- ClientIP\n- c-uri\n- c-useragent\nid: e06ac91d-b9e6-443d-8e5b-af749e7aa6b6\nlevel: critical\nlogsource:\n  category: proxy\nmodified: 2022/08/15\nreferences:\n- https://googleprojectzero.blogspot.com/2019/08/implant-teardown.html\n- https://twitter.com/craiu/status/1167358457344925696\nstatus: test\ntags:\n- attack.execution\n- attack.t1203\n- attack.collection\n- attack.t1005\n- attack.t1119\n- attack.credential_access\n- attack.t1528\n- attack.t1552.001\ntitle: iOS Implant URL Pattern\n",
                            "sigma:id": "e06ac91d-b9e6-443d-8e5b-af749e7aa6b6",
                            "title": "iOS Implant URL Pattern",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d9b516c-e5f0-4e7c-a958-5d8c0a019371",
                        "lookup_data": {
                            "description": "Operation Ghost - White Paper",
                            "link": "http://www.botvrij.eu/data/feed-osint/5d9b516c-e5f0-4e7c-a958-5d8c0a019371.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1571855044",
                            "uuid": "5d9b516c-e5f0-4e7c-a958-5d8c0a019371",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4833155a-4053-4c9c-a997-777fcea0baa7",
                        "lookup_data": {
                            "description": "Detect usage of the \"sqlite\" binary to query databases in Firefox and other Gecko-based browsers for potential data stealing.",
                            "raw": "author: frack113\ndate: 2022/04/08\ndescription: Detect usage of the \"sqlite\" binary to query databases in Firefox and\n  other Gecko-based browsers for potential data stealing.\ndetection:\n  condition: all of selection_*\n  selection_firefox:\n    CommandLine|contains:\n    - cookies.sqlite\n    - places.sqlite\n  selection_sql:\n  - Product: SQLite\n  - Image|endswith:\n    - \\sqlite.exe\n    - \\sqlite3.exe\nfalsepositives:\n- Unknown\nid: 4833155a-4053-4c9c-a997-777fcea0baa7\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/19\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1539/T1539.md#atomic-test-1---steal-firefox-cookies-windows\n- https://blog.cyble.com/2022/04/21/prynt-stealer-a-new-info-stealer-performing-clipper-and-keylogger-activities/\nstatus: experimental\ntags:\n- attack.credential_access\n- attack.t1539\n- attack.collection\n- attack.t1005\ntitle: SQLite Firefox Profile Data DB Access\n",
                            "sigma:id": "4833155a-4053-4c9c-a997-777fcea0baa7",
                            "title": "SQLite Firefox Profile Data DB Access",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "24c77512-782b-448a-8950-eddb0785fc71",
                        "lookup_data": {
                            "description": "Detect usage of the \"sqlite\" binary to query databases in Chromium-based browsers for potential data stealing.",
                            "raw": "author: TropChaud\ndate: 2022/12/19\ndescription: Detect usage of the \"sqlite\" binary to query databases in Chromium-based\n  browsers for potential data stealing.\ndetection:\n  condition: all of selection_*\n  selection_chromium:\n    CommandLine|contains:\n    - \\User Data\\\n    - \\Opera Software\\\n    - \\ChromiumViewer\\\n  selection_data:\n    CommandLine|contains:\n    - Login Data\n    - Cookies\n    - Web Data\n    - History\n    - Bookmarks\n  selection_sql:\n  - Product: SQLite\n  - Image|endswith:\n    - \\sqlite.exe\n    - \\sqlite3.exe\nfalsepositives:\n- Unknown\nid: 24c77512-782b-448a-8950-eddb0785fc71\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/19\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/84d9edaaaa2c5511144521b0e4af726d1c7276ce/atomics/T1539/T1539.md#atomic-test-2---steal-chrome-cookies-windows\n- https://blog.cyble.com/2022/04/21/prynt-stealer-a-new-info-stealer-performing-clipper-and-keylogger-activities/\nstatus: experimental\ntags:\n- attack.credential_access\n- attack.t1539\n- attack.t1555.003\n- attack.collection\n- attack.t1005\ntitle: SQLite Chromium Profile Data DB Access\n",
                            "sigma:id": "24c77512-782b-448a-8950-eddb0785fc71",
                            "title": "SQLite Chromium Profile Data DB Access",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                        "lookup_data": {
                            "description": "SectorJ04 Groupâ€™s Increased Activity in 2019",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5d6e7aa3-aca4-46cc-b96a-46ac950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1568039252",
                            "uuid": "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "2f47f1fd-0901-466e-a770-3b7092834a1b",
                        "lookup_data": {
                            "description": "Detects a command used by conti to dump database",
                            "raw": "author: frack113\ndate: 2021/08/16\ndescription: Detects a command used by conti to dump database\ndetection:\n  condition: all of selection*\n  selection_query:\n    CommandLine|contains:\n    - sys.sysprocesses\n    - master.dbo.sysdatabases\n    - BACKUP DATABASE\n  selection_svr:\n    CommandLine|contains: ' -S localhost '\n  selection_tools:\n    CommandLine|contains:\n    - 'sqlcmd '\n    - sqlcmd.exe\nfalsepositives:\n- Unknown\nid: 2f47f1fd-0901-466e-a770-3b7092834a1b\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/25\nreferences:\n- https://twitter.com/vxunderground/status/1423336151860002816?s=20\n- https://www.virustotal.com/gui/file/03e9b8c2e86d6db450e5eceec057d7e369ee2389b9daecaf06331a95410aa5f8/detection\n- https://docs.microsoft.com/en-us/sql/tools/sqlcmd-utility?view=sql-server-ver15\nstatus: test\ntags:\n- attack.collection\n- attack.t1005\ntitle: Conti Backup Database\n",
                            "sigma:id": "2f47f1fd-0901-466e-a770-3b7092834a1b",
                            "title": "Conti Backup Database",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "7ee0879d-ce4f-4f54-a96b-c532dfb98ffd",
                        "lookup_data": {
                            "mitre-attack-id": "T1005",
                            "mitre-cti:description": "Identify unnecessary system utilities or potentially malicious software that may be used to collect data from the local system, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)",
                            "mitre-cti:name": "Data from Local System Mitigation",
                            "mitre-cti:type": "course-of-action",
                            "raw": "{'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'course-of-action--7ee0879d-ce4f-4f54-a96b-c532dfb98ffd', 'type': 'course-of-action', 'created': '2018-10-17T00:14:20.652Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'external_id': 'T1005', 'url': 'https://attack.mitre.org/mitigations/T1005', 'source_name': 'mitre-attack'}, {'source_name': 'Beechey 2010', 'description': 'Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.', 'url': 'http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599'}, {'url': 'https://blogs.jpcert.or.jp/en/2016/01/windows-commands-abused-by-attackers.html', 'description': 'Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.', 'source_name': 'Windows Commands JPCERT'}, {'url': 'https://apps.nsa.gov/iaarchive/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm', 'description': 'NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.', 'source_name': 'NSA MS AppLocker'}, {'source_name': 'Corio 2008', 'description': 'Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.', 'url': 'http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx'}, {'source_name': 'TechNet Applocker vs SRP', 'description': 'Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.', 'url': 'https://technet.microsoft.com/en-us/library/ee791851.aspx'}], 'modified': '2021-08-23T20:25:19.372Z', 'name': 'Data from Local System Mitigation', 'description': 'Identify unnecessary system utilities or potentially malicious software that may be used to collect data from the local system, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)', 'x_mitre_deprecated': True, 'x_mitre_version': '1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "3c4a2599-71ee-4405-ba1e-0e28414b4bc5",
                        "lookup_data": {
                            "mitre-attack-id": "T1005",
                            "mitre-cti:description": "Adversaries may search local system sources, such as file systems and configuration files or local databases, to find files of interest and sensitive data prior to Exfiltration.\n\nAdversaries may do this using a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), such as [cmd](https://attack.mitre.org/software/S0106) as well as a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008), which have functionality to interact with the file system to gather information. Adversaries may also use [Automated Collection](https://attack.mitre.org/techniques/T1119) on the local system.\n",
                            "mitre-cti:name": "Data from Local System",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'modified': '2022-10-19T21:55:54.866Z', 'name': 'Data from Local System', 'description': 'Adversaries may search local system sources, such as file systems and configuration files or local databases, to find files of interest and sensitive data prior to Exfiltration.\\n\\nAdversaries may do this using a [Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059), such as [cmd](https://attack.mitre.org/software/S0106) as well as a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008), which have functionality to interact with the file system to gather information. Adversaries may also use [Automated Collection](https://attack.mitre.org/techniques/T1119) on the local system.\\n', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'collection'}], 'x_mitre_detection': 'Monitor processes and command-line arguments for actions that could be taken to collect files from a system. Remote access tools with built-in features may interact directly with the Windows API to gather data. Further, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands may also be used to collect files such as configuration files with built-in features native to the network device platform.(Citation: Mandiant APT41 Global Intrusion )(Citation: US-CERT-TA18-106A) Monitor CLI activity for unexpected or unauthorized use commands being run by non-standard users from non-standard locations. Data may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).', 'x_mitre_platforms': ['Linux', 'macOS', 'Windows', 'Network'], 'x_mitre_is_subtechnique': False, 'x_mitre_deprecated': False, 'x_mitre_domains': ['enterprise-attack'], 'x_mitre_version': '1.5', 'x_mitre_contributors': ['William Cain', 'Austin Clark, @c2defense'], 'x_mitre_data_sources': ['Process: OS API Execution', 'File: File Access', 'Process: Process Creation', 'Script: Script Execution', 'Command: Command Execution'], 'x_mitre_system_requirements': ['Privileges to access certain files and directories'], 'type': 'attack-pattern', 'id': 'attack-pattern--3c4a2599-71ee-4405-ba1e-0e28414b4bc5', 'created': '2017-05-31T21:30:20.537Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'revoked': False, 'external_references': [{'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/techniques/T1005', 'external_id': 'T1005'}, {'source_name': 'Mandiant APT41 Global Intrusion ', 'description': 'Gyler, C.,Perez D.,Jones, S.,Miller, S.. (2021, February 25). This is Not a Test: APT41 Initiates Global Intrusion Campaign Using Multiple Exploits. Retrieved February 17, 2022.', 'url': 'https://www.mandiant.com/resources/apt41-initiates-global-intrusion-campaign-using-multiple-exploits'}, {'source_name': 'US-CERT-TA18-106A', 'description': 'US-CERT. (2018, April 20). Alert (TA18-106A) Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.', 'url': 'https://www.us-cert.gov/ncas/alerts/TA18-106A'}], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'x_mitre_attack_spec_version': '2.1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5eeec9aa-9d88-4ece-9e6f-9d92884ae404",
                        "lookup_data": {
                            "description": "Dissecting PlugX to Extract Its Crown Jewels",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5eeec9aa-9d88-4ece-9e6f-9d92884ae404.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1663580963",
                            "uuid": "5eeec9aa-9d88-4ece-9e6f-9d92884ae404",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5ae2129e-15b4-41e9-9428-4f1e02de0b81",
                        "lookup_data": {
                            "description": "OSINT - Analyzing Operation GhostSecret: Attack Seeks to Steal Data Worldwide",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5ae2129e-15b4-41e9-9428-4f1e02de0b81.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1524766410",
                            "uuid": "5ae2129e-15b4-41e9-9428-4f1e02de0b81",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5b9663f7-91d0-4bcb-ad23-4637950d210f",
                        "lookup_data": {
                            "description": "OSINT -  Operation AppleJeus: Lazarus hits cryptocurrency exchange with fake installer and macOS malware",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5b9663f7-91d0-4bcb-ad23-4637950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1540716814",
                            "uuid": "5b9663f7-91d0-4bcb-ad23-4637950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5c3c4a6d-15f0-4133-baff-3c2c68f8e8cf",
                        "lookup_data": {
                            "description": "2019-01-10: North Korea Lazarus Targeting REDBANC",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5c3c4a6d-15f0-4133-baff-3c2c68f8e8cf.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1547585075",
                            "uuid": "5c3c4a6d-15f0-4133-baff-3c2c68f8e8cf",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d498330-f574-4889-bcc9-c53c950d210f",
                        "lookup_data": {
                            "description": "OSINT - Sharpening the Machete",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5d498330-f574-4889-bcc9-c53c950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1566552908",
                            "uuid": "5d498330-f574-4889-bcc9-c53c950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "1ea13e8c-03ea-409b-877d-ce5c3d2c1cb3",
                        "lookup_data": {
                            "description": "Detects suspicious local connections via a named pipe to the AD FS configuration database (Windows Internal Database).\nUsed to access information such as the AD FS configuration settings which contains sensitive information used to sign SAML tokens.\n",
                            "raw": "author: Roberto Rodriguez @Cyb3rWard0g\ndate: 2021/10/08\ndescription: 'Detects suspicious local connections via a named pipe to the AD FS configuration\n  database (Windows Internal Database).\n\n  Used to access information such as the AD FS configuration settings which contains\n  sensitive information used to sign SAML tokens.\n\n  '\ndetection:\n  condition: selection and not filter\n  filter:\n    Image|endswith:\n    - \\Microsoft.IdentityServer.ServiceHost.exe\n    - \\Microsoft.Identity.Health.Adfs.PshSurrogate.exe\n    - \\AzureADConnect.exe\n    - \\Microsoft.Tri.Sensor.exe\n    - \\wsmprovhost.exe\n    - \\mmc.exe\n    - \\sqlservr.exe\n    - \\tssdis.exe\n  selection:\n    PipeName: \\MICROSOFT##WID\\tsql\\query\nfalsepositives:\n- Processes in the filter condition\nid: 1ea13e8c-03ea-409b-877d-ce5c3d2c1cb3\nlevel: high\nlogsource:\n  category: pipe_created\n  definition: Note that you have to configure logging for Named Pipe Events in Sysmon\n    config (Event ID 17 and Event ID 18). The basic configuration is in popular sysmon\n    configuration (https://github.com/SwiftOnSecurity/sysmon-config), but it is worth\n    verifying. You can also use other repo, e.g. https://github.com/Neo23x0/sysmon-config,\n    https://github.com/olafhartong/sysmon-modular. How to test detection? You can\n    check powershell script from this site https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575\n  product: windows\nmodified: 2022/02/16\nreferences:\n- https://github.com/Azure/Azure-Sentinel/blob/f99542b94afe0ad2f19a82cc08262e7ac8e1428e/Detections/SecurityEvent/ADFSDBNamedPipeConnection.yaml\n- https://o365blog.com/post/adfs/\n- https://github.com/Azure/SimuLand\nstatus: test\ntags:\n- attack.collection\n- attack.t1005\ntitle: ADFS Database Named Pipe Connection\n",
                            "sigma:id": "1ea13e8c-03ea-409b-877d-ce5c3d2c1cb3",
                            "title": "ADFS Database Named Pipe Connection",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "0d47e3f6-357f-4534-928c-202631d065fa",
                        "lookup_data": {
                            "description": "This rule detects potential exfiltration by looking for a few compression extensions in the uri and signs of compression in the mime type, file type, and http body",
                            "raw": "author: Greg Howell, OTR (Open Threat Research)\ndate: 2020/04/05\ndescription: This rule detects potential exfiltration by looking for a few compression\n  extensions in the uri and signs of compression in the mime type, file type, and\n  http body\ndetection:\n  condition: selection1 or selection3 or selection4\n  selection1:\n    mime_types|endswith: compressed\n    uri|endswith:\n    - .7z\n    - .zip\n    - .rar\n  selection3:\n    filetype|endswith: compressed\n  selection4:\n    http.bodyMagic|endswith: compressed\n    http.method: PUT\nfalsepositives:\n- Legitimate upload/download of archives\nid: 0d47e3f6-357f-4534-928c-202631d065fa\nlevel: medium\nlogsource:\n  product: zeek\n  service: http\nreferences:\n- https://github.com/OTRF/detection-hackathon-apt29/issues/17\ntags:\n- attack.exfiltration\n- attack.t1560.001\n- attack.t1005\ntitle: Potential Exfiltration of Compressed Files\n",
                            "sigma:id": "0d47e3f6-357f-4534-928c-202631d065fa",
                            "title": "Potential Exfiltration of Compressed Files",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "3ada8ae4-a7bd-4732-ad66-0ff8fc0f80f5",
                        "lookup_data": {
                            "description": "\"Lebanese Cedar\" APT Global Lebanese Espionage Campaign Leveraging Web Servers",
                            "link": "http://www.botvrij.eu/data/feed-osint/3ada8ae4-a7bd-4732-ad66-0ff8fc0f80f5.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1612198942",
                            "uuid": "3ada8ae4-a7bd-4732-ad66-0ff8fc0f80f5",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5ce6aa86-9cd8-4302-9dc9-4a59950d210f",
                        "lookup_data": {
                            "description": "OSINT - A journey to Zebrocy land",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5ce6aa86-9cd8-4302-9dc9-4a59950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1563528054",
                            "uuid": "5ce6aa86-9cd8-4302-9dc9-4a59950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "54b9a76a-3c71-4673-b4b3-2edb4566ea7b",
                        "lookup_data": {
                            "description": "An attempt to export an AWS EC2 instance has been detected. A VM Export might indicate an attempt to extract information from an instance.",
                            "raw": "author: Diogo Braz\ndate: 2020/04/16\ndescription: An attempt to export an AWS EC2 instance has been detected. A VM Export\n  might indicate an attempt to extract information from an instance.\ndetection:\n  condition: selection and not 1 of filter*\n  filter1:\n    errorMessage|contains: '*'\n  filter2:\n    errorCode|contains: '*'\n  filter3:\n    responseElements|contains: Failure\n  selection:\n    eventName: CreateInstanceExportTask\n    eventSource: ec2.amazonaws.com\nid: 54b9a76a-3c71-4673-b4b3-2edb4566ea7b\nlevel: low\nlogsource:\n  product: aws\n  service: cloudtrail\nmodified: 2022/10/05\nreferences:\n- https://docs.aws.amazon.com/vm-import/latest/userguide/vmexport.html#export-instance\nstatus: experimental\ntags:\n- attack.collection\n- attack.t1005\n- attack.exfiltration\n- attack.t1537\ntitle: AWS EC2 VM Export Failure\n",
                            "sigma:id": "54b9a76a-3c71-4673-b4b3-2edb4566ea7b",
                            "title": "AWS EC2 VM Export Failure",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "6a69f62d-ce75-4b57-8dce-6351eb55b362",
                        "lookup_data": {
                            "description": "One way Qbot steals sensitive information is by extracting browser data from Internet Explorer and Microsoft Edge by using the built-in utility esentutl.exe",
                            "raw": "author: frack113\ndate: 2022/02/13\ndescription: One way Qbot steals sensitive information is by extracting browser data\n  from Internet Explorer and Microsoft Edge by using the built-in utility esentutl.exe\ndetection:\n  condition: all of selection*\n  selection_flag:\n    CommandLine|contains:\n    - /r\n    - -r\n  selection_img:\n  - Image|endswith: \\esentutl.exe\n  - OriginalFileName: esentutl.exe\n  selection_webcache:\n    CommandLine|contains: \\Windows\\WebCache\nfalsepositives:\n- Legitimate use\nid: 6a69f62d-ce75-4b57-8dce-6351eb55b362\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/10/31\nreferences:\n- https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/\n- https://redcanary.com/threat-detection-report/threats/qbot/\n- https://thedfirreport.com/2022/10/31/follina-exploit-leads-to-domain-compromise/\nstatus: experimental\ntags:\n- attack.collection\n- attack.t1005\ntitle: Esentutl Steals Browser Information\n",
                            "sigma:id": "6a69f62d-ce75-4b57-8dce-6351eb55b362",
                            "title": "Esentutl Steals Browser Information",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b57ba453-b384-4ab9-9f40-1038086b4e53",
                        "lookup_data": {
                            "description": "Detects dump of credentials in VeeamBackup dbo",
                            "raw": "author: frack113\ndate: 2021/12/20\ndescription: Detects dump of credentials in VeeamBackup dbo\ndetection:\n  condition: all of selection*\n  selection_query:\n    CommandLine|contains|all:\n    - SELECT\n    - TOP\n    - '[VeeamBackup].[dbo].[Credentials]'\n  selection_tools:\n    Image|endswith: \\sqlcmd.exe\nfalsepositives:\n- Unknown\nid: b57ba453-b384-4ab9-9f40-1038086b4e53\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/25\nreferences:\n- https://thedfirreport.com/2021/12/13/diavol-ransomware/\n- https://forums.veeam.com/veeam-backup-replication-f2/recover-esxi-password-in-veeam-t34630.html\nstatus: test\ntags:\n- attack.collection\n- attack.t1005\ntitle: VeeamBackup Database Credentials Dump\n",
                            "sigma:id": "b57ba453-b384-4ab9-9f40-1038086b4e53",
                            "title": "VeeamBackup Database Credentials Dump",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "cd072b25-a418-4f98-8ebc-5093fb38fe1a",
                        "lookup_data": {
                            "description": "Collect pertinent data from the configuration files",
                            "raw": "author: Austin Clark\ndate: 2019/08/11\ndescription: Collect pertinent data from the configuration files\ndetection:\n  condition: keywords\n  keywords:\n  - show running-config\n  - show startup-config\n  - show archive config\n  - more\nfalsepositives:\n- Commonly run by administrators\nfields:\n- src\n- CmdSet\n- User\n- Privilege_Level\n- Remote_Address\nid: cd072b25-a418-4f98-8ebc-5093fb38fe1a\nlevel: low\nlogsource:\n  product: cisco\n  service: aaa\nmodified: 2023/01/04\nstatus: test\ntags:\n- attack.discovery\n- attack.credential_access\n- attack.collection\n- attack.t1087.001\n- attack.t1552.001\n- attack.t1005\ntitle: Cisco Collect Data\n",
                            "sigma:id": "cd072b25-a418-4f98-8ebc-5093fb38fe1a",
                            "title": "Cisco Collect Data",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5cccb246-0da0-4c93-a463-61fe0a016219",
                        "lookup_data": {
                            "description": "ESET Turla LightNeuron Research",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5cccb246-0da0-4c93-a463-61fe0a016219.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1607525139",
                            "uuid": "5cccb246-0da0-4c93-a463-61fe0a016219",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5ced8da1-0960-40bc-b5dc-2fed0a016219",
                        "lookup_data": {
                            "description": "Turla PowerShell blogpost",
                            "link": "http://www.botvrij.eu/data/feed-osint/5ced8da1-0960-40bc-b5dc-2fed0a016219.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1559232101",
                            "uuid": "5ced8da1-0960-40bc-b5dc-2fed0a016219",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5de7883b-22bc-4264-995c-4d1f950d210f",
                        "lookup_data": {
                            "description": "Malicious PyPI packages",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5de7883b-22bc-4264-995c-4d1f950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1575466984",
                            "uuid": "5de7883b-22bc-4264-995c-4d1f950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5e5709a4-8850-453e-9f11-275a0a0a020f",
                        "lookup_data": {
                            "description": "Racoon Stealer",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5e5709a4-8850-453e-9f11-275a0a0a020f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1621850670",
                            "uuid": "5e5709a4-8850-453e-9f11-275a0a0a020f",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": [
            {
                "attack_technique": "T1005",
                "display_name": "Data from Local System",
                "atomic_tests": [
                    {
                        "name": "Search files of interest and save them to a single zip file (Windows)",
                        "auto_generated_guid": "d3d9af44-b8ad-4375-8b0a-4bff4b7e419c",
                        "description": "This test searches for files of certain extensions and saves them to a single zip file prior to extraction.                              \n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "starting_directory": {
                                "description": "Path to starting directory for the search",
                                "type": "Path",
                                "default": "C:\\Users"
                            },
                            "output_zip_folder_path": {
                                "description": "Path to directory for saving the generated zip file",
                                "type": "Path",
                                "default": "PathToAtomicsFolder\\..\\ExternalPayloads\\T1005"
                            },
                            "file_extensions": {
                                "description": "List of file extensions to be searched and zipped, separated by comma and space",
                                "type": "string",
                                "default": ".doc, .docx, .txt"
                            }
                        },
                        "executor": {
                            "command": "$startingDirectory = \"#{starting_directory}\"\n$outputZip = \"#{output_zip_folder_path}\"\n$fileExtensionsString = \"#{file_extensions}\" \n$fileExtensions = $fileExtensionsString -split \", \"\n\nNew-Item -Type Directory $outputZip -ErrorAction Ignore -Force | Out-Null\n\nFunction Search-Files {\n  param (\n    [string]$directory\n  )\n  $files = Get-ChildItem -Path $directory -File -Recurse | Where-Object {\n    $fileExtensions -contains $_.Extension.ToLower()\n  }\n  return $files\n}\n\n$foundFiles = Search-Files -directory $startingDirectory\nif ($foundFiles.Count -gt 0) {\n  $foundFilePaths = $foundFiles.FullName\n  Compress-Archive -Path $foundFilePaths -DestinationPath \"$outputZip\\data.zip\"\n\n  Write-Host \"Zip file created: $outputZip\\data.zip\"\n  } else {\n      Write-Host \"No files found with the specified extensions.\"\n  }\n",
                            "cleanup_command": "Remove-Item -Path  $outputZip\\data.zip -Force\n",
                            "name": "powershell",
                            "elevation_required": false
                        }
                    },
                    {
                        "name": "Find and dump sqlite databases (Linux)",
                        "auto_generated_guid": "00cbb875-7ae4-4cf1-b638-e543fd825300",
                        "description": "An adversary may know/assume that the user of a system uses sqlite databases which contain interest and sensitive data. In this test we download two databases and a sqlite dump script, then run a find command to find & dump the database content.\n",
                        "supported_platforms": [
                            "linux"
                        ],
                        "input_arguments": {
                            "remote_url": {
                                "description": "url of remote payload",
                                "type": "url",
                                "default": "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1005/src"
                            }
                        },
                        "dependencies": [
                            {
                                "description": "Check if running on a Debian based machine.\n",
                                "prereq_command": "if [ -x \"$(command -v sqlite3)\" ]; then echo \"sqlite3 is installed\"; else echo \"sqlite3 is NOT installed\"; exit 1; fi\nif [ -x \"$(command -v curl)\" ]; then echo \"curl is installed\"; else echo \"curl is NOT installed\"; exit 1; fi\nif [ -x \"$(command -v strings)\" ]; then echo \"strings is installed\"; else echo \"strings is NOT installed\"; exit 1; fi\n",
                                "get_prereq_command": "if grep -iq \"debian\\|ubuntu\\|kali\\|mint\" /usr/lib/os-release; then apt update && apt install -y binutils curl sqlite3; fi\nif grep -iq \"rhel\\|fedora\\|centos\" /usr/lib/os-release; then yum update -y && yum install -y binutils curl sqlite-devel; fi\n"
                            }
                        ],
                        "executor": {
                            "name": "bash",
                            "elevation_required": false,
                            "command": "cd $HOME\ncurl -O #{remote_url}/art\ncurl -O #{remote_url}/gta.db\ncurl -O #{remote_url}/sqlite_dump.sh\nchmod +x sqlite_dump.sh\nfind . ! -executable -exec bash -c 'if [[ \"$(head -c 15 {} | strings)\" == \"SQLite format 3\" ]]; then echo \"{}\"; ./sqlite_dump.sh {}; fi' \\;\n",
                            "cleanup_command": "rm -f $HOME/.art\nrm -f $HOME/gta.db\nrm -f $HOME/sqlite_dump.sh \n"
                        }
                    },
                    {
                        "name": "Copy Apple Notes database files using AppleScript",
                        "auto_generated_guid": "cfb6d400-a269-4c06-a347-6d88d584d5f7",
                        "description": "This command will copy Apple Notes database files using AppleScript as seen in Atomic Stealer.\n",
                        "supported_platforms": [
                            "macos"
                        ],
                        "input_arguments": {
                            "destination_path": {
                                "description": "Specify the path to copy the database files into.",
                                "type": "path",
                                "default": "/private/tmp"
                            }
                        },
                        "executor": {
                            "command": "osascript -e 'tell application \"Finder\"' -e 'set destinationFolderPath to POSIX file \"#{destination_path}\"' -e 'set notesFolderPath to (path to home folder as text) & \"Library:Group Containers:group.com.apple.notes:\"' -e 'set notesFolder to folder notesFolderPath' -e 'set notesFiles to {file \"NoteStore.sqlite\", file \"NoteStore.sqlite-shm\", file \"NoteStore.sqlite-wal\"} of notesFolder' -e 'repeat with aFile in notesFiles' -e 'duplicate aFile to folder destinationFolderPath with replacing' -e 'end' -e 'end tell'",
                            "cleanup_command": "rm \"#{destination_path}/NoteStore.sqlite*\"",
                            "name": "sh",
                            "elevation_required": false
                        }
                    }
                ]
            }
        ]
    },
    "timestamp": "2025-02-28 10:44:49"
}