{
    "id": "T1218.013",
    "name": "Mavinject",
    "description": "Adversaries may abuse mavinject.exe to proxy execution of malicious code. Mavinject.exe is the Microsoft Application Virtualization Injector, a Windows utility that can inject code into external processes as part of Microsoft Application Virtualization (App-V).(Citation: LOLBAS Mavinject)\nAdversaries may abuse mavinject.exe to inject malicious DLLs into running processes (i.e. [Dynamic-link Library Injection](T1055.001)), allowing for arbitrary code execution (ex. `C:Windowssystem32mavinject.exe PID /INJECTRUNNING PATH_DLL`).(Citation: ATT Lazarus TTP Evolution)(Citation: Reaqta Mavinject) Since mavinject.exe is digitally signed by Microsoft, proxying execution via this method may evade detection by security products because the execution is masked under a legitimate process.\nIn addition to [Dynamic-link Library Injection](T1055.001), Mavinject.exe can also be abused to perform import descriptor injection via its  `/HMODULE` command-line parameter (ex. `mavinject.exe PID /HMODULE=BASE_ADDRESS PATH_DLL ORDINAL_NUMBER`). This command would inject an import table entry consisting of the specified DLL into the module at the given base address.(Citation: Mavinject Functionality Deconstructed)",
    "platforms": "Windows",
    "kill_chain_phases": "Defense Evasion",
    "data_sources": "Process: Process Creation, Command: Command Execution",
    "detection": "Monitor the execution and arguments of mavinject.exe. Compare recent invocations of mavinject.exe with prior history of known good arguments and injected DLLs to determine anomalous and potentially adversarial activity.\nAdversaries may rename abusable binaries to evade detections, but the argument `INJECTRUNNING` is required for mavinject.exe to perform [Dynamic-link Library Injection](T1055.001) and may therefore be monitored to alert malicious activity.",
    "url": "https://attack.mitre.org/techniques/T1218/013",
    "enrichments": {
        "attack_rule_map": [],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "e6474a1b-5390-49cd-ab41-8d88655f7394",
                    "4f73421b-5a0b-4bbf-a892-5a7fb99bea66",
                    "1bae753e-8e52-4055-a66d-2ead90303ca9"
                ],
                "lookup_results": [
                    {
                        "uuid": "e6474a1b-5390-49cd-ab41-8d88655f7394",
                        "lookup_data": {
                            "description": "Detects execution of a renamed version of the \"Mavinject\" process. Which can be abused to perform process injection using the \"/INJECTRUNNING\" flag",
                            "raw": "author: frack113, Florian Roth\ndate: 2022/12/05\ndescription: Detects execution of a renamed version of the \"Mavinject\" process. Which\n  can be abused to perform process injection using the \"/INJECTRUNNING\" flag\ndetection:\n  condition: selection and not filter\n  filter:\n    Image|endswith:\n    - \\mavinject32.exe\n    - \\mavinject64.exe\n  selection:\n    OriginalFileName:\n    - mavinject32.exe\n    - mavinject64.exe\nfalsepositives:\n- Unlikely\nid: e6474a1b-5390-49cd-ab41-8d88655f7394\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1056.004/T1056.004.md\n- https://posts.specterops.io/mavinject-exe-functionality-deconstructed-c29ab2cf5c0e\n- https://twitter.com/gN3mes1s/status/941315826107510784\n- https://reaqta.com/2017/12/mavinject-microsoft-injector/\n- https://twitter.com/Hexacorn/status/776122138063409152\n- https://github.com/SigmaHQ/sigma/issues/3742\n- https://github.com/keyboardcrunch/SentinelOne-ATTACK-Queries/blob/6a228d23eefe963ca81f2d52f94b815f61ef5ee0/Tactics/DefenseEvasion.md#t1055-process-injection\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.privilege_escalation\n- attack.t1055.001\n- attack.t1218.013\ntitle: Rename Mavinject Execution\n",
                            "sigma:id": "e6474a1b-5390-49cd-ab41-8d88655f7394",
                            "title": "Rename Mavinject Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4f73421b-5a0b-4bbf-a892-5a7fb99bea66",
                        "lookup_data": {
                            "description": "Detects process injection using the signed Windows tool \"Mavinject\" via the \"INJECTRUNNING\" flag",
                            "raw": "author: frack113, Florian Roth\ndate: 2021/07/12\ndescription: Detects process injection using the signed Windows tool \"Mavinject\" via\n  the \"INJECTRUNNING\" flag\ndetection:\n  condition: selection and not filter\n  filter:\n    ParentImage: C:\\Windows\\System32\\AppVClient.exe\n  selection:\n    CommandLine|contains: ' /INJECTRUNNING '\nfalsepositives:\n- Unknown\nid: 4f73421b-5a0b-4bbf-a892-5a7fb99bea66\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/05\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1056.004/T1056.004.md\n- https://posts.specterops.io/mavinject-exe-functionality-deconstructed-c29ab2cf5c0e\n- https://twitter.com/gN3mes1s/status/941315826107510784\n- https://reaqta.com/2017/12/mavinject-microsoft-injector/\n- https://twitter.com/Hexacorn/status/776122138063409152\n- https://github.com/SigmaHQ/sigma/issues/3742\n- https://github.com/keyboardcrunch/SentinelOne-ATTACK-Queries/blob/6a228d23eefe963ca81f2d52f94b815f61ef5ee0/Tactics/DefenseEvasion.md#t1055-process-injection\nrelated:\n- id: 17eb8e57-9983-420d-ad8a-2c4976c22eb8\n  type: obsoletes\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.privilege_escalation\n- attack.t1055.001\n- attack.t1218.013\ntitle: Mavinject Inject DLL Into Running Process\n",
                            "sigma:id": "4f73421b-5a0b-4bbf-a892-5a7fb99bea66",
                            "title": "Mavinject Inject DLL Into Running Process",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "1bae753e-8e52-4055-a66d-2ead90303ca9",
                        "lookup_data": {
                            "mitre-attack-id": "T1218.013",
                            "mitre-cti:description": "Adversaries may abuse mavinject.exe to proxy execution of malicious code. Mavinject.exe is the Microsoft Application Virtualization Injector, a Windows utility that can inject code into external processes as part of Microsoft Application Virtualization (App-V).(Citation: LOLBAS Mavinject)\n\nAdversaries may abuse mavinject.exe to inject malicious DLLs into running processes (i.e. [Dynamic-link Library Injection](https://attack.mitre.org/techniques/T1055/001)), allowing for arbitrary code execution (ex. <code>C:\\Windows\\system32\\mavinject.exe PID /INJECTRUNNING PATH_DLL</code>).(Citation: ATT Lazarus TTP Evolution)(Citation: Reaqta Mavinject) Since mavinject.exe may be digitally signed by Microsoft, proxying execution via this method may evade detection by security products because the execution is masked under a legitimate process. \n\nIn addition to [Dynamic-link Library Injection](https://attack.mitre.org/techniques/T1055/001), Mavinject.exe can also be abused to perform import descriptor injection via its  <code>/HMODULE</code> command-line parameter (ex. <code>mavinject.exe PID /HMODULE=BASE_ADDRESS PATH_DLL ORDINAL_NUMBER</code>). This command would inject an import table entry consisting of the specified DLL into the module at the given base address.(Citation: Mavinject Functionality Deconstructed)",
                            "mitre-cti:name": "Mavinject",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'x_mitre_platforms': ['Windows'], 'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'type': 'attack-pattern', 'id': 'attack-pattern--1bae753e-8e52-4055-a66d-2ead90303ca9', 'created': '2021-09-22T17:45:10.241Z', 'x_mitre_version': '2.0', 'external_references': [{'source_name': 'mitre-attack', 'external_id': 'T1218.013', 'url': 'https://attack.mitre.org/techniques/T1218/013'}, {'source_name': 'ATT Lazarus TTP Evolution', 'url': 'https://cybersecurity.att.com/blogs/labs-research/lazarus-campaign-ttps-and-evolution', 'description': 'Fernando Martinez. (2021, July 6). Lazarus campaign TTPs and evolution. Retrieved September 22, 2021.'}, {'source_name': 'LOLBAS Mavinject', 'url': 'https://lolbas-project.github.io/lolbas/Binaries/Mavinject/', 'description': 'LOLBAS. (n.d.). Mavinject.exe. Retrieved September 22, 2021.'}, {'source_name': 'Mavinject Functionality Deconstructed', 'url': 'https://posts.specterops.io/mavinject-exe-functionality-deconstructed-c29ab2cf5c0e', 'description': 'Matt Graeber. (2018, May 29). mavinject.exe Functionality Deconstructed. Retrieved September 22, 2021.'}, {'source_name': 'Reaqta Mavinject', 'url': 'https://reaqta.com/2017/12/mavinject-microsoft-injector/', 'description': 'Reaqta. (2017, December 16). From False Positive to True Positive: the story of Mavinject.exe, the Microsoft Injector. Retrieved September 22, 2021.'}], 'x_mitre_deprecated': False, 'revoked': False, 'description': 'Adversaries may abuse mavinject.exe to proxy execution of malicious code. Mavinject.exe is the Microsoft Application Virtualization Injector, a Windows utility that can inject code into external processes as part of Microsoft Application Virtualization (App-V).(Citation: LOLBAS Mavinject)\\n\\nAdversaries may abuse mavinject.exe to inject malicious DLLs into running processes (i.e. [Dynamic-link Library Injection](https://attack.mitre.org/techniques/T1055/001)), allowing for arbitrary code execution (ex. <code>C:\\\\Windows\\\\system32\\\\mavinject.exe PID /INJECTRUNNING PATH_DLL</code>).(Citation: ATT Lazarus TTP Evolution)(Citation: Reaqta Mavinject) Since mavinject.exe may be digitally signed by Microsoft, proxying execution via this method may evade detection by security products because the execution is masked under a legitimate process. \\n\\nIn addition to [Dynamic-link Library Injection](https://attack.mitre.org/techniques/T1055/001), Mavinject.exe can also be abused to perform import descriptor injection via its  <code>/HMODULE</code> command-line parameter (ex. <code>mavinject.exe PID /HMODULE=BASE_ADDRESS PATH_DLL ORDINAL_NUMBER</code>). This command would inject an import table entry consisting of the specified DLL into the module at the given base address.(Citation: Mavinject Functionality Deconstructed)', 'modified': '2022-04-19T17:35:08.315Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'name': 'Mavinject', 'x_mitre_detection': 'Monitor the execution and arguments of mavinject.exe. Compare recent invocations of mavinject.exe with prior history of known good arguments and injected DLLs to determine anomalous and potentially adversarial activity.\\n\\nAdversaries may rename abusable binaries to evade detections, but the argument <code>INJECTRUNNING</code> is required for mavinject.exe to perform [Dynamic-link Library Injection](https://attack.mitre.org/techniques/T1055/001) and may therefore be monitored to alert malicious activity.', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'defense-evasion'}], 'x_mitre_is_subtechnique': True, 'x_mitre_data_sources': ['Process: Process Creation', 'Command: Command Execution'], 'x_mitre_attack_spec_version': '2.1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": []
    },
    "timestamp": "2025-02-28 14:21:32"
}