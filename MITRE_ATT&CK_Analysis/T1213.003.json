{
    "id": "T1213.003",
    "name": "Code Repositories",
    "description": "Adversaries may leverage code repositories to collect valuable information. Code repositories are tools/services that store source code and automate software builds. They may be hosted internally or privately on third party sites such as Github, GitLab, SourceForge, and BitBucket. Users typically interact with code repositories through a web application or command-line utilities such as git.\nOnce adversaries gain access to a victim network or a private code repository, they may collect sensitive information such as proprietary source code or credentials contained within software's source code.  Having access to software's source code may allow adversaries to develop [Exploits](T1587.004), while credentials may provide access to additional resources using [Valid Accounts](T1078).(Citation: Wired Uber Breach)(Citation: Krebs Adobe)",
    "platforms": "SaaS",
    "kill_chain_phases": "Collection",
    "data_sources": "Logon Session: Logon Session Creation, Application Log: Application Log Content",
    "detection": "Monitor access to code repositories, especially performed by privileged users such as Active Directory Domain or Enterprise Administrators as these types of accounts should generally not be used to access code repositories. In environments with high-maturity, it may be possible to leverage User-Behavioral Analytics (UBA) platforms to detect and alert on user-based anomalies.",
    "url": "https://attack.mitre.org/techniques/T1213/003",
    "enrichments": {
        "attack_rule_map": [],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "f8ed0e8f-7438-4b79-85eb-f358ef2fbebd",
                    "16a71777-0b2e-4db7-9888-9d59cb75200b",
                    "cff94884-3b1c-4987-a70b-6d5643c621c3",
                    "eaa9ac35-1730-441f-9587-25767bde99d7"
                ],
                "lookup_results": [
                    {
                        "uuid": "f8ed0e8f-7438-4b79-85eb-f358ef2fbebd",
                        "lookup_data": {
                            "description": "A self-hosted runner is a system that you deploy and manage to execute jobs from GitHub Actions on GitHub.com.\nThis rule detects changes to self-hosted runners configurations in the environment. The self-hosted runner configuration changes once detected,\nit should be validated from GitHub UI becasue the log entry may not provide full context.\n",
                            "raw": "author: Muhammad Faisal\ndate: 2023/01/27\ndescription: 'A self-hosted runner is a system that you deploy and manage to execute\n  jobs from GitHub Actions on GitHub.com.\n\n  This rule detects changes to self-hosted runners configurations in the environment.\n  The self-hosted runner configuration changes once detected,\n\n  it should be validated from GitHub UI becasue the log entry may not provide full\n  context.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    action:\n    - org.remove_self_hosted_runner\n    - org.runner_group_created\n    - org.runner_group_removed\n    - org.runner_group_updated\n    - org.runner_group_runners_added\n    - org.runner_group_runner_removed\n    - org.runner_group_runners_updated\n    - repo.register_self_hosted_runner\n    - repo.remove_self_hosted_runner\nfalsepositives:\n- Allowed self-hosted runners changes in the envrionment.\n- A self-hosted runner is automatically removed from GitHub if it has not connected\n  to GitHub Actions for more than 14 days.\n- An ephemeral self-hosted runner is automatically removed from GitHub if it has not\n  connected to GitHub Actions for more than 1 day.\nfields:\n- action\n- actor\n- org\n- actor_location.country_code\n- transport_protocol_name\n- repository\n- repo\n- repository_public\n- '@timestamp'\nid: f8ed0e8f-7438-4b79-85eb-f358ef2fbebd\nlevel: low\nlogsource:\n  definition: 'Requirements: The audit log streaming feature must be enabled to be\n    able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming'\n  product: github\n  service: audit\nreferences:\n- https://docs.github.com/en/actions/hosting-your-own-runners/about-self-hosted-runners#about-self-hosted-runners\n- https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-security-settings-for-your-organization/reviewing-the-audit-log-for-your-organization#search-based-on-operation\nstatus: experimental\ntags:\n- attack.impact\n- attack.discovery\n- attack.collection\n- attack.defense_evasion\n- attack.persistence\n- attack.privilege_escalation\n- attack.initial_access\n- attack.t1526\n- attack.t1213.003\n- attack.t1078.004\ntitle: Github Self Hosted Runner Changes Detected\n",
                            "sigma:id": "f8ed0e8f-7438-4b79-85eb-f358ef2fbebd",
                            "title": "Github Self Hosted Runner Changes Detected",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "16a71777-0b2e-4db7-9888-9d59cb75200b",
                        "lookup_data": {
                            "description": "Detects delete action in the Github audit logs for codespaces, environment, project and repo.",
                            "raw": "author: Muhammad Faisal\ndate: 2023/01/19\ndescription: Detects delete action in the Github audit logs for codespaces, environment,\n  project and repo.\ndetection:\n  condition: selection\n  selection:\n    action:\n    - codespaces.delete\n    - environment.delete\n    - project.delete\n    - repo.destroy\nfalsepositives:\n- Validate the deletion activity is permitted. The \"actor\" field need to be validated.\nfields:\n- action\n- actor\n- org\n- actor_location.country_code\nid: 16a71777-0b2e-4db7-9888-9d59cb75200b\nlevel: medium\nlogsource:\n  definition: 'Requirements: The audit log streaming feature must be enabled to be\n    able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming'\n  product: github\n  service: audit\nreferences:\n- https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-security-settings-for-your-organization/reviewing-the-audit-log-for-your-organization#audit-log-actions\nstatus: experimental\ntags:\n- attack.impact\n- attack.collection\n- attack.t1213.003\ntitle: Github Delete Action Invoked\n",
                            "sigma:id": "16a71777-0b2e-4db7-9888-9d59cb75200b",
                            "title": "Github Delete Action Invoked",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "cff94884-3b1c-4987-a70b-6d5643c621c3",
                        "lookup_data": {
                            "mitre-attack-id": "T1213.003",
                            "mitre-cti:description": "Adversaries may leverage code repositories to collect valuable information. Code repositories are tools/services that store source code and automate software builds. They may be hosted internally or privately on third party sites such as Github, GitLab, SourceForge, and BitBucket. Users typically interact with code repositories through a web application or command-line utilities such as git.\n\nOnce adversaries gain access to a victim network or a private code repository, they may collect sensitive information such as proprietary source code or credentials contained within software's source code.  Having access to software's source code may allow adversaries to develop [Exploits](https://attack.mitre.org/techniques/T1587/004), while credentials may provide access to additional resources using [Valid Accounts](https://attack.mitre.org/techniques/T1078).(Citation: Wired Uber Breach)(Citation: Krebs Adobe)\n\n**Note:** This is distinct from [Code Repositories](https://attack.mitre.org/techniques/T1593/003), which focuses on conducting [Reconnaissance](https://attack.mitre.org/tactics/TA0043) via public code repositories.",
                            "mitre-cti:name": "Code Repositories",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'modified': '2022-10-18T22:44:01.723Z', 'name': 'Code Repositories', 'description': \"Adversaries may leverage code repositories to collect valuable information. Code repositories are tools/services that store source code and automate software builds. They may be hosted internally or privately on third party sites such as Github, GitLab, SourceForge, and BitBucket. Users typically interact with code repositories through a web application or command-line utilities such as git.\\n\\nOnce adversaries gain access to a victim network or a private code repository, they may collect sensitive information such as proprietary source code or credentials contained within software's source code.  Having access to software's source code may allow adversaries to develop [Exploits](https://attack.mitre.org/techniques/T1587/004), while credentials may provide access to additional resources using [Valid Accounts](https://attack.mitre.org/techniques/T1078).(Citation: Wired Uber Breach)(Citation: Krebs Adobe)\\n\\n**Note:** This is distinct from [Code Repositories](https://attack.mitre.org/techniques/T1593/003), which focuses on conducting [Reconnaissance](https://attack.mitre.org/tactics/TA0043) via public code repositories.\", 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'collection'}], 'x_mitre_detection': 'Monitor access to code repositories, especially performed by privileged users such as Active Directory Domain or Enterprise Administrators as these types of accounts should generally not be used to access code repositories. In environments with high-maturity, it may be possible to leverage User-Behavioral Analytics (UBA) platforms to detect and alert on user-based anomalies.', 'x_mitre_platforms': ['SaaS'], 'x_mitre_is_subtechnique': True, 'x_mitre_deprecated': False, 'x_mitre_domains': ['enterprise-attack'], 'x_mitre_version': '1.1', 'x_mitre_contributors': ['Itamar Mizrahi, Cymptom', 'Toby Kohlenberg', 'Josh Liburdi, @jshlbrd'], 'x_mitre_data_sources': ['Application Log: Application Log Content', 'Logon Session: Logon Session Creation'], 'type': 'attack-pattern', 'id': 'attack-pattern--cff94884-3b1c-4987-a70b-6d5643c621c3', 'created': '2021-05-11T18:51:16.343Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'revoked': False, 'external_references': [{'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/techniques/T1213/003', 'external_id': 'T1213.003'}, {'source_name': 'Wired Uber Breach', 'description': 'Andy Greenberg. (2017, January 21). Hack Brief: Uber Paid Off Hackers to Hide a 57-Million User Data Breach. Retrieved May 14, 2021.', 'url': 'https://www.wired.com/story/uber-paid-off-hackers-to-hide-a-57-million-user-data-breach/'}, {'source_name': 'Krebs Adobe', 'description': 'Brian Krebs. (2013, October 3). Adobe To Announce Source Code, Customer Data Breach. Retrieved May 17, 2021.', 'url': 'https://krebsonsecurity.com/2013/10/adobe-to-announce-source-code-customer-data-breach/'}], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'x_mitre_attack_spec_version': '2.1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "eaa9ac35-1730-441f-9587-25767bde99d7",
                        "lookup_data": {
                            "description": "Detects when an organization member or an outside collaborator is added to or removed from a project board or has their permission level changed or when an owner removes an outside collaborator from an organization or when two-factor authentication is required in an organization and an outside collaborator does not use 2FA or disables 2FA.\n",
                            "raw": "author: Muhammad Faisal\ndate: 2023/01/20\ndescription: 'Detects when an organization member or an outside collaborator is added\n  to or removed from a project board or has their permission level changed or when\n  an owner removes an outside collaborator from an organization or when two-factor\n  authentication is required in an organization and an outside collaborator does not\n  use 2FA or disables 2FA.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    action:\n    - project.update_user_permission\n    - org.remove_outside_collaborator\nfalsepositives:\n- Validate the actor if permitted to access the repo.\n- Validate the Multifactor Authentication changes.\nfields:\n- action\n- actor\n- org\n- actor_location.country_code\nid: eaa9ac35-1730-441f-9587-25767bde99d7\nlevel: medium\nlogsource:\n  definition: 'Requirements: The audit log streaming feature must be enabled to be\n    able to receive such logs. You can enable following the documentation here: https://docs.github.com/en/enterprise-cloud@latest/admin/monitoring-activity-in-your-enterprise/reviewing-audit-logs-for-your-enterprise/streaming-the-audit-log-for-your-enterprise#setting-up-audit-log-streaming'\n  product: github\n  service: audit\nreferences:\n- https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-security-settings-for-your-organization/reviewing-the-audit-log-for-your-organization#audit-log-actions\n- https://docs.github.com/en/organizations/keeping-your-organization-secure/managing-two-factor-authentication-for-your-organization/requiring-two-factor-authentication-in-your-organization\nstatus: experimental\ntags:\n- attack.persistence\n- attack.collection\n- attack.t1098.001\n- attack.t1098.003\n- attack.t1213.003\ntitle: Github Outside Collaborator Detected\n",
                            "sigma:id": "eaa9ac35-1730-441f-9587-25767bde99d7",
                            "title": "Github Outside Collaborator Detected",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": []
    },
    "timestamp": "2025-02-28 14:06:42"
}