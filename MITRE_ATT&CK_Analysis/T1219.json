{
    "id": "T1219",
    "name": "Remote Access Software",
    "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks. These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment. Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\nRemote access tools may be established and used post-compromise as alternate communications channel for redundant access or as a way to establish an interactive remote desktop session with the target system. They may also be used as a component of malware to establish a reverse connection or back-connect to a service or adversary controlled system.\nAdmin tools such as TeamViewer have been used by several groups targeting institutions in countries of interest to the Russian state and criminal campaigns. (Citation: CrowdStrike 2015 Global Threat Report) (Citation: CrySyS Blog TeamSpy)",
    "platforms": "Linux, Windows, macOS",
    "kill_chain_phases": "Command and Control",
    "data_sources": "Process: Process Creation, Network Traffic: Network Traffic Flow, Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content",
    "detection": "Monitor for applications and processes related to remote admin tools. Correlate activity with other suspicious behavior that may reduce false positives if these tools are used by legitimate users and administrators.\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol for the port that is being used.\n[Domain Fronting](T1090.004) may be used in conjunction to avoid defenses. Adversaries will likely need to deploy and/or install these remote tools to compromised systems. It may be possible to detect or prevent the installation of these tools with host-based solutions.",
    "url": "https://attack.mitre.org/techniques/T1219",
    "enrichments": {
        "attack_rule_map": [
            {
                "tech_id": "T1219",
                "atomic_attack_guid": "1b72b3bd-72f8-4b63-a30b-84e91b9c3578",
                "atomic_attack_name": "GoToAssist Files Detected Test on Windows",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Usage Of Web Request Commands And Cmdlets",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_web_request_cmd_and_cmdlets.yml",
                        "remote_content": "title: Usage Of Web Request Commands And Cmdlets\nid: 9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d\nrelated:\n    - id: 1139d2e2-84b1-4226-b445-354492eba8ba\n      type: similar\n    - id: f67dbfce-93bc-440d-86ad-a95ae8858c90\n      type: obsolete\n    - id: cd5c8085-4070-4e22-908d-a5b3342deb74\n      type: obsolete\nstatus: test\ndescription: Detects the use of various web request commands with commandline tools and Windows PowerShell cmdlets (including aliases) via CommandLine\nreferences:\n    - https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/\n    - https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell\n    - https://learn.microsoft.com/en-us/powershell/module/bitstransfer/add-bitsfile?view=windowsserver2019-ps\nauthor: James Pemberton / @4A616D6573, Endgame, JHasenbusch, oscd.community, Austin Songer @austinsonger\ndate: 2019-10-24\nmodified: 2023-01-10\ntags:\n    - attack.execution\n    - attack.t1059.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains:\n            - '[System.Net.WebRequest]::create'\n            - 'curl '\n            - 'Invoke-RestMethod'\n            - 'Invoke-WebRequest'\n            - 'iwr '\n            - 'Net.WebClient'\n            - 'Resume-BitsTransfer'\n            - 'Start-BitsTransfer'\n            - 'wget '\n            - 'WinHttp.WinHttpRequest'\n    condition: selection\nfalsepositives:\n    - Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer.\nlevel: medium\n"
                    },
                    {
                        "rule_name": "PowerShell Web Download",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_download_cradles.yml",
                        "remote_content": "title: PowerShell Web Download\nid: 6e897651-f157-4d8f-aaeb-df8151488385\nstatus: test\ndescription: Detects suspicious ways to download files or content using PowerShell\nreferences:\n    - https://github.com/VirtualAlllocEx/Payload-Download-Cradles/blob/88e8eca34464a547c90d9140d70e9866dcbc6a12/Download-Cradles.cmd\nauthor: Florian Roth (Nextron Systems)\ndate: 2022-03-24\nmodified: 2023-01-05\ntags:\n    - attack.command-and-control\n    - attack.execution\n    - attack.t1059.001\n    - attack.t1105\nlogsource:\n    product: windows\n    category: process_creation\ndetection:\n    selection:\n        CommandLine|contains:\n            - '.DownloadString('\n            - '.DownloadFile('\n            - 'Invoke-WebRequest '\n            - 'iwr '\n    condition: selection\nfalsepositives:\n    - Scripts or tools that download files\nlevel: medium\n"
                    },
                    {
                        "rule_name": "Suspicious Invoke-WebRequest Execution",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_invoke_webrequest_download.yml",
                        "remote_content": "title: Suspicious Invoke-WebRequest Execution\nid: 5e3cc4d8-3e68-43db-8656-eaaeefdec9cc\nrelated:\n    - id: e218595b-bbe7-4ee5-8a96-f32a24ad3468\n      type: derived\nstatus: test\ndescription: Detects a suspicious call to Invoke-WebRequest cmdlet where the and output is located in a suspicious location\nreferences:\n    - https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-08-02\nmodified: 2024-02-23\ntags:\n    - attack.command-and-control\n    - attack.t1105\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_img:\n        - Image|endswith:\n              - '\\powershell.exe'\n              - '\\pwsh.exe'\n        - OriginalFileName:\n              - 'PowerShell.EXE'\n              - 'pwsh.dll'\n    selection_commands:\n        CommandLine|contains:\n            # These are all aliases of Invoke-WebRequest\n            - 'curl '\n            - 'Invoke-WebRequest'\n            - 'iwr '\n            - 'wget '\n    selection_flags:\n        CommandLine|contains:\n            - ' -ur'\n            - ' -o'\n    selection_susp_locations:\n        CommandLine|contains:\n            - '\\AppData\\'\n            - '\\Desktop\\'\n            - '\\Temp\\'\n            - '\\Users\\Public\\'\n            - '%AppData%'\n            - '%Public%'\n            - '%Temp%'\n            - '%tmp%'\n            - ':\\Windows\\'\n    condition: all of selection_*\nfalsepositives:\n    - Unknown\nlevel: high\n"
                    }
                ],
                "splunk_rules": [
                    {
                        "rule_name": "User Discovery With Env Vars PowerShell",
                        "rule_link": "https://research.splunk.com/endpoint/0cdf318b-a0dd-47d7-b257-c621c0247de8/"
                    }
                ]
            },
            {
                "tech_id": "T1219",
                "atomic_attack_guid": "6b8b7391-5c0a-4f8c-baee-78d8ce0ce330",
                "atomic_attack_name": "AnyDesk Files Detected Test on Windows",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Usage Of Web Request Commands And Cmdlets",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_web_request_cmd_and_cmdlets.yml",
                        "remote_content": "title: Usage Of Web Request Commands And Cmdlets\nid: 9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d\nrelated:\n    - id: 1139d2e2-84b1-4226-b445-354492eba8ba\n      type: similar\n    - id: f67dbfce-93bc-440d-86ad-a95ae8858c90\n      type: obsolete\n    - id: cd5c8085-4070-4e22-908d-a5b3342deb74\n      type: obsolete\nstatus: test\ndescription: Detects the use of various web request commands with commandline tools and Windows PowerShell cmdlets (including aliases) via CommandLine\nreferences:\n    - https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/\n    - https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell\n    - https://learn.microsoft.com/en-us/powershell/module/bitstransfer/add-bitsfile?view=windowsserver2019-ps\nauthor: James Pemberton / @4A616D6573, Endgame, JHasenbusch, oscd.community, Austin Songer @austinsonger\ndate: 2019-10-24\nmodified: 2023-01-10\ntags:\n    - attack.execution\n    - attack.t1059.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains:\n            - '[System.Net.WebRequest]::create'\n            - 'curl '\n            - 'Invoke-RestMethod'\n            - 'Invoke-WebRequest'\n            - 'iwr '\n            - 'Net.WebClient'\n            - 'Resume-BitsTransfer'\n            - 'Start-BitsTransfer'\n            - 'wget '\n            - 'WinHttp.WinHttpRequest'\n    condition: selection\nfalsepositives:\n    - Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer.\nlevel: medium\n"
                    },
                    {
                        "rule_name": "PowerShell Web Download",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_download_cradles.yml",
                        "remote_content": "title: PowerShell Web Download\nid: 6e897651-f157-4d8f-aaeb-df8151488385\nstatus: test\ndescription: Detects suspicious ways to download files or content using PowerShell\nreferences:\n    - https://github.com/VirtualAlllocEx/Payload-Download-Cradles/blob/88e8eca34464a547c90d9140d70e9866dcbc6a12/Download-Cradles.cmd\nauthor: Florian Roth (Nextron Systems)\ndate: 2022-03-24\nmodified: 2023-01-05\ntags:\n    - attack.command-and-control\n    - attack.execution\n    - attack.t1059.001\n    - attack.t1105\nlogsource:\n    product: windows\n    category: process_creation\ndetection:\n    selection:\n        CommandLine|contains:\n            - '.DownloadString('\n            - '.DownloadFile('\n            - 'Invoke-WebRequest '\n            - 'iwr '\n    condition: selection\nfalsepositives:\n    - Scripts or tools that download files\nlevel: medium\n"
                    },
                    {
                        "rule_name": "Suspicious Invoke-WebRequest Execution",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_invoke_webrequest_download.yml",
                        "remote_content": "title: Suspicious Invoke-WebRequest Execution\nid: 5e3cc4d8-3e68-43db-8656-eaaeefdec9cc\nrelated:\n    - id: e218595b-bbe7-4ee5-8a96-f32a24ad3468\n      type: derived\nstatus: test\ndescription: Detects a suspicious call to Invoke-WebRequest cmdlet where the and output is located in a suspicious location\nreferences:\n    - https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-08-02\nmodified: 2024-02-23\ntags:\n    - attack.command-and-control\n    - attack.t1105\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_img:\n        - Image|endswith:\n              - '\\powershell.exe'\n              - '\\pwsh.exe'\n        - OriginalFileName:\n              - 'PowerShell.EXE'\n              - 'pwsh.dll'\n    selection_commands:\n        CommandLine|contains:\n            # These are all aliases of Invoke-WebRequest\n            - 'curl '\n            - 'Invoke-WebRequest'\n            - 'iwr '\n            - 'wget '\n    selection_flags:\n        CommandLine|contains:\n            - ' -ur'\n            - ' -o'\n    selection_susp_locations:\n        CommandLine|contains:\n            - '\\AppData\\'\n            - '\\Desktop\\'\n            - '\\Temp\\'\n            - '\\Users\\Public\\'\n            - '%AppData%'\n            - '%Public%'\n            - '%Temp%'\n            - '%tmp%'\n            - ':\\Windows\\'\n    condition: all of selection_*\nfalsepositives:\n    - Unknown\nlevel: high\n"
                    }
                ],
                "splunk_rules": [
                    {
                        "rule_name": "User Discovery With Env Vars PowerShell",
                        "rule_link": "https://research.splunk.com/endpoint/0cdf318b-a0dd-47d7-b257-c621c0247de8/"
                    }
                ]
            }
        ],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "065b00ca-5d5c-4557-ac95-64a6d0b64d86",
                    "758ff488-18d5-4cbe-8ec4-02b6285a434f",
                    "778ba9a8-45e4-4b80-8e3e-34a419f0b85e",
                    "b1377339-fda6-477a-b455-ac0923f9ec2c",
                    "b52e84a3-029e-4529-b09b-71d19dd27e94",
                    "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                    "52753ea4-b3a0-4365-910d-36cff487b789",
                    "03be663f-7037-4f68-a96a-362036e75637",
                    "0b9ad457-2554-44c1-82c2-d56a99c42377",
                    "2d367498-5112-4ae5-a06a-96e7bc33a211",
                    "34582dfc-d0bf-403d-8419-2d4fa7a76466",
                    "57bff678-25d1-4d6c-8211-8ca106d12053",
                    "af093bc8-7b59-4e2a-9da8-8e839b4c50c6",
                    "e0d1ad53-c7eb-48ec-a87a-72393cc6cedc",
                    "9711de76-5d4f-4c50-a94f-21e4e8f8384d",
                    "4d07b1f4-cb00-4470-b9f8-b0191d48ff52",
                    "bb09dd3e-2b78-4819-8e35-a7c1b874e449",
                    "ce5678bb-b9aa-4fb5-be4b-e57f686256ad",
                    "4061e78c-1284-44b4-9116-73e4ac3912f7",
                    "9847f263-4a81-424f-970c-875dab15b79b",
                    "d85873ef-a0f8-4c48-a53a-6b621f11729d",
                    "5d756aee-ad3e-4306-ad95-cb1abec48de2",
                    "e1e0b7d7-e10b-4ee4-ac49-a4bda05d320d",
                    "b6d98a4f-cef0-4abf-bbf6-24132854a83d",
                    "114e7f1c-f137-48c8-8f54-3088c24ce4b9",
                    "fec96f39-988b-4586-b746-b93d59fd1922",
                    "7b582f1a-b318-4c6a-bf4e-66fe49bf55a5",
                    "162ab1e4-6874-4564-853c-53ec3ab8be01",
                    "238527ad-3c2c-4e4f-a1f6-92fd63adb864",
                    "4a14a80e-6067-43de-b5e3-c88a913dd13d",
                    "88656cec-6c3b-487c-82c0-f73ebb805503",
                    "5dee2bc3-47ac-4784-a52a-4da2950d210f",
                    "87261fb2-69d0-42fe-b9de-88c6b5f65a43",
                    "4bcf0465-4b53-4de4-8c53-fcc5f7d04dfc",
                    "4bb79b62-ef12-4861-981d-2aab43fab642",
                    "145322e4-0fd3-486b-81ca-9addc75736d8"
                ],
                "lookup_results": [
                    {
                        "uuid": "065b00ca-5d5c-4557-ac95-64a6d0b64d86",
                        "lookup_data": {
                            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/05/20\ndescription: 'An adversary may use legitimate desktop support and remote access software,\n  such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive\n  command and control channel to target systems within networks.\n\n  These services are commonly used as legitimate technical support software, and may\n  be allowed by application control within a target environment.\n\n  Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared\n  with other legitimate software commonly used by adversaries. (Citation: Symantec\n  Living off the Land)\n\n  '\ndetection:\n  condition: selection and not filter\n  filter:\n    Image|contains:\n    - \\AppData\\\n    - Program Files (x86)\\AnyDesk\n    - Program Files\\AnyDesk\n  selection:\n  - Image|endswith: \\AnyDesk.exe\n  - Description: AnyDesk\n  - Product: AnyDesk\n  - Company: AnyDesk Software GmbH\nfalsepositives:\n- Legitimate use of AnyDesk from a non-standard folder\nid: 065b00ca-5d5c-4557-ac95-64a6d0b64d86\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/27\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows\nrelated:\n- id: b52e84a3-029e-4529-b09b-71d19dd27e94\n  type: similar\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Anydesk Execution From Suspicious Folder\n",
                            "sigma:id": "065b00ca-5d5c-4557-ac95-64a6d0b64d86",
                            "title": "Anydesk Execution From Suspicious Folder",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "758ff488-18d5-4cbe-8ec4-02b6285a434f",
                        "lookup_data": {
                            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
                            "raw": "author: frack113\ndate: 2022/09/25\ndescription: 'An adversary may use legitimate desktop support and remote access software,\n  such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive\n  command and control channel to target systems within networks.\n\n  These services are commonly used as legitimate technical support software, and may\n  be allowed by application control within a target environment.\n\n  Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared\n  with other legitimate software commonly used by adversaries. (Citation: Symantec\n  Living off the Land)\n\n  '\ndetection:\n  condition: selection\n  selection:\n  - Description: NetSupport Client Configurator\n  - Product: NetSupport Remote Control\n  - Company: NetSupport Ltd\n  - OriginalFileName: PCICFGUI.EXE\nfalsepositives:\n- Legitimate use\nid: 758ff488-18d5-4cbe-8ec4-02b6285a434f\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Use of NetSupport Remote Access Software\n",
                            "sigma:id": "758ff488-18d5-4cbe-8ec4-02b6285a434f",
                            "title": "Use of NetSupport Remote Access Software",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "778ba9a8-45e4-4b80-8e3e-34a419f0b85e",
                        "lookup_data": {
                            "description": "Detects DNS queries to a TeamViewer domain only resolved by a TeamViewer client by an image that isn't named TeamViewer (sometimes used by threat actors for obfuscation)",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/01/30\ndescription: Detects DNS queries to a TeamViewer domain only resolved by a TeamViewer\n  client by an image that isn't named TeamViewer (sometimes used by threat actors\n  for obfuscation)\ndetection:\n  condition: dns_request and not filter\n  dns_request:\n    QueryName:\n    - taf.teamviewer.com\n    - udp.ping.teamviewer.com\n  filter:\n    Image|contains: TeamViewer\nfalsepositives:\n- Unknown binary names of TeamViewer\n- Other programs that also lookup the observed domain\nid: 778ba9a8-45e4-4b80-8e3e-34a419f0b85e\nlevel: medium\nlogsource:\n  category: dns_query\n  product: windows\nmodified: 2022/02/08\nreferences:\n- https://www.teamviewer.com/en-us/\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Suspicious TeamViewer Domain Access\n",
                            "sigma:id": "778ba9a8-45e4-4b80-8e3e-34a419f0b85e",
                            "title": "Suspicious TeamViewer Domain Access",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b1377339-fda6-477a-b455-ac0923f9ec2c",
                        "lookup_data": {
                            "description": "Detects piping the password to an anydesk instance via CMD and the '--set-password' flag.",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/09/28\ndescription: Detects piping the password to an anydesk instance via CMD and the '--set-password'\n  flag.\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - '/c '\n    - 'echo '\n    - .exe --set-password\nfalsepositives:\n- Legitimate piping of the password to anydesk\n- Some FP could occure with similar tools that uses the same command line '--set-password'\nid: b1377339-fda6-477a-b455-ac0923f9ec2c\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/27\nreferences:\n- https://redcanary.com/blog/misbehaving-rats/\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: AnyDesk Piped Password Via CLI\n",
                            "sigma:id": "b1377339-fda6-477a-b455-ac0923f9ec2c",
                            "title": "AnyDesk Piped Password Via CLI",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b52e84a3-029e-4529-b09b-71d19dd27e94",
                        "lookup_data": {
                            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
                            "raw": "author: frack113\ndate: 2022/02/11\ndescription: 'An adversary may use legitimate desktop support and remote access software,\n  such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive\n  command and control channel to target systems within networks.\n\n  These services are commonly used as legitimate technical support software, and may\n  be allowed by application control within a target environment.\n\n  Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared\n  with other legitimate software commonly used by adversaries. (Citation: Symantec\n  Living off the Land)\n\n  '\ndetection:\n  condition: selection\n  selection:\n  - Image|endswith: \\AnyDesk.exe\n  - Description: AnyDesk\n  - Product: AnyDesk\n  - Company: AnyDesk Software GmbH\nfalsepositives:\n- Legitimate use\nid: b52e84a3-029e-4529-b09b-71d19dd27e94\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/27\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows\nrelated:\n- id: 065b00ca-5d5c-4557-ac95-64a6d0b64d86\n  type: similar\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: AnyDesk Execution\n",
                            "sigma:id": "b52e84a3-029e-4529-b09b-71d19dd27e94",
                            "title": "AnyDesk Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                        "lookup_data": {
                            "description": "SectorJ04 Groupâ€™s Increased Activity in 2019",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5d6e7aa3-aca4-46cc-b96a-46ac950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1568039252",
                            "uuid": "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "52753ea4-b3a0-4365-910d-36cff487b789",
                        "lookup_data": {
                            "description": "Detects the usage of tsclient share to place a backdoor on the RDP source machine's startup folder",
                            "raw": "author: Samir Bousseaden\ndate: 2019/02/21\ndescription: Detects the usage of tsclient share to place a backdoor on the RDP source\n  machine's startup folder\ndetection:\n  condition: selection\n  selection:\n    Image|endswith: \\mstsc.exe\n    TargetFilename|contains: \\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\\nfalsepositives:\n- Unlikely\nid: 52753ea4-b3a0-4365-910d-36cff487b789\nlevel: high\nlogsource:\n  category: file_event\n  product: windows\nmodified: 2021/11/27\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Hijack Legit RDP Session to Move Laterally\n",
                            "sigma:id": "52753ea4-b3a0-4365-910d-36cff487b789",
                            "title": "Hijack Legit RDP Session to Move Laterally",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "03be663f-7037-4f68-a96a-362036e75637",
                        "lookup_data": {
                            "description": "Indicators of Compromise Associated with Hive  Ransomware",
                            "link": "http://www.botvrij.eu/data/feed-osint/03be663f-7037-4f68-a96a-362036e75637.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1630322118",
                            "uuid": "03be663f-7037-4f68-a96a-362036e75637",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "0b9ad457-2554-44c1-82c2-d56a99c42377",
                        "lookup_data": {
                            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
                            "raw": "author: frack113\ndate: 2022/02/11\ndescription: 'An adversary may use legitimate desktop support and remote access software,\n  such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive\n  command and control channel to target systems within networks.\n\n  These services are commonly used as legitimate technical support software, and may\n  be allowed by application control within a target environment.\n\n  Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared\n  with other legitimate software commonly used by adversaries. (Citation: Symantec\n  Living off the Land)\n\n  '\ndetection:\n  condition: selection\n  selection:\n    TargetFilename|contains:\n    - \\AppData\\Roaming\\AnyDesk\\user.conf\n    - \\AppData\\Roaming\\AnyDesk\\system.conf\n    TargetFilename|endswith: .temp\nfalsepositives:\n- Legitimate use\nid: 0b9ad457-2554-44c1-82c2-d56a99c42377\nlevel: medium\nlogsource:\n  category: file_event\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Anydesk Temporary Artefact\n",
                            "sigma:id": "0b9ad457-2554-44c1-82c2-d56a99c42377",
                            "title": "Anydesk Temporary Artefact",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "2d367498-5112-4ae5-a06a-96e7bc33a211",
                        "lookup_data": {
                            "description": "Detects anydesk writing binaries files to disk other than \"gcapi.dll\".\nAccording to RedCanary research it's highly abnormal for AnyDesk to write executable files to disk besides gcapi.dll,\nwhich is a legitimate DLL that's part of the Google Chrome web browser used to interact with the Google Cloud API. (See reference section for more details)\n",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/09/28\ndescription: 'Detects anydesk writing binaries files to disk other than \"gcapi.dll\".\n\n  According to RedCanary research it''s highly abnormal for AnyDesk to write executable\n  files to disk besides gcapi.dll,\n\n  which is a legitimate DLL that''s part of the Google Chrome web browser used to\n  interact with the Google Cloud API. (See reference section for more details)\n\n  '\ndetection:\n  condition: selection and not 1 of filter_*\n  filter_dlls:\n    TargetFilename|endswith: \\gcapi.dll\n  selection:\n    Image|endswith: \\anydesk.exe\n    TargetFilename|endswith:\n    - .dll\n    - .exe\nfalsepositives:\n- Unknown\nid: 2d367498-5112-4ae5-a06a-96e7bc33a211\nlevel: high\nlogsource:\n  category: file_event\n  product: windows\nreferences:\n- https://redcanary.com/blog/misbehaving-rats/\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Suspicious Binary Writes Via AnyDesk\n",
                            "sigma:id": "2d367498-5112-4ae5-a06a-96e7bc33a211",
                            "title": "Suspicious Binary Writes Via AnyDesk",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "34582dfc-d0bf-403d-8419-2d4fa7a76466",
                        "lookup_data": {
                            "description": "Investigating APT36 or Earth Karkaddan’s Attack Chain and Malware Arsenal",
                            "link": "http://www.botvrij.eu/data/feed-osint/34582dfc-d0bf-403d-8419-2d4fa7a76466.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1644252214",
                            "uuid": "34582dfc-d0bf-403d-8419-2d4fa7a76466",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "57bff678-25d1-4d6c-8211-8ca106d12053",
                        "lookup_data": {
                            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
                            "raw": "author: frack113\ndate: 2022/02/13\ndescription: 'An adversary may use legitimate desktop support and remote access software,\n  such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive\n  command and control channel to target systems within networks.\n\n  These services are commonly used as legitimate technical support software, and may\n  be allowed by application control within a target environment.\n\n  Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared\n  with other legitimate software commonly used by adversaries. (Citation: Symantec\n  Living off the Land)\n\n  '\ndetection:\n  condition: selection\n  selection:\n  - Description: ScreenConnect Service\n  - Product: ScreenConnect\n  - Company: ScreenConnect Software\nfalsepositives:\n- Legitimate usage of the tool\nid: 57bff678-25d1-4d6c-8211-8ca106d12053\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-5---screenconnect-application-download-and-install-on-windows\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Use of ScreenConnect Remote Access Software\n",
                            "sigma:id": "57bff678-25d1-4d6c-8211-8ca106d12053",
                            "title": "Use of ScreenConnect Remote Access Software",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "af093bc8-7b59-4e2a-9da8-8e839b4c50c6",
                        "lookup_data": {
                            "mitre-attack-id": "T1219",
                            "mitre-cti:description": "Properly configure firewalls, application firewalls, and proxies to limit outgoing traffic to sites and services used by remote access tools.\n\nNetwork intrusion detection and prevention systems that use network signatures may be able to prevent traffic to these services as well.\n\nUse application whitelisting to mitigate use of and installation of unapproved software.",
                            "mitre-cti:name": "Remote Access Tools Mitigation",
                            "mitre-cti:type": "course-of-action",
                            "raw": "{'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'course-of-action--af093bc8-7b59-4e2a-9da8-8e839b4c50c6', 'type': 'course-of-action', 'created': '2018-10-17T00:14:20.652Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/mitigations/T1219', 'external_id': 'T1219'}], 'modified': '2019-07-25T11:32:44.821Z', 'name': 'Remote Access Tools Mitigation', 'description': 'Properly configure firewalls, application firewalls, and proxies to limit outgoing traffic to sites and services used by remote access tools.\\n\\nNetwork intrusion detection and prevention systems that use network signatures may be able to prevent traffic to these services as well.\\n\\nUse application whitelisting to mitigate use of and installation of unapproved software.', 'x_mitre_deprecated': True, 'x_mitre_version': '1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "e0d1ad53-c7eb-48ec-a87a-72393cc6cedc",
                        "lookup_data": {
                            "description": "Detects a Mesh Agent service installation. Mesh Agent is used to remotely manage computers",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/11/28\ndescription: Detects a Mesh Agent service installation. Mesh Agent is used to remotely\n  manage computers\ndetection:\n  condition: all of selection_*\n  selection_root:\n    EventID: 7045\n    Provider_Name: Service Control Manager\n  selection_service:\n  - ImagePath|contains: MeshAgent.exe\n  - ServiceName|contains: Mesh Agent\nfalsepositives:\n- Legitimate use of the tool\nid: e0d1ad53-c7eb-48ec-a87a-72393cc6cedc\nlevel: medium\nlogsource:\n  product: windows\n  service: system\nreferences:\n- https://thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Mesh Agent Service Installation\n",
                            "sigma:id": "e0d1ad53-c7eb-48ec-a87a-72393cc6cedc",
                            "title": "Mesh Agent Service Installation",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "9711de76-5d4f-4c50-a94f-21e4e8f8384d",
                        "lookup_data": {
                            "description": "TeamViewer_Desktop.exe is create during install",
                            "raw": "author: frack113\ndate: 2022/01/28\ndescription: TeamViewer_Desktop.exe is create during install\ndetection:\n  condition: selection\n  selection:\n    TargetFilename|endswith: \\TeamViewer_Desktop.exe\nfalsepositives:\n- Unknown\nid: 9711de76-5d4f-4c50-a94f-21e4e8f8384d\nlevel: medium\nlogsource:\n  category: file_event\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-1---teamviewer-files-detected-test-on-windows\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Installation of TeamViewer Desktop\n",
                            "sigma:id": "9711de76-5d4f-4c50-a94f-21e4e8f8384d",
                            "title": "Installation of TeamViewer Desktop",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4d07b1f4-cb00-4470-b9f8-b0191d48ff52",
                        "lookup_data": {
                            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
                            "raw": "author: frack113, Connor Martin\ndate: 2022/07/11\ndescription: 'An adversary may use legitimate desktop support and remote access software,\n  such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive\n  command and control channel to target systems within networks.\n\n  These services are commonly used as legitimate technical support software, and may\n  be allowed by application control within a target environment.\n\n  Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared\n  with other legitimate software commonly used by adversaries. (Citation: Symantec\n  Living off the Land)\n\n  '\ndetection:\n  condition: selection and not filter\n  filter:\n    Image|endswith:\n    - \\Google\\Chrome\\Application\\chrome.exe\n    - \\brave.exe\n    - \\chromium.exe\n    - \\firefox.exe\n    - \\msedge.exe\n    - \\opera.exe\n    - \\microsoftedge.exe\n    - \\iexplorer.exe\n    - \\vivaldi.exe\n    - \\CCleaner Browser\\Application\\CCleanerBrowser.exe\n  selection:\n    QueryName|endswith:\n    - .getgo.com\n    - .logmein.com\n    - .ammyy.com\n    - .netsupportsoftware.com\n    - remoteutilities.com\n    - .net.anydesk.com\n    - api.playanext.com\n    - .relay.splashtop.com\n    - .api.splashtop.com\n    - app.atera.com\n    - .agentreporting.atera.com\n    - .pubsub.atera.com\n    - logmeincdn.http.internapcdn.net\n    - logmein-gateway.com\n    - client.teamviewer.com\n    - integratedchat.teamviewer.com\n    - static.remotepc.com\n    - .n-able.com\n    - comserver.corporate.beanywhere.com\n    - .swi-rc.com\n    - .swi-tc.com\n    - telemetry.servers.qetqo.com\n    - relay.screenconnect.com\n    - control.connectwise.com\n    - express.gotoassist.com\n    - authentication.logmeininc.com\n    - .services.vnc.com\n    - .tmate.io\n    - api.parsec.app\n    - parsecusercontent.com\n    - remotedesktop-pa.googleapis.com\n    - .logmein-gateway.com\n    - secure.logmeinrescue.com\n    - join.zoho.com\n    - assist.zoho.com\n    - .zohoassist.com\n    - downloads.zohocdn.com\n    - agent.jumpcloud.com\n    - kickstart.jumpcloud.com\n    - cdn.kaseya.net\n    - relay.kaseya.net\n    - license.bomgar.com\n    - .beyondtrustcloud.com\nfalsepositives:\n- Legitimate usage of the softwares mentioned above\nid: 4d07b1f4-cb00-4470-b9f8-b0191d48ff52\nlevel: medium\nlogsource:\n  category: dns_query\n  product: windows\nmodified: 2022/12/23\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-4---gotoassist-files-detected-test-on-windows\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-3---logmein-files-detected-test-on-windows\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-6---ammyy-admin-software-execution\n- https://redcanary.com/blog/misbehaving-rats/\nrelated:\n- id: 71ba22cb-8a01-42e2-a6dd-5bf9b547498f\n  type: obsoletes\n- id: 7c4cf8e0-1362-48b2-a512-b606d2065d7d\n  type: obsoletes\n- id: ed785237-70fa-46f3-83b6-d264d1dc6eb4\n  type: obsoletes\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: DNS Query To Remote Access Software Domain\n",
                            "sigma:id": "4d07b1f4-cb00-4470-b9f8-b0191d48ff52",
                            "title": "DNS Query To Remote Access Software Domain",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "bb09dd3e-2b78-4819-8e35-a7c1b874e449",
                        "lookup_data": {
                            "description": "Detects the presence and execution of Inveigh via dropped artefacts",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/10/24\ndescription: Detects the presence and execution of Inveigh via dropped artefacts\ndetection:\n  condition: selection\n  selection:\n    TargetFilename|endswith:\n    - \\Inveigh-Log.txt\n    - \\Inveigh-Cleartext.txt\n    - \\Inveigh-NTLMv1Users.txt\n    - \\Inveigh-NTLMv2Users.txt\n    - \\Inveigh-NTLMv1.txt\n    - \\Inveigh-NTLMv2.txt\n    - \\Inveigh-FormInput.txt\n    - \\Inveigh.dll\n    - \\Inveigh.exe\n    - \\Inveigh.ps1\n    - \\Inveigh-Relay.ps1\nfalsepositives:\n- Unlikely\nid: bb09dd3e-2b78-4819-8e35-a7c1b874e449\nlevel: critical\nlogsource:\n  category: file_event\n  product: windows\nreferences:\n- https://github.com/Kevin-Robertson/Inveigh/blob/29d9e3c3a625b3033cdaf4683efaafadcecb9007/Inveigh/Support/Output.cs\n- https://github.com/Kevin-Robertson/Inveigh/blob/29d9e3c3a625b3033cdaf4683efaafadcecb9007/Inveigh/Support/Control.cs\n- https://thedfirreport.com/2020/11/23/pysa-mespinoza-ransomware/\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Inveigh Execution Artefacts\n",
                            "sigma:id": "bb09dd3e-2b78-4819-8e35-a7c1b874e449",
                            "title": "Inveigh Execution Artefacts",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ce5678bb-b9aa-4fb5-be4b-e57f686256ad",
                        "lookup_data": {
                            "description": "Detects logons using NTLM to hosts that are potentially not part of the domain.",
                            "raw": "author: James Pemberton\ndate: 2020/05/22\ndescription: Detects logons using NTLM to hosts that are potentially not part of the\n  domain.\ndetection:\n  condition: selection\n  selection:\n    EventID: 8001\n    TargetName|startswith: TERMSRV\nfalsepositives:\n- Host connections to valid domains, exclude these.\n- Host connections not using host FQDN.\n- Host connections to external legitimate domains.\nfields:\n- Computer\n- UserName\n- DomainName\n- TargetName\nid: ce5678bb-b9aa-4fb5-be4b-e57f686256ad\nlevel: medium\nlogsource:\n  definition: Requires events from Microsoft-Windows-NTLM/Operational\n  product: windows\n  service: ntlm\nmodified: 2021/11/27\nreferences:\n- n/a\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Potential Remote Desktop Connection to Non-Domain Host\n",
                            "sigma:id": "ce5678bb-b9aa-4fb5-be4b-e57f686256ad",
                            "title": "Potential Remote Desktop Connection to Non-Domain Host",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4061e78c-1284-44b4-9116-73e4ac3912f7",
                        "lookup_data": {
                            "mitre-attack-id": "T1219",
                            "mitre-cti:description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, AnyDesk, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks. These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment. Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries.(Citation: Symantec Living off the Land)\n\nRemote access tools may be installed and used post-compromise as alternate communications channel for redundant access or as a way to establish an interactive remote desktop session with the target system. They may also be used as a component of malware to establish a reverse connection or back-connect to a service or adversary controlled system. Installation of many remote access tools may also include persistence (ex: the tool's installation routine creates a [Windows Service](https://attack.mitre.org/techniques/T1543/003)).\n\nAdmin tools such as TeamViewer have been used by several groups targeting institutions in countries of interest to the Russian state and criminal campaigns.(Citation: CrowdStrike 2015 Global Threat Report)(Citation: CrySyS Blog TeamSpy)",
                            "mitre-cti:name": "Remote Access Software",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'x_mitre_platforms': ['Linux', 'Windows', 'macOS'], 'x_mitre_domains': ['enterprise-attack'], 'x_mitre_contributors': ['Matt Kelly, @breakersall', 'Zachary Stanford, @svch0st'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'type': 'attack-pattern', 'id': 'attack-pattern--4061e78c-1284-44b4-9116-73e4ac3912f7', 'created': '2018-04-18T17:59:24.739Z', 'x_mitre_version': '2.1', 'external_references': [{'source_name': 'mitre-attack', 'external_id': 'T1219', 'url': 'https://attack.mitre.org/techniques/T1219'}, {'source_name': 'CrowdStrike 2015 Global Threat Report', 'url': 'https://go.crowdstrike.com/rs/281-OBQ-266/images/15GlobalThreatReport.pdf', 'description': 'CrowdStrike Intelligence. (2016). 2015 Global Threat Report. Retrieved April 11, 2018.'}, {'source_name': 'CrySyS Blog TeamSpy', 'url': 'https://blog.crysys.hu/2013/03/teamspy/', 'description': 'CrySyS Lab. (2013, March 20). TeamSpy – Obshie manevri. Ispolzovat’ tolko s razreshenija S-a. Retrieved April 11, 2018.'}, {'source_name': 'Symantec Living off the Land', 'url': 'https://www.symantec.com/content/dam/symantec/docs/security-center/white-papers/istr-living-off-the-land-and-fileless-attack-techniques-en.pdf', 'description': 'Wueest, C., Anand, H. (2017, July). Living off the land and fileless attack techniques. Retrieved April 10, 2018.'}], 'x_mitre_deprecated': False, 'revoked': False, 'description': \"An adversary may use legitimate desktop support and remote access software, such as Team Viewer, AnyDesk, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks. These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment. Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries.(Citation: Symantec Living off the Land)\\n\\nRemote access tools may be installed and used post-compromise as alternate communications channel for redundant access or as a way to establish an interactive remote desktop session with the target system. They may also be used as a component of malware to establish a reverse connection or back-connect to a service or adversary controlled system. Installation of many remote access tools may also include persistence (ex: the tool's installation routine creates a [Windows Service](https://attack.mitre.org/techniques/T1543/003)).\\n\\nAdmin tools such as TeamViewer have been used by several groups targeting institutions in countries of interest to the Russian state and criminal campaigns.(Citation: CrowdStrike 2015 Global Threat Report)(Citation: CrySyS Blog TeamSpy)\", 'modified': '2022-04-21T14:54:10.899Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'name': 'Remote Access Software', 'x_mitre_detection': 'Monitor for applications and processes related to remote admin tools. Correlate activity with other suspicious behavior that may reduce false positives if these tools are used by legitimate users and administrators.\\n\\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol for the port that is being used.\\n\\n[Domain Fronting](https://attack.mitre.org/techniques/T1090/004) may be used in conjunction to avoid defenses. Adversaries will likely need to deploy and/or install these remote tools to compromised systems. It may be possible to detect or prevent the installation of these tools with host-based solutions.', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'command-and-control'}], 'x_mitre_is_subtechnique': False, 'x_mitre_data_sources': ['Network Traffic: Network Traffic Flow', 'Network Traffic: Network Connection Creation', 'Process: Process Creation', 'Network Traffic: Network Traffic Content'], 'x_mitre_attack_spec_version': '2.1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "9847f263-4a81-424f-970c-875dab15b79b",
                        "lookup_data": {
                            "description": "Detects a tscon.exe start as LOCAL SYSTEM",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2018/03/17\ndescription: Detects a tscon.exe start as LOCAL SYSTEM\ndetection:\n  condition: selection\n  selection:\n    Image|endswith: \\tscon.exe\n    User|contains:\n    - AUTHORI\n    - AUTORI\nfalsepositives:\n- Unknown\nid: 9847f263-4a81-424f-970c-875dab15b79b\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/05/27\nreferences:\n- http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html\n- https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6\n- https://www.ired.team/offensive-security/lateral-movement/t1076-rdp-hijacking-for-lateral-movement\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Suspicious TSCON Start as SYSTEM\n",
                            "sigma:id": "9847f263-4a81-424f-970c-875dab15b79b",
                            "title": "Suspicious TSCON Start as SYSTEM",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d85873ef-a0f8-4c48-a53a-6b621f11729d",
                        "lookup_data": {
                            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
                            "raw": "author: frack113\ndate: 2022/02/11\ndescription: 'An adversary may use legitimate desktop support and remote access software,\n  such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive\n  command and control channel to target systems within networks.\n\n  These services are commonly used as legitimate technical support software, and may\n  be allowed by application control within a target environment.\n\n  Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared\n  with other legitimate software commonly used by adversaries. (Citation: Symantec\n  Living off the Land)\n\n  '\ndetection:\n  condition: selection\n  selection:\n  - Description: LMIGuardianSvc\n  - Product: LMIGuardianSvc\n  - Company: LogMeIn, Inc.\nfalsepositives:\n- Legitimate use\nid: d85873ef-a0f8-4c48-a53a-6b621f11729d\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-3---logmein-files-detected-test-on-windows\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Use of LogMeIn Remote Access Software\n",
                            "sigma:id": "d85873ef-a0f8-4c48-a53a-6b621f11729d",
                            "title": "Use of LogMeIn Remote Access Software",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d756aee-ad3e-4306-ad95-cb1abec48de2",
                        "lookup_data": {
                            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
                            "raw": "author: frack113\ndate: 2022/02/13\ndescription: 'An adversary may use legitimate desktop support and remote access software,\n  such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive\n  command and control channel to target systems within networks.\n\n  These services are commonly used as legitimate technical support software, and may\n  be allowed by application control within a target environment.\n\n  Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared\n  with other legitimate software commonly used by adversaries. (Citation: Symantec\n  Living off the Land)\n\n  '\ndetection:\n  condition: selection\n  selection:\n    TargetFilename|contains: \\AppData\\Local\\Temp\\LogMeInInc\\GoToAssist Remote Support\n      Expert\\\nfalsepositives:\n- Legitimate use\nid: 5d756aee-ad3e-4306-ad95-cb1abec48de2\nlevel: medium\nlogsource:\n  category: file_event\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-4---gotoassist-files-detected-test-on-windows\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: GoToAssist Temporary Installation Artefact\n",
                            "sigma:id": "5d756aee-ad3e-4306-ad95-cb1abec48de2",
                            "title": "GoToAssist Temporary Installation Artefact",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "e1e0b7d7-e10b-4ee4-ac49-a4bda05d320d",
                        "lookup_data": {
                            "description": "Detects usage of the Gpg4win to decrypt files located in suspicious locations from CLI",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems), X__Junior\ndate: 2022/11/30\ndescription: Detects usage of the Gpg4win to decrypt files located in suspicious locations\n  from CLI\ndetection:\n  condition: all of selection_*\n  selection_cli:\n    CommandLine|contains: -passphrase\n  selection_metadata:\n  - Image|endswith: \\gpg2.exe\n  - Product: GNU Privacy Guard (GnuPG)\n  - Company: g10 Code GmbH\n  selection_paths:\n    CommandLine|contains:\n    - \\AppData\\Roaming\\\n    - C:\\Perflogs\\\n    - C:\\Windows\\Temp\\\n    - C:\\temp\nfalsepositives:\n- Legitimate use\nid: e1e0b7d7-e10b-4ee4-ac49-a4bda05d320d\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Gpg4Win Decrypt Files From Suspicious Locations\n",
                            "sigma:id": "e1e0b7d7-e10b-4ee4-ac49-a4bda05d320d",
                            "title": "Gpg4Win Decrypt Files From Suspicious Locations",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b6d98a4f-cef0-4abf-bbf6-24132854a83d",
                        "lookup_data": {
                            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
                            "raw": "author: frack113\ndate: 2022/02/13\ndescription: 'An adversary may use legitimate desktop support and remote access software,\n  such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive\n  command and control channel to target systems within networks.\n\n  These services are commonly used as legitimate technical support software, and may\n  be allowed by application control within a target environment.\n\n  Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared\n  with other legitimate software commonly used by adversaries. (Citation: Symantec\n  Living off the Land)\n\n  '\ndetection:\n  condition: selection\n  selection:\n  - Description: GoTo Opener\n  - Product: GoTo Opener\n  - Company: LogMeIn, Inc.\nfalsepositives:\n- Legitimate use\nid: b6d98a4f-cef0-4abf-bbf6-24132854a83d\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-4---gotoassist-files-detected-test-on-windows\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Use of GoToAssist Remote Access Software\n",
                            "sigma:id": "b6d98a4f-cef0-4abf-bbf6-24132854a83d",
                            "title": "Use of GoToAssist Remote Access Software",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "114e7f1c-f137-48c8-8f54-3088c24ce4b9",
                        "lookup_data": {
                            "description": "Detects AnyDesk Remote Desktop silent installation. Which can be used by attackers to gain remote access.",
                            "raw": "author: \"J\\xE1n Tren\\u010Dansk\\xFD\"\ndate: 2021/08/06\ndescription: Detects AnyDesk Remote Desktop silent installation. Which can be used\n  by attackers to gain remote access.\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - --install\n    - --start-with-win\n    - --silent\nfalsepositives:\n- Legitimate deployment of AnyDesk\nfields:\n- CommandLine\n- ParentCommandLine\n- CurrentDirectory\nid: 114e7f1c-f137-48c8-8f54-3088c24ce4b9\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://twitter.com/TheDFIRReport/status/1423361119926816776?s=20\n- https://support.anydesk.com/Automatic_Deployment\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: AnyDesk Silent Installation\n",
                            "sigma:id": "114e7f1c-f137-48c8-8f54-3088c24ce4b9",
                            "title": "AnyDesk Silent Installation",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "fec96f39-988b-4586-b746-b93d59fd1922",
                        "lookup_data": {
                            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
                            "raw": "author: frack113\ndate: 2022/02/13\ndescription: 'An adversary may use legitimate desktop support and remote access software,\n  such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive\n  command and control channel to target systems within networks.\n\n  These services are commonly used as legitimate technical support software, and may\n  be allowed by application control within a target environment.\n\n  Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared\n  with other legitimate software commonly used by adversaries. (Citation: Symantec\n  Living off the Land)\n\n  '\ndetection:\n  condition: selection\n  selection:\n    TargetFilename|contains: \\Bin\\ScreenConnect.\nfalsepositives:\n- Legitimate use\nid: fec96f39-988b-4586-b746-b93d59fd1922\nlevel: medium\nlogsource:\n  category: file_event\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-5---screenconnect-application-download-and-install-on-windows\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: ScreenConnect Temporary Installation Artefact\n",
                            "sigma:id": "fec96f39-988b-4586-b746-b93d59fd1922",
                            "title": "ScreenConnect Temporary Installation Artefact",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "7b582f1a-b318-4c6a-bf4e-66fe49bf55a5",
                        "lookup_data": {
                            "description": "Detects suspicious sub processes started by the ScreenConnect client service, which indicates the use of the so-called Backstage mode",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/02/25\ndescription: Detects suspicious sub processes started by the ScreenConnect client\n  service, which indicates the use of the so-called Backstage mode\ndetection:\n  condition: selection\n  selection:\n    Image|endswith:\n    - \\cmd.exe\n    - \\powershell.exe\n    - \\pwsh.exe\n    ParentImage|endswith: ScreenConnect.ClientService.exe\nfalsepositives:\n- Case in which administrators are allowed to use ScreenConnect's Backstage mode\nid: 7b582f1a-b318-4c6a-bf4e-66fe49bf55a5\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/07/27\nreferences:\n- https://www.mandiant.com/resources/telegram-malware-iranian-espionage\n- https://docs.connectwise.com/ConnectWise_Control_Documentation/Get_started/Host_client/View_menu/Backstage_mode\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: ScreenConnect Backstage Mode Anomaly\n",
                            "sigma:id": "7b582f1a-b318-4c6a-bf4e-66fe49bf55a5",
                            "title": "ScreenConnect Backstage Mode Anomaly",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "162ab1e4-6874-4564-853c-53ec3ab8be01",
                        "lookup_data": {
                            "description": "Detects the creation of log files during a TeamViewer remote session",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/01/30\ndescription: Detects the creation of log files during a TeamViewer remote session\ndetection:\n  condition: 1 of selection*\n  selection1:\n    TargetFilename|endswith:\n    - \\TeamViewer\\RemotePrinting\\tvprint.db\n    - \\TeamViewer\\TVNetwork.log\n  selection2:\n    TargetFilename|contains|all:\n    - \\TeamViewer\n    - _Logfile.log\nfalsepositives:\n- Legitimate uses of TeamViewer in an organisation\nid: 162ab1e4-6874-4564-853c-53ec3ab8be01\nlevel: medium\nlogsource:\n  category: file_event\n  product: windows\nreferences:\n- https://www.teamviewer.com/en-us/\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: TeamViewer Remote Session\n",
                            "sigma:id": "162ab1e4-6874-4564-853c-53ec3ab8be01",
                            "title": "TeamViewer Remote Session",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "238527ad-3c2c-4e4f-a1f6-92fd63adb864",
                        "lookup_data": {
                            "description": "Detects a highly relevant Antivirus alert that reports an exploitation framework",
                            "raw": "author: Florian Roth (Nextron Systems), Arnim Rupp\ndate: 2018/09/09\ndescription: Detects a highly relevant Antivirus alert that reports an exploitation\n  framework\ndetection:\n  condition: selection\n  selection:\n    Signature|contains:\n    - MeteTool\n    - MPreter\n    - Meterpreter\n    - Metasploit\n    - PowerSploit\n    - CobaltStrike\n    - BruteR\n    - Brutel\n    - Swrort\n    - Rozena\n    - Backdoor.Cobalt\n    - CobaltStr\n    - COBEACON\n    - Cometer\n    - Razy\n    - IISExchgSpawnCMD\n    - Exploit.Script.CVE\n    - Seatbelt\n    - Sbelt\n    - Sliver\nfalsepositives:\n- Unlikely\nfields:\n- FileName\n- User\nid: 238527ad-3c2c-4e4f-a1f6-92fd63adb864\nlevel: critical\nlogsource:\n  category: antivirus\nmodified: 2023/01/13\nreferences:\n- https://www.nextron-systems.com/?s=antivirus\n- https://www.virustotal.com/gui/file/925b0b28472d4d79b4bf92050e38cc2b8f722691c713fc28743ac38551bc3797\n- https://www.virustotal.com/gui/file/8f8daabe1c8ceb5710949283818e16c4aa8059bf2ce345e2f2c90b8692978424\n- https://www.virustotal.com/gui/file/d9669f7e3eb3a9cdf6a750eeb2ba303b5ae148a43e36546896f1d1801e912466\nstatus: stable\ntags:\n- attack.execution\n- attack.t1203\n- attack.command_and_control\n- attack.t1219\ntitle: Antivirus Exploitation Framework Detection\n",
                            "sigma:id": "238527ad-3c2c-4e4f-a1f6-92fd63adb864",
                            "title": "Antivirus Exploitation Framework Detection",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4a14a80e-6067-43de-b5e3-c88a913dd13d",
                        "lookup_data": {
                            "description": "A wolf in sheep's clothing: Actors spread malware by leveraging trust in Amnesty International and fear of Pegasus",
                            "link": "http://www.botvrij.eu/data/feed-osint/4a14a80e-6067-43de-b5e3-c88a913dd13d.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1633165353",
                            "uuid": "4a14a80e-6067-43de-b5e3-c88a913dd13d",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "88656cec-6c3b-487c-82c0-f73ebb805503",
                        "lookup_data": {
                            "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
                            "raw": "author: frack113\ndate: 2022/09/25\ndescription: 'An adversary may use legitimate desktop support and remote access software,\n  such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive\n  command and control channel to target systems within networks.\n\n  These services are commonly used as legitimate technical support software, and may\n  be allowed by application control within a target environment.\n\n  Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared\n  with other legitimate software commonly used by adversaries. (Citation: Symantec\n  Living off the Land)\n\n  '\ndetection:\n  condition: selection\n  selection:\n  - Product: UltraViewer\n  - Company: DucFabulous Co,ltd\n  - OriginalFileName: UltraViewer_Desktop.exe\nfalsepositives:\n- Legitimate use\nid: 88656cec-6c3b-487c-82c0-f73ebb805503\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Use of UltraViewer Remote Access Software\n",
                            "sigma:id": "88656cec-6c3b-487c-82c0-f73ebb805503",
                            "title": "Use of UltraViewer Remote Access Software",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5dee2bc3-47ac-4784-a52a-4da2950d210f",
                        "lookup_data": {
                            "description": "OSINT - BfV Cyber-Brief Nr. 01/2019 - Hinweis auf aktuelle Angriffskampagne -",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5dee2bc3-47ac-4784-a52a-4da2950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1576068623",
                            "uuid": "5dee2bc3-47ac-4784-a52a-4da2950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "87261fb2-69d0-42fe-b9de-88c6b5f65a43",
                        "lookup_data": {
                            "description": "Detects successful installation of Atera Remote Monitoring & Management (RMM) agent as recently found to be used by Conti operators",
                            "raw": "author: Bhabesh Raj\ndate: 2021/09/01\ndescription: Detects successful installation of Atera Remote Monitoring & Management\n  (RMM) agent as recently found to be used by Conti operators\ndetection:\n  condition: selection\n  selection:\n    EventID: 1033\n    Message|contains: AteraAgent\n    Provider_Name: MsiInstaller\nfalsepositives:\n- Legitimate Atera agent installation\nid: 87261fb2-69d0-42fe-b9de-88c6b5f65a43\nlevel: high\nlogsource:\n  product: windows\n  service: application\nmodified: 2022/12/25\nreferences:\n- https://www.advintel.io/post/secret-backdoor-behind-conti-ransomware-operation-introducing-atera-agent\nstatus: test\ntags:\n- attack.t1219\ntitle: Atera Agent Installation\n",
                            "sigma:id": "87261fb2-69d0-42fe-b9de-88c6b5f65a43",
                            "title": "Atera Agent Installation",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4bcf0465-4b53-4de4-8c53-fcc5f7d04dfc",
                        "lookup_data": {
                            "description": "Unwrapping Ursnifs Gifts - The DFIR Report",
                            "link": "http://www.botvrij.eu/data/feed-osint/4bcf0465-4b53-4de4-8c53-fcc5f7d04dfc.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1674763285",
                            "uuid": "4bcf0465-4b53-4de4-8c53-fcc5f7d04dfc",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4bb79b62-ef12-4861-981d-2aab43fab642",
                        "lookup_data": {
                            "description": "Detects a TacticalRMM service installation. Tactical RMM is a remote monitoring & management tool.",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/11/28\ndescription: Detects a TacticalRMM service installation. Tactical RMM is a remote\n  monitoring & management tool.\ndetection:\n  condition: all of selection_*\n  selection_root:\n    EventID: 7045\n    Provider_Name: Service Control Manager\n  selection_service:\n  - ImagePath|contains: tacticalrmm.exe\n  - ServiceName|contains: TacticalRMM Agent Service\nfalsepositives:\n- Legitimate use of the tool\nid: 4bb79b62-ef12-4861-981d-2aab43fab642\nlevel: medium\nlogsource:\n  product: windows\n  service: system\nreferences:\n- https://thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: TacticalRMM Service Installation\n",
                            "sigma:id": "4bb79b62-ef12-4861-981d-2aab43fab642",
                            "title": "TacticalRMM Service Installation",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "145322e4-0fd3-486b-81ca-9addc75736d8",
                        "lookup_data": {
                            "description": "An adversary may use legitimate desktop support and remote access software,to establish an interactive command and control channel to target systems within networks",
                            "raw": "author: frack113\ndate: 2022/10/02\ndescription: An adversary may use legitimate desktop support and remote access software,to\n  establish an interactive command and control channel to target systems within networks\ndetection:\n  condition: selection\n  selection:\n  - Description: VNCViewer\n  - Product: UltraVNC VNCViewer\n  - Company: UltraVNC\n  - OriginalFileName: VNCViewer.exe\nfalsepositives:\n- Legitimate use\nid: 145322e4-0fd3-486b-81ca-9addc75736d8\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1219/T1219.md\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1219\ntitle: Use of UltraVNC Remote Access Software\n",
                            "sigma:id": "145322e4-0fd3-486b-81ca-9addc75736d8",
                            "title": "Use of UltraVNC Remote Access Software",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": [
            {
                "attack_technique": "T1219",
                "display_name": "Remote Access Software",
                "atomic_tests": [
                    {
                        "name": "TeamViewer Files Detected Test on Windows",
                        "auto_generated_guid": "8ca3b96d-8983-4a7f-b125-fc98cc0a2aa0",
                        "description": "An adversary may attempt to trick the user into downloading teamviewer and using this to maintain access to the machine. Download of TeamViewer installer will be at the destination location when sucessfully executed.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "Invoke-WebRequest -OutFile C:\\Users\\$env:username\\Desktop\\TeamViewer_Setup.exe https://download.teamviewer.com/download/TeamViewer_Setup.exe\n$file1 = \"C:\\Users\\\" + $env:username + \"\\Desktop\\TeamViewer_Setup.exe\"\nStart-Process -Wait $file1 /S; \nStart-Process 'C:\\Program Files (x86)\\TeamViewer\\TeamViewer.exe'\n",
                            "cleanup_command": "$file = 'C:\\Program Files (x86)\\TeamViewer\\uninstall.exe'\nif(Test-Path $file){ Start-Process $file \"/S\" -ErrorAction Ignore | Out-Null }\n$file1 = \"C:\\Users\\\" + $env:username + \"\\Desktop\\TeamViewer_Setup.exe\"\nRemove-Item $file1 -ErrorAction Ignore | Out-Null",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "AnyDesk Files Detected Test on Windows",
                        "auto_generated_guid": "6b8b7391-5c0a-4f8c-baee-78d8ce0ce330",
                        "description": "An adversary may attempt to trick the user into downloading AnyDesk and use to establish C2. Download of AnyDesk installer will be at the destination location and ran when sucessfully executed.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "Invoke-WebRequest -OutFile C:\\Users\\$env:username\\Desktop\\AnyDesk.exe https://download.anydesk.com/AnyDesk.exe\n$file1 = \"C:\\Users\\\" + $env:username + \"\\Desktop\\AnyDesk.exe\"\nStart-Process $file1 /S;\n",
                            "cleanup_command": "$file1 = \"C:\\Users\\\" + $env:username + \"\\Desktop\\AnyDesk.exe\"\nRemove-Item $file1 -ErrorAction Ignore",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "LogMeIn Files Detected Test on Windows",
                        "auto_generated_guid": "d03683ec-aae0-42f9-9b4c-534780e0f8e1",
                        "description": "An adversary may attempt to trick the user into downloading LogMeIn and use to establish C2. Download of LogMeIn installer will be at the destination location and ran when sucessfully executed.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "Invoke-WebRequest -OutFile C:\\Users\\$env:username\\Desktop\\LogMeInIgnition.msi https://secure.logmein.com/LogMeInIgnition.msi\n$file1 = \"C:\\Users\\\" + $env:username + \"\\Desktop\\LogMeInIgnition.msi\"\nStart-Process -Wait $file1 /quiet;\nStart-Process 'C:\\Program Files (x86)\\LogMeIn Ignition\\LMIIgnition.exe' \"/S\"\n",
                            "cleanup_command": "get-package *'LogMeIn Client'* -ErrorAction Ignore | uninstall-package \n$file1 = \"C:\\Users\\\" + $env:username + \"\\Desktop\\LogMeInIgnition.msi\"\nRemove-Item $file1 -ErrorAction Ignore",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "GoToAssist Files Detected Test on Windows",
                        "auto_generated_guid": "1b72b3bd-72f8-4b63-a30b-84e91b9c3578",
                        "description": "An adversary may attempt to trick the user into downloading GoToAssist and use to establish C2. Download of GoToAssist installer will be at the destination location and ran when sucessfully executed.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "Invoke-WebRequest -OutFile C:\\Users\\$env:username\\Downloads\\GoToAssist.exe \"https://launch.getgo.com/launcher2/helper?token=e0-FaCddxmtMoX8_cY4czssnTeGvy83ihp8CLREfvwQshiBW0_RcbdoaEp8IA-Qn8wpbKlpGIflS-39gW6RuWRM-XHwtkRVMLBsp5RSKp-a3PBM-Pb1Fliy73EDgoaxr-q83WtXbLKqD7-u3cfDl9gKsymmhdkTGsXcDXir90NqKj92LsN_KpyYwV06lIxsdRekhNZjNwhkWrBa_hG8RQJqWSGk6tkZLVMuMufmn37eC2Cqqiwq5bCGnH5dYiSUUsklSedRLjh4N46qPYT1bAU0qD25ZPr-Kvf4Kzu9bT02q3Yntj02ZA99TxL2-SKzgryizoopBPg4Ilfo5t78UxKTYeEwo4etQECfkCRvenkTRlIHmowdbd88zz7NiccXnbHJZehgs6_-JSVjQIdPTXZbF9T5z44mi4BQYMtZAS3DE86F0C3D4Tcd7fa5F6Ve8rQWt7pvqFCYyiJAailslxOw0LsGyFokoy65tMF980ReP8zhVcTKYP8s8mhGXihUQJQPNk20Sw&downloadTrigger=restart&renameFile=1\"\n$file1 = \"C:\\Users\\\" + $env:username + \"\\Downloads\\GoToAssist.exe\"\nStart-Process $file1 /S;\n",
                            "cleanup_command": "try{\"$PathToAtomicsFolder/T1219/bin/GoToCleanup.ps1\"} catch{}",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "ScreenConnect Application Download and Install on Windows",
                        "auto_generated_guid": "4a18cc4e-416f-4966-9a9d-75731c4684c0",
                        "description": "An adversary may attempt to trick the user into downloading ScreenConnect for use as a C2 channel. Download of ScreenConnect installer will be in the Downloads directory.\nMsiexec will be used to quietly insall ScreenConnect.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "$installer = \"C:\\Users\\$env:username\\Downloads\\ScreenConnect.msi\"\nInvoke-WebRequest -OutFile $installer \"https://d1kuyuqowve5id.cloudfront.net/ScreenConnect_21.11.4237.7885_Release.msi\"\nmsiexec /i $installer /qn\n",
                            "cleanup_command": "$installer = \"C:\\Users\\$env:username\\Downloads\\ScreenConnect.msi\"\nmsiexec /x $installer /qn\n",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Ammyy Admin Software Execution",
                        "auto_generated_guid": "0ae9e327-3251-465a-a53b-485d4e3f58fa",
                        "description": "An adversary may attempt to trick the user into downloading Ammyy Admin Remote Desktop Software for use as a C2 channel. \nUpon successful execution, Ammyy Admin will be executed. \n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "Ammyy_Admin_Path": {
                                "description": "Path of Ammyy Admin executable",
                                "type": "path",
                                "default": "PathToAtomicsFolder\\..\\ExternalPayloads\\ammyy.exe"
                            }
                        },
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "Ammyy Admin must exist on disk at the specified location (#{Ammyy_Admin_Path})\n",
                                "prereq_command": "if (Test-Path \"#{Ammyy_Admin_Path}\") {exit 0} else {exit 1}\n",
                                "get_prereq_command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://web.archive.org/web/20140625232737/http://www.ammyy.com/AA_v3.exe\" -OutFile \"PathToAtomicsFolder\\..\\ExternalPayloads\\ammyy.exe\" -UseBasicParsing\n"
                            }
                        ],
                        "executor": {
                            "command": "Start-Process \"#{Ammyy_Admin_Path}\"\n",
                            "cleanup_command": "Stop-Process -Name \"Ammyy\" -force -erroraction silentlycontinue\n",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "RemotePC Software Execution",
                        "auto_generated_guid": "fbff3f1f-b0bf-448e-840f-7e1687affdce",
                        "description": "An adversary may attempt to trick the user into downloading RemotePC Software for use as a C2 channel. \nUpon successful execution, RemotePC will be executed. \n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "RemotePC_Path": {
                                "description": "Path of RemotePC executable",
                                "type": "path",
                                "default": "PathToAtomicsFolder\\..\\ExternalPayloads\\RemotePC.exe"
                            }
                        },
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "RemotePC must exist on disk at the specified location (#{RemotePC_Path})\n",
                                "prereq_command": "if (Test-Path \"#{RemotePC_Path}\") {exit 0} else {exit 1}\n",
                                "get_prereq_command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://static.remotepc.com/downloads/rpc/140422/RemotePC.exe\" -OutFile \"#{RemotePC_Path}\" -UseBasicParsing\n"
                            }
                        ],
                        "executor": {
                            "command": "Start-Process \"#{RemotePC_Path}\"\n",
                            "cleanup_command": "Unregister-ScheduledTask -TaskName \"RemotePC\" -Confirm:$False -ErrorAction SilentlyContinue\nUnregister-ScheduledTask -TaskName \"RPCServiceHealthCheck\" -Confirm:$False -ErrorAction SilentlyContinue\nUnregister-ScheduledTask -TaskName \"ServiceMonitor\" -Confirm:$False -ErrorAction SilentlyContinue\nUnregister-ScheduledTask -TaskName \"StartRPCService\" -Confirm:$False -ErrorAction SilentlyContinue      \nStop-Process -Name \"RemotePCPerformance\" -force -erroraction silentlycontinue\nStop-Process -Name \"RPCPerformanceService\" -force -erroraction silentlycontinue\nStop-Process -Name \"RemotePCUIU\" -force -erroraction silentlycontinue\nStop-Process -Name \"RPCDownloader\" -force -erroraction silentlycontinue\nStop-Process -Name \"RemotePCService\" -force -erroraction silentlycontinue\nStop-Process -Name \"RPCService\" -force -erroraction silentlycontinue\n",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "NetSupport - RAT Execution",
                        "auto_generated_guid": "ecca999b-e0c8-40e8-8416-ad320b146a75",
                        "description": "A recent trend by threat actors, once a foothold is established, maintain long term persistence using third party remote services such as NetSupport to provide the operator with access to the network using legitimate services. \n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "NetSupport_Path": {
                                "description": "Path to the NetSupport executable.",
                                "type": "path",
                                "default": "PathToAtomicsFolder\\..\\ExternalPayloads\\T1219_NetSupport.exe"
                            }
                        },
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "NetSupport must be downloaded and exist on the disk at the specified location. (#{NetSupport_Path})\n",
                                "prereq_command": "if (Test-Path \"#{NetSupport_Path}\") {exit 0} else {exit 1}\n",
                                "get_prereq_command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\n(New-Object Net.WebClient).DownloadFile(\"https://nsproducts.azureedge.net/nsm-1270/en/Setup.exe\",\"#{NetSupport_Path}\")\n"
                            }
                        ],
                        "executor": {
                            "command": "Start-Process \"#{NetSupport_Path}\" -ArgumentList \"/S /v/qn\"\n",
                            "cleanup_command": "Stop-Process -Name \"client32\" -force -erroraction silentlycontinue\n",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "UltraViewer - RAT Execution",
                        "auto_generated_guid": "19acf63b-55c4-4b6a-8552-00a8865105c8",
                        "description": "A recent trend by threat actors, once a foothold is established, maintain long term persistence using third party remote services such as UltraViewer to provide the operator with access to the network using legitimate services. \n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "UltraViewer_Path": {
                                "description": "Path to the UltraViewer executable.",
                                "type": "path",
                                "default": "PathToAtomicsFolder\\..\\ExternalPayloads\\T1219_UltraViewer.exe"
                            }
                        },
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "Ultraviewer installer must be downloaded and exist on the disk at the specified location. (#{UltraViewer_Path})\n",
                                "prereq_command": "if (Test-Path \"#{UltraViewer_Path}\") {exit 0} else {exit 1}\n",
                                "get_prereq_command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\n(New-Object Net.WebClient).DownloadFile(\"https://www.ultraviewer.net/en/UltraViewer_setup_6.5_en.exe\",\"#{UltraViewer_Path}\")\n"
                            }
                        ],
                        "executor": {
                            "command": "Start-Process -Wait -FilePath \"#{UltraViewer_Path}\" -Argument \"/silent\" -PassThru\nStart-Process 'C:\\Program Files (x86)\\UltraViewer\\UltraViewer_Desktop.exe'\n",
                            "cleanup_command": "Stop-Process -Name \"UltraViewer_Desktop\" -Force -ErrorAction SilentlyContinue\n",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "UltraVNC Execution",
                        "auto_generated_guid": "42e51815-a6cc-4c75-b970-3f0ff54b610e",
                        "description": "An adversary may attempt to trick the user into downloading UltraVNC for use as a C2 channel.\nUpon successful execution, UltraVNC will be executed.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "UltraVNC_Viewer_Path": {
                                "description": "Path of UltraVNC Viewer executable",
                                "type": "path",
                                "default": "$env:ProgramFiles\\'uvnc bvba\\UltraVnc\\vncviewer.exe'"
                            }
                        },
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "UltraVNC must exist at (#{UltraVNC_Viewer_Path})\n",
                                "prereq_command": "if (Test-Path #{UltraVNC_Viewer_Path}) {exit 0} else {exit 1}\n",
                                "get_prereq_command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://www.uvnc.eu/download/1381/UltraVNC_1_3_81_X64_Setup.exe\" -OutFile \"PathToAtomicsFolder\\..\\ExternalPayloads\\vncsetup.exe\"\nstart-process \"PathToAtomicsFolder\\..\\ExternalPayloads\\vncsetup.exe\" /silent\n"
                            }
                        ],
                        "executor": {
                            "command": "Start-Process #{UltraVNC_Viewer_Path}\n",
                            "cleanup_command": "Stop-Process -Name \"vncviewer\" -force -erroraction silentlycontinue\n",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "MSP360 Connect Execution",
                        "auto_generated_guid": "b1b8128b-c5d4-4de9-bf70-e60419274562",
                        "description": "An adversary may attempt to trick the user into downloading MSP360 Connect for use as a C2 channel.\nUpon successful execution, MSP360 Connect will be executed.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "MSP360_Connect_Path": {
                                "description": "Path of MSP360 executable",
                                "type": "path",
                                "default": "$env:ProgramFiles\\Connect\\Connect.exe"
                            },
                            "MSP360_Download_Url": {
                                "description": "URL to download MSP360 Connect from",
                                "type": "url",
                                "default": null
                            }
                        },
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "MSP360 must exist at (#{MSP360_Connect_Path})\n",
                                "prereq_command": "if (Test-Path #{MSP360_Connect_Path}) {exit 0} else {exit 1}\n",
                                "get_prereq_command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest -OutFile \"PathToAtomicsFolder\\..\\ExternalPayloads\\msp360connect.exe\" \"#{MSP360_Download_Url}\"\nstart-process \"PathToAtomicsFolder\\..\\ExternalPayloads\\msp360connect.exe\" /S    \n"
                            }
                        ],
                        "executor": {
                            "command": "Start-Process #{MSP360_Connect_Path}\n",
                            "cleanup_command": "Stop-Process -Name \"Connect\" -force -erroraction silentlycontinue\n",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "RustDesk Files Detected Test on Windows",
                        "auto_generated_guid": "f1641ba9-919a-4323-b74f-33372333bf0e",
                        "description": "An adversary may attempt to trick the user into downloading RustDesk and use this to maintain access to the machine. \nDownload of RustDesk installer will be at the destination location when successfully executed.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "$file = Join-Path $env:USERPROFILE \"Desktop\\rustdesk-1.2.3-1-x86_64.exe\"\nInvoke-WebRequest  -OutFile $file https://github.com/rustdesk/rustdesk/releases/download/1.2.3-1/rustdesk-1.2.3-1-x86_64.exe\nStart-Process -FilePath $file \"/S\"",
                            "cleanup_command": "$file = Join-Path $env:USERPROFILE \"Desktop\\rustdesk-1.2.3-1-x86_64.exe\"\nRemove-Item $file1 -ErrorAction Ignore",
                            "name": "powershell"
                        }
                    },
                    {
                        "name": "Splashtop Execution",
                        "auto_generated_guid": "b025c580-029e-4023-888d-a42710d76934",
                        "description": "An adversary may attempt to trick the user into downloading Splashtop for use as a C2 channel.\nUpon successful execution, Splashtop will be executed.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "Splashtop_Path": {
                                "description": "Path of Splashtop executable",
                                "type": "path",
                                "default": "${env:programfiles(x86)}\\Splashtop\\Splashtop Remote\\Client for STP\\strwinclt.exe"
                            }
                        },
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "Splashtop must exist at \"#{Splashtop_Path}\"\n",
                                "prereq_command": "if (Test-Path \"#{Splashtop_Path}\") {exit 0} else {exit 1}\n",
                                "get_prereq_command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest -OutFile \"PathToAtomicsFolder\\..\\ExternalPayloads\\splashtop_install.exe\" \"https://download.splashtop.com/winclient/STP/Splashtop_Personal_Win_v3.6.6.0.exe\"\nstart-sleep 30\nstart-process \"PathToAtomicsFolder\\..\\ExternalPayloads\\splashtop_install.exe\" /S  \nstart-sleep 30      \n"
                            }
                        ],
                        "executor": {
                            "command": "Start-Process \"#{Splashtop_Path}\"\n",
                            "cleanup_command": "Stop-Process -Name \"strwinclt\" -force -erroraction silentlycontinue\n",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Splashtop Streamer Execution",
                        "auto_generated_guid": "3e1858ee-3550-401c-86ec-5e70ed79295b",
                        "description": "An adversary may attempt to use Splashtop Streamer to gain unattended remote interactive access. Upon successful execution, Splashtop streamer will be executed.",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "srserver_exe": {
                                "description": "Splashtop streamer installation executables",
                                "type": "string",
                                "default": "SRServer.exe"
                            }
                        },
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "Splashtop Streamer must be installed in the location",
                                "prereq_command": "if (Test-Path \"C:\\Program Files (x86)\\Splashtop\\Splashtop Remote\\Server\\#{srserver_exe}\") {exit 0} else {exit 1}\n",
                                "get_prereq_command": "Write-Host Downloading Splashtop Streamer\nNew-Item -Type Directory \"C:\\Temp\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://download.splashtop.com/win/Splashtop_Streamer_Win_INSTALLER_v3.6.4.1.exe\" -OutFile  \"C:\\Temp\\ExternalPayloads\\Splashtop.exe\"\nWrite-Host Installing Splashtop Streamer\nStart-Process \"c:\\Temp\\ExternalPayloads\\Splashtop.exe\" -Wait -ArgumentList \"/s\""
                            }
                        ],
                        "executor": {
                            "command": "Start-Process -FilePath \"C:Program Files (x86)\\Splashtop\\Splashtop Remote\\Server\\#{srserver_exe}\"",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    }
                ]
            }
        ]
    },
    "timestamp": "2025-02-28 14:23:30"
}