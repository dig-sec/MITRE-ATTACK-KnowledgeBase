{
    "id": "T1489",
    "name": "Service Stop",
    "description": "Adversaries may stop or disable services on a system to render those services unavailable to legitimate users. Stopping critical services or processes can inhibit or stop response to an incident or aid in the adversary's overall objectives to cause damage to the environment.(Citation: Talos Olympic Destroyer 2018)(Citation: Novetta Blockbuster)\nAdversaries may accomplish this by disabling individual services of high importance to an organization, such as `MSExchangeIS`, which will make Exchange content inaccessible (Citation: Novetta Blockbuster). In some cases, adversaries may stop or disable many or all services to render systems unusable.(Citation: Talos Olympic Destroyer 2018) Services or processes may not allow for modification of their data stores while running. Adversaries may stop services or processes in order to conduct [Data Destruction](T1485) or [Data Encrypted for Impact](T1486) on the data stores of services like Exchange and SQL Server.(Citation: SecureWorks WannaCry Analysis)",
    "platforms": "Windows, Linux, macOS",
    "kill_chain_phases": "Impact",
    "data_sources": "Process: Process Creation, Command: Command Execution, Process: OS API Execution, Service: Service Metadata, Windows Registry: Windows Registry Key Modification, File: File Modification, Process: Process Termination",
    "detection": "Monitor processes and command-line arguments to see if critical processes are terminated or stop running.\nMonitor for edits for modifications to services and startup programs that correspond to services of high importance. Look for changes to services that do not correlate with known software, patch cycles, etc. Windows service information is stored in the Registry at `HKLMSYSTEMCurrentControlSetServices`. Systemd service unit files are stored within the /etc/systemd/system, /usr/lib/systemd/system/, and /home/.config/systemd/user/ directories, as well as associated symbolic links.\nAlterations to the service binary path or the service startup type changed to disabled may be suspicious.\nRemote access tools with built-in features may interact directly with the Windows API to perform these functions outside of typical system utilities. For example, `ChangeServiceConfigW` may be used by an adversary to prevent services from starting.(Citation: Talos Olympic Destroyer 2018)",
    "url": "https://attack.mitre.org/techniques/T1489",
    "enrichments": {
        "attack_rule_map": [
            {
                "tech_id": "T1489",
                "atomic_attack_guid": "08b4718f-a8bf-4bb5-a552-294fc5178fea",
                "atomic_attack_name": "Linux - Stop service by killing process using pkill",
                "platform": "Linux",
                "sigma_rules": [
                    {
                        "rule_name": "Terminate Linux Process Via Kill",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules-threat-hunting/linux/process_creation/proc_creation_lnx_susp_process_termination_via_kill.yml",
                        "remote_content": "title: Terminate Linux Process Via Kill\nid: 64c41342-6b27-523b-5d3f-c265f3efcdb3\nstatus: test\ndescription: Detects usage of command line tools such as \"kill\", \"pkill\" or \"killall\" to terminate or signal a running process.\nreferences:\n    - https://www.trendmicro.com/en_us/research/23/c/iron-tiger-sysupdate-adds-linux-targeting.html\n    - https://www.cyberciti.biz/faq/how-force-kill-process-linux/\n    - https://www.geeksforgeeks.org/how-to-kill-processes-on-the-linux-desktop-with-xkill/\nauthor: Tuan Le (NCSGroup)\ndate: 2023-03-16\nmodified: 2024-12-12\ntags:\n    - attack.defense-evasion\n    - attack.t1562\n    - detection.threat-hunting\nlogsource:\n    product: linux\n    category: process_creation\ndetection:\n    selection:\n        Image|endswith:\n            - '/kill'\n            - '/killall'\n            - '/pkill'\n            - '/xkill'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n"
                    }
                ],
                "splunk_rules": [
                    {
                        "rule_name": "Linux Impair Defenses Process Kill",
                        "rule_link": "https://research.splunk.com/endpoint/435c6b33-adf9-47fe-be87-8e29fd6654f5/"
                    },
                    {
                        "rule_name": "Linux Sudo OR Su Execution",
                        "rule_link": "https://research.splunk.com/endpoint/4b00f134-6d6a-11ec-a90c-acde48001122/"
                    }
                ]
            },
            {
                "tech_id": "T1489",
                "atomic_attack_guid": "332f4c76-7e96-41a6-8cc2-7361c49db8be",
                "atomic_attack_name": "Linux - Stop service by killing process using kill",
                "platform": "Linux",
                "splunk_rules": [
                    {
                        "rule_name": "Linux Sudo OR Su Execution",
                        "rule_link": "https://research.splunk.com/endpoint/4b00f134-6d6a-11ec-a90c-acde48001122/"
                    }
                ]
            },
            {
                "tech_id": "T1489",
                "atomic_attack_guid": "e5d95be6-02ee-4ff1-aebe-cf86013b6189",
                "atomic_attack_name": "Linux - Stop service by killing process using killall",
                "platform": "Linux",
                "sigma_rules": [
                    {
                        "rule_name": "Terminate Linux Process Via Kill",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules-threat-hunting/linux/process_creation/proc_creation_lnx_susp_process_termination_via_kill.yml",
                        "remote_content": "title: Terminate Linux Process Via Kill\nid: 64c41342-6b27-523b-5d3f-c265f3efcdb3\nstatus: test\ndescription: Detects usage of command line tools such as \"kill\", \"pkill\" or \"killall\" to terminate or signal a running process.\nreferences:\n    - https://www.trendmicro.com/en_us/research/23/c/iron-tiger-sysupdate-adds-linux-targeting.html\n    - https://www.cyberciti.biz/faq/how-force-kill-process-linux/\n    - https://www.geeksforgeeks.org/how-to-kill-processes-on-the-linux-desktop-with-xkill/\nauthor: Tuan Le (NCSGroup)\ndate: 2023-03-16\nmodified: 2024-12-12\ntags:\n    - attack.defense-evasion\n    - attack.t1562\n    - detection.threat-hunting\nlogsource:\n    product: linux\n    category: process_creation\ndetection:\n    selection:\n        Image|endswith:\n            - '/kill'\n            - '/killall'\n            - '/pkill'\n            - '/xkill'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n"
                    }
                ],
                "splunk_rules": [
                    {
                        "rule_name": "Linux Sudo OR Su Execution",
                        "rule_link": "https://research.splunk.com/endpoint/4b00f134-6d6a-11ec-a90c-acde48001122/"
                    }
                ]
            },
            {
                "tech_id": "T1489",
                "atomic_attack_guid": "42e3a5bd-1e45-427f-aa08-2a65fa29a820",
                "atomic_attack_name": "Linux - Stop service using systemctl",
                "platform": "Linux",
                "sigma_rules": [
                    {
                        "rule_name": "Disable Or Stop Services",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_services_stop_and_disable.yml",
                        "remote_content": "title: Disable Or Stop Services\nid: de25eeb8-3655-4643-ac3a-b662d3f26b6b\nstatus: test\ndescription: Detects the usage of utilities such as 'systemctl', 'service'...etc to stop or disable tools and services\nreferences:\n    - https://www.trendmicro.com/pl_pl/research/20/i/the-evolution-of-malicious-shell-scripts.html\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-09-15\ntags:\n    - attack.defense-evasion\nlogsource:\n    category: process_creation\n    product: linux\ndetection:\n    selection:\n        Image|endswith:\n            - '/service'\n            - '/systemctl'\n            - '/chkconfig'\n        CommandLine|contains:\n            - 'stop'\n            - 'disable'\n    condition: selection\nfalsepositives:\n    - Legitimate administration activities\nlevel: medium\n"
                    }
                ],
                "splunk_rules": [
                    {
                        "rule_name": "Linux Sudo OR Su Execution",
                        "rule_link": "https://research.splunk.com/endpoint/4b00f134-6d6a-11ec-a90c-acde48001122/"
                    }
                ]
            },
            {
                "tech_id": "T1489",
                "atomic_attack_guid": "f3191b84-c38b-400b-867e-3a217a27795f",
                "atomic_attack_name": "Windows - Stop service by killing process",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Process Terminated Via Taskkill",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules-threat-hunting/windows/process_creation/proc_creation_win_taskkill_execution.yml",
                        "remote_content": "title: Process Terminated Via Taskkill\nid: 86085955-ea48-42a2-9dd3-85d4c36b167d\nstatus: test\ndescription: |\n    Detects execution of \"taskkill.exe\" in order to stop a service or a process. Look for suspicious parents executing this command in order to hunt for potential malicious activity.\n    Attackers might leverage this in order to conduct data destruction or data encrypted for impact on the data stores of services like Exchange and SQL Server.\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1489/T1489.md#atomic-test-3---windows---stop-service-by-killing-process\n    - https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/\nauthor: frack113, MalGamy (Nextron Systems), Nasreddine Bencherchali\ndate: 2021-12-26\nmodified: 2024-10-06\ntags:\n    - attack.impact\n    - attack.t1489\n    - detection.threat-hunting\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_img:\n        - Image|endswith: '\\taskkill.exe'\n        - OriginalFileName: 'taskkill.exe'\n    selection_cli_force:\n        - CommandLine|contains|windash: ' /f '\n        - CommandLine|endswith|windash: ' /f'\n    selection_cli_filter_process:\n        CommandLine|contains|windash:\n            - ' /im '\n            - ' /pid '\n    filter_main_installers:\n        ParentImage|contains:\n            - '\\AppData\\Local\\Temp\\'\n            - ':\\Windows\\Temp'\n        ParentImage|endswith: '.tmp'\n    condition: all of selection_* and not 1 of filter_main_*\nfalsepositives:\n    - Expected FP with some processes using this techniques to terminate one of their processes during installations and updates\nlevel: low\n"
                    }
                ]
            },
            {
                "tech_id": "T1489",
                "atomic_attack_guid": "41274289-ec9c-4213-bea4-e43c4aa57954",
                "atomic_attack_name": "Windows - Stop service using net.exe",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Net.EXE Execution",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules-threat-hunting/windows/process_creation/proc_creation_win_net_execution.yml",
                        "remote_content": "title: Net.EXE Execution\nid: 183e7ea8-ac4b-4c23-9aec-b3dac4e401ac\nstatus: test\ndescription: Detects execution of \"Net.EXE\".\nreferences:\n    - https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/\n    - https://eqllib.readthedocs.io/en/latest/analytics/4d2e7fc1-af0b-4915-89aa-03d25ba7805e.html\n    - https://eqllib.readthedocs.io/en/latest/analytics/e61f557c-a9d0-4c25-ab5b-bbc46bb24deb.html\n    - https://eqllib.readthedocs.io/en/latest/analytics/9b3dd402-891c-4c4d-a662-28947168ce61.html\n    - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1007/T1007.md#atomic-test-2---system-service-discovery---netexe\nauthor: Michael Haag, Mark Woan (improvements), James Pemberton / @4A616D6573 / oscd.community (improvements)\ndate: 2019-01-16\nmodified: 2022-07-11\ntags:\n    - attack.discovery\n    - attack.t1007\n    - attack.t1049\n    - attack.t1018\n    - attack.t1135\n    - attack.t1201\n    - attack.t1069.001\n    - attack.t1069.002\n    - attack.t1087.001\n    - attack.t1087.002\n    - attack.lateral-movement\n    - attack.t1021.002\n    - attack.s0039\n    - detection.threat-hunting\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_img:\n        - Image|endswith:\n              - '\\net.exe'\n              - '\\net1.exe'\n        - OriginalFileName:\n              - 'net.exe'\n              - 'net1.exe'\n    selection_cli:\n        CommandLine|contains:\n            - ' accounts'\n            - ' group'\n            - ' localgroup'\n            - ' share'\n            - ' start'\n            - ' stop '\n            - ' user'\n            - ' view'\n    condition: all of selection_*\nfalsepositives:\n    - Likely\nlevel: low\n"
                    },
                    {
                        "rule_name": "Stop Windows Service Via Net.EXE",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_net_stop_service.yml",
                        "remote_content": "title: Stop Windows Service Via Net.EXE\nid: 88872991-7445-4a22-90b2-a3adadb0e827\nrelated:\n    - id: eb87818d-db5d-49cc-a987-d5da331fbd90\n      type: obsolete\nstatus: test\ndescription: Detects the stopping of a Windows service via the \"net\" utility.\nreferences:\n    - https://ss64.com/nt/net-service.html\nauthor: Jakob Weinzettl, oscd.community, Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-03-05\ntags:\n    - attack.impact\n    - attack.t1489\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_img:\n        - OriginalFileName:\n              - 'net.exe'\n              - 'net1.exe'\n        - Image|endswith:\n              - '\\net.exe'\n              - '\\net1.exe'\n    selection_cli:\n        CommandLine|contains: ' stop '\n    condition: all of selection_*\nfalsepositives:\n    - There are many legitimate reasons to stop a service. This rule isn't looking for any suspicious behaviour in particular. Filter legitimate activity accordingly\nlevel: low\n"
                    }
                ]
            },
            {
                "tech_id": "T1489",
                "atomic_attack_guid": "21dfb440-830d-4c86-a3e5-2a491d5a8d04",
                "atomic_attack_name": "Windows - Stop service using Service Controller",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Stop Windows Service Via Sc.EXE",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sc_stop_service.yml",
                        "remote_content": "title: Stop Windows Service Via Sc.EXE\nid: 81bcb81b-5b1f-474b-b373-52c871aaa7b1\nrelated:\n    - id: eb87818d-db5d-49cc-a987-d5da331fbd90\n      type: obsolete\nstatus: test\ndescription: Detects the stopping of a Windows service via the \"sc.exe\" utility\nreferences:\n    - https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc742107(v=ws.11)\nauthor: Jakob Weinzettl, oscd.community, Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-03-05\nmodified: 2024-01-18\ntags:\n    - attack.impact\n    - attack.t1489\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_img:\n        - OriginalFileName: 'sc.exe'\n        - Image|endswith: '\\sc.exe'\n    selection_cli:\n        CommandLine|contains: ' stop '\n    condition: all of selection_*\nfalsepositives:\n    - There are many legitimate reasons to stop a service. This rule isn't looking for any suspicious behavior in particular. Filter legitimate activity accordingly\nlevel: low\n"
                    }
                ]
            }
        ],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "410d2a41-1e6d-452f-85e5-abdd8257a823",
                    "dbc1f800-0fe0-4bc0-9c66-292c2abe3f78",
                    "570ae5ec-33dc-427c-b815-db86228ad43e",
                    "220457c1-1c9f-4c2e-afe6-9598926222c1",
                    "8dbeaaac-a671-4a02-8dab-5eec2a1c935b",
                    "9ac94dc8-9042-493c-ba45-3b5e7c86b980",
                    "9e3cb244-bdb8-4632-8c90-6079c8f4f16d",
                    "86085955-ea48-42a2-9dd3-85d4c36b167d",
                    "cdc842aa-761d-48e2-9b97-c344bed8b3a8",
                    "eb87818d-db5d-49cc-a987-d5da331fbd90",
                    "ce72ef99-22f1-43d4-8695-419dcb5d9330",
                    "417fed8c-bd76-48b5-90a2-a88882a95241",
                    "20fb2507-d71c-455d-9b6d-6104461cf26b"
                ],
                "lookup_results": [
                    {
                        "uuid": "410d2a41-1e6d-452f-85e5-abdd8257a823",
                        "lookup_data": {
                            "description": "Identifies when a application is deleted in Azure.",
                            "raw": "author: Austin Songer @austinsonger\ndate: 2021/09/03\ndescription: Identifies when a application is deleted in Azure.\ndetection:\n  condition: selection\n  selection:\n    properties.message:\n    - Delete application\n    - Hard Delete application\nfalsepositives:\n- Application being deleted may be performed by a system administrator.\n- Verify whether the user identity, user agent, and/or hostname should be making changes\n  in your environment.\n- Application deleted from unfamiliar users should be investigated. If known behavior\n  is causing false positives, it can be exempted from the rule.\nid: 410d2a41-1e6d-452f-85e5-abdd8257a823\nlevel: medium\nlogsource:\n  product: azure\n  service: activitylogs\nmodified: 2022/10/09\nreferences:\n- https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/reference-audit-activities#application-proxy\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.impact\n- attack.t1489\ntitle: Azure Application Deleted\n",
                            "sigma:id": "410d2a41-1e6d-452f-85e5-abdd8257a823",
                            "title": "Azure Application Deleted",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "dbc1f800-0fe0-4bc0-9c66-292c2abe3f78",
                        "lookup_data": {
                            "description": "Detects when adversaries stop services or processes by deleting their respective scheduled tasks in order to conduct data destructive activities",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/09/09\ndescription: Detects when adversaries stop services or processes by deleting their\n  respective scheduled tasks in order to conduct data destructive activities\ndetection:\n  condition: all of schtasks_*\n  schtasks_exe:\n    CommandLine|contains:\n    - \\Windows\\SystemRestore\\SR\n    - \\Windows\\Windows Defender\\\n    - \\Windows\\BitLocker\n    - \\Windows\\WindowsBackup\\\n    - \\Windows\\WindowsUpdate\\\n    - \\Windows\\UpdateOrchestrator\\\n    - \\Windows\\ExploitGuard\n    CommandLine|contains|all:\n    - /delete\n    - /tn\n    Image|endswith: \\schtasks.exe\nfalsepositives:\n- Unlikely\nid: dbc1f800-0fe0-4bc0-9c66-292c2abe3f78\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- Internal Research\nrelated:\n- id: 9ac94dc8-9042-493c-ba45-3b5e7c86b980\n  type: derived\n- id: 9e3cb244-bdb8-4632-8c90-6079c8f4f16d\n  type: similar\nstatus: experimental\ntags:\n- attack.impact\n- attack.t1489\ntitle: Delete Important Scheduled Task\n",
                            "sigma:id": "dbc1f800-0fe0-4bc0-9c66-292c2abe3f78",
                            "title": "Delete Important Scheduled Task",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "570ae5ec-33dc-427c-b815-db86228ad43e",
                        "lookup_data": {
                            "description": "An application has been removed. Check if it is critical.",
                            "raw": "author: frack113\ndate: 2022/01/28\ndescription: An application has been removed. Check if it is critical.\ndetection:\n  condition: selection\n  selection:\n    EventID:\n    - 11724\n    - 1034\n    Provider_Name: MsiInstaller\nfalsepositives:\n- Unknown\nid: 570ae5ec-33dc-427c-b815-db86228ad43e\nlevel: low\nlogsource:\n  product: windows\n  service: application\nmodified: 2022/09/17\nstatus: experimental\ntags:\n- attack.impact\n- attack.t1489\ntitle: Application Uninstalled\n",
                            "sigma:id": "570ae5ec-33dc-427c-b815-db86228ad43e",
                            "title": "Application Uninstalled",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "220457c1-1c9f-4c2e-afe6-9598926222c1",
                        "lookup_data": {
                            "description": "Detects the usage of schtasks with the delete flag and the asterisk symbole to delete all tasks from the schedule of the local computer, including tasks scheduled by other users.",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/09/09\ndescription: Detects the usage of schtasks with the delete flag and the asterisk symbole\n  to delete all tasks from the schedule of the local computer, including tasks scheduled\n  by other users.\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - ' /delete '\n    - /tn \\*\n    - ' /f'\n    Image|endswith: \\schtasks.exe\nfalsepositives:\n- Unlikely\nid: 220457c1-1c9f-4c2e-afe6-9598926222c1\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-delete\nstatus: experimental\ntags:\n- attack.impact\n- attack.t1489\ntitle: Delete All Scheduled Tasks\n",
                            "sigma:id": "220457c1-1c9f-4c2e-afe6-9598926222c1",
                            "title": "Delete All Scheduled Tasks",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "8dbeaaac-a671-4a02-8dab-5eec2a1c935b",
                        "lookup_data": {
                            "description": "Ragnar Locker Ransomware Targeting the Energy Sector",
                            "link": "http://www.botvrij.eu/data/feed-osint/8dbeaaac-a671-4a02-8dab-5eec2a1c935b.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1662991697",
                            "uuid": "8dbeaaac-a671-4a02-8dab-5eec2a1c935b",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "9ac94dc8-9042-493c-ba45-3b5e7c86b980",
                        "lookup_data": {
                            "description": "Detects when adversaries stop services or processes by disabling their respective scheduled tasks in order to conduct data destructive activities",
                            "raw": "author: frack113, Nasreddine Bencherchali\ndate: 2021/12/26\ndescription: Detects when adversaries stop services or processes by disabling their\n  respective scheduled tasks in order to conduct data destructive activities\ndetection:\n  condition: all of schtasks_*\n  schtasks_exe:\n    CommandLine|contains:\n    - \\Windows\\SystemRestore\\SR\n    - \\Windows\\Windows Defender\\\n    - \\Windows\\BitLocker\n    - \\Windows\\WindowsBackup\\\n    - \\Windows\\WindowsUpdate\\\n    - \\Windows\\UpdateOrchestrator\\\n    - \\Windows\\ExploitGuard\n    CommandLine|contains|all:\n    - /Change\n    - /TN\n    - /disable\n    Image|endswith: \\schtasks.exe\nfalsepositives:\n- Unknown\nid: 9ac94dc8-9042-493c-ba45-3b5e7c86b980\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/09/02\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md#atomic-test-8---windows---disable-the-sr-scheduled-task\n- https://twitter.com/MichalKoczwara/status/1553634816016498688\n- https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/\nstatus: experimental\ntags:\n- attack.impact\n- attack.t1489\ntitle: Disable Important Scheduled Task\n",
                            "sigma:id": "9ac94dc8-9042-493c-ba45-3b5e7c86b980",
                            "title": "Disable Important Scheduled Task",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "9e3cb244-bdb8-4632-8c90-6079c8f4f16d",
                        "lookup_data": {
                            "description": "Detects when adversaries stop services or processes by deleting their respective scheduled tasks in order to conduct data destructive activities",
                            "raw": "author: frack113\ndate: 2023/01/13\ndescription: Detects when adversaries stop services or processes by deleting their\n  respective scheduled tasks in order to conduct data destructive activities\ndetection:\n  condition: selection and not filter\n  filter:\n    UserName|contains:\n    - AUTHORI\n    - AUTORI\n  selection:\n    EventID: 141\n    TaskName|contains:\n    - \\Windows\\SystemRestore\\SR\n    - \\Windows\\Windows Defender\\\n    - \\Windows\\BitLocker\n    - \\Windows\\WindowsBackup\\\n    - \\Windows\\WindowsUpdate\\\n    - \\Windows\\UpdateOrchestrator\\\n    - \\Windows\\ExploitGuard\nfalsepositives:\n- Unknown\nid: 9e3cb244-bdb8-4632-8c90-6079c8f4f16d\nlevel: high\nlogsource:\n  definition: 'Requirements: The \"Microsoft-Windows-TaskScheduler/Operational\" is\n    disabled by default and needs to be enabled in order for this detection to trigger'\n  product: windows\n  service: taskscheduler\nrelated:\n- id: dbc1f800-0fe0-4bc0-9c66-292c2abe3f78\n  type: similar\n- id: 9ac94dc8-9042-493c-ba45-3b5e7c86b980\n  type: similar\n- id: 7595ba94-cf3b-4471-aa03-4f6baa9e5fad\n  type: similar\nstatus: experimental\ntags:\n- attack.impact\n- attack.t1489\ntitle: Suspicious Security Scheduled Tasks Deleted\n",
                            "sigma:id": "9e3cb244-bdb8-4632-8c90-6079c8f4f16d",
                            "title": "Suspicious Security Scheduled Tasks Deleted",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "86085955-ea48-42a2-9dd3-85d4c36b167d",
                        "lookup_data": {
                            "description": "Adversaries may stop services or processes in order to conduct Data Destruction or Data Encrypted for Impact on the data stores of services like Exchange and SQL Server.",
                            "raw": "author: frack113\ndate: 2021/12/26\ndescription: Adversaries may stop services or processes in order to conduct Data Destruction\n  or Data Encrypted for Impact on the data stores of services like Exchange and SQL\n  Server.\ndetection:\n  condition: all of selection*\n  selection_cli:\n    CommandLine|contains|all:\n    - ' /f'\n    - ' /im '\n  selection_img:\n  - Image|endswith: \\taskkill.exe\n  - OriginalFileName: taskkill.exe\nfalsepositives:\n- Expected FP with some processes using this techniques to terminate one of their\n  processes during installations and updates\nid: 86085955-ea48-42a2-9dd3-85d4c36b167d\nlevel: low\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/05/17\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1489/T1489.md#atomic-test-3---windows---stop-service-by-killing-process\nstatus: experimental\ntags:\n- attack.impact\n- attack.t1489\ntitle: Suspicious Execution of Taskkill\n",
                            "sigma:id": "86085955-ea48-42a2-9dd3-85d4c36b167d",
                            "title": "Suspicious Execution of Taskkill",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "cdc842aa-761d-48e2-9b97-c344bed8b3a8",
                        "lookup_data": {
                            "description": "Cyberattack on fuel supplier causes supply chain disruption",
                            "link": "http://www.botvrij.eu/data/feed-osint/cdc842aa-761d-48e2-9b97-c344bed8b3a8.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1644231782",
                            "uuid": "cdc842aa-761d-48e2-9b97-c344bed8b3a8",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "eb87818d-db5d-49cc-a987-d5da331fbd90",
                        "lookup_data": {
                            "description": "Detects a windows service to be stopped",
                            "raw": "author: Jakob Weinzettl, oscd.community, Nasreddine Bencherchali\ndate: 2019/10/23\ndescription: Detects a windows service to be stopped\ndetection:\n  condition: (all of selection_sc_net* and not filter) or selection_pwsh\n  filter:\n    CommandLine:\n    - sc  stop KSCWebConsoleMessageQueue\n    - sc  stop LGHUBUpdaterService\n    User|contains:\n    - AUTHORI\n    - AUTORI\n  selection_pwsh:\n    CommandLine|contains: 'Stop-Service '\n    Image|endswith:\n    - \\powershell.exe\n    - \\pwsh.exe\n  selection_sc_net_cli:\n    CommandLine|contains: ' stop '\n  selection_sc_net_img:\n  - OriginalFileName:\n    - sc.exe\n    - net.exe\n    - net1.exe\n  - Image|endswith:\n    - \\sc.exe\n    - \\net.exe\n    - \\net1.exe\nfalsepositives:\n- Administrator shutting down the service due to upgrade or removal purposes\nfields:\n- ComputerName\n- User\n- CommandLine\nid: eb87818d-db5d-49cc-a987-d5da331fbd90\nlevel: low\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/22\nstatus: experimental\ntags:\n- attack.impact\n- attack.t1489\ntitle: Stop Windows Service\n",
                            "sigma:id": "eb87818d-db5d-49cc-a987-d5da331fbd90",
                            "title": "Stop Windows Service",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ce72ef99-22f1-43d4-8695-419dcb5d9330",
                        "lookup_data": {
                            "description": "Detects the usage of one of the the commands to stop services such as 'net', 'sc'...etc in order to stop critical or important windows services such as AV, Backup...etc. As seen being used in some ransomware scripts",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/09/01\ndescription: Detects the usage of one of the the commands to stop services such as\n  'net', 'sc'...etc in order to stop critical or important windows services such as\n  AV, Backup...etc. As seen being used in some ransomware scripts\ndetection:\n  condition: services and (all of selection_sc_net* or selection_pwsh)\n  selection_pwsh:\n    CommandLine|contains: 'Stop-Service '\n    Image|endswith:\n    - \\powershell.exe\n    - \\pwsh.exe\n  selection_sc_net_cli:\n    CommandLine|contains: ' stop '\n  selection_sc_net_img:\n  - OriginalFileName:\n    - sc.exe\n    - net.exe\n    - net1.exe\n  - Image|endswith:\n    - \\sc.exe\n    - \\net.exe\n    - \\net1.exe\n  services:\n    CommandLine|contains:\n    - '\"Acronis VSS Provider\"'\n    - '\"Client Agent 7.60\"'\n    - '\"Enterprise Client Service\"'\n    - '\"Sophos Agent\"'\n    - '\"Sophos AutoUpdate Service\"'\n    - '\"Sophos Clean Service\"'\n    - '\"Sophos Device Control Service\"'\n    - '\"Sophos File Scanner Service\"'\n    - '\"Sophos Health Service\"'\n    - '\"Sophos MCS Agent\"'\n    - '\"Sophos MCS Client\"'\n    - '\"Sophos Message Router\"'\n    - '\"Sophos Safestore Service\"'\n    - '\"Sophos System Protection Service\"'\n    - '\"Sophos Web Control Service\"'\n    - '\"SQL Backups\"'\n    - '\"SQL Server (MSSQLSERVER)\"'\n    - '\"SQL Server (SQLEXPRESS)'\n    - '\"SQLsafe Backup Service\"'\n    - '\"SQLsafe Filter Service\"'\n    - '\"Symantec System Recovery\"'\n    - '\"Veeam Backup Catalog Data Service\"'\n    - '\"Veritas System Recovery\"'\n    - '\"Zoolz 2 Service\"'\n    - \"\\u201CAvast Business Console Client Antivirus Service\\u201D\"\n    - \"\\u201Cavast! Antivirus\\u201D\"\n    - \"\\u201CSQL Backups\\u201D\"\n    - \"\\u201CZoolz 2 Service\\u201D\"\n    - 143Svc\n    - AcronisAgent\n    - AcrSch2Svc\n    - Antivirus\n    - ARSM\n    - aswBcc\n    - AVP\n    - BackupExecAgentAccelerator\n    - BackupExecAgentBrowser\n    - BackupExecDeviceMediaService\n    - BackupExecJobEngine\n    - BackupExeclobEngine\n    - BackupExecManagementService\n    - BackupExecRPCService\n    - BackupExecVSSProvider\n    - bedbg\n    - BITS\n    - BrokerInfrastructure\n    - DCAgent\n    - EhttpSrv\n    - EhttpSry\n    - ekrn\n    - epag\n    - EPIntegrationService\n    - EPlntegrationService\n    - EPProtectedService\n    - EPRedline\n    - EPSecurityService\n    - EPUpdateService\n    - EraserSvc11710\n    - EsgShKernel\n    - ESHASRV\n    - FA_Scheduler\n    - HealthTLService\n    - HISSQLFDLauncherSSHAREPOINIT\n    - HMS\n    - IISAdmin\n    - IMANSVC\n    - IMAP4Svc\n    - KAVFS\n    - KAVFSGT\n    - kavfsslp\n    - klnagent\n    - LogProcessorService\n    - M8EndpointAgent\n    - macmnsvc\n    - masvc\n    - MBAMService\n    - MBEndpointAgent\n    - McAfeeEngineService\n    - MCAFEEEVENTPARSERSRV\n    - McAfeeFramework\n    - McAfeeFrameworkMcAfeeFramework\n    - MCAFEETOMCATSRV530\n    - McShield\n    - McTaskManager\n    - mfefire\n    - mfemms\n    - mfevto\n    - mfevtp\n    - mfewc\n    - MMS\n    - mozyprobackup\n    - MsDtsServer\n    - MsDtsServer100\n    - MsDtsServer110\n    - MsDtsServer130\n    - MSExchangeES\n    - MSExchangeIS\n    - MSExchangeMGMT\n    - MSExchangeMIA\n    - MSExchangeMTA\n    - MSExchangeSA\n    - MSExchangeSRS\n    - msftesq1SPROO\n    - msftesql$PROD\n    - MSOLAP$SQL_2008\n    - MSOLAP$SYSTEM_BGC\n    - MSOLAP$TPS\n    - MSOLAP$TPSAMA\n    - MSOLAPSTPS\n    - MSOLAPSTPSAMA\n    - MSSQ!I.SPROFXENGAGEMEHT\n    - MSSQ0SHAREPOINT\n    - MSSQ0SOPHOS\n    - MSSQL$BKUPEXEC\n    - MSSQL$ECWDB2\n    - MSSQL$EPOSERVER\n    - MSSQL$ITRIS\n    - MSSQL$PRACTICEMGT\n    - MSSQL$PRACTTICEBGC\n    - MSSQL$PROD\n    - MSSQL$PROFXENGAGEMENT\n    - MSSQL$SBSMONITORING\n    - MSSQL$SHAREPOINT\n    - MSSQL$SOPHOS\n    - MSSQL$SQL_2008\n    - MSSQL$SQLEXPRESS\n    - MSSQL$SYSTEM_BGC\n    - MSSQL$TPS\n    - MSSQL$TPSAMA\n    - MSSQL$VEEAMSQL2008R2\n    - MSSQL$VEEAMSQL2012\n    - MSSQLFDLauncher\n    - MSSQLFDLauncher$ITRIS\n    - MSSQLFDLauncher$PROFXENGAGEMENT\n    - MSSQLFDLauncher$S8SMONITORING\n    - MSSQLFDLauncher$SBSMONITORING\n    - MSSQLFDLauncher$SHAREPOINT\n    - MSSQLFDLauncher$SQL_2008\n    - MSSQLFDLauncher$SYSTEM_BGC\n    - MSSQLFDLauncher$TPS\n    - MSSQLFDLauncher$TPSAMA\n    - MSSQLFDLauncherSPROFXENGAGEMENT\n    - MSSQLFDLauncherSTPS\n    - MSSQLFDLauncherSTPSAMA\n    - MSSQLFOLauncherSSVSTEM_BGC\n    - MSSQLFOLavocher\n    - MSSQLLaunchpad$ITRIS\n    - MSSQLSBKUPEXEC\n    - MSSQLSECWDB2\n    - MSSQLSERVER\n    - MSSQLServerADHelper\n    - MSSQLServerADHelper100\n    - MSSQLServerOLAPService\n    - mSSQLSFRACTICEMGT\n    - MSSQLSPRACTTICEBGE\n    - MSSQLSPROO\n    - MSSQLSSBSMONITORIMG\n    - MSSQLSSQL_2008\n    - MSSQLSSQLEXPRESS\n    - MSSQLSSVSTEM_BGC\n    - MSSQLSTPS\n    - MSSQLSTPSAMA\n    - MSSQLSVEEAMSQL2012\n    - MSSQLSVIEAMSQL2008112\n    - MSSQLWEEAMSQL2008R2\n    - MySQL57\n    - MySQL80\n    - MySQLS7\n    - NetMsmqActivator\n    - ntrtscan\n    - OracleClientCache80\n    - PDVFSService\n    - POP3Svc\n    - POVFSService\n    - ReportServer\n    - ReportServer$SQL_2008\n    - ReportServer$SYSTEM_BGC\n    - ReportServer$TPS\n    - ReportServer$TPSAMA\n    - RESvc\n    - sacsvr\n    - SamSs\n    - SAVAdminService\n    - SAVService\n    - SDRSVC\n    - SentinelAgent\n    - SentinelHelperService\n    - SepMasterService\n    - ShMonitor\n    - Smcinst\n    - SmcService\n    - SMTPSvc\n    - SNAC\n    - SntpService\n    - sophossps\n    - SQ1SafeOLRService\n    - SQLAgent$BKUPEXEC\n    - SQLAgent$CITRIX_METAFRAME\n    - SQLAgent$CXDB\n    - SQLAgent$ECWDB2\n    - SQLAgent$EPOSERVER\n    - SQLAgent$ITRIS\n    - SQLAgent$PRACTTICEBGC\n    - SQLAgent$PRACTTICEMGT\n    - SQLAgent$PROD\n    - SQLAgent$PROFXENGAGEMENT\n    - SQLAgent$SBSMONITORING\n    - SQLAgent$SHAREPOINT\n    - SQLAgent$SOPHOS\n    - SQLAgent$SQL_2008\n    - SQLAgent$SQLEXPRESS\n    - SQLAgent$SVSTEM_BGC\n    - SQLAgent$SYSTEM_BGC\n    - SQLAgent$TPS\n    - SQLAgent$TPSAMA\n    - SQLAgent$VEEAMSQL2008R2\n    - SQLAgent$VEEAMSQL2012\n    - SQLAgentSCITRIX_METAFRAME\n    - SQLAgentSCXDB\n    - SQLAgentSPRACTTICEBGC\n    - SQLAgentSPROO\n    - SQLAgentSSBSMONITORING\n    - SQLAgentSSQL EXPRESS\n    - SQLAgentSTPS\n    - SQLAgentSTPSAMA\n    - SQLAgentSVEEAMSQL2008R2\n    - SQLBrowser\n    - SQLSafeOLRService\n    - SQLSERVERAGENT\n    - SQLTELEMETRY\n    - SQLTELEMETRY$ECWDB2\n    - SQLTELEMETRY$ITRIS\n    - SQLWriter\n    - SSISTELEMETRY130\n    - SstpSvc\n    - svcGenericHost\n    - svcienericHost\n    - swi_filter\n    - swi_service\n    - swi_update\n    - swi_update_64\n    - Telemetryserver\n    - ThreatLockerService\n    - TmCCSF\n    - tmlisten\n    - TmPfw\n    - TrueKey\n    - TruekeyScheduler\n    - TrueKeyServiceHelper\n    - UI0Detect\n    - UTODetect\n    - VeeamBackupSvc\n    - VeeamBrokerSvc\n    - VeeamCatalogSvc\n    - VeeamCloudSvc\n    - VeeamDeploymentService\n    - VeeamDeploySvc\n    - VeeamEnterpriseHanagerSvc\n    - VeeamEnterpriseManagerSvc\n    - VeeamHvIntegrationSvc\n    - VeeamMountSvc\n    - VeeamNFSSvc\n    - VeeamRESTSvc\n    - VeeamRISTSvc\n    - VeeamTransportSvc\n    - VeemaDep/oySvc\n    - VSS\n    - W3Svc\n    - wbengine\n    - WdNisSvc\n    - WeanClOudSve\n    - Weems JY\n    - WinDefend\n    - wozyprobackup\n    - WRSVC\nfalsepositives:\n- Administrator or tools shutting down the services due to upgrade or removal purposes.\n  If you experience some FP please consider adding filters to the parent process launching\n  this command and not removing the entry\nid: ce72ef99-22f1-43d4-8695-419dcb5d9330\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/11/29\nreferences:\n- https://www.trendmicro.com/content/dam/trendmicro/global/en/research/22/h/ransomware-actor-abuses-genshin-impact-anti-cheat-driver-to-kill-antivirus/Genshin%20Impact%20Figure%2010.jpg\n- https://www.trellix.com/en-sg/about/newsroom/stories/threat-labs/lockergoga-ransomware-family-used-in-targeted-attacks.html\nrelated:\n- id: eb87818d-db5d-49cc-a987-d5da331fbd90\n  type: derived\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1489\ntitle: Suspicious Stop Windows Service\n",
                            "sigma:id": "ce72ef99-22f1-43d4-8695-419dcb5d9330",
                            "title": "Suspicious Stop Windows Service",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "417fed8c-bd76-48b5-90a2-a88882a95241",
                        "lookup_data": {
                            "mitre-attack-id": "T1489",
                            "mitre-cti:description": "Ensure proper process, registry, and file permissions are in place to inhibit adversaries from disabling or interfering with critical services. Limit privileges of user accounts and groups so that only authorized administrators can interact with service changes and service configurations. Harden systems used to serve critical network, business, and communications functions. Operate intrusion detection, analysis, and response systems on a separate network from the production environment to lessen the chances that an adversary can see and interfere with critical response functions.",
                            "mitre-cti:name": "Service Stop Mitigation",
                            "mitre-cti:type": "course-of-action",
                            "raw": "{'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'course-of-action--417fed8c-bd76-48b5-90a2-a88882a95241', 'type': 'course-of-action', 'created': '2019-04-24T17:01:10.433Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'external_id': 'T1489', 'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/mitigations/T1489'}], 'modified': '2019-07-25T11:42:52.240Z', 'name': 'Service Stop Mitigation', 'description': 'Ensure proper process, registry, and file permissions are in place to inhibit adversaries from disabling or interfering with critical services. Limit privileges of user accounts and groups so that only authorized administrators can interact with service changes and service configurations. Harden systems used to serve critical network, business, and communications functions. Operate intrusion detection, analysis, and response systems on a separate network from the production environment to lessen the chances that an adversary can see and interfere with critical response functions.', 'x_mitre_deprecated': True, 'x_mitre_version': '1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "20fb2507-d71c-455d-9b6d-6104461cf26b",
                        "lookup_data": {
                            "mitre-attack-id": "T1489",
                            "mitre-cti:description": "Adversaries may stop or disable services on a system to render those services unavailable to legitimate users. Stopping critical services or processes can inhibit or stop response to an incident or aid in the adversary's overall objectives to cause damage to the environment.(Citation: Talos Olympic Destroyer 2018)(Citation: Novetta Blockbuster) \n\nAdversaries may accomplish this by disabling individual services of high importance to an organization, such as <code>MSExchangeIS</code>, which will make Exchange content inaccessible (Citation: Novetta Blockbuster). In some cases, adversaries may stop or disable many or all services to render systems unusable.(Citation: Talos Olympic Destroyer 2018) Services or processes may not allow for modification of their data stores while running. Adversaries may stop services or processes in order to conduct [Data Destruction](https://attack.mitre.org/techniques/T1485) or [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486) on the data stores of services like Exchange and SQL Server.(Citation: SecureWorks WannaCry Analysis)",
                            "mitre-cti:name": "Service Stop",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'x_mitre_platforms': ['Windows', 'Linux', 'macOS'], 'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'type': 'attack-pattern', 'id': 'attack-pattern--20fb2507-d71c-455d-9b6d-6104461cf26b', 'created': '2019-03-29T19:00:55.901Z', 'x_mitre_version': '1.2', 'external_references': [{'source_name': 'mitre-attack', 'external_id': 'T1489', 'url': 'https://attack.mitre.org/techniques/T1489'}, {'source_name': 'SecureWorks WannaCry Analysis', 'url': 'https://www.secureworks.com/research/wcry-ransomware-analysis', 'description': 'Counter Threat Unit Research Team. (2017, May 18). WCry Ransomware Analysis. Retrieved March 26, 2019.'}, {'source_name': 'Talos Olympic Destroyer 2018', 'url': 'https://blog.talosintelligence.com/2018/02/olympic-destroyer.html', 'description': 'Mercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer Takes Aim At Winter Olympics. Retrieved March 14, 2019.'}, {'source_name': 'Novetta Blockbuster', 'url': 'https://web.archive.org/web/20160226161828/https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Report.pdf', 'description': 'Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Unraveling the Long Thread of the Sony Attack. Retrieved February 25, 2016.'}], 'x_mitre_deprecated': False, 'revoked': False, 'description': \"Adversaries may stop or disable services on a system to render those services unavailable to legitimate users. Stopping critical services or processes can inhibit or stop response to an incident or aid in the adversary's overall objectives to cause damage to the environment.(Citation: Talos Olympic Destroyer 2018)(Citation: Novetta Blockbuster) \\n\\nAdversaries may accomplish this by disabling individual services of high importance to an organization, such as <code>MSExchangeIS</code>, which will make Exchange content inaccessible (Citation: Novetta Blockbuster). In some cases, adversaries may stop or disable many or all services to render systems unusable.(Citation: Talos Olympic Destroyer 2018) Services or processes may not allow for modification of their data stores while running. Adversaries may stop services or processes in order to conduct [Data Destruction](https://attack.mitre.org/techniques/T1485) or [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486) on the data stores of services like Exchange and SQL Server.(Citation: SecureWorks WannaCry Analysis)\", 'modified': '2022-07-28T18:47:11.957Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'name': 'Service Stop', 'x_mitre_detection': 'Monitor processes and command-line arguments to see if critical processes are terminated or stop running.\\n\\nMonitor for edits for modifications to services and startup programs that correspond to services of high importance. Look for changes to services that do not correlate with known software, patch cycles, etc. Windows service information is stored in the Registry at <code>HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services</code>. Systemd service unit files are stored within the /etc/systemd/system, /usr/lib/systemd/system/, and /home/.config/systemd/user/ directories, as well as associated symbolic links.\\n\\nAlterations to the service binary path or the service startup type changed to disabled may be suspicious.\\n\\nRemote access tools with built-in features may interact directly with the Windows API to perform these functions outside of typical system utilities. For example, <code>ChangeServiceConfigW</code> may be used by an adversary to prevent services from starting.(Citation: Talos Olympic Destroyer 2018)', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'impact'}], 'x_mitre_is_subtechnique': False, 'x_mitre_data_sources': ['Process: Process Creation', 'Process: Process Termination', 'Command: Command Execution', 'File: File Modification', 'Windows Registry: Windows Registry Key Modification', 'Service: Service Metadata', 'Process: OS API Execution'], 'x_mitre_impact_type': ['Availability'], 'x_mitre_attack_spec_version': '2.1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": [
            {
                "attack_technique": "T1489",
                "display_name": "Service Stop",
                "atomic_tests": [
                    {
                        "name": "Windows - Stop service using Service Controller",
                        "auto_generated_guid": "21dfb440-830d-4c86-a3e5-2a491d5a8d04",
                        "description": "Stops a specified service using the sc.exe command. Upon execution, if the spooler service was running infomration will be displayed saying\nit has changed to a state of STOP_PENDING. If the spooler service was not running \"The service has not been started.\" will be displayed and it can be\nstarted by running the cleanup command.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "service_name": {
                                "description": "Name of a service to stop",
                                "type": "string",
                                "default": "spooler"
                            }
                        },
                        "executor": {
                            "command": "sc.exe stop #{service_name}\n",
                            "cleanup_command": "sc.exe start #{service_name} >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Windows - Stop service using net.exe",
                        "auto_generated_guid": "41274289-ec9c-4213-bea4-e43c4aa57954",
                        "description": "Stops a specified service using the net.exe command. Upon execution, if the service was running \"The Print Spooler service was stopped successfully.\"\nwill be displayed. If the service was not running, \"The Print Spooler service is not started.\" will be displayed and it can be\nstarted by running the cleanup command.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "service_name": {
                                "description": "Name of a service to stop",
                                "type": "string",
                                "default": "spooler"
                            }
                        },
                        "executor": {
                            "command": "net.exe stop #{service_name}\n",
                            "cleanup_command": "net.exe start #{service_name} >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Windows - Stop service by killing process",
                        "auto_generated_guid": "f3191b84-c38b-400b-867e-3a217a27795f",
                        "description": "Stops a specified service killng the service's process.\nThis technique was used by WannaCry. Upon execution, if the spoolsv service was running \"SUCCESS: The process \"spoolsv.exe\" with PID 2316 has been terminated.\"\nwill be displayed. If the service was not running \"ERROR: The process \"spoolsv.exe\" not found.\" will be displayed and it can be\nstarted by running the cleanup command.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "process_name": {
                                "description": "Name of a process to kill",
                                "type": "string",
                                "default": "spoolsv.exe"
                            }
                        },
                        "executor": {
                            "command": "taskkill.exe /f /im #{process_name}\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Linux - Stop service using systemctl",
                        "auto_generated_guid": "42e3a5bd-1e45-427f-aa08-2a65fa29a820",
                        "description": "Stops a specified service using the systemctl command.\nUpon execution, if the specified service was running, it will change to a state of inactive and it can be restarted by running the cleanup command.\nYou can list all available services with following command: \"systemctl list-units --type=service\"\n",
                        "supported_platforms": [
                            "linux"
                        ],
                        "input_arguments": {
                            "service_name": {
                                "description": "Name of a service to stop",
                                "type": "string",
                                "default": "cron"
                            }
                        },
                        "executor": {
                            "command": "sudo systemctl stop #{service_name}\n",
                            "cleanup_command": "sudo systemctl start #{service_name} 2> /dev/null\n",
                            "name": "sh",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Linux - Stop service by killing process using killall",
                        "auto_generated_guid": "e5d95be6-02ee-4ff1-aebe-cf86013b6189",
                        "description": "Stops a specified service by sending a SIGTERM signal to the linked process using the killall command.\nUpon execution, if the service's main process was running, it will be terminated.\nIf the service was not running, no process will be found to kill and it can be restarted by running the cleanup command.\nYou can list all available services with following command: \"systemctl list-units --type=service\"\n",
                        "supported_platforms": [
                            "linux"
                        ],
                        "input_arguments": {
                            "process_name": {
                                "description": "Name of a process to stop",
                                "type": "string",
                                "default": "cron"
                            },
                            "service_name": {
                                "description": "Name of a service to restart",
                                "type": "string",
                                "default": "cron"
                            }
                        },
                        "executor": {
                            "command": "sudo killall -SIGTERM #{process_name}\n",
                            "cleanup_command": "sudo systemctl start #{service_name} 2> /dev/null\n",
                            "name": "sh",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Linux - Stop service by killing process using kill",
                        "auto_generated_guid": "332f4c76-7e96-41a6-8cc2-7361c49db8be",
                        "description": "Stops a specified service by sending a SIGTERM signal to the linked process using the kill command. Upon execution, if the service's main process was running, it will be terminated.\nIf the service was not running, no process will be found to kill and it can be restarted by running the cleanup command.\nYou can list all available services with following command: \"systemctl list-units --type=service\"\n",
                        "supported_platforms": [
                            "linux"
                        ],
                        "input_arguments": {
                            "process_name": {
                                "description": "Name of a process to kill",
                                "type": "string",
                                "default": "cron"
                            },
                            "service_name": {
                                "description": "Name of a service to restart",
                                "type": "string",
                                "default": "cron"
                            }
                        },
                        "executor": {
                            "command": "sudo kill -SIGTERM $(pgrep #{process_name})\n",
                            "cleanup_command": "sudo systemctl start #{service_name} 2> /dev/null\n",
                            "name": "sh",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Linux - Stop service by killing process using pkill",
                        "auto_generated_guid": "08b4718f-a8bf-4bb5-a552-294fc5178fea",
                        "description": "Stops a specified service by sending a SIGTERM signal to the linked process using pkill. This method is effective when multiple instances of the process may be running.\nUpon execution, if any instances of the process were running, they will be terminated. If no instances were running, pkill will not find any processes to kill.\nStopped service can be restarted by running the cleanup command.\nYou can list all available services with following command: \"systemctl list-units --type=service\"\n",
                        "supported_platforms": [
                            "linux"
                        ],
                        "input_arguments": {
                            "process_pattern": {
                                "description": "Pattern to match the name of the process to kill",
                                "type": "string",
                                "default": "^cron$"
                            },
                            "service_name": {
                                "description": "Name of a service to restart",
                                "type": "string",
                                "default": "cron"
                            }
                        },
                        "executor": {
                            "command": "sudo pkill -SIGTERM #{process_pattern}\n",
                            "cleanup_command": "sudo systemctl start #{service_name} 2> /dev/null\n",
                            "name": "sh",
                            "elevation_required": true
                        }
                    }
                ]
            }
        ]
    },
    "timestamp": "2025-02-28 14:36:19"
}