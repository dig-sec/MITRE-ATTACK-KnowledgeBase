{
    "id": "T1550.001",
    "name": "Application Access Token",
    "description": "Adversaries may use stolen application access tokens to bypass the typical authentication process and access restricted accounts, information, or services on remote systems. These tokens are typically stolen from users and used in lieu of login credentials.\nApplication access tokens are used to make authorized API requests on behalf of a user and are commonly used as a way to access resources in cloud-based applications and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) OAuth is one commonly implemented framework that issues tokens to users for access to systems. These frameworks are used collaboratively to verify the user and determine what actions the user is allowed to perform. Once identity is established, the token allows actions to be authorized, without passing the actual credentials of the user. Therefore, compromise of the token can grant the adversary access to resources of other sites through a malicious application.(Citation: okta)\nFor example, with a cloud-based email service once an OAuth access token is granted to a malicious application, it can potentially gain long-term access to features of the user account if a \"refresh\" token enabling background access is awarded.(Citation: Microsoft Identity Platform Access 2019) With an OAuth access token an adversary can use the user-granted REST API to perform functions such as email searching and contact enumeration.(Citation: Staaldraad Phishing with OAuth 2017)\nCompromised access tokens may be used as an initial step in compromising other services. For example, if a token grants access to a victim’s primary email, the adversary may be able to extend access to all other services which the target subscribes by triggering forgotten password routines. Direct API access through a token negates the effectiveness of a second authentication factor and may be immune to intuitive countermeasures like changing passwords. Access abuse over an API channel can be difficult to detect even from the service provider end, as the access can still align well with a legitimate workflow.",
    "platforms": "Office 365, SaaS, Google Workspace",
    "kill_chain_phases": "Defense Evasion, Lateral Movement",
    "data_sources": "Web Credential: Web Credential Usage, Application Log: Application Log Content",
    "detection": "Monitor access token activity for abnormal use and permissions granted to unusual or suspicious applications and APIs.",
    "url": "https://attack.mitre.org/techniques/T1550/001",
    "enrichments": {
        "attack_rule_map": [],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "f005e783-57d4-4837-88ad-dbe7faee1c51",
                    "905d389b-b853-46d0-9d3d-dea0d3a3cd49",
                    "b45ab1d2-712f-4f01-a751-df3826969807",
                    "f43f5d2f-3f2a-4cc8-b1af-81fde7dbaf0e"
                ],
                "lookup_results": [
                    {
                        "uuid": "f005e783-57d4-4837-88ad-dbe7faee1c51",
                        "lookup_data": {
                            "capec": "CAPEC-593",
                            "mitre-attack-id": "T1550.001",
                            "mitre-cti:description": "Adversaries may use stolen application access tokens to bypass the typical authentication process and access restricted accounts, information, or services on remote systems. These tokens are typically stolen from users or services and used in lieu of login credentials.\n\nApplication access tokens are used to make authorized API requests on behalf of a user or service and are commonly used as a way to access resources in cloud and container-based applications and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) \n\nIn AWS and GCP environments, adversaries can trigger a request for a short-lived access token with the privileges of another user account.(Citation: Google Cloud Service Account Credentials)(Citation: AWS Temporary Security Credentials) The adversary can then use this token to request data or perform actions the original account could not. If permissions for this feature are misconfigured – for example, by allowing all users to request a token for a particular account - an adversary may be able to gain initial access to a Cloud Account or escalate their privileges.(Citation: Rhino Security Labs Enumerating AWS Roles)\n\nOAuth is one commonly implemented framework that issues tokens to users for access to systems. These frameworks are used collaboratively to verify the user and determine what actions the user is allowed to perform. Once identity is established, the token allows actions to be authorized, without passing the actual credentials of the user. Therefore, compromise of the token can grant the adversary access to resources of other sites through a malicious application.(Citation: okta)\n\nFor example, with a cloud-based email service once an OAuth access token is granted to a malicious application, it can potentially gain long-term access to features of the user account if a \"refresh\" token enabling background access is awarded.(Citation: Microsoft Identity Platform Access 2019) With an OAuth access token an adversary can use the user-granted REST API to perform functions such as email searching and contact enumeration.(Citation: Staaldraad Phishing with OAuth 2017)\n\nCompromised access tokens may be used as an initial step in compromising other services. For example, if a token grants access to a victim’s primary email, the adversary may be able to extend access to all other services which the target subscribes by triggering forgotten password routines. Direct API access through a token negates the effectiveness of a second authentication factor and may be immune to intuitive countermeasures like changing passwords. Access abuse over an API channel can be difficult to detect even from the service provider end, as the access can still align well with a legitimate workflow.",
                            "mitre-cti:name": "Application Access Token",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'modified': '2022-10-21T17:01:05.286Z', 'name': 'Application Access Token', 'description': 'Adversaries may use stolen application access tokens to bypass the typical authentication process and access restricted accounts, information, or services on remote systems. These tokens are typically stolen from users or services and used in lieu of login credentials.\\n\\nApplication access tokens are used to make authorized API requests on behalf of a user or service and are commonly used as a way to access resources in cloud and container-based applications and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) \\n\\nIn AWS and GCP environments, adversaries can trigger a request for a short-lived access token with the privileges of another user account.(Citation: Google Cloud Service Account Credentials)(Citation: AWS Temporary Security Credentials) The adversary can then use this token to request data or perform actions the original account could not. If permissions for this feature are misconfigured – for example, by allowing all users to request a token for a particular account - an adversary may be able to gain initial access to a Cloud Account or escalate their privileges.(Citation: Rhino Security Labs Enumerating AWS Roles)\\n\\nOAuth is one commonly implemented framework that issues tokens to users for access to systems. These frameworks are used collaboratively to verify the user and determine what actions the user is allowed to perform. Once identity is established, the token allows actions to be authorized, without passing the actual credentials of the user. Therefore, compromise of the token can grant the adversary access to resources of other sites through a malicious application.(Citation: okta)\\n\\nFor example, with a cloud-based email service once an OAuth access token is granted to a malicious application, it can potentially gain long-term access to features of the user account if a \"refresh\" token enabling background access is awarded.(Citation: Microsoft Identity Platform Access 2019) With an OAuth access token an adversary can use the user-granted REST API to perform functions such as email searching and contact enumeration.(Citation: Staaldraad Phishing with OAuth 2017)\\n\\nCompromised access tokens may be used as an initial step in compromising other services. For example, if a token grants access to a victim’s primary email, the adversary may be able to extend access to all other services which the target subscribes by triggering forgotten password routines. Direct API access through a token negates the effectiveness of a second authentication factor and may be immune to intuitive countermeasures like changing passwords. Access abuse over an API channel can be difficult to detect even from the service provider end, as the access can still align well with a legitimate workflow.', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'defense-evasion'}, {'kill_chain_name': 'mitre-attack', 'phase_name': 'lateral-movement'}], 'x_mitre_detection': 'Monitor access token activity for abnormal use and permissions granted to unusual or suspicious applications and APIs. Additionally, administrators should review logs for calls to the AWS Security Token Service (STS) and usage of GCP service accounts in order to identify anomalous actions.(Citation: AWS Logging IAM Calls)(Citation: GCP Monitoring Service Account Usage)', 'x_mitre_platforms': ['Office 365', 'SaaS', 'Google Workspace', 'Containers', 'IaaS', 'Azure AD'], 'x_mitre_is_subtechnique': True, 'x_mitre_deprecated': False, 'x_mitre_domains': ['enterprise-attack'], 'x_mitre_version': '1.4', 'x_mitre_contributors': ['Shailesh Tiwary (Indian Army)', 'Saisha Agrawal, Microsoft Threat Intelligent Center (MSTIC)', 'Jeff Sakowicz, Microsoft Identity Developer Platform Services (IDPM Services)', 'Mark Wee', 'Jen Burns, HubSpot', 'Ian Davila, Tidal Cyber'], 'x_mitre_data_sources': ['Web Credential: Web Credential Usage'], 'x_mitre_defense_bypassed': ['System Access Controls'], 'type': 'attack-pattern', 'id': 'attack-pattern--f005e783-57d4-4837-88ad-dbe7faee1c51', 'created': '2020-01-30T17:37:22.261Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'revoked': False, 'external_references': [{'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/techniques/T1550/001', 'external_id': 'T1550.001'}, {'source_name': 'Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019', 'description': 'Auth0. (n.d.). Why You Should Always Use Access Tokens to Secure APIs. Retrieved September 12, 2019.', 'url': 'https://auth0.com/blog/why-should-use-accesstokens-to-secure-an-api/'}, {'source_name': 'AWS Logging IAM Calls', 'description': 'AWS. (n.d.). Logging IAM and AWS STS API calls with AWS CloudTrail. Retrieved April 1, 2022.', 'url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/cloudtrail-integration.html'}, {'source_name': 'AWS Temporary Security Credentials', 'description': 'AWS. (n.d.). Requesting temporary security credentials. Retrieved April 1, 2022.', 'url': 'https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp_request.html'}, {'source_name': 'Microsoft Identity Platform Access 2019', 'description': 'Cai, S., Flores, J., de Guzman, C., et. al.. (2019, August 27). Microsoft identity platform access tokens. Retrieved October 4, 2019.', 'url': 'https://docs.microsoft.com/en-us/azure/active-directory/develop/access-tokens'}, {'source_name': 'Google Cloud Service Account Credentials', 'description': 'Google Cloud. (2022, March 31). Creating short-lived service account credentials. Retrieved April 1, 2022.', 'url': 'https://cloud.google.com/iam/docs/creating-short-lived-service-account-credentials'}, {'source_name': 'GCP Monitoring Service Account Usage', 'description': 'Google Cloud. (2022, March 31). Monitor usage patterns for service accounts and keys . Retrieved April 1, 2022.', 'url': 'https://cloud.google.com/iam/docs/service-account-monitoring'}, {'source_name': 'okta', 'description': 'okta. (n.d.). What Happens If Your JWT Is Stolen?. Retrieved September 12, 2019.', 'url': 'https://developer.okta.com/blog/2018/06/20/what-happens-if-your-jwt-is-stolen'}, {'source_name': 'Rhino Security Labs Enumerating AWS Roles', 'description': 'Spencer Gietzen. (2018, August 8). Assume the Worst: Enumerating AWS Roles through ‘AssumeRole’. Retrieved April 1, 2022.', 'url': 'https://rhinosecuritylabs.com/aws/assume-worst-aws-assume-role-enumeration'}, {'source_name': 'Staaldraad Phishing with OAuth 2017', 'description': 'Stalmans, E.. (2017, August 2). Phishing with OAuth and o365/Azure. Retrieved October 4, 2019.', 'url': 'https://staaldraad.github.io/2017/08/02/o356-phishing-with-oauth/'}, {'source_name': 'capec', 'url': 'https://capec.mitre.org/data/definitions/593.html', 'external_id': 'CAPEC-593'}], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'x_mitre_attack_spec_version': '2.1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "905d389b-b853-46d0-9d3d-dea0d3a3cd49",
                        "lookup_data": {
                            "description": "Identifies the suspicious use of AssumeRole. Attackers could move laterally and escalate privileges.",
                            "raw": "author: Austin Songer @austinsonger\ndate: 2021/07/24\ndescription: Identifies the suspicious use of AssumeRole. Attackers could move laterally\n  and escalate privileges.\ndetection:\n  condition: selection\n  selection:\n    userIdentity.sessionContext.sessionIssuer.type: Role\n    userIdentity.type: AssumedRole\nfalsepositives:\n- AssumeRole may be done by a system or network administrator. Verify whether the\n  user identity, user agent, and/or hostname should be making changes in your environment.\n- AssumeRole from unfamiliar users or hosts should be investigated. If known behavior\n  is causing false positives, it can be exempted from the rule.\n- Automated processes that uses Terraform may lead to false positives.\nid: 905d389b-b853-46d0-9d3d-dea0d3a3cd49\nlevel: low\nlogsource:\n  product: aws\n  service: cloudtrail\nmodified: 2022/10/09\nreferences:\n- https://github.com/elastic/detection-rules/pull/1214\n- https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html\nstatus: test\ntags:\n- attack.lateral_movement\n- attack.privilege_escalation\n- attack.t1548\n- attack.t1550\n- attack.t1550.001\ntitle: AWS STS AssumeRole Misuse\n",
                            "sigma:id": "905d389b-b853-46d0-9d3d-dea0d3a3cd49",
                            "title": "AWS STS AssumeRole Misuse",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b45ab1d2-712f-4f01-a751-df3826969807",
                        "lookup_data": {
                            "description": "Identifies the suspicious use of GetSessionToken. Tokens could be created and used by attackers to move laterally and escalate privileges.",
                            "raw": "author: Austin Songer @austinsonger\ndate: 2021/07/24\ndescription: Identifies the suspicious use of GetSessionToken. Tokens could be created\n  and used by attackers to move laterally and escalate privileges.\ndetection:\n  condition: selection\n  selection:\n    eventName: GetSessionToken\n    eventSource: sts.amazonaws.com\n    userIdentity.type: IAMUser\nfalsepositives:\n- GetSessionToken may be done by a system or network administrator. Verify whether\n  the user identity, user agent, and/or hostname should be making changes in your\n  environment. GetSessionToken from unfamiliar users or hosts should be investigated.\n  If known behavior is causing false positives, it can be exempted from the rule.\nid: b45ab1d2-712f-4f01-a751-df3826969807\nlevel: low\nlogsource:\n  product: aws\n  service: cloudtrail\nmodified: 2022/10/09\nreferences:\n- https://github.com/elastic/detection-rules/pull/1213\n- https://docs.aws.amazon.com/STS/latest/APIReference/API_GetSessionToken.html\nstatus: test\ntags:\n- attack.lateral_movement\n- attack.privilege_escalation\n- attack.t1548\n- attack.t1550\n- attack.t1550.001\ntitle: AWS STS GetSessionToken Misuse\n",
                            "sigma:id": "b45ab1d2-712f-4f01-a751-df3826969807",
                            "title": "AWS STS GetSessionToken Misuse",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f43f5d2f-3f2a-4cc8-b1af-81fde7dbaf0e",
                        "lookup_data": {
                            "description": "Identifies when suspicious SAML activity has occurred in AWS. An adversary could gain backdoor access via SAML.",
                            "raw": "author: Austin Songer\ndate: 2021/09/22\ndescription: Identifies when suspicious SAML activity has occurred in AWS. An adversary\n  could gain backdoor access via SAML.\ndetection:\n  condition: 1 of selection_*\n  selection_iam:\n    eventName: UpdateSAMLProvider\n    eventSource: iam.amazonaws.com\n  selection_sts:\n    eventName: AssumeRoleWithSAML\n    eventSource: sts.amazonaws.com\nfalsepositives:\n- Automated processes that uses Terraform may lead to false positives.\n- SAML Provider could be updated by a system administrator. Verify whether the user\n  identity, user agent, and/or hostname should be making changes in your environment.\n- SAML Provider being updated from unfamiliar users should be investigated. If known\n  behavior is causing false positives, it can be exempted from the rule.\nid: f43f5d2f-3f2a-4cc8-b1af-81fde7dbaf0e\nlevel: medium\nlogsource:\n  product: aws\n  service: cloudtrail\nmodified: 2022/12/18\nreferences:\n- https://docs.aws.amazon.com/IAM/latest/APIReference/API_UpdateSAMLProvider.html\n- https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1078\n- attack.lateral_movement\n- attack.t1548\n- attack.privilege_escalation\n- attack.t1550\n- attack.t1550.001\ntitle: AWS Suspicious SAML Activity\n",
                            "sigma:id": "f43f5d2f-3f2a-4cc8-b1af-81fde7dbaf0e",
                            "title": "AWS Suspicious SAML Activity",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": []
    },
    "timestamp": "2025-02-28 15:55:13"
}