{
    "id": "T1557",
    "name": "Adversary-in-the-Middle",
    "description": "Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support follow-on behaviors such as [Network Sniffing](T1040) or [Transmitted Data Manipulation](T1565.002). By abusing features of common networking protocols that can determine the flow of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions.(Citation: Rapid7 MiTM Basics)\nAdversaries may leverage the AiTM position to attempt to modify traffic, such as in [Transmitted Data Manipulation](T1565.002). Adversaries can also stop traffic from flowing to the appropriate destination, causing denial of service.",
    "platforms": "Windows, macOS, Linux",
    "kill_chain_phases": "Credential Access, Collection",
    "data_sources": "Network Traffic: Network Traffic Content, Network Traffic: Network Traffic Flow, Service: Service Creation, Windows Registry: Windows Registry Key Modification",
    "detection": "Monitor network traffic for anomalies associated with known AiTM behavior. Consider monitoring for modifications to system configuration files involved in shaping network traffic flow.",
    "url": "https://attack.mitre.org/techniques/T1557",
    "enrichments": {
        "attack_rule_map": [],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "50e606bf-04ce-4ca7-9d54-3449494bbd4b",
                    "a7c0ae48-8df8-42bf-91bd-2ea57e2f9d43",
                    "56fa3cd6-f8d6-4520-a8c7-607292971886",
                    "a557ffe6-ac54-43d2-ae69-158027082350",
                    "035bb001-ab69-4a0b-9f6c-2de8b09e1b9d",
                    "c2c76b77-32be-4d1f-82c9-7e544bdfe0eb"
                ],
                "lookup_results": [
                    {
                        "uuid": "50e606bf-04ce-4ca7-9d54-3449494bbd4b",
                        "lookup_data": {
                            "description": "Detects LDP failures which may be indicative of brute force attacks to manipulate MPLS labels",
                            "raw": "author: Tim Brown\ndate: 2023/01/09\ndescription: Detects LDP failures which may be indicative of brute force attacks to\n  manipulate MPLS labels\ndetection:\n  condition: selection_protocol and selection_keywords\n  selection_keywords:\n  - SOCKET_TCP_PACKET_MD5_AUTHEN_FAIL\n  - TCPMD5AuthenFail\n  selection_protocol:\n  - LDP\nfalsepositives:\n- Unlikely. Except due to misconfigurations\nfields:\n- tcpConnLocalAddress\n- tcpConnRemAddress\nid: 50e606bf-04ce-4ca7-9d54-3449494bbd4b\nlevel: low\nlogsource:\n  definition: 'Requirements: cisco ldp logs need to be enabled and ingested'\n  product: cisco\n  service: ldp\nreferences:\n- https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf\nstatus: experimental\ntags:\n- attack.initial_access\n- attack.persistence\n- attack.privilege_escalation\n- attack.defense_evasion\n- attack.credential_access\n- attack.collection\n- attack.t1078\n- attack.t1110\n- attack.t1557\ntitle: Cisco LDP Authentication Failures\n",
                            "sigma:id": "50e606bf-04ce-4ca7-9d54-3449494bbd4b",
                            "title": "Cisco LDP Authentication Failures",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "a7c0ae48-8df8-42bf-91bd-2ea57e2f9d43",
                        "lookup_data": {
                            "description": "Detects juniper BGP missing MD5 digest. Which may be indicative of brute force attacks to manipulate routing.",
                            "raw": "author: Tim Brown\ndate: 2023/01/09\ndescription: Detects juniper BGP missing MD5 digest. Which may be indicative of brute\n  force attacks to manipulate routing.\ndetection:\n  condition: keywords_bgp_juniper\n  keywords_bgp_juniper:\n    '|all':\n    - :179\n    - missing MD5 digest\nfalsepositives:\n- Unlikely. Except due to misconfigurations\nfields:\n- host\nid: a7c0ae48-8df8-42bf-91bd-2ea57e2f9d43\nlevel: low\nlogsource:\n  definition: 'Requirements: juniper bgp logs need to be enabled and ingested'\n  product: juniper\n  service: bgp\nmodified: 2023/01/23\nreferences:\n- https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf\nstatus: experimental\ntags:\n- attack.initial_access\n- attack.persistence\n- attack.privilege_escalation\n- attack.defense_evasion\n- attack.credential_access\n- attack.collection\n- attack.t1078\n- attack.t1110\n- attack.t1557\ntitle: Juniper BGP Missing MD5\n",
                            "sigma:id": "a7c0ae48-8df8-42bf-91bd-2ea57e2f9d43",
                            "title": "Juniper BGP Missing MD5",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "56fa3cd6-f8d6-4520-a8c7-607292971886",
                        "lookup_data": {
                            "description": "Detects BGP failures which may be indicative of brute force attacks to manipulate routing",
                            "raw": "author: Tim Brown\ndate: 2023/01/09\ndescription: Detects BGP failures which may be indicative of brute force attacks to\n  manipulate routing\ndetection:\n  condition: keywords_bgp_cisco\n  keywords_bgp_cisco:\n    '|all':\n    - :179\n    - IP-TCP-3-BADAUTH\nfalsepositives:\n- Unlikely. Except due to misconfigurations\nfields:\n- tcpConnLocalAddress\n- tcpConnRemAddress\nid: 56fa3cd6-f8d6-4520-a8c7-607292971886\nlevel: low\nlogsource:\n  definition: 'Requirements: cisco bgp logs need to be enabled and ingested'\n  product: cisco\n  service: bgp\nmodified: 2023/01/23\nreferences:\n- https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf\nstatus: experimental\ntags:\n- attack.initial_access\n- attack.persistence\n- attack.privilege_escalation\n- attack.defense_evasion\n- attack.credential_access\n- attack.collection\n- attack.t1078\n- attack.t1110\n- attack.t1557\ntitle: Cisco BGP Authentication Failures\n",
                            "sigma:id": "56fa3cd6-f8d6-4520-a8c7-607292971886",
                            "title": "Cisco BGP Authentication Failures",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "a557ffe6-ac54-43d2-ae69-158027082350",
                        "lookup_data": {
                            "description": "Detects BGP failures which may be indicative of brute force attacks to manipulate routing.",
                            "raw": "author: Tim Brown\ndate: 2023/01/09\ndescription: Detects BGP failures which may be indicative of brute force attacks to\n  manipulate routing.\ndetection:\n  condition: keywords_bgp_huawei\n  keywords_bgp_huawei:\n    '|all':\n    - :179\n    - BGP_AUTH_FAILED\nfalsepositives:\n- Unlikely. Except due to misconfigurations\nfields:\n- host\n- PeeId\nid: a557ffe6-ac54-43d2-ae69-158027082350\nlevel: low\nlogsource:\n  definition: 'Requirements: huawei bgp logs need to be enabled and ingested'\n  product: huawei\n  service: bgp\nmodified: 2023/01/23\nreferences:\n- https://www.blackhat.com/presentations/bh-usa-03/bh-us-03-convery-franz-v3.pdf\nstatus: experimental\ntags:\n- attack.initial_access\n- attack.persistence\n- attack.privilege_escalation\n- attack.defense_evasion\n- attack.credential_access\n- attack.collection\n- attack.t1078\n- attack.t1110\n- attack.t1557\ntitle: Huawei BGP Authentication Failures\n",
                            "sigma:id": "a557ffe6-ac54-43d2-ae69-158027082350",
                            "title": "Huawei BGP Authentication Failures",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "035bb001-ab69-4a0b-9f6c-2de8b09e1b9d",
                        "lookup_data": {
                            "capec": "CAPEC-94",
                            "mitre-attack-id": "T1557",
                            "mitre-cti:description": "Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040) or [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). By abusing features of common networking protocols that can determine the flow of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions.(Citation: Rapid7 MiTM Basics)\n\nFor example, adversaries may manipulate victim DNS settings to enable other malicious activities such as preventing/redirecting users from accessing legitimate sites and/or pushing additional malware.(Citation: ttint_rat)(Citation: dns_changer_trojans)(Citation: ad_blocker_with_miner) Adversaries may also manipulate DNS and leverage their position in order to intercept user credentials and session cookies.(Citation: volexity_0day_sophos_FW) [Downgrade Attack](https://attack.mitre.org/techniques/T1562/010)s can also be used to establish an AiTM position, such as by negotiating a less secure, deprecated, or weaker version of communication protocol (SSL/TLS) or encryption algorithm.(Citation: mitm_tls_downgrade_att)(Citation: taxonomy_downgrade_att_tls)(Citation: tlseminar_downgrade_att)\n\nAdversaries may also leverage the AiTM position to attempt to monitor and/or modify traffic, such as in [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). Adversaries can setup a position similar to AiTM to prevent traffic from flowing to the appropriate destination, potentially to [Impair Defenses](https://attack.mitre.org/techniques/T1562) and/or in support of a [Network Denial of Service](https://attack.mitre.org/techniques/T1498).",
                            "mitre-cti:name": "Adversary-in-the-Middle",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'modified': '2022-10-19T19:51:41.858Z', 'name': 'Adversary-in-the-Middle', 'description': 'Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support follow-on behaviors such as [Network Sniffing](https://attack.mitre.org/techniques/T1040) or [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). By abusing features of common networking protocols that can determine the flow of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions.(Citation: Rapid7 MiTM Basics)\\n\\nFor example, adversaries may manipulate victim DNS settings to enable other malicious activities such as preventing/redirecting users from accessing legitimate sites and/or pushing additional malware.(Citation: ttint_rat)(Citation: dns_changer_trojans)(Citation: ad_blocker_with_miner) Adversaries may also manipulate DNS and leverage their position in order to intercept user credentials and session cookies.(Citation: volexity_0day_sophos_FW) [Downgrade Attack](https://attack.mitre.org/techniques/T1562/010)s can also be used to establish an AiTM position, such as by negotiating a less secure, deprecated, or weaker version of communication protocol (SSL/TLS) or encryption algorithm.(Citation: mitm_tls_downgrade_att)(Citation: taxonomy_downgrade_att_tls)(Citation: tlseminar_downgrade_att)\\n\\nAdversaries may also leverage the AiTM position to attempt to monitor and/or modify traffic, such as in [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002). Adversaries can setup a position similar to AiTM to prevent traffic from flowing to the appropriate destination, potentially to [Impair Defenses](https://attack.mitre.org/techniques/T1562) and/or in support of a [Network Denial of Service](https://attack.mitre.org/techniques/T1498).', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'credential-access'}, {'kill_chain_name': 'mitre-attack', 'phase_name': 'collection'}], 'x_mitre_detection': 'Monitor network traffic for anomalies associated with known AiTM behavior. Consider monitoring for modifications to system configuration files involved in shaping network traffic flow.', 'x_mitre_platforms': ['Windows', 'macOS', 'Linux', 'Network'], 'x_mitre_is_subtechnique': False, 'x_mitre_deprecated': False, 'x_mitre_domains': ['enterprise-attack'], 'x_mitre_version': '2.2', 'x_mitre_contributors': ['Mayuresh Dani, Qualys', 'Daniil Yugoslavskiy, @yugoslavskiy, Atomic Threat Coverage project', 'NEC'], 'x_mitre_data_sources': ['Application Log: Application Log Content', 'Service: Service Creation', 'Network Traffic: Network Traffic Content', 'Network Traffic: Network Traffic Flow', 'Windows Registry: Windows Registry Key Modification'], 'type': 'attack-pattern', 'id': 'attack-pattern--035bb001-ab69-4a0b-9f6c-2de8b09e1b9d', 'created': '2020-02-11T19:07:12.114Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'revoked': False, 'external_references': [{'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/techniques/T1557', 'external_id': 'T1557'}, {'source_name': 'dns_changer_trojans', 'description': 'Abendan, O. (2012, June 14). How DNS Changer Trojans Direct Users to Threats. Retrieved October 28, 2021.', 'url': 'https://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-attack/125/how-dns-changer-trojans-direct-users-to-threats'}, {'source_name': 'volexity_0day_sophos_FW', 'description': 'Adair, S., Lancaster, T., Volexity Threat Research. (2022, June 15). DriftingCloud: Zero-Day Sophos Firewall Exploitation and an Insidious Breach. Retrieved July 1, 2022.', 'url': 'https://www.volexity.com/blog/2022/06/15/driftingcloud-zero-day-sophos-firewall-exploitation-and-an-insidious-breach/'}, {'source_name': 'taxonomy_downgrade_att_tls', 'description': \"Alashwali, E. S., Rasmussen, K. (2019, January 26). What's in a Downgrade? A Taxonomy of Downgrade Attacks in the TLS Protocol and Application Protocols Using TLS. Retrieved December 7, 2021.\", 'url': 'https://arxiv.org/abs/1809.05681'}, {'source_name': 'ad_blocker_with_miner', 'description': 'Kuzmenko, A.. (2021, March 10). Ad blocker with miner included. Retrieved October 28, 2021.', 'url': 'https://securelist.com/ad-blocker-with-miner-included/101105/'}, {'source_name': 'mitm_tls_downgrade_att', 'description': 'praetorian Editorial Team. (2014, August 19). Man-in-the-Middle TLS Protocol Downgrade Attack. Retrieved December 8, 2021.', 'url': 'https://www.praetorian.com/blog/man-in-the-middle-tls-ssl-protocol-downgrade-attack/'}, {'source_name': 'Rapid7 MiTM Basics', 'description': 'Rapid7. (n.d.). Man-in-the-Middle (MITM) Attacks. Retrieved March 2, 2020.', 'url': 'https://www.rapid7.com/fundamentals/man-in-the-middle-attacks/'}, {'source_name': 'tlseminar_downgrade_att', 'description': 'Team Cinnamon. (2017, February 3). Downgrade Attacks. Retrieved December 9, 2021.', 'url': 'https://tlseminar.github.io/downgrade-attacks/'}, {'source_name': 'ttint_rat', 'description': 'Tu, L. Ma, Y. Ye, G. (2020, October 1). Ttint: An IoT Remote Access Trojan spread through 2 0-day vulnerabilities. Retrieved October 28, 2021.', 'url': 'https://blog.netlab.360.com/ttint-an-iot-remote-control-trojan-spread-through-2-0-day-vulnerabilities/'}, {'source_name': 'capec', 'url': 'https://capec.mitre.org/data/definitions/94.html', 'external_id': 'CAPEC-94'}], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'x_mitre_attack_spec_version': '2.1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "c2c76b77-32be-4d1f-82c9-7e544bdfe0eb",
                        "lookup_data": {
                            "description": "Detects potential suspicious behaviour using secedit.exe. Such as exporting or modifying the security policy",
                            "raw": "author: Janantha Marasinghe\ndate: 2022/11/18\ndescription: Detects potential suspicious behaviour using secedit.exe. Such as exporting\n  or modifying the security policy\ndetection:\n  condition: selection_img and (1 of selection_flags_*)\n  selection_flags_configure:\n    CommandLine|contains|all:\n    - /configure\n    - /db\n  selection_flags_discovery:\n    CommandLine|contains|all:\n    - /export\n    - /cfg\n  selection_img:\n  - Image|endswith: \\secedit.exe\n  - OriginalFileName: SeCEdit\nfalsepositives:\n- Legitimate administrative use\nid: c2c76b77-32be-4d1f-82c9-7e544bdfe0eb\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/30\nreferences:\n- https://blueteamops.medium.com/secedit-and-i-know-it-595056dee53d\n- https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/secedit\nstatus: experimental\ntags:\n- attack.discovery\n- attack.persistence\n- attack.defense_evasion\n- attack.credential_access\n- attack.privilege_escalation\n- attack.t1562.002\n- attack.t1547.001\n- attack.t1505.005\n- attack.t1556.002\n- attack.t1562\n- attack.t1574.007\n- attack.t1564.002\n- attack.t1546.008\n- attack.t1546.007\n- attack.t1547.014\n- attack.t1547.010\n- attack.t1547.002\n- attack.t1557\n- attack.t1082\ntitle: Potential Suspicious Activity Using SeCEdit\n",
                            "sigma:id": "c2c76b77-32be-4d1f-82c9-7e544bdfe0eb",
                            "title": "Potential Suspicious Activity Using SeCEdit",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": []
    },
    "timestamp": "2025-02-28 16:23:34"
}