{
    "id": "T1599.001",
    "name": "Network Address Translation Traversal",
    "description": "Adversaries may bridge network boundaries by modifying a network device’s Network Address Translation (NAT) configuration. Malicious modifications to NAT may enable an adversary to bypass restrictions on traffic routing that otherwise separate trusted and untrusted networks.\nNetwork devices such as routers and firewalls that connect multiple networks together may implement NAT during the process of passing packets between networks. When performing NAT, the network device will rewrite the source and/or destination addresses of the IP address header. Some network designs require NAT for the packets to cross the border device.  A typical example of this is environments where internal networks make use of non-Internet routable addresses.(Citation: RFC1918)\nWhen an adversary gains control of a network boundary device, they can either leverage existing NAT configurations to send traffic between two separated networks, or they can implement NAT configurations of their own design.  In the case of network designs that require NAT to function, this enables the adversary to overcome inherent routing limitations that would normally prevent them from accessing protected systems behind the border device.  In the case of network designs that do not require NAT, address translation can be used by adversaries to obscure their activities, as changing the addresses of packets that traverse a network boundary device can make monitoring data transmissions more challenging for defenders.\nAdversaries may use [Patch System Image](T1601.001) to change the operating system of a network device, implementing their own custom NAT mechanisms to further obscure their activities",
    "platforms": "Network",
    "kill_chain_phases": "Defense Evasion",
    "data_sources": "Network Traffic: Network Traffic Flow, Network Traffic: Network Traffic Content",
    "detection": "Consider monitoring network traffic on both interfaces of border network devices.  Compare packets transmitted by the device between networks to look for signs of NAT being implemented.  Packets which have their IP addresses changed should still have the same size and contents in the data encapsulated beyond Layer 3.  In some cases, Port Address Translation (PAT) may also be used by an adversary.\nMonitor the border network device’s configuration to determine if any unintended NAT rules have been added without authorization.",
    "url": "https://attack.mitre.org/techniques/T1599/001",
    "enrichments": {
        "attack_rule_map": [],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "4ffc1794-ec3b-45be-9e52-42dbcb2af2de",
                    "679085d5-f427-4484-9f58-1dc30a7c426d"
                ],
                "lookup_results": [
                    {
                        "uuid": "4ffc1794-ec3b-45be-9e52-42dbcb2af2de",
                        "lookup_data": {
                            "mitre-attack-id": "T1599.001",
                            "mitre-cti:description": "Adversaries may bridge network boundaries by modifying a network device’s Network Address Translation (NAT) configuration. Malicious modifications to NAT may enable an adversary to bypass restrictions on traffic routing that otherwise separate trusted and untrusted networks.\n\nNetwork devices such as routers and firewalls that connect multiple networks together may implement NAT during the process of passing packets between networks. When performing NAT, the network device will rewrite the source and/or destination addresses of the IP address header. Some network designs require NAT for the packets to cross the border device.  A typical example of this is environments where internal networks make use of non-Internet routable addresses.(Citation: RFC1918)\n\nWhen an adversary gains control of a network boundary device, they can either leverage existing NAT configurations to send traffic between two separated networks, or they can implement NAT configurations of their own design.  In the case of network designs that require NAT to function, this enables the adversary to overcome inherent routing limitations that would normally prevent them from accessing protected systems behind the border device.  In the case of network designs that do not require NAT, address translation can be used by adversaries to obscure their activities, as changing the addresses of packets that traverse a network boundary device can make monitoring data transmissions more challenging for defenders.  \n\nAdversaries may use [Patch System Image](https://attack.mitre.org/techniques/T1601/001) to change the operating system of a network device, implementing their own custom NAT mechanisms to further obscure their activities",
                            "mitre-cti:name": "Network Address Translation Traversal",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'x_mitre_platforms': ['Network'], 'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'attack-pattern--4ffc1794-ec3b-45be-9e52-42dbcb2af2de', 'type': 'attack-pattern', 'created': '2020-10-19T16:48:08.241Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'source_name': 'mitre-attack', 'external_id': 'T1599.001', 'url': 'https://attack.mitre.org/techniques/T1599/001'}, {'source_name': 'RFC1918', 'url': 'https://tools.ietf.org/html/rfc1918', 'description': 'IETF Network Working Group. (1996, February). Address Allocation for Private Internets. Retrieved October 20, 2020.'}], 'modified': '2020-10-21T01:45:58.951Z', 'name': 'Network Address Translation Traversal', 'description': 'Adversaries may bridge network boundaries by modifying a network device’s Network Address Translation (NAT) configuration. Malicious modifications to NAT may enable an adversary to bypass restrictions on traffic routing that otherwise separate trusted and untrusted networks.\\n\\nNetwork devices such as routers and firewalls that connect multiple networks together may implement NAT during the process of passing packets between networks. When performing NAT, the network device will rewrite the source and/or destination addresses of the IP address header. Some network designs require NAT for the packets to cross the border device.  A typical example of this is environments where internal networks make use of non-Internet routable addresses.(Citation: RFC1918)\\n\\nWhen an adversary gains control of a network boundary device, they can either leverage existing NAT configurations to send traffic between two separated networks, or they can implement NAT configurations of their own design.  In the case of network designs that require NAT to function, this enables the adversary to overcome inherent routing limitations that would normally prevent them from accessing protected systems behind the border device.  In the case of network designs that do not require NAT, address translation can be used by adversaries to obscure their activities, as changing the addresses of packets that traverse a network boundary device can make monitoring data transmissions more challenging for defenders.  \\n\\nAdversaries may use [Patch System Image](https://attack.mitre.org/techniques/T1601/001) to change the operating system of a network device, implementing their own custom NAT mechanisms to further obscure their activities', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'defense-evasion'}], 'x_mitre_detection': 'Consider monitoring network traffic on both interfaces of border network devices.  Compare packets transmitted by the device between networks to look for signs of NAT being implemented.  Packets which have their IP addresses changed should still have the same size and contents in the data encapsulated beyond Layer 3.  In some cases, Port Address Translation (PAT) may also be used by an adversary.\\n\\nMonitor the border network device’s configuration to determine if any unintended NAT rules have been added without authorization.', 'x_mitre_is_subtechnique': True, 'x_mitre_version': '1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'x_mitre_data_sources': ['Network Traffic: Network Traffic Flow', 'Network Traffic: Network Traffic Content'], 'x_mitre_permissions_required': ['Administrator']}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "679085d5-f427-4484-9f58-1dc30a7c426d",
                        "lookup_data": {
                            "description": "Detects the load of the Windiver driver, a powerful user-mode capture/sniffing/modification/blocking/re-injection package for Windows",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2021/07/30\ndescription: Detects the load of the Windiver driver, a powerful user-mode capture/sniffing/modification/blocking/re-injection\n  package for Windows\ndetection:\n  condition: 1 of selection*\n  selection:\n    ImageLoaded|contains:\n    - \\WinDivert.sys\n    - \\WinDivert64.sys\n    - \\NordDivert.sys\n    - \\lingtiwfp.sys\n    - \\eswfp.sys\n  selection_hashes:\n    Imphash:\n    - 0604bb7cb4bb851e2168d5c7d9399087\n    - 2e5f0e649d97f32b03c09e4686d0574f\n    - 52f8aa269f69f0edad9e8fcdaedce276\n    - c0e5d314da39dbf65a2dbff409cc2c76\n    - 58623490691babe8330adc81cd04a663\n    - 8ee39b48656e4d6b8459d7ba7da7438b\n    - 45ee545ae77e8d43fc70ede9efcd4c96\n    - a1b2e245acd47e4a348e1a552a02859a\n    - 2a5f85fe4609461c6339637594fa9b0a\n    - 6b2c6f95233c2914d1d488ee27531acc\n    - 9f2fdd3f9ab922bbb0560a7df46f4342\n    - d8a719865c448b1bd2ec241e46ac1c88\n    - 0ea54f8c9af4a2fe8367fa457f48ed38\n    - 9d519ae0a0864d6d6ae3f8b6c9c70af6\n    - a74929edfc3289895e3f2885278947ae\n    - a66b476c2d06c370f0a53b5537f2f11e\n    - bdcd836a46bc2415773f6b5ea77a46e4\n    - c28cd6ccd83179e79dac132a553693d9\n  selection_sysmon:\n    Hashes|contains:\n    - IMPHASH=0604bb7cb4bb851e2168d5c7d9399087\n    - IMPHASH=2e5f0e649d97f32b03c09e4686d0574f\n    - IMPHASH=52f8aa269f69f0edad9e8fcdaedce276\n    - IMPHASH=c0e5d314da39dbf65a2dbff409cc2c76\n    - IMPHASH=58623490691babe8330adc81cd04a663\n    - IMPHASH=8ee39b48656e4d6b8459d7ba7da7438b\n    - IMPHASH=45ee545ae77e8d43fc70ede9efcd4c96\n    - IMPHASH=a1b2e245acd47e4a348e1a552a02859a\n    - IMPHASH=2a5f85fe4609461c6339637594fa9b0a\n    - IMPHASH=6b2c6f95233c2914d1d488ee27531acc\n    - IMPHASH=9f2fdd3f9ab922bbb0560a7df46f4342\n    - IMPHASH=d8a719865c448b1bd2ec241e46ac1c88\n    - IMPHASH=0ea54f8c9af4a2fe8367fa457f48ed38\n    - IMPHASH=9d519ae0a0864d6d6ae3f8b6c9c70af6\n    - IMPHASH=a74929edfc3289895e3f2885278947ae\n    - IMPHASH=a66b476c2d06c370f0a53b5537f2f11e\n    - IMPHASH=bdcd836a46bc2415773f6b5ea77a46e4\n    - IMPHASH=c28cd6ccd83179e79dac132a553693d9\nfalsepositives:\n- Legitimate WinDivert driver usage\nid: 679085d5-f427-4484-9f58-1dc30a7c426d\nlevel: high\nlogsource:\n  category: driver_load\n  product: windows\nmodified: 2022/11/19\nreferences:\n- https://reqrypt.org/windivert-doc.html\n- https://rastamouse.me/ntlm-relaying-via-cobalt-strike/\nstatus: experimental\ntags:\n- attack.collection\n- attack.defense_evasion\n- attack.t1599.001\n- attack.t1557.001\ntitle: WinDivert Driver Load\n",
                            "sigma:id": "679085d5-f427-4484-9f58-1dc30a7c426d",
                            "title": "WinDivert Driver Load",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": []
    },
    "timestamp": "2025-02-28 18:45:16"
}