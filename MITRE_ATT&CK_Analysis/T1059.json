{
    "id": "T1059",
    "name": "Command and Scripting Interpreter",
    "description": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](T1059.004) while Windows installations include the [Windows Command Shell](T1059.003) and [PowerShell](T1059.001).\nThere are also cross-platform interpreters such as [Python](T1059.006), as well as those commonly associated with client applications such as [JavaScript](T1059.007) and [Visual Basic](T1059.005).\nAdversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)",
    "platforms": "Linux, macOS, Windows, Network",
    "kill_chain_phases": "Execution",
    "data_sources": "Command: Command Execution, Process: Process Creation, Module: Module Load, Script: Script Execution",
    "detection": "Command-line and scripting activities can be captured through proper logging of process execution with command-line arguments. This information can be useful in gaining additional insight to adversaries' actions through how they use native processes or custom tools. Also monitor for loading of modules associated with specific languages.\nIf scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.\nScripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information discovery, collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script.",
    "url": "https://attack.mitre.org/techniques/T1059",
    "enrichments": {
        "attack_rule_map": [
            {
                "tech_id": "T1059",
                "atomic_attack_guid": "a9b93f17-31cb-435d-a462-5e838a2a6026",
                "atomic_attack_name": "AutoIt Script Execution",
                "platform": "Windows",
                "splunk_rules": [
                    {
                        "rule_name": "Windows AutoIt3 Execution",
                        "rule_link": "https://research.splunk.com/endpoint/0ecb40d9-492b-4a57-9f87-515dd742794c/"
                    }
                ]
            }
        ],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "087790e3-3287-436c-bccf-cbd0184a7db1",
                    "cbb9e3d1-2386-4e59-912e-62f1484f7a89",
                    "5d64d069-0fa0-45a4-bd65-b6f0950d210f",
                    "e3e245fa-1e8e-41db-94d3-6991edd0eaee",
                    "ae9b0bd7-8888-4606-b444-0ed7410cb728",
                    "7b49c990-4a9a-4e65-ba95-47c9cc448f6e",
                    "2b30fa36-3a18-402f-a22d-bf4ce2189f35",
                    "72af37e2-ec32-47dc-992b-bc288a2708cb",
                    "0955e4e1-c281-4fb9-9ee1-5ee7b4b754d2",
                    "8c7090c3-e0a0-4944-bd08-08c3a0cecf79",
                    "313d6012-51a0-4d93-8dfc-de8553239e25",
                    "ba778144-5e3d-40cf-8af9-e28fb1df1e20",
                    "61ab5496-748e-4818-a92f-de78e20fe7f1",
                    "cc4e02ba-9c06-48e2-b09e-2500cace9ae0",
                    "20a5ffa1-3848-4584-b6f8-c7c7fd9f69c8",
                    "5cddf373-ef00-4112-ad72-960ac29bac34",
                    "42333b2c-b425-441c-b70e-99404a17170f",
                    "5e4886b7-3f14-4ab0-867f-4ea30a0a020f",
                    "5dee2bc3-47ac-4784-a52a-4da2950d210f",
                    "5e55be1a-3a30-48ae-9934-4199950d210f",
                    "808146b2-9332-4d78-9416-d7e47012d83d",
                    "6e90ae7a-7cd3-473f-a035-4ebb72d961da",
                    "0319b483-5973-4932-91ea-5a44c2975b24",
                    "a6a39bdb-935c-4f0a-ab77-35f4bbf44d33",
                    "1c373b6d-76ce-4553-997d-8c1da9a6b5f5",
                    "c0b2768a-dd06-4671-8339-b16ca8d1f27f",
                    "7fb14105-530e-4e2e-8cfb-99f7d8700b66",
                    "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                    "84b0a8f3-680b-4096-a45b-e9a89221727c",
                    "5eeec9aa-9d88-4ece-9e6f-9d92884ae404",
                    "b96b2031-7c17-4473-afe7-a30ce714db29",
                    "f426547a-e0f7-441a-b63e-854ac5bdf54d",
                    "8d63dadf-b91b-4187-87b6-34a1114577ea",
                    "899133d5-4d7c-4a7f-94ee-27355c879d90",
                    "033fe7d6-66d1-4240-ac6b-28908009c71f",
                    "1ab3c5ed-5baf-417b-bb6b-78ca33f6c3df",
                    "6bba49bf-7f8c-47d6-a1bb-6b4dece4640e",
                    "5de632bc-7fbd-4c8a-944a-fce55c59eae5",
                    "6e4dcdd1-e48b-42f7-b2d8-3b413fc58cb4",
                    "24549159-ac1b-479c-8175-d42aea947cae",
                    "894397c6-da03-425c-a589-3d09e7d1f750",
                    "5b80cf53-3a46-4adc-960b-05ec19348d74",
                    "5c463bd0-63bc-41f1-91dc-622168f8e8cf",
                    "5d9b5933-964c-433c-b84f-4c680a2fe004",
                    "d81871ef-5738-47ab-9797-7a9c90cd4bfb",
                    "75925535-ca97-4e0a-a850-00b5c00779dc",
                    "c1344fa2-323b-4d2e-9176-84b4d4821c88",
                    "d292e0af-9a18-420c-9525-ec0ac3936892",
                    "234dc5df-40b5-49d1-bf53-0d44ce778eca",
                    "95022b85-ff2a-49fa-939a-d7b8f56eeb9b",
                    "4b991083-3d0e-44ce-8fc4-b254025d8d4b",
                    "eb4ee171-8930-4c15-8917-9af8775417fb",
                    "5a717019-2b96-48ea-aad0-8532d4f1dad2",
                    "d5b9ae7a-e6fc-405e-80ff-2ff9dcc64e7e",
                    "9aa5106d-bce3-4b13-86df-3a20f1d5cf0b",
                    "f8ad2e2c-40b6-4117-84d7-20b89896ab23",
                    "afe52666-401e-4a02-b4ff-5d128990b8cb",
                    "85b0b087-eddf-4a2b-b033-d771fa2b9775",
                    "245f92e3-c4da-45f1-9070-bc552e06db11",
                    "57b649ef-ff42-4fb0-8bf6-62da243a1708",
                    "bdeeabc9-ff2a-4a51-be59-bb253aac7891",
                    "ea9bf0fa-edec-4fb8-8b78-b119f2528186",
                    "480e7e51-e797-47e3-8d72-ebfce65b6d8d",
                    "5e5709a4-8850-453e-9f11-275a0a0a020f",
                    "277a4393-446c-449a-b0ed-7fdc7795244c",
                    "2c28c248-7f50-417a-9186-a85b223010ee",
                    "24c4d154-05a4-4b99-b57d-9b977472443a",
                    "7385dfaf-6886-4229-9ecd-6fd678040830",
                    "846b866e-2a57-46ee-8e16-85fa92759be7",
                    "023394c4-29d5-46ab-92b8-6a534c6f447b",
                    "06b401f4-107c-4ff9-947f-9ec1e7649f1e",
                    "e507feb7-5f73-4ef6-a970-91bb6f6d744f",
                    "5687f942-867b-4578-ade7-1e341c46e99a",
                    "29d31aee-30f4-4006-85a9-a4a02d65306c",
                    "344482e4-a477-436c-aa70-7536d18a48c7",
                    "814c95cc-8192-4378-a70a-f1aafd877af1",
                    "f0b70adb-0075-43b0-9745-e82a1c608fcc",
                    "5e66dd0a-d858-4f9e-b0b2-a7c6950d210f",
                    "1228c958-e64e-4e71-92ad-7d429f4138ba",
                    "178e615d-e666-498b-9630-9ed363038101",
                    "c601f20d-570a-4cde-a7d6-e17f99cb8e7f",
                    "a77c1610-fc73-4019-8e29-0f51efc04a51",
                    "c4042d54-110d-45dd-a0e1-05c47822c937",
                    "c83bf4b5-cdf0-437c-90fa-43d734f7c476",
                    "e212d415-0e93-435f-9e1a-f29005bb4723",
                    "5dbae98e-7974-4480-86db-44be950d210f",
                    "5cf22f74-759c-4744-90eb-4300950d210f",
                    "eca49c87-8a75-4f13-9c73-a5a29e845f03",
                    "f35c5d71-b489-4e22-a115-f003df287317"
                ],
                "lookup_results": [
                    {
                        "uuid": "087790e3-3287-436c-bccf-cbd0184a7db1",
                        "lookup_data": {
                            "description": "detects the usage of path traversal in cmd.exe indicating possible command/argument confusion/hijacking",
                            "raw": "author: xknow @xknow_infosec, Tim Shelton\ndate: 2020/06/11\ndescription: detects the usage of path traversal in cmd.exe indicating possible command/argument\n  confusion/hijacking\ndetection:\n  condition: all of selection_* and not 1 of falsepositive*\n  falsepositive_1:\n    CommandLine|contains: \\Tasktop\\keycloak\\bin\\/../../jre\\bin\\java\n  selection_1:\n  - ParentCommandLine|contains: cmd\n  - ParentImage|endswith: \\cmd.exe\n  selection_2:\n    CommandLine|contains: /../../\n    ParentCommandLine|contains:\n    - /c\n    - /k\n    - /r\nfalsepositives:\n- (not much) some benign Java tools may product false-positive commandlines for loading\n  libraries\nid: 087790e3-3287-436c-bccf-cbd0184a7db1\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/11/18\nreferences:\n- https://hackingiscool.pl/cmdhijack-command-argument-confusion-with-path-traversal-in-cmd-exe/\n- https://twitter.com/Oddvarmoe/status/1270633613449723905\nstatus: test\ntags:\n- attack.execution\n- attack.t1059.003\ntitle: Cmd.exe CommandLine Path Traversal\n",
                            "sigma:id": "087790e3-3287-436c-bccf-cbd0184a7db1",
                            "title": "Cmd.exe CommandLine Path Traversal",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "cbb9e3d1-2386-4e59-912e-62f1484f7a89",
                        "lookup_data": {
                            "description": "Detects when the Console Window Host (conhost.exe) process is spawned by a suspicious parent process, which could be indicative of code injection.",
                            "raw": "author: Tim Rauch\ndate: 2022/09/28\ndescription: Detects when the Console Window Host (conhost.exe) process is spawned\n  by a suspicious parent process, which could be indicative of code injection.\ndetection:\n  condition: selection and not filter\n  filter:\n    ParentCommandLine|contains:\n    - -k apphost -s AppHostSvc\n    - -k imgsvc\n    - -k localService -p -s RemoteRegistry\n    - -k LocalSystemNetworkRestricted -p -s NgcSvc\n    - -k NetSvcs -p -s NcaSvc\n    - -k netsvcs -p -s NetSetupSvc\n    - -k netsvcs -p -s wlidsvc\n    - -k NetworkService -p -s DoSvc\n    - -k wsappx -p -s AppXSvc\n    - -k wsappx -p -s ClipSVC\n    - C:\\Program Files (x86)\\Dropbox\\Client\\\n    - C:\\Program Files\\Dropbox\\Client\\\n  selection:\n    Image|endswith: \\conhost.exe\n    ParentImage|endswith:\n    - \\svchost.exe\n    - \\lsass.exe\n    - \\services.exe\n    - \\smss.exe\n    - \\winlogon.exe\n    - \\explorer.exe\n    - \\rundll32.exe\n    - \\regsvr32.exe\n    - \\userinit.exe\n    - \\wininit.exe\n    - \\spoolsv.exe\nfalsepositives:\n- Unknown\nid: cbb9e3d1-2386-4e59-912e-62f1484f7a89\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/02\nreferences:\n- https://www.elastic.co/guide/en/security/current/conhost-spawned-by-suspicious-parent-process.html\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Conhost Spawned By Suspicious Parent Process\n",
                            "sigma:id": "cbb9e3d1-2386-4e59-912e-62f1484f7a89",
                            "title": "Conhost Spawned By Suspicious Parent Process",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d64d069-0fa0-45a4-bd65-b6f0950d210f",
                        "lookup_data": {
                            "description": "OSINT - Gamaredon group",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5d64d069-0fa0-45a4-bd65-b6f0950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1566995352",
                            "uuid": "5d64d069-0fa0-45a4-bd65-b6f0950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "e3e245fa-1e8e-41db-94d3-6991edd0eaee",
                        "lookup_data": {
                            "description": "Always Another Secret: Lifting the Haze on China-nexus Espionage in Southeast Asia | Mandiant",
                            "link": "http://www.botvrij.eu/data/feed-osint/e3e245fa-1e8e-41db-94d3-6991edd0eaee.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1670434101",
                            "uuid": "e3e245fa-1e8e-41db-94d3-6991edd0eaee",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ae9b0bd7-8888-4606-b444-0ed7410cb728",
                        "lookup_data": {
                            "description": "Monitors for the hiding possible malicious files in the C:\\Windows\\Fonts\\ location. This folder doesn't require admin privillege to be written and executed from.",
                            "raw": "author: Sreeman\ndate: 2020/04/21\ndescription: Monitors for the hiding possible malicious files in the C:\\Windows\\Fonts\\\n  location. This folder doesn't require admin privillege to be written and executed\n  from.\ndetection:\n  condition: all of selection_*\n  selection_1:\n    CommandLine|contains:\n    - echo\n    - copy\n    - type\n    - file createnew\n    - cacls\n  selection_2:\n    CommandLine|contains: C:\\Windows\\Fonts\\\n  selection_3:\n    CommandLine|contains:\n    - .sh\n    - .exe\n    - .dll\n    - .bin\n    - .bat\n    - .cmd\n    - .js\n    - .msh\n    - .reg\n    - .scr\n    - .ps\n    - .vb\n    - .jar\n    - .pl\n    - '.inf'\n    - .cpl\n    - .hta\n    - .msi\n    - .vbs\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\n- ParentProcess\n- CommandLine\nid: ae9b0bd7-8888-4606-b444-0ed7410cb728\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/03/08\nreferences:\n- https://thedfirreport.com/2020/04/20/sqlserver-or-the-miner-in-the-basement/\nstatus: test\ntags:\n- attack.t1211\n- attack.t1059\n- attack.defense_evasion\n- attack.persistence\ntitle: Writing Of Malicious Files To The Fonts Folder\n",
                            "sigma:id": "ae9b0bd7-8888-4606-b444-0ed7410cb728",
                            "title": "Writing Of Malicious Files To The Fonts Folder",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "7b49c990-4a9a-4e65-ba95-47c9cc448f6e",
                        "lookup_data": {
                            "description": "Detects different loaders as described in various threat reports on Lazarus group activity",
                            "raw": "author: Florian Roth (Nextron Systems), wagga\ndate: 2020/12/23\ndescription: Detects different loaders as described in various threat reports on Lazarus\n  group activity\ndetection:\n  condition: ( selection_cmd1 and selection_cmd2 ) or ( selection_rundll1 and selection_rundll2\n    )\n  selection_cmd1:\n    CommandLine|contains|all:\n    - 'cmd.exe /c '\n    - ' -p 0x'\n  selection_cmd2:\n    CommandLine|contains:\n    - C:\\ProgramData\\\n    - C:\\RECYCLER\\\n  selection_rundll1:\n    CommandLine|contains|all:\n    - 'rundll32.exe '\n    - C:\\ProgramData\\\n  selection_rundll2:\n    CommandLine|contains:\n    - .bin,\n    - .tmp,\n    - .dat,\n    - .io,\n    - .ini,\n    - .db,\nfalsepositives:\n- Unknown\nid: 7b49c990-4a9a-4e65-ba95-47c9cc448f6e\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/06/27\nreferences:\n- https://www.hvs-consulting.de/lazarus-report/\n- https://securelist.com/lazarus-covets-covid-19-related-intelligence/99906/\nstatus: test\ntags:\n- attack.g0032\n- attack.execution\n- attack.t1059\ntitle: Lazarus Loaders\n",
                            "sigma:id": "7b49c990-4a9a-4e65-ba95-47c9cc448f6e",
                            "title": "Lazarus Loaders",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "2b30fa36-3a18-402f-a22d-bf4ce2189f35",
                        "lookup_data": {
                            "description": "Detects activity that could be related to Baby Shark malware",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2019/02/24\ndescription: Detects activity that could be related to Baby Shark malware\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains:\n    - reg query \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\"\n    - powershell.exe mshta.exe http\n    - cmd.exe /c taskkill /im cmd.exe\nfalsepositives:\n- Unknown\nid: 2b30fa36-3a18-402f-a22d-bf4ce2189f35\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/11/11\nreferences:\n- https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/\nstatus: test\ntags:\n- attack.execution\n- attack.t1059.003\n- attack.t1059.001\n- attack.discovery\n- attack.t1012\n- attack.defense_evasion\n- attack.t1218.005\ntitle: Baby Shark Activity\n",
                            "sigma:id": "2b30fa36-3a18-402f-a22d-bf4ce2189f35",
                            "title": "Baby Shark Activity",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "72af37e2-ec32-47dc-992b-bc288a2708cb",
                        "lookup_data": {
                            "description": "Identifies when a new cloudshell is created inside of Azure portal.",
                            "raw": "author: Austin Songer\ndate: 2021/09/21\ndescription: Identifies when a new cloudshell is created inside of Azure portal.\ndetection:\n  condition: selection\n  selection:\n    operationName: MICROSOFT.PORTAL/CONSOLES/WRITE\nfalsepositives:\n- A new cloudshell may be created by a system administrator.\nid: 72af37e2-ec32-47dc-992b-bc288a2708cb\nlevel: medium\nlogsource:\n  product: azure\n  service: activitylogs\nmodified: 2022/08/23\nreferences:\n- https://docs.microsoft.com/en-us/azure/role-based-access-control/resource-provider-operations\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Azure New CloudShell Created\n",
                            "sigma:id": "72af37e2-ec32-47dc-992b-bc288a2708cb",
                            "title": "Azure New CloudShell Created",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "0955e4e1-c281-4fb9-9ee1-5ee7b4b754d2",
                        "lookup_data": {
                            "description": "Detects execition of commands and binaries from the context of The program compatibility assistant (Pcalua.exe). This can be used as a LOLBIN in order to bypass application whitelisting.",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems), E.M. Anhaus (originally from Atomic\n  Blue Detections, Endgame), oscd.community\ndate: 2022/06/14\ndescription: Detects execition of commands and binaries from the context of The program\n  compatibility assistant (Pcalua.exe). This can be used as a LOLBIN in order to bypass\n  application whitelisting.\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains: ' -a'\n    Image|endswith: \\pcalua.exe\nfalsepositives:\n- Legitimate use by a via a batch script or by an administrator.\nid: 0955e4e1-c281-4fb9-9ee1-5ee7b4b754d2\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/04\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/Pcalua/\n- https://pentestlab.blog/2020/07/06/indirect-command-execution/\nrelated:\n- id: fa47597e-90e9-41cd-ab72-c3b74cfb0d02\n  type: obsoletes\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Use of Pcalua For Execution\n",
                            "sigma:id": "0955e4e1-c281-4fb9-9ee1-5ee7b4b754d2",
                            "title": "Use of Pcalua For Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "8c7090c3-e0a0-4944-bd08-08c3a0cecf79",
                        "lookup_data": {
                            "description": "Detects TropicTrooper activity, an actor who targeted high-profile organizations in the energy and food and beverage sectors in Asia",
                            "raw": "author: '@41thexplorer, Microsoft Defender ATP'\ndate: 2019/11/12\ndescription: Detects TropicTrooper activity, an actor who targeted high-profile organizations\n  in the energy and food and beverage sectors in Asia\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains: abCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCc\nid: 8c7090c3-e0a0-4944-bd08-08c3a0cecf79\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2020/08/27\nreferences:\n- https://cloudblogs.microsoft.com/microsoftsecure/2018/11/28/windows-defender-atp-device-risk-score-exposes-new-cyberattack-drives-conditional-access-to-protect-networks/\nstatus: stable\ntags:\n- attack.execution\n- attack.t1059.001\ntitle: TropicTrooper Campaign November 2018\n",
                            "sigma:id": "8c7090c3-e0a0-4944-bd08-08c3a0cecf79",
                            "title": "TropicTrooper Campaign November 2018",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "313d6012-51a0-4d93-8dfc-de8553239e25",
                        "lookup_data": {
                            "description": "Detects usage of winget to install applications via manifest file. Adversaries can abuse winget to download payloads remotely and execute them without touching disk. The manifest option enables you to install an application by passing in a YAML file directly to the client. Winget can be used to download and install exe's, msi, msix files later.",
                            "raw": "author: Sreeman, Florian Roth (Nextron Systems), Frack113\ndate: 2020/04/21\ndescription: Detects usage of winget to install applications via manifest file. Adversaries\n  can abuse winget to download payloads remotely and execute them without touching\n  disk. The manifest option enables you to install an application by passing in a\n  YAML file directly to the client. Winget can be used to download and install exe's,\n  msi, msix files later.\ndetection:\n  condition: all of selection_*\n  selection_img:\n  - Image|endswith: \\winget.exe\n  - OriginalFileName: winget.exe\n  selection_install_flag:\n    CommandLine|contains: install\n  selection_manifest_flag:\n    CommandLine|contains:\n    - '-m '\n    - --manifest\nfalsepositives:\n- Admin activity installing packages not in the official Microsoft repo. Winget probably\n  won't be used by most users.\nid: 313d6012-51a0-4d93-8dfc-de8553239e25\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/03\nreferences:\n- https://docs.microsoft.com/en-us/windows/package-manager/winget/install#local-install\n- https://lolbas-project.github.io/lolbas/Binaries/Winget/\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.execution\n- attack.t1059\ntitle: Monitoring Winget For LOLbin Execution\n",
                            "sigma:id": "313d6012-51a0-4d93-8dfc-de8553239e25",
                            "title": "Monitoring Winget For LOLbin Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ba778144-5e3d-40cf-8af9-e28fb1df1e20",
                        "lookup_data": {
                            "description": "Detects Trojan loader activity as used by APT28",
                            "raw": "author: Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community\ndate: 2018/03/01\ndescription: Detects Trojan loader activity as used by APT28\ndetection:\n  condition: all of selection*\n  selection1:\n    CommandLine|contains|all:\n    - rundll32.exe\n    - '%APPDATA%\\'\n  selection2:\n  - CommandLine|contains: .dat\",\n  - CommandLine|endswith:\n    - .dll\",#1\n    - '.dll #1'\n    - '.dll\" #1'\nfalsepositives:\n- Unknown\nid: ba778144-5e3d-40cf-8af9-e28fb1df1e20\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/07/07\nreferences:\n- https://researchcenter.paloaltonetworks.com/2018/02/unit42-sofacy-attacks-multiple-government-entities/\n- https://www.reverse.it/sample/e3399d4802f9e6d6d539e3ae57e7ea9a54610a7c4155a6541df8e94d67af086e?environmentId=100\n- https://twitter.com/ClearskySec/status/960924755355369472\nstatus: test\ntags:\n- attack.g0007\n- attack.execution\n- attack.t1059.003\n- attack.defense_evasion\n- car.2013-10-002\n- attack.t1218.011\ntitle: Sofacy Trojan Loader Activity\n",
                            "sigma:id": "ba778144-5e3d-40cf-8af9-e28fb1df1e20",
                            "title": "Sofacy Trojan Loader Activity",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "61ab5496-748e-4818-a92f-de78e20fe7f1",
                        "lookup_data": {
                            "description": "Detects multiple suspicious process in a limited timeframe",
                            "raw": "author: juju4\ndate: 2019/01/16\ndescription: Detects multiple suspicious process in a limited timeframe\ndetection:\n  condition: selection | count() by MachineName > 5\n  selection:\n    CommandLine|contains:\n    - arp.exe\n    - at.exe\n    - attrib.exe\n    - cscript.exe\n    - dsquery.exe\n    - hostname.exe\n    - ipconfig.exe\n    - mimikatz.exe\n    - nbtstat.exe\n    - net.exe\n    - netsh.exe\n    - nslookup.exe\n    - ping.exe\n    - quser.exe\n    - qwinsta.exe\n    - reg.exe\n    - runas.exe\n    - sc.exe\n    - schtasks.exe\n    - ssh.exe\n    - systeminfo.exe\n    - taskkill.exe\n    - telnet.exe\n    - tracert.exe\n    - wscript.exe\n    - xcopy.exe\n    - pscp.exe\n    - copy.exe\n    - robocopy.exe\n    - certutil.exe\n    - vssadmin.exe\n    - powershell.exe\n    - pwsh.exe\n    - wevtutil.exe\n    - psexec.exe\n    - bcedit.exe\n    - wbadmin.exe\n    - icacls.exe\n    - diskpart.exe\n  timeframe: 5m\nfalsepositives:\n- False positives depend on scripts and administrative tools used in the monitored\n  environment\nid: 61ab5496-748e-4818-a92f-de78e20fe7f1\nlevel: low\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/07/14\nreferences:\n- https://car.mitre.org/wiki/CAR-2013-04-002\nstatus: experimental\ntags:\n- car.2013-04-002\n- attack.execution\n- attack.t1059\ntitle: Quick Execution of a Series of Suspicious Commands\n",
                            "sigma:id": "61ab5496-748e-4818-a92f-de78e20fe7f1",
                            "title": "Quick Execution of a Series of Suspicious Commands",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "cc4e02ba-9c06-48e2-b09e-2500cace9ae0",
                        "lookup_data": {
                            "description": "The Tasks folder in system32 and syswow64 are globally writable paths.\nAdversaries can take advantage of this and load or influence any script hosts or ANY .NET Application \nin Tasks to load and execute a custom assembly into cscript, wscript, regsvr32, mshta, eventvwr\n",
                            "raw": "author: Sreeman\ndate: 2020/01/13\ndescription: \"The Tasks folder in system32 and syswow64 are globally writable paths.\\n\\\n  Adversaries can take advantage of this and load or influence any script hosts or\\\n  \\ ANY .NET Application \\nin Tasks to load and execute a custom assembly into cscript,\\\n  \\ wscript, regsvr32, mshta, eventvwr\\n\"\ndetection:\n  condition: all of selection*\n  selection1:\n    CommandLine|contains:\n    - 'echo '\n    - 'copy '\n    - 'type '\n    - file createnew\n  selection2:\n    CommandLine|contains:\n    - ' C:\\Windows\\System32\\Tasks\\'\n    - ' C:\\Windows\\SysWow64\\Tasks\\'\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\n- ParentProcess\nid: cc4e02ba-9c06-48e2-b09e-2500cace9ae0\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/25\nreferences:\n- https://twitter.com/subTee/status/1216465628946563073\n- https://gist.github.com/am0nsec/8378da08f848424e4ab0cc5b317fdd26\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.persistence\n- attack.execution\n- attack.t1574.002\ntitle: Tasks Folder Evasion\n",
                            "sigma:id": "cc4e02ba-9c06-48e2-b09e-2500cace9ae0",
                            "title": "Tasks Folder Evasion",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "20a5ffa1-3848-4584-b6f8-c7c7fd9f69c8",
                        "lookup_data": {
                            "description": "Detects execution of ruby using the \"-e\" flag. This is could be used as a way to launch a reverse shell or execute live ruby code.",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023/01/02\ndescription: Detects execution of ruby using the \"-e\" flag. This is could be used\n  as a way to launch a reverse shell or execute live ruby code.\ndetection:\n  condition: all of selection_*\n  selection_cli:\n    CommandLine|contains: ' -e'\n  selection_img:\n  - Image|endswith: \\ruby.exe\n  - OriginalFileName: ruby.exe\nfalsepositives:\n- Unknown\nid: 20a5ffa1-3848-4584-b6f8-c7c7fd9f69c8\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet\n- https://www.revshells.com/\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Ruby Inline Command Execution\n",
                            "sigma:id": "20a5ffa1-3848-4584-b6f8-c7c7fd9f69c8",
                            "title": "Ruby Inline Command Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5cddf373-ef00-4112-ad72-960ac29bac34",
                        "lookup_data": {
                            "description": "Detects command line parameters used by Koadic hack tool",
                            "raw": "author: wagga, Jonhnathan Ribeiro, oscd.community\ndate: 2020/01/12\ndescription: Detects command line parameters used by Koadic hack tool\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - /q\n    - /c\n    - chcp\n    Image|endswith: \\cmd.exe\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\n- ParentCommandLine\nid: 5cddf373-ef00-4112-ad72-960ac29bac34\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/01/07\nreferences:\n- https://unit42.paloaltonetworks.com/unit42-sofacy-groups-parallel-attacks/\n- https://github.com/offsecginger/koadic/blob/457f9a3ff394c989cdb4c599ab90eb34fb2c762c/data/stager/js/stdlib.js\n- https://blog.f-secure.com/hunting-for-koadic-a-com-based-rootkit/\nstatus: test\ntags:\n- attack.execution\n- attack.t1059.003\n- attack.t1059.005\n- attack.t1059.007\ntitle: Koadic Execution\n",
                            "sigma:id": "5cddf373-ef00-4112-ad72-960ac29bac34",
                            "title": "Koadic Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "42333b2c-b425-441c-b70e-99404a17170f",
                        "lookup_data": {
                            "description": "Detects process activity patterns as seen being used by Sliver C2 framework implants",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems), Florian Roth\ndate: 2022/08/25\ndescription: Detects process activity patterns as seen being used by Sliver C2 framework\n  implants\ndetection:\n  condition: 1 of selection*\n  selection_cmdline:\n    CommandLine|contains: -NoExit -Command [Console]::OutputEncoding=[Text.UTF8Encoding]::UTF8\nfalsepositives:\n- Unlikely\nid: 42333b2c-b425-441c-b70e-99404a17170f\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/BishopFox/sliver/blob/79f2d48fcdfc2bee4713b78d431ea4b27f733f30/implant/sliver/shell/shell_windows.go#L36\n- https://www.microsoft.com/security/blog/2022/08/24/looking-for-the-sliver-lining-hunting-for-emerging-command-and-control-frameworks/\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Sliver C2 Implant Activity Pattern\n",
                            "sigma:id": "42333b2c-b425-441c-b70e-99404a17170f",
                            "title": "Sliver C2 Implant Activity Pattern",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5e4886b7-3f14-4ab0-867f-4ea30a0a020f",
                        "lookup_data": {
                            "description": "IRS Doc Malware",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5e4886b7-3f14-4ab0-867f-4ea30a0a020f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1621850643",
                            "uuid": "5e4886b7-3f14-4ab0-867f-4ea30a0a020f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5dee2bc3-47ac-4784-a52a-4da2950d210f",
                        "lookup_data": {
                            "description": "OSINT - BfV Cyber-Brief Nr. 01/2019 - Hinweis auf aktuelle Angriffskampagne -",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5dee2bc3-47ac-4784-a52a-4da2950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1576068623",
                            "uuid": "5dee2bc3-47ac-4784-a52a-4da2950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5e55be1a-3a30-48ae-9934-4199950d210f",
                        "lookup_data": {
                            "description": "Interesting Recon Script",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5e55be1a-3a30-48ae-9934-4199950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1582912038",
                            "uuid": "5e55be1a-3a30-48ae-9934-4199950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "808146b2-9332-4d78-9416-d7e47012d83d",
                        "lookup_data": {
                            "description": "detects BPFDoor .lock and .pid files access in temporary file storage facility",
                            "raw": "author: Rafal Piasecki\ndate: 2022/08/10\ndescription: detects BPFDoor .lock and .pid files access in temporary file storage\n  facility\ndetection:\n  condition: selection\n  selection:\n    name:\n    - /var/run/haldrund.pid\n    - /var/run/xinetd.lock\n    - /var/run/kdevrund.pid\n    type: PATH\nfalsepositives:\n- Unlikely\nid: 808146b2-9332-4d78-9416-d7e47012d83d\nlevel: high\nlogsource:\n  product: linux\n  service: auditd\nreferences:\n- https://www.sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/\n- https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1106\n- attack.t1059\ntitle: BPFDoor Abnormal Process ID or Lock File Accessed\n",
                            "sigma:id": "808146b2-9332-4d78-9416-d7e47012d83d",
                            "title": "BPFDoor Abnormal Process ID or Lock File Accessed",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "6e90ae7a-7cd3-473f-a035-4ebb72d961da",
                        "lookup_data": {
                            "description": "Detects processes creating temp files related to PCRE.NET package",
                            "raw": "author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2020/10/29\ndescription: Detects processes creating temp files related to PCRE.NET package\ndetection:\n  condition: selection\n  selection:\n    TargetFilename|contains: \\AppData\\Local\\Temp\\ba9ea7344a4a5f591d6e5dc32a13494b\\\nfalsepositives:\n- Unknown\nid: 6e90ae7a-7cd3-473f-a035-4ebb72d961da\nlevel: high\nlogsource:\n  category: file_event\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://twitter.com/rbmaslen/status/1321859647091970051\n- https://twitter.com/tifkin_/status/1321916444557365248\nstatus: test\ntags:\n- attack.execution\n- attack.t1059\ntitle: PCRE.NET Package Temp Files\n",
                            "sigma:id": "6e90ae7a-7cd3-473f-a035-4ebb72d961da",
                            "title": "PCRE.NET Package Temp Files",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "0319b483-5973-4932-91ea-5a44c2975b24",
                        "lookup_data": {
                            "description": "Conti Ransomware",
                            "link": "http://www.botvrij.eu/data/feed-osint/0319b483-5973-4932-91ea-5a44c2975b24.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1621181463",
                            "uuid": "0319b483-5973-4932-91ea-5a44c2975b24",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "a6a39bdb-935c-4f0a-ab77-35f4bbf44d33",
                        "lookup_data": {
                            "description": "Detects a suspicious script executions from temporary folder",
                            "raw": "author: Florian Roth (Nextron Systems), Max Altgelt (Nextron Systems), Tim Shelton\ndate: 2021/07/14\ndescription: Detects a suspicious script executions from temporary folder\ndetection:\n  condition: selection and not filter\n  filter:\n    CommandLine|contains:\n    - ' >'\n    - Out-File\n    - ConvertTo-Json\n    - -WindowStyle hidden -Verb runAs\n    - \\Windows\\system32\\config\\systemprofile\\AppData\\Local\\Temp\\Amazon\\EC2-Windows\\\n  selection:\n    CommandLine|contains:\n    - \\Windows\\Temp\n    - \\Temporary Internet\n    - \\AppData\\Local\\Temp\n    - \\AppData\\Roaming\\Temp\n    - '%TEMP%'\n    - '%TMP%'\n    - '%LocalAppData%\\Temp'\n    Image|endswith:\n    - \\powershell.exe\n    - \\pwsh.exe\n    - \\mshta.exe\n    - \\wscript.exe\n    - \\cscript.exe\nfalsepositives:\n- Administrative scripts\nid: a6a39bdb-935c-4f0a-ab77-35f4bbf44d33\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/10/05\nreferences:\n- https://www.microsoft.com/security/blog/2021/07/13/microsoft-discovers-threat-actor-targeting-solarwinds-serv-u-software-with-0-day-exploit/\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Suspicious Script Execution From Temp Folder\n",
                            "sigma:id": "a6a39bdb-935c-4f0a-ab77-35f4bbf44d33",
                            "title": "Suspicious Script Execution From Temp Folder",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "1c373b6d-76ce-4553-997d-8c1da9a6b5f5",
                        "lookup_data": {
                            "description": "Detects exploitation attempt of privilege escalation vulnerability via SetupComplete.cmd and PartnerSetupComplete.cmd described in CVE-2019-1378",
                            "raw": "author: Florian Roth (Nextron Systems), oscd.community, Jonhnathan Ribeiro\ndate: 2019/11/15\ndescription: Detects exploitation attempt of privilege escalation vulnerability via\n  SetupComplete.cmd and PartnerSetupComplete.cmd described in CVE-2019-1378\ndetection:\n  condition: selection and not filter\n  filter:\n    Image|startswith:\n    - C:\\Windows\\System32\\\n    - C:\\Windows\\SysWOW64\\\n    - C:\\Windows\\WinSxS\\\n    - C:\\Windows\\Setup\\\n  selection:\n    ParentCommandLine|contains|all:\n    - \\cmd.exe\n    - /c\n    - C:\\Windows\\Setup\\Scripts\\\n    ParentCommandLine|endswith:\n    - SetupComplete.cmd\n    - PartnerSetupComplete.cmd\nfalsepositives:\n- Unknown\nid: 1c373b6d-76ce-4553-997d-8c1da9a6b5f5\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://www.embercybersecurity.com/blog/cve-2019-1378-exploiting-an-access-control-privilege-escalation-vulnerability-in-windows-10-update-assistant-wua\nstatus: test\ntags:\n- attack.privilege_escalation\n- attack.t1068\n- attack.execution\n- attack.t1059.003\n- attack.t1574\n- cve.2019.1378\ntitle: Exploiting SetupComplete.cmd CVE-2019-1378\n",
                            "sigma:id": "1c373b6d-76ce-4553-997d-8c1da9a6b5f5",
                            "title": "Exploiting SetupComplete.cmd CVE-2019-1378",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "c0b2768a-dd06-4671-8339-b16ca8d1f27f",
                        "lookup_data": {
                            "description": "A symbolic link is a type of file that contains a reference to another file.\nThis is probably done to make sure that the ransomware is able to follow shortcuts on the machine in order to find the original file to encrypt\n",
                            "raw": "author: frack113\ndate: 2022/03/02\ndescription: 'A symbolic link is a type of file that contains a reference to another\n  file.\n\n  This is probably done to make sure that the ransomware is able to follow shortcuts\n  on the machine in order to find the original file to encrypt\n\n  '\ndetection:\n  condition: all of selection_*\n  selection_cli:\n    CommandLine|contains|all:\n    - 'behavior '\n    - 'set '\n    - SymlinkEvaluation\n  selection_img:\n  - Image|endswith: \\fsutil.exe\n  - OriginalFileName: fsutil.exe\nfalsepositives:\n- Legitimate use\nid: c0b2768a-dd06-4671-8339-b16ca8d1f27f\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/19\nreferences:\n- https://www.cybereason.com/blog/cybereason-vs.-blackcat-ransomware\n- https://docs.microsoft.com/fr-fr/windows-server/administration/windows-commands/fsutil-behavior\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Fsutil Behavior Set SymlinkEvaluation\n",
                            "sigma:id": "c0b2768a-dd06-4671-8339-b16ca8d1f27f",
                            "title": "Fsutil Behavior Set SymlinkEvaluation",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "7fb14105-530e-4e2e-8cfb-99f7d8700b66",
                        "lookup_data": {
                            "description": "Detects spawning of suspicious child processes by Atlassian Confluence server which may indicate successful exploitation of CVE-2022-26134",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/06/03\ndescription: Detects spawning of suspicious child processes by Atlassian Confluence\n  server which may indicate successful exploitation of CVE-2022-26134\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains:\n    - /bin/sh\n    - bash\n    - dash\n    - ksh\n    - zsh\n    - csh\n    - fish\n    - curl\n    - wget\n    - python\n    ParentImage|endswith: /java\n    ParentImage|startswith: /opt/atlassian/confluence/\nfalsepositives:\n- Unknown\nid: 7fb14105-530e-4e2e-8cfb-99f7d8700b66\nlevel: high\nlogsource:\n  category: process_creation\n  product: linux\nreferences:\n- https://www.volexity.com/blog/2022/06/02/zero-day-exploitation-of-atlassian-confluence/\nrelated:\n- id: 245f92e3-c4da-45f1-9070-bc552e06db11\n  type: derived\nstatus: experimental\ntags:\n- attack.initial_access\n- attack.execution\n- attack.t1190\n- attack.t1059\n- cve.2022.26134\ntitle: Atlassian Confluence CVE-2022-26134\n",
                            "sigma:id": "7fb14105-530e-4e2e-8cfb-99f7d8700b66",
                            "title": "Atlassian Confluence CVE-2022-26134",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                        "lookup_data": {
                            "description": "SectorJ04 Groupâ€™s Increased Activity in 2019",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5d6e7aa3-aca4-46cc-b96a-46ac950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1568039252",
                            "uuid": "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "84b0a8f3-680b-4096-a45b-e9a89221727c",
                        "lookup_data": {
                            "description": "Detects processes loading modules related to PCRE.NET package",
                            "raw": "author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2020/10/29\ndescription: Detects processes loading modules related to PCRE.NET package\ndetection:\n  condition: selection\n  selection:\n    ImageLoaded|contains: \\AppData\\Local\\Temp\\ba9ea7344a4a5f591d6e5dc32a13494b\\\nfalsepositives:\n- Unknown\nid: 84b0a8f3-680b-4096-a45b-e9a89221727c\nlevel: high\nlogsource:\n  category: image_load\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://twitter.com/rbmaslen/status/1321859647091970051\n- https://twitter.com/tifkin_/status/1321916444557365248\nstatus: test\ntags:\n- attack.execution\n- attack.t1059\ntitle: PCRE.NET Package Image Load\n",
                            "sigma:id": "84b0a8f3-680b-4096-a45b-e9a89221727c",
                            "title": "PCRE.NET Package Image Load",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5eeec9aa-9d88-4ece-9e6f-9d92884ae404",
                        "lookup_data": {
                            "description": "Dissecting PlugX to Extract Its Crown Jewels",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5eeec9aa-9d88-4ece-9e6f-9d92884ae404.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1663580963",
                            "uuid": "5eeec9aa-9d88-4ece-9e6f-9d92884ae404",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b96b2031-7c17-4473-afe7-a30ce714db29",
                        "lookup_data": {
                            "description": "The FSharp Interpreters, FsiAnyCpu.exe and FSi.exe, can be used for AWL bypass and is listed in Microsoft recommended block rules.",
                            "raw": "author: Christopher Peacock @SecurePeacock, SCYTHE @scythe_io\ndate: 2022/06/02\ndescription: The FSharp Interpreters, FsiAnyCpu.exe and FSi.exe, can be used for AWL\n  bypass and is listed in Microsoft recommended block rules.\ndetection:\n  condition: selection\n  selection:\n  - Image|endswith: \\fsianycpu.exe\n  - OriginalFileName: fsianycpu.exe\n  - Image|endswith: \\fsi.exe\n  - OriginalFileName: fsi.exe\nfalsepositives:\n- Legitimate use by a software developer.\nid: b96b2031-7c17-4473-afe7-a30ce714db29\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules\n- https://bohops.com/2020/11/02/exploring-the-wdac-microsoft-recommended-block-rules-part-ii-wfc-fsi/\n- https://lolbas-project.github.io/lolbas/OtherMSBinaries/FsiAnyCpu/\n- https://lolbas-project.github.io/lolbas/OtherMSBinaries/Fsi/\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Use of FSharp Interpreters\n",
                            "sigma:id": "b96b2031-7c17-4473-afe7-a30ce714db29",
                            "title": "Use of FSharp Interpreters",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f426547a-e0f7-441a-b63e-854ac5bdf54d",
                        "lookup_data": {
                            "description": "Detects execution of perl using the \"-e\"/\"-E\" flags. This is could be used as a way to launch a reverse shell or execute live perl code.",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023/01/02\ndescription: Detects execution of perl using the \"-e\"/\"-E\" flags. This is could be\n  used as a way to launch a reverse shell or execute live perl code.\ndetection:\n  condition: all of selection_*\n  selection_cli:\n    CommandLine|contains: ' -e'\n  selection_img:\n  - Image|endswith: \\perl.exe\n  - OriginalFileName: perl.exe\nfalsepositives:\n- Unknown\nid: f426547a-e0f7-441a-b63e-854ac5bdf54d\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet\n- https://www.revshells.com/\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Perl Inline Command Execution\n",
                            "sigma:id": "f426547a-e0f7-441a-b63e-854ac5bdf54d",
                            "title": "Perl Inline Command Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "8d63dadf-b91b-4187-87b6-34a1114577ea",
                        "lookup_data": {
                            "description": "Detects WMI SquiblyTwo Attack with possible renamed WMI by looking for imphash",
                            "raw": "author: Markus Neis, Florian Roth\ndate: 2019/01/16\ndescription: Detects WMI SquiblyTwo Attack with possible renamed WMI by looking for\n  imphash\ndetection:\n  condition: all of selection_org_* or all of selection_renamed_*\n  selection_org_cli:\n    CommandLine|contains|all:\n    - wmic\n    - format\n    - http\n  selection_org_img:\n  - Image|endswith: \\wmic.exe\n  - OriginalFileName: wmic.exe\n  selection_renamed_flags:\n    CommandLine|contains|all:\n    - 'format:'\n    - http\n  selection_renamed_wmic_imphash:\n  - Imphash:\n    - 1B1A3F43BF37B5BFE60751F2EE2F326E\n    - 37777A96245A3C74EB217308F3546F4C\n    - 9D87C9D67CE724033C0B40CC4CA1B206\n  - Hashes|contains:\n    - IMPHASH=1B1A3F43BF37B5BFE60751F2EE2F326E\n    - IMPHASH=37777A96245A3C74EB217308F3546F4C\n    - IMPHASH=9D87C9D67CE724033C0B40CC4CA1B206\nfalsepositives:\n- Unknown\nid: 8d63dadf-b91b-4187-87b6-34a1114577ea\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/11/11\nreferences:\n- https://subt0x11.blogspot.ch/2018/04/wmicexe-whitelisting-bypass-hacking.html\n- https://twitter.com/mattifestation/status/986280382042595328\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1047\n- attack.t1220\n- attack.execution\n- attack.t1059.005\n- attack.t1059.007\ntitle: SquiblyTwo Execution\n",
                            "sigma:id": "8d63dadf-b91b-4187-87b6-34a1114577ea",
                            "title": "SquiblyTwo Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "899133d5-4d7c-4a7f-94ee-27355c879d90",
                        "lookup_data": {
                            "description": "Detects execution of python using the \"-c\" flag. This is could be used as a way to launch a reverse shell or execute live python code.",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023/01/02\ndescription: Detects execution of python using the \"-c\" flag. This is could be used\n  as a way to launch a reverse shell or execute live python code.\ndetection:\n  condition: all of selection_* and not 1 of filter_*\n  filter_python:\n    ParentImage|endswith: \\python.exe\n    ParentImage|startswith: C:\\Program Files\\Python\n  filter_vscode:\n    ParentImage|endswith: \\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe\n  selection_cli:\n    CommandLine|contains: ' -c'\n  selection_img:\n  - Image|endswith:\n    - python.exe\n    - python3.exe\n    - python2.exe\n  - OriginalFileName: python.exe\nfalsepositives:\n- Unknown\nid: 899133d5-4d7c-4a7f-94ee-27355c879d90\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/10\nreferences:\n- https://docs.python.org/3/using/cmdline.html#cmdoption-c\n- https://www.revshells.com/\n- https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Python Inline Command Execution\n",
                            "sigma:id": "899133d5-4d7c-4a7f-94ee-27355c879d90",
                            "title": "Python Inline Command Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "033fe7d6-66d1-4240-ac6b-28908009c71f",
                        "lookup_data": {
                            "description": "This method detects a suspicious PowerShell command line combination as used by APT29 in a campaign against U.S. think tanks.",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2018/12/04\ndescription: This method detects a suspicious PowerShell command line combination\n  as used by APT29 in a campaign against U.S. think tanks.\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - -noni\n    - -ep\n    - bypass\n    - $\nfalsepositives:\n- Unknown\nid: 033fe7d6-66d1-4240-ac6b-28908009c71f\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://www.microsoft.com/security/blog/2018/12/03/analysis-of-cyberattack-on-u-s-think-tanks-non-profits-public-sector-by-unidentified-attackers/\n- https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html\nstatus: test\ntags:\n- attack.execution\n- attack.g0016\n- attack.t1059.001\ntitle: APT29\n",
                            "sigma:id": "033fe7d6-66d1-4240-ac6b-28908009c71f",
                            "title": "APT29",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "1ab3c5ed-5baf-417b-bb6b-78ca33f6c3df",
                        "lookup_data": {
                            "description": "Detects changes to the EC2 instance startup script. The shell script will be executed as root/SYSTEM every time the specific instances are booted up.",
                            "raw": "author: faloker\ndate: 2020/02/12\ndescription: Detects changes to the EC2 instance startup script. The shell script\n  will be executed as root/SYSTEM every time the specific instances are booted up.\ndetection:\n  condition: selection_source\n  selection_source:\n    eventName: ModifyInstanceAttribute\n    eventSource: ec2.amazonaws.com\n    requestParameters.attribute: userData\nfalsepositives:\n- Valid changes to the startup script\nid: 1ab3c5ed-5baf-417b-bb6b-78ca33f6c3df\nlevel: high\nlogsource:\n  product: aws\n  service: cloudtrail\nmodified: 2022/06/07\nreferences:\n- https://github.com/RhinoSecurityLabs/pacu/blob/866376cd711666c775bbfcde0524c817f2c5b181/pacu/modules/ec2__startup_shell_script/main.py#L9\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059.001\n- attack.t1059.003\n- attack.t1059.004\ntitle: AWS EC2 Startup Shell Script Change\n",
                            "sigma:id": "1ab3c5ed-5baf-417b-bb6b-78ca33f6c3df",
                            "title": "AWS EC2 Startup Shell Script Change",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "6bba49bf-7f8c-47d6-a1bb-6b4dece4640e",
                        "lookup_data": {
                            "description": "Detects suspicious process related to rasdial.exe",
                            "raw": "author: juju4\ndate: 2019/01/16\ndescription: Detects suspicious process related to rasdial.exe\ndetection:\n  condition: selection\n  selection:\n    Image|endswith: rasdial.exe\nfalsepositives:\n- False positives depend on scripts and administrative tools used in the monitored\n  environment\nid: 6bba49bf-7f8c-47d6-a1bb-6b4dece4640e\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://twitter.com/subTee/status/891298217907830785\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.execution\n- attack.t1059\ntitle: Suspicious RASdial Activity\n",
                            "sigma:id": "6bba49bf-7f8c-47d6-a1bb-6b4dece4640e",
                            "title": "Suspicious RASdial Activity",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5de632bc-7fbd-4c8a-944a-fce55c59eae5",
                        "lookup_data": {
                            "description": "Detects process command line patterns and locations used by REvil group in Kaseya incident (can also match on other malware)",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2021/07/03\ndescription: Detects process command line patterns and locations used by REvil group\n  in Kaseya incident (can also match on other malware)\ndetection:\n  condition: 1 of selection*\n  selection1:\n    CommandLine|contains:\n    - C:\\Windows\\cert.exe\n    - del /q /f c:\\kworking\\agent.crt\n    - Kaseya VSA Agent Hot-fix\n    - \\AppData\\Local\\Temp\\MsMpEng.exe\n    - rmdir /s /q %SystemDrive%\\inetpub\\logs\n    - del /s /q /f %SystemDrive%\\\\*.log\n    - c:\\kworking1\\agent.exe\n    - c:\\kworking1\\agent.crt\n  selection2:\n    Image:\n    - C:\\Windows\\MsMpEng.exe\n    - C:\\Windows\\cert.exe\n    - C:\\kworking\\agent.exe\n    - C:\\kworking1\\agent.exe\n  selection3:\n    CommandLine|contains|all:\n    - del /s /q /f\n    - WebPages\\Errors\\webErrorLog.txt\nfalsepositives:\n- Unknown\nid: 5de632bc-7fbd-4c8a-944a-fce55c59eae5\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/05/20\nreferences:\n- https://community.sophos.com/b/security-blog/posts/active-ransomware-attack-on-kaseya-customers\n- https://www.joesandbox.com/analysis/443736/0/html\n- https://doublepulsar.com/kaseya-supply-chain-attack-delivers-mass-ransomware-event-to-us-companies-76e4ec6ec64b\n- https://therecord.media/revil-ransomware-executes-supply-chain-attack-via-malicious-kaseya-update/\n- https://blog.truesec.com/2021/07/04/kaseya-supply-chain-attack-targeting-msps-to-deliver-revil-ransomware/\nstatus: test\ntags:\n- attack.execution\n- attack.t1059\n- attack.g0115\ntitle: REvil Kaseya Incident Malware Patterns\n",
                            "sigma:id": "5de632bc-7fbd-4c8a-944a-fce55c59eae5",
                            "title": "REvil Kaseya Incident Malware Patterns",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "6e4dcdd1-e48b-42f7-b2d8-3b413fc58cb4",
                        "lookup_data": {
                            "description": "Detects when the macOS Script Editor utility spawns an unusual child process.",
                            "raw": "author: Tim Rauch (rule), Elastic (idea)\ndate: 2022/10/21\ndescription: Detects when the macOS Script Editor utility spawns an unusual child\n  process.\ndetection:\n  condition: all of selection_*\n  selection_img:\n  - Image|endswith:\n    - /curl\n    - /bash\n    - /sh\n    - /zsh\n    - /dash\n    - /fish\n    - /osascript\n    - /mktemp\n    - /chmod\n    - /php\n    - /nohup\n    - /openssl\n    - /plutil\n    - /PlistBuddy\n    - /xattr\n    - /sqlite\n    - /funzip\n    - /popen\n  - Image|contains:\n    - python\n    - perl\n  selection_parent:\n    ParentImage|endswith: /Script Editor\nfalsepositives:\n- Unknown\nid: 6e4dcdd1-e48b-42f7-b2d8-3b413fc58cb4\nlevel: medium\nlogsource:\n  category: process_creation\n  product: macos\nmodified: 2022/12/28\nreferences:\n- https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-7f541fbc4a4a28a92970e8bf53effea5bd934604429112c920affb457f5b2685\n- https://wojciechregula.blog/post/macos-red-teaming-initial-access-via-applescript-url/\nstatus: experimental\ntags:\n- attack.t1566\n- attack.t1566.002\n- attack.initial_access\n- attack.t1059\n- attack.t1059.002\n- attack.t1204\n- attack.t1204.001\n- attack.execution\n- attack.persistence\n- attack.t1553\n- attack.defense_evasion\ntitle: Suspicious Execution via macOS Script Editor\n",
                            "sigma:id": "6e4dcdd1-e48b-42f7-b2d8-3b413fc58cb4",
                            "title": "Suspicious Execution via macOS Script Editor",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "24549159-ac1b-479c-8175-d42aea947cae",
                        "lookup_data": {
                            "description": "This events that are generated when using the hacktool Ruler by Sensepost",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/05/31\ndescription: This events that are generated when using the hacktool Ruler by Sensepost\ndetection:\n  condition: (1 of selection*)\n  selection1:\n    EventID: 4776\n    Workstation: RULER\n  selection2:\n    EventID:\n    - 4624\n    - 4625\n    WorkstationName: RULER\nfalsepositives:\n- Go utilities that use staaldraad awesome NTLM library\nid: 24549159-ac1b-479c-8175-d42aea947cae\nlevel: high\nlogsource:\n  product: windows\n  service: security\nmodified: 2022/10/09\nreferences:\n- https://github.com/sensepost/ruler\n- https://github.com/sensepost/ruler/issues/47\n- https://github.com/staaldraad/go-ntlm/blob/cd032d41aa8ce5751c07cb7945400c0f5c81e2eb/ntlm/ntlmv1.go#L427\n- https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4776\n- https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4624\nstatus: test\ntags:\n- attack.discovery\n- attack.execution\n- attack.t1087\n- attack.t1114\n- attack.t1059\n- attack.t1550.002\ntitle: Hacktool Ruler\n",
                            "sigma:id": "24549159-ac1b-479c-8175-d42aea947cae",
                            "title": "Hacktool Ruler",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "894397c6-da03-425c-a589-3d09e7d1f750",
                        "lookup_data": {
                            "description": "Detects a suspicious process pattern found in CVE-2021-40444 exploitation",
                            "raw": "author: '@neonprimetime, Florian Roth'\ndate: 2021/09/08\ndescription: Detects a suspicious process pattern found in CVE-2021-40444 exploitation\ndetection:\n  condition: selection and not filter\n  filter:\n    CommandLine|endswith:\n    - \\control.exe input.dll\n    - \\control.exe\" input.dll\n  selection:\n    Image|endswith: \\control.exe\n    ParentImage|endswith:\n    - \\winword.exe\n    - \\powerpnt.exe\n    - \\excel.exe\nfalsepositives:\n- Unknown\nid: 894397c6-da03-425c-a589-3d09e7d1f750\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/03/03\nreferences:\n- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444\n- https://twitter.com/neonprimetime/status/1435584010202255375\n- https://www.joesandbox.com/analysis/476188/1/iochtml\nstatus: test\ntags:\n- attack.execution\n- attack.t1059\ntitle: CVE-2021-40444 Process Pattern\n",
                            "sigma:id": "894397c6-da03-425c-a589-3d09e7d1f750",
                            "title": "CVE-2021-40444 Process Pattern",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5b80cf53-3a46-4adc-960b-05ec19348d74",
                        "lookup_data": {
                            "description": "Detects Wscript or Cscript executing from a drive other than C. This has been observed with Qakbot executing from within a mounted ISO file.",
                            "raw": "author: Aaron Herman\ndate: 2022/10/01\ndescription: Detects Wscript or Cscript executing from a drive other than C. This\n  has been observed with Qakbot executing from within a mounted ISO file.\ndetection:\n  condition: all of selection_* and not 1 of filter_*\n  filter_drive_path:\n    CommandLine|contains:\n    - ' C:\\\\'\n    - ' ''C:\\'\n    - ' \"C:\\\\'\n  filter_env_vars:\n    CommandLine|contains: '%'\n  filter_unc_paths:\n    CommandLine|contains: ' \\\\\\\\'\n  selection_drive_path:\n    CommandLine|contains: :\\\n  selection_exetensions:\n    CommandLine|contains:\n    - .js\n    - .vbs\n    - .vbe\n  selection_lolbin:\n    Image|endswith:\n    - \\wscript.exe\n    - \\cscript.exe\nfalsepositives:\n- Legitimate applications installed on other partitions such as \"D:\"\nid: 5b80cf53-3a46-4adc-960b-05ec19348d74\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/pr0xylife/Qakbot/blob/main/Qakbot_BB_30.09.2022.txt\n- https://app.any.run/tasks/4985c746-601e-401a-9ccf-ae350ac2e887/\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Wscript Execution from Non C Drive\n",
                            "sigma:id": "5b80cf53-3a46-4adc-960b-05ec19348d74",
                            "title": "Wscript Execution from Non C Drive",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5c463bd0-63bc-41f1-91dc-622168f8e8cf",
                        "lookup_data": {
                            "description": "2019-01-21: APT28 Autoit Zebrocy Progression",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5c463bd0-63bc-41f1-91dc-622168f8e8cf.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1621849993",
                            "uuid": "5c463bd0-63bc-41f1-91dc-622168f8e8cf",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d9b5933-964c-433c-b84f-4c680a2fe004",
                        "lookup_data": {
                            "description": "Emotet in Depth TTP 10-07-19",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5d9b5933-964c-433c-b84f-4c680a2fe004.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1621850615",
                            "uuid": "5d9b5933-964c-433c-b84f-4c680a2fe004",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d81871ef-5738-47ab-9797-7a9c90cd4bfb",
                        "lookup_data": {
                            "description": "Detects execution of php using the \"-r\" flag. This is could be used as a way to launch a reverse shell or execute live php code.",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023/01/02\ndescription: Detects execution of php using the \"-r\" flag. This is could be used as\n  a way to launch a reverse shell or execute live php code.\ndetection:\n  condition: all of selection_*\n  selection_cli:\n    CommandLine|contains: ' -r'\n  selection_img:\n  - Image|endswith: \\php.exe\n  - OriginalFileName: php.exe\nfalsepositives:\n- Unknown\nid: d81871ef-5738-47ab-9797-7a9c90cd4bfb\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://www.php.net/manual/en/features.commandline.php\n- https://www.revshells.com/\n- https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Php Inline Command Execution\n",
                            "sigma:id": "d81871ef-5738-47ab-9797-7a9c90cd4bfb",
                            "title": "Php Inline Command Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "75925535-ca97-4e0a-a850-00b5c00779dc",
                        "lookup_data": {
                            "description": "Detects automated lateral movement by Turla group",
                            "raw": "author: Markus Neis\ndate: 2017/11/07\ndescription: Detects automated lateral movement by Turla group\ndetection:\n  condition: netCommand1 | near netCommand2 and netCommand3\n  netCommand1:\n    CommandLine: net view /DOMAIN\n  netCommand2:\n    CommandLine: net session\n  netCommand3:\n    CommandLine: net share\n  timeframe: 1m\nfalsepositives:\n- Unknown\nid: 75925535-ca97-4e0a-a850-00b5c00779dc\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/02\nreferences:\n- https://securelist.com/the-epic-turla-operation/65545/\nstatus: test\ntags:\n- attack.g0010\n- attack.execution\n- attack.t1059\n- attack.lateral_movement\n- attack.t1021.002\n- attack.discovery\n- attack.t1083\n- attack.t1135\ntitle: Automated Turla Group Lateral Movement\n",
                            "sigma:id": "75925535-ca97-4e0a-a850-00b5c00779dc",
                            "title": "Automated Turla Group Lateral Movement",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "c1344fa2-323b-4d2e-9176-84b4d4821c88",
                        "lookup_data": {
                            "description": "Detects modifications to the Windows Defender configuration settings using PowerShell to add exclusions",
                            "raw": "author: Tim Rauch\ndate: 2022/09/16\ndescription: Detects modifications to the Windows Defender configuration settings\n  using PowerShell to add exclusions\ndetection:\n  condition: all of selection*\n  selection_args_exc:\n    ScriptBlockText|contains:\n    - ' -ExclusionPath '\n    - ' -ExclusionExtension '\n    - ' -ExclusionProcess '\n    - ' -ExclusionIpAddress '\n  selection_args_pref:\n    ScriptBlockText|contains:\n    - 'Add-MpPreference '\n    - 'Set-MpPreference '\nfalsepositives:\n- Unknown\nid: c1344fa2-323b-4d2e-9176-84b4d4821c88\nlevel: medium\nlogsource:\n  category: ps_script\n  definition: 'Requirements: Script Block Logging must be enabled'\n  product: windows\nmodified: 2022/11/26\nreferences:\n- https://www.elastic.co/guide/en/security/current/windows-defender-exclusions-added-via-powershell.html\nrelated:\n- id: 17769c90-230e-488b-a463-e05c08e9d48f\n  type: similar\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1562\n- attack.execution\n- attack.t1059\ntitle: Windows Defender Exclusions Added - PowerShell\n",
                            "sigma:id": "c1344fa2-323b-4d2e-9176-84b4d4821c88",
                            "title": "Windows Defender Exclusions Added - PowerShell",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d292e0af-9a18-420c-9525-ec0ac3936892",
                        "lookup_data": {
                            "description": "Detects java process spawning suspicious children",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/06/03\ndescription: Detects java process spawning suspicious children\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains:\n    - /bin/sh\n    - bash\n    - dash\n    - ksh\n    - zsh\n    - csh\n    - fish\n    - curl\n    - wget\n    - python\n    ParentImage|endswith: /java\nfalsepositives:\n- Unknown\nid: d292e0af-9a18-420c-9525-ec0ac3936892\nlevel: high\nlogsource:\n  category: process_creation\n  product: linux\nreferences:\n- https://www.tecmint.com/different-types-of-linux-shells/\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Suspicious Java Children Processes\n",
                            "sigma:id": "d292e0af-9a18-420c-9525-ec0ac3936892",
                            "title": "Suspicious Java Children Processes",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "234dc5df-40b5-49d1-bf53-0d44ce778eca",
                        "lookup_data": {
                            "description": "Detects when a built-in utility is used to decode and decrypt a payload after a macOS disk image (DMG) is executed. Malware authors may attempt to evade detection and trick users into executing malicious code by encoding and encrypting their payload and placing it in a disk image file. This behavior is consistent with adware or malware families such as Bundlore and Shlayer.",
                            "raw": "author: Tim Rauch (rule), Elastic (idea)\ndate: 2022/10/17\ndescription: Detects when a built-in utility is used to decode and decrypt a payload\n  after a macOS disk image (DMG) is executed. Malware authors may attempt to evade\n  detection and trick users into executing malicious code by encoding and encrypting\n  their payload and placing it in a disk image file. This behavior is consistent with\n  adware or malware families such as Bundlore and Shlayer.\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - /Volumes/\n    - enc\n    - -base64\n    - ' -d '\n    Image|endswith: /openssl\nfalsepositives:\n- Unknown\nid: 234dc5df-40b5-49d1-bf53-0d44ce778eca\nlevel: medium\nlogsource:\n  category: process_creation\n  product: macos\nreferences:\n- https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-5d42c3d772e04f1e8d0eb60f5233bc79def1ea73105a2d8822f44164f77ef823\nstatus: experimental\ntags:\n- attack.t1059\n- attack.t1204\n- attack.execution\n- attack.t1140\n- attack.defense_evasion\n- attack.s0482\n- attack.s0402\ntitle: Payload Decoded and Decrypted via Built-in Utilities\n",
                            "sigma:id": "234dc5df-40b5-49d1-bf53-0d44ce778eca",
                            "title": "Payload Decoded and Decrypted via Built-in Utilities",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "95022b85-ff2a-49fa-939a-d7b8f56eeb9b",
                        "lookup_data": {
                            "description": "Detects actions caused by the RedMimicry Winnti playbook",
                            "raw": "author: Alexander Rausch\ndate: 2020/06/24\ndescription: Detects actions caused by the RedMimicry Winnti playbook\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains:\n    - gthread-3.6.dll\n    - \\Windows\\Temp\\tmp.bat\n    - sigcmm-2.4.dll\n    Image|endswith:\n    - \\rundll32.exe\n    - \\cmd.exe\nfalsepositives:\n- Unknown\nid: 95022b85-ff2a-49fa-939a-d7b8f56eeb9b\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/30\nreferences:\n- https://redmimicry.com/posts/redmimicry-winnti/\nstatus: test\ntags:\n- attack.execution\n- attack.defense_evasion\n- attack.t1106\n- attack.t1059.003\n- attack.t1218.011\ntitle: RedMimicry Winnti Playbook Execution\n",
                            "sigma:id": "95022b85-ff2a-49fa-939a-d7b8f56eeb9b",
                            "title": "RedMimicry Winnti Playbook Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4b991083-3d0e-44ce-8fc4-b254025d8d4b",
                        "lookup_data": {
                            "description": "Detects suspicious parent process for cmd.exe",
                            "raw": "author: Tim Rauch\ndate: 2022/09/21\ndescription: Detects suspicious parent process for cmd.exe\ndetection:\n  condition: selection\n  selection:\n    Image|endswith: \\cmd.exe\n    ParentImage|endswith:\n    - \\lsass.exe\n    - \\csrss.exe\n    - \\epad.exe\n    - \\regsvr32.exe\n    - \\dllhost.exe\n    - \\LogonUI.exe\n    - \\wergmgr.exe\n    - \\spoolsv.exe\n    - \\jucheck.exe\n    - \\jusched.exe\n    - \\ctfmon.exe\n    - \\taskhostw.exe\n    - \\GoogleUpdate.exe\n    - \\sppsvc.exe\n    - \\sihost.exe\n    - \\slui.exe\n    - \\SIHClient.exe\n    - \\SearchIndexer.exe\n    - \\SearchProtocolHost.exe\n    - \\FlashPlayerUpdateService.exe\n    - \\WerFault.exe\n    - \\WUDFHost.exe\n    - \\unsecapp.exe\n    - \\wlanext.exe\nfalsepositives:\n- Unknown\nid: 4b991083-3d0e-44ce-8fc4-b254025d8d4b\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://www.elastic.co/guide/en/security/current/unusual-parent-process-for-cmd.exe.html\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Unusual Parent Process for cmd.exe\n",
                            "sigma:id": "4b991083-3d0e-44ce-8fc4-b254025d8d4b",
                            "title": "Unusual Parent Process for cmd.exe",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "eb4ee171-8930-4c15-8917-9af8775417fb",
                        "lookup_data": {
                            "description": "CERT-FR report extended - sandworm intrusion set campaign targeting Centreon systems",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/eb4ee171-8930-4c15-8917-9af8775417fb.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1613463604",
                            "uuid": "eb4ee171-8930-4c15-8917-9af8775417fb",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5a717019-2b96-48ea-aad0-8532d4f1dad2",
                        "lookup_data": {
                            "description": "Return of the Evilnum APT with updated TTPs and new targets",
                            "link": "http://www.botvrij.eu/data/feed-osint/5a717019-2b96-48ea-aad0-8532d4f1dad2.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1656703958",
                            "uuid": "5a717019-2b96-48ea-aad0-8532d4f1dad2",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d5b9ae7a-e6fc-405e-80ff-2ff9dcc64e7e",
                        "lookup_data": {
                            "description": "Detects suspicious sysprep process start with AppData folder as target (as used by Trojan Syndicasec in Thrip report by Symantec)",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2018/06/22\ndescription: Detects suspicious sysprep process start with AppData folder as target\n  (as used by Trojan Syndicasec in Thrip report by Symantec)\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains: \\AppData\\\n    Image|endswith: \\sysprep.exe\nfalsepositives:\n- False positives depend on scripts and administrative tools used in the monitored\n  environment\nid: d5b9ae7a-e6fc-405e-80ff-2ff9dcc64e7e\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets\n- https://app.any.run/tasks/61a296bb-81ad-4fee-955f-3b399f4aaf4b\nstatus: test\ntags:\n- attack.execution\n- attack.t1059\ntitle: Sysprep on AppData Folder\n",
                            "sigma:id": "d5b9ae7a-e6fc-405e-80ff-2ff9dcc64e7e",
                            "title": "Sysprep on AppData Folder",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "9aa5106d-bce3-4b13-86df-3a20f1d5cf0b",
                        "lookup_data": {
                            "description": "Execute commands and binaries from the context of \"forfiles\". This is used as a LOLBIN for example to bypass application whitelisting.",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/06/14\ndescription: Execute commands and binaries from the context of \"forfiles\". This is\n  used as a LOLBIN for example to bypass application whitelisting.\ndetection:\n  condition: all of selection*\n  selection_cli_c:\n    CommandLine|contains:\n    - ' /c '\n    - ' -c '\n  selection_cli_m:\n    CommandLine|contains:\n    - ' /m '\n    - ' -m '\n  selection_cli_p:\n    CommandLine|contains:\n    - ' /p '\n    - ' -p '\n  selection_img:\n  - Image|endswith: \\forfiles.exe\n  - OriginalFileName: forfiles.exe\nfalsepositives:\n- Legitimate use via a batch script or by an administrator.\nid: 9aa5106d-bce3-4b13-86df-3a20f1d5cf0b\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/Forfiles/\n- https://pentestlab.blog/2020/07/06/indirect-command-execution/\nrelated:\n- id: a85cf4e3-56ee-4e79-adeb-789f8fb209a8\n  type: obsoletes\n- id: fa47597e-90e9-41cd-ab72-c3b74cfb0d02\n  type: obsoletes\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Use of Forfiles For Execution\n",
                            "sigma:id": "9aa5106d-bce3-4b13-86df-3a20f1d5cf0b",
                            "title": "Use of Forfiles For Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f8ad2e2c-40b6-4117-84d7-20b89896ab23",
                        "lookup_data": {
                            "description": "Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system",
                            "raw": "author: frack113\ndate: 2022/03/12\ndescription: Adversaries may attempt to get a listing of other systems by IP address,\n  hostname, or other logical identifier on a network that may be used for Lateral\n  Movement from the current system\ndetection:\n  condition: all of selection_*\n  selection_loop:\n    CommandLine|contains:\n    - 'for '\n    - 'foreach '\n  selection_tools:\n    CommandLine|contains:\n    - nslookup\n    - ping\nfalsepositives:\n- Legitimate script\nid: f8ad2e2c-40b6-4117-84d7-20b89896ab23\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1018/T1018.md\n- https://ss64.com/nt/for.html\n- https://ss64.com/ps/foreach-object.htmll\nstatus: test\ntags:\n- attack.execution\n- attack.t1059\n- attack.discovery\n- attack.t1018\ntitle: Suspicious Scan Loop Network\n",
                            "sigma:id": "f8ad2e2c-40b6-4117-84d7-20b89896ab23",
                            "title": "Suspicious Scan Loop Network",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "afe52666-401e-4a02-b4ff-5d128990b8cb",
                        "lookup_data": {
                            "description": "Detects RAR usage that creates an archive from a suspicious folder, either a system folder or one of the folders often used by attackers for staging purposes",
                            "raw": "author: X__Junior, Florian Roth\ndate: 2022/12/15\ndescription: Detects RAR usage that creates an archive from a suspicious folder, either\n  a system folder or one of the folders often used by attackers for staging purposes\ndetection:\n  condition: 1 of selection_opt_* and all of selection_cli_*\n  selection_cli_flags:\n    CommandLine|contains|all:\n    - ' -hp'\n    - ' -r '\n  selection_cli_folders:\n    CommandLine|contains:\n    - ' C:\\\\\\*.'\n    - ' C:\\\\\\\\\\*.'\n    - ' C:\\Users\\Public\\'\n    - ' %public%'\n    - ' C:\\Windows\\'\n    - ' C:\\PerfLogs\\'\n    - ' C:\\Temp'\n    - ' C:\\$Recycle.bin\\'\n  selection_opt_1:\n  - Image|endswith: \\rar.exe\n  - Description: Command line RAR\n  selection_opt_2:\n    CommandLine|contains:\n    - '.exe a '\n    - ' a -m'\nfalsepositives:\n- Unknown\nid: afe52666-401e-4a02-b4ff-5d128990b8cb\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://decoded.avast.io/martinchlumecky/png-steganography\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: RAR Greedy Compression\n",
                            "sigma:id": "afe52666-401e-4a02-b4ff-5d128990b8cb",
                            "title": "RAR Greedy Compression",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "85b0b087-eddf-4a2b-b033-d771fa2b9775",
                        "lookup_data": {
                            "description": "Detects suspicious ways to download files or content and execute them using PowerShell Invoke-Expression",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/03/24\ndescription: Detects suspicious ways to download files or content and execute them\n  using PowerShell Invoke-Expression\ndetection:\n  condition: all of selection_*\n  selection_download:\n    CommandLine|contains:\n    - .DownloadString(\n    - .DownloadFile(\n    - 'Invoke-WebRequest '\n    - 'iwr '\n  selection_iex:\n    CommandLine|contains:\n    - IEX(\n    - IEX (\n    - I`EX\n    - IE`X\n    - I`E`X\n    - '| IEX'\n    - '|IEX '\n    - Invoke-Expression\n    - ;iex $\nfalsepositives:\n- Scripts or tools that download files and execute them\nid: 85b0b087-eddf-4a2b-b033-d771fa2b9775\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/05\nreferences:\n- https://github.com/VirtualAlllocEx/Payload-Download-Cradles/blob/88e8eca34464a547c90d9140d70e9866dcbc6a12/Download-Cradles.cmd\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: PowerShell Web Download and Execution\n",
                            "sigma:id": "85b0b087-eddf-4a2b-b033-d771fa2b9775",
                            "title": "PowerShell Web Download and Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "245f92e3-c4da-45f1-9070-bc552e06db11",
                        "lookup_data": {
                            "description": "Detects spawning of suspicious child processes by Atlassian Confluence server which may indicate successful exploitation of CVE-2021-26084",
                            "raw": "author: Bhabesh Raj\ndate: 2021/09/08\ndescription: Detects spawning of suspicious child processes by Atlassian Confluence\n  server which may indicate successful exploitation of CVE-2021-26084\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains:\n    - cmd /c\n    - cmd /k\n    - powershell\n    - certutil\n    - curl\n    - whoami\n    - ipconfig\n    ParentImage|endswith: \\Atlassian\\Confluence\\jre\\bin\\java.exe\nfalsepositives:\n- Unknown\nid: 245f92e3-c4da-45f1-9070-bc552e06db11\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://nvd.nist.gov/vuln/detail/CVE-2021-26084\n- https://confluence.atlassian.com/doc/confluence-security-advisory-2021-08-25-1077906215.html\n- https://github.com/h3v0x/CVE-2021-26084_Confluence\nstatus: test\ntags:\n- attack.initial_access\n- attack.execution\n- attack.t1190\n- attack.t1059\ntitle: Atlassian Confluence CVE-2021-26084\n",
                            "sigma:id": "245f92e3-c4da-45f1-9070-bc552e06db11",
                            "title": "Atlassian Confluence CVE-2021-26084",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "57b649ef-ff42-4fb0-8bf6-62da243a1708",
                        "lookup_data": {
                            "description": "Detects all actions taken by Windows Defender malware detection engines",
                            "raw": "author: \"J\\xE1n Tren\\u010Dansk\\xFD\"\ndate: 2020/07/28\ndescription: Detects all actions taken by Windows Defender malware detection engines\ndetection:\n  condition: selection\n  selection:\n    EventID:\n    - 1006\n    - 1116\n    - 1015\n    - 1117\nfalsepositives:\n- Unlikely\nid: 57b649ef-ff42-4fb0-8bf6-62da243a1708\nlevel: high\nlogsource:\n  product: windows\n  service: windefend\nreferences:\n- https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-antivirus/troubleshoot-windows-defender-antivirus\nstatus: stable\ntags:\n- attack.execution\n- attack.t1059\ntitle: Windows Defender Threat Detected\n",
                            "sigma:id": "57b649ef-ff42-4fb0-8bf6-62da243a1708",
                            "title": "Windows Defender Threat Detected",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "bdeeabc9-ff2a-4a51-be59-bb253aac7891",
                        "lookup_data": {
                            "description": "Detects usage of wsudo (Windows Sudo Utility). Which is a tool that let the user execute programs with different permissions (System, Trusted Installer, Administrator...etc)",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/12/02\ndescription: Detects usage of wsudo (Windows Sudo Utility). Which is a tool that let\n  the user execute programs with different permissions (System, Trusted Installer,\n  Administrator...etc)\ndetection:\n  condition: 1 of selection_*\n  selection_cli:\n    CommandLine|contains:\n    - -u System\n    - -uSystem\n    - -u TrustedInstaller\n    - -uTrustedInstaller\n    - ' --ti '\n  selection_metadata:\n  - Image|endswith: \\wsudo.exe\n  - OriginalFileName: wsudo.exe\n  - Description: Windows sudo utility\n  - ParentImage|endswith: \\wsudo-bridge.exe\nfalsepositives:\n- Unknown\nid: bdeeabc9-ff2a-4a51-be59-bb253aac7891\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/M2Team/Privexec/\nstatus: experimental\ntags:\n- attack.execution\n- attack.privilege_escalation\n- attack.t1059\ntitle: Wsudo Suspicious Execution\n",
                            "sigma:id": "bdeeabc9-ff2a-4a51-be59-bb253aac7891",
                            "title": "Wsudo Suspicious Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ea9bf0fa-edec-4fb8-8b78-b119f2528186",
                        "lookup_data": {
                            "description": "Detects triggering of AMSI by Windows Defender.",
                            "raw": "author: Bhabesh Raj\ndate: 2020/09/14\ndescription: Detects triggering of AMSI by Windows Defender.\ndetection:\n  condition: selection\n  selection:\n    EventID: 1116\n    SourceName: AMSI\nfalsepositives:\n- Unlikely\nid: ea9bf0fa-edec-4fb8-8b78-b119f2528186\nlevel: high\nlogsource:\n  product: windows\n  service: windefend\nmodified: 2022/12/07\nreferences:\n- https://docs.microsoft.com/en-us/windows/win32/amsi/how-amsi-helps\nstatus: stable\ntags:\n- attack.execution\n- attack.t1059\ntitle: Windows Defender AMSI Trigger Detected\n",
                            "sigma:id": "ea9bf0fa-edec-4fb8-8b78-b119f2528186",
                            "title": "Windows Defender AMSI Trigger Detected",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "480e7e51-e797-47e3-8d72-ebfce65b6d8d",
                        "lookup_data": {
                            "description": "Detects python spawning a pretty tty",
                            "raw": "author: Nextron Systems\ndate: 2022/06/03\ndescription: Detects python spawning a pretty tty\ndetection:\n  condition: selection_image and 1 of selection_cli*\n  selection_cli1:\n    CommandLine|contains|all:\n    - import pty\n    - .spawn(\n  selection_cli2:\n    CommandLine|contains: from pty import spawn\n  selection_image:\n    Image|endswith:\n    - python.exe\n    - python3.exe\n    - python2.exe\nfalsepositives:\n- Unknown\nid: 480e7e51-e797-47e3-8d72-ebfce65b6d8d\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://www.volexity.com/blog/2022/06/02/zero-day-exploitation-of-atlassian-confluence/\nrelated:\n- id: 899133d5-4d7c-4a7f-94ee-27355c879d90\n  type: derived\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Python Spawning Pretty TTY on Windows\n",
                            "sigma:id": "480e7e51-e797-47e3-8d72-ebfce65b6d8d",
                            "title": "Python Spawning Pretty TTY on Windows",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5e5709a4-8850-453e-9f11-275a0a0a020f",
                        "lookup_data": {
                            "description": "Racoon Stealer",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5e5709a4-8850-453e-9f11-275a0a0a020f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1621850670",
                            "uuid": "5e5709a4-8850-453e-9f11-275a0a0a020f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "277a4393-446c-449a-b0ed-7fdc7795244c",
                        "lookup_data": {
                            "description": "Detects execution of renamed ftp.exe binary based on OriginalFileName field",
                            "raw": "author: Victor Sergeev, oscd.community\ndate: 2020/10/09\ndescription: Detects execution of renamed ftp.exe binary based on OriginalFileName\n  field\ndetection:\n  condition: selection_original and not filter_img\n  filter_img:\n    Image|endswith: \\ftp.exe\n  selection_original:\n    OriginalFileName: ftp.exe\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\n- ParentImage\nid: 277a4393-446c-449a-b0ed-7fdc7795244c\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/11/10\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/Ftp/\nstatus: test\ntags:\n- attack.execution\n- attack.t1059\n- attack.defense_evasion\n- attack.t1202\ntitle: Renamed FTP.EXE Binary Execution\n",
                            "sigma:id": "277a4393-446c-449a-b0ed-7fdc7795244c",
                            "title": "Renamed FTP.EXE Binary Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "2c28c248-7f50-417a-9186-a85b223010ee",
                        "lookup_data": {
                            "description": "Detects the presence of the keywords \"Wscript\", \"Shell\" and \"Run\" in the command, which could indicate a suspicious activity",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/08/31\ndescription: Detects the presence of the keywords \"Wscript\", \"Shell\" and \"Run\" in\n  the command, which could indicate a suspicious activity\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - Wscript.\n    - .Shell\n    - .Run\nfalsepositives:\n- Rare legitimate inline scripting by some administrators\nid: 2c28c248-7f50-417a-9186-a85b223010ee\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- http://blog.talosintelligence.com/2022/08/modernloader-delivers-multiple-stealers.html\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Wscript Shell Run In CommandLine\n",
                            "sigma:id": "2c28c248-7f50-417a-9186-a85b223010ee",
                            "title": "Wscript Shell Run In CommandLine",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "24c4d154-05a4-4b99-b57d-9b977472443a",
                        "lookup_data": {
                            "description": "Detects different process creation events as described in various threat reports on Lazarus group activity",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2020/12/23\ndescription: Detects different process creation events as described in various threat\n  reports on Lazarus group activity\ndetection:\n  condition: 1 of selection*\n  selection1:\n    CommandLine|contains:\n    - reg.exe save hklm\\sam %temp%\\~reg_sam.save\n    - 1q2w3e4r@#$@#$@#$\n    - ' -hp1q2w3e4 '\n    - '.dat data03 10000 -p '\n  selection2:\n    CommandLine|contains|all:\n    - process call create\n    - ' > %temp%\\~'\n  selection3:\n    CommandLine|contains|all:\n    - 'netstat -aon | find '\n    - ' > %temp%\\~'\n  selection4:\n    CommandLine|contains: .255 10 C:\\ProgramData\\\nfalsepositives:\n- Overlap with legitimate process activity in some cases (especially selection 3 and\n  4)\nid: 24c4d154-05a4-4b99-b57d-9b977472443a\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/02\nreferences:\n- https://securelist.com/lazarus-covets-covid-19-related-intelligence/99906/\n- https://www.hvs-consulting.de/lazarus-report/\nstatus: test\ntags:\n- attack.g0032\n- attack.execution\n- attack.t1059\ntitle: Lazarus Activity Dec20\n",
                            "sigma:id": "24c4d154-05a4-4b99-b57d-9b977472443a",
                            "title": "Lazarus Activity Dec20",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "7385dfaf-6886-4229-9ecd-6fd678040830",
                        "lookup_data": {
                            "mitre-attack-id": "T1059",
                            "mitre-cti:description": "Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\n\nThere are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005).\n\nAdversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)",
                            "mitre-cti:name": "Command and Scripting Interpreter",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'x_mitre_platforms': ['Linux', 'macOS', 'Windows', 'Network'], 'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'type': 'attack-pattern', 'id': 'attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830', 'created': '2017-05-31T21:30:49.546Z', 'x_mitre_version': '2.3', 'external_references': [{'source_name': 'mitre-attack', 'external_id': 'T1059', 'url': 'https://attack.mitre.org/techniques/T1059'}, {'source_name': 'Remote Shell Execution in Python', 'url': 'https://www.thepythoncode.com/article/executing-bash-commands-remotely-in-python', 'description': 'Abdou Rockikz. (2020, July). How to Execute Shell Commands in a Remote Machine in Python. Retrieved July 26, 2021.'}, {'source_name': 'Cisco IOS Software Integrity Assurance - Command History', 'url': 'https://tools.cisco.com/security/center/resources/integrity_assurance.html#23', 'description': 'Cisco. (n.d.). Cisco IOS Software Integrity Assurance - Command History. Retrieved October 21, 2020.'}, {'source_name': 'Powershell Remote Commands', 'url': 'https://docs.microsoft.com/en-us/powershell/scripting/learn/remoting/running-remote-commands?view=powershell-7.1', 'description': 'Microsoft. (2020, August 21). Running Remote Commands. Retrieved July 26, 2021.'}], 'x_mitre_deprecated': False, 'revoked': False, 'description': 'Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\\n\\nThere are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005).\\n\\nAdversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)', 'modified': '2022-04-19T18:31:48.827Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'name': 'Command and Scripting Interpreter', 'x_mitre_detection': \"Command-line and scripting activities can be captured through proper logging of process execution with command-line arguments. This information can be useful in gaining additional insight to adversaries' actions through how they use native processes or custom tools. Also monitor for loading of modules associated with specific languages.\\n\\nIf scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.\\n\\nScripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information discovery, collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script.\", 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'execution'}], 'x_mitre_is_subtechnique': False, 'x_mitre_data_sources': ['Process: Process Creation', 'Module: Module Load', 'Process: Process Metadata', 'Script: Script Execution', 'Command: Command Execution'], 'x_mitre_remote_support': True, 'x_mitre_attack_spec_version': '2.1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "846b866e-2a57-46ee-8e16-85fa92759be7",
                        "lookup_data": {
                            "description": "Detects the exploitation of Zoho ManageEngine Desktop Central Java Deserialization vulnerability reported as CVE-2020-10189",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2020/03/25\ndescription: Detects the exploitation of Zoho ManageEngine Desktop Central Java Deserialization\n  vulnerability reported as CVE-2020-10189\ndetection:\n  condition: selection\n  selection:\n    Image|endswith:\n    - \\cmd.exe\n    - \\powershell.exe\n    - \\pwsh.exe\n    - \\bitsadmin.exe\n    - \\systeminfo.exe\n    - \\net.exe\n    - \\net1.exe\n    - \\reg.exe\n    - \\query.exe\n    ParentImage|endswith: DesktopCentral_Server\\jre\\bin\\java.exe\nfalsepositives:\n- Unknown\nid: 846b866e-2a57-46ee-8e16-85fa92759be7\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/21\nreferences:\n- https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html\n- https://vulmon.com/exploitdetails?qidtp=exploitdb&qid=48224\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1190\n- attack.execution\n- attack.t1059.001\n- attack.t1059.003\n- attack.s0190\n- cve.2020.10189\ntitle: Exploited CVE-2020-10189 Zoho ManageEngine\n",
                            "sigma:id": "846b866e-2a57-46ee-8e16-85fa92759be7",
                            "title": "Exploited CVE-2020-10189 Zoho ManageEngine",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "023394c4-29d5-46ab-92b8-6a534c6f447b",
                        "lookup_data": {
                            "description": "Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2019/10/24\ndescription: Detects suspicious Hangul Word Processor (Hanword) sub processes that\n  could indicate an exploitation\ndetection:\n  condition: selection\n  selection:\n    Image|endswith: \\gbb.exe\n    ParentImage|endswith: \\Hwp.exe\nfalsepositives:\n- Unknown\nid: 023394c4-29d5-46ab-92b8-6a534c6f447b\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://www.securitynewspaper.com/2016/11/23/technical-teardown-exploit-malware-hwp-files/\n- https://www.hybrid-analysis.com/search?query=context:74940dcc5b38f9f9b1a0fea760d344735d7d91b610e6d5bd34533dd0153402c5&from_sample=5db135000388385a7644131f&block_redirect=1\n- https://twitter.com/cyberwar_15/status/1187287262054076416\n- https://blog.alyac.co.kr/1901\n- https://en.wikipedia.org/wiki/Hangul_(word_processor)\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1566.001\n- attack.execution\n- attack.t1203\n- attack.t1059.003\n- attack.g0032\ntitle: Suspicious HWP Sub Processes\n",
                            "sigma:id": "023394c4-29d5-46ab-92b8-6a534c6f447b",
                            "title": "Suspicious HWP Sub Processes",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "06b401f4-107c-4ff9-947f-9ec1e7649f1e",
                        "lookup_data": {
                            "description": "Detects execution of ftp.exe script execution with the \"-s\" flag and any child processes ran by ftp.exe",
                            "raw": "author: Victor Sergeev, oscd.community\ndate: 2020/10/09\ndescription: Detects execution of ftp.exe script execution with the \"-s\" flag and\n  any child processes ran by ftp.exe\ndetection:\n  condition: selection_parent or all of selection_ftp_*\n  selection_ftp_cli:\n    CommandLine|contains: '-s:'\n  selection_ftp_img:\n  - Image|endswith: \\ftp.exe\n  - OriginalFileName: ftp.exe\n  selection_parent:\n    ParentImage|endswith: \\ftp.exe\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\n- ParentImage\nid: 06b401f4-107c-4ff9-947f-9ec1e7649f1e\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/11/10\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/Ftp/\nstatus: test\ntags:\n- attack.execution\n- attack.t1059\n- attack.defense_evasion\n- attack.t1202\ntitle: LOLBIN Execution Of The FTP.EXE Binary\n",
                            "sigma:id": "06b401f4-107c-4ff9-947f-9ec1e7649f1e",
                            "title": "LOLBIN Execution Of The FTP.EXE Binary",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "e507feb7-5f73-4ef6-a970-91bb6f6d744f",
                        "lookup_data": {
                            "description": "Detects Elise backdoor acitivty as used by APT32",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2018/01/31\ndescription: Detects Elise backdoor acitivty as used by APT32\ndetection:\n  condition: 1 of selection*\n  selection1:\n    CommandLine|contains: '\\Windows\\Caches\\NavShExt.dll '\n    Image: C:\\Windows\\SysWOW64\\cmd.exe\n  selection2:\n    CommandLine|endswith: \\AppData\\Roaming\\MICROS~1\\Windows\\Caches\\NavShExt.dll,Setting\nfalsepositives:\n- Unknown\nid: e507feb7-5f73-4ef6-a970-91bb6f6d744f\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://community.rsa.com/community/products/netwitness/blog/2018/02/13/lotus-blossom-continues-asean-targeting\nstatus: test\ntags:\n- attack.g0030\n- attack.g0050\n- attack.s0081\n- attack.execution\n- attack.t1059.003\ntitle: Elise Backdoor\n",
                            "sigma:id": "e507feb7-5f73-4ef6-a970-91bb6f6d744f",
                            "title": "Elise Backdoor",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5687f942-867b-4578-ade7-1e341c46e99a",
                        "lookup_data": {
                            "description": "Detects suspicious child process creations of VMware Tools process which may indicate persistence setup",
                            "raw": "author: behops, Bhabesh Raj\ndate: 2021/10/08\ndescription: Detects suspicious child process creations of VMware Tools process which\n  may indicate persistence setup\ndetection:\n  condition: all of selection* and not filter\n  filter:\n    CommandLine|contains:\n    - \\VMware\\VMware Tools\\poweron-vm-default.bat\n    - \\VMware\\VMware Tools\\poweroff-vm-default.bat\n    - \\VMware\\VMware Tools\\resume-vm-default.bat\n    - \\VMware\\VMware Tools\\suspend-vm-default.bat\n  selection_img:\n  - Image|endswith:\n    - \\cmd.exe\n    - \\powershell.exe\n    - \\pwsh.exe\n    - \\rundll32.exe\n    - \\regsvr32.exe\n    - \\wscript.exe\n    - \\cscript.exe\n  - OriginalFileName:\n    - Cmd.Exe\n    - PowerShell.EXE\n    - pwsh.dll\n    - RUNDLL32.EXE\n    - REGSVR32.EXE\n    - wscript.exe\n    - cscript.exe\n  selection_parent:\n    ParentImage|endswith: \\vmtoolsd.exe\nfalsepositives:\n- Legitimate use by administrator\nfields:\n- CommandLine\n- ParentCommandLine\n- Details\nid: 5687f942-867b-4578-ade7-1e341c46e99a\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/07/14\nreferences:\n- https://bohops.com/2021/10/08/analyzing-and-detecting-a-vmtools-persistence-technique/\nstatus: experimental\ntags:\n- attack.execution\n- attack.persistence\n- attack.t1059\ntitle: VMToolsd Suspicious Child Process\n",
                            "sigma:id": "5687f942-867b-4578-ade7-1e341c46e99a",
                            "title": "VMToolsd Suspicious Child Process",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "29d31aee-30f4-4006-85a9-a4a02d65306c",
                        "lookup_data": {
                            "description": "This event was observed on the target host during lateral movement. The process name within the event contains the process spawned post compromise. Account Name within the event contains the compromised user account name. This event should to be correlated with 4624 and 4688 for further intrusion context.",
                            "raw": "author: Janantha Marasinghe\ndate: 2021/04/27\ndescription: This event was observed on the target host during lateral movement. The\n  process name within the event contains the process spawned post compromise. Account\n  Name within the event contains the compromised user account name. This event should\n  to be correlated with 4624 and 4688 for further intrusion context.\ndetection:\n  condition: selection\n  selection:\n    EventID: 4674\n    ObjectName: \\Device\\ConDrv\n    ObjectServer: Security\n    ObjectType: File\nfalsepositives:\n- Penetration tests where lateral movement has occured. This event will be created\n  on the target host.\nid: 29d31aee-30f4-4006-85a9-a4a02d65306c\nlevel: high\nlogsource:\n  definition: null\n  product: windows\n  service: security\nreferences:\n- https://jpcertcc.github.io/ToolAnalysisResultSheet/details/wmiexec-vbs.htm\n- https://www.fireeye.com/blog/threat-research/2017/08/monitoring-windows-console-activity-part-one.html\nstatus: stable\ntags:\n- attack.lateral_movement\n- attack.execution\n- attack.t1021\n- attack.t1059\ntitle: Lateral Movement Indicator ConDrv\n",
                            "sigma:id": "29d31aee-30f4-4006-85a9-a4a02d65306c",
                            "title": "Lateral Movement Indicator ConDrv",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "344482e4-a477-436c-aa70-7536d18a48c7",
                        "lookup_data": {
                            "description": "Detects execution via MSSQL xp_cmdshell stored procedure. Malicious users may attempt to elevate their privileges by using xp_cmdshell, which is disabled by default.",
                            "raw": "author: Tim Rauch\ndate: 2022/09/28\ndescription: Detects execution via MSSQL xp_cmdshell stored procedure. Malicious users\n  may attempt to elevate their privileges by using xp_cmdshell, which is disabled\n  by default.\ndetection:\n  condition: selection\n  selection:\n    Image|endswith: \\cmd.exe\n    ParentImage|endswith: \\sqlservr.exe\nfalsepositives:\n- Unknown\nid: 344482e4-a477-436c-aa70-7536d18a48c7\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://www.elastic.co/guide/en/security/current/execution-via-mssql-xp_cmdshell-stored-procedure.html\nrelated:\n- id: d08dd86f-681e-4a00-a92c-1db218754417\n  type: derived\n- id: 7f103213-a04e-4d59-8261-213dddf22314\n  type: derived\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Execution via MSSQL Xp_cmdshell Stored Procedure\n",
                            "sigma:id": "344482e4-a477-436c-aa70-7536d18a48c7",
                            "title": "Execution via MSSQL Xp_cmdshell Stored Procedure",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "814c95cc-8192-4378-a70a-f1aafd877af1",
                        "lookup_data": {
                            "description": "Detects usage of OpenConsole binary as a LOLBIN to launch other binaries to bypass application Whitelisting",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/06/16\ndescription: Detects usage of OpenConsole binary as a LOLBIN to launch other binaries\n  to bypass application Whitelisting\ndetection:\n  condition: selection and not filter\n  filter:\n    Image|startswith: C:\\Program Files\\WindowsApps\\Microsoft.WindowsTerminal\n  selection:\n  - OriginalFileName: OpenConsole.exe\n  - Image|endswith: \\OpenConsole.exe\nfalsepositives:\n- Legitimate use by an administrator\nid: 814c95cc-8192-4378-a70a-f1aafd877af1\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://twitter.com/nas_bench/status/1537563834478645252\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Use of OpenConsole\n",
                            "sigma:id": "814c95cc-8192-4378-a70a-f1aafd877af1",
                            "title": "Use of OpenConsole",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f0b70adb-0075-43b0-9745-e82a1c608fcc",
                        "lookup_data": {
                            "description": "Detects a ZxShell start by the called and well-known function name",
                            "raw": "author: Florian Roth (Nextron Systems), oscd.community, Jonhnathan Ribeiro\ndate: 2017/07/20\ndescription: Detects a ZxShell start by the called and well-known function name\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains:\n    - zxFunction\n    - RemoteDiskXXXXX\n    Image|endswith: \\rundll32.exe\nfalsepositives:\n- Unlikely\nfields:\n- CommandLine\n- ParentCommandLine\nid: f0b70adb-0075-43b0-9745-e82a1c608fcc\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://www.hybrid-analysis.com/sample/5d2a4cde9fa7c2fdbf39b2e2ffd23378d0c50701a3095d1e91e3cf922d7b0b16?environmentId=100\nstatus: test\ntags:\n- attack.execution\n- attack.t1059.003\n- attack.defense_evasion\n- attack.t1218.011\n- attack.s0412\n- attack.g0001\ntitle: ZxShell Malware\n",
                            "sigma:id": "f0b70adb-0075-43b0-9745-e82a1c608fcc",
                            "title": "ZxShell Malware",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5e66dd0a-d858-4f9e-b0b2-a7c6950d210f",
                        "lookup_data": {
                            "description": "Harma and Odveta Ransomware",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5e66dd0a-d858-4f9e-b0b2-a7c6950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1583972578",
                            "uuid": "5e66dd0a-d858-4f9e-b0b2-a7c6950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "1228c958-e64e-4e71-92ad-7d429f4138ba",
                        "lookup_data": {
                            "description": "Detects a suspicious script executions in temporary folders or folders accessible by environment variables",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/02/08\ndescription: Detects a suspicious script executions in temporary folders or folders\n  accessible by environment variables\ndetection:\n  condition: 1 of selection* and folders\n  folders:\n    Image|contains:\n    - \\Windows\\Temp\n    - \\Temporary Internet\n    - \\AppData\\Local\\Temp\n    - \\AppData\\Roaming\\Temp\n    - C:\\Users\\Public\\\n    - C:\\Perflogs\\\n  selection_flags:\n    CommandLine|contains:\n    - ' -w hidden '\n    - ' -ep bypass '\n    - '/e:vbscript '\n    - '/e:javascript '\n  selection_image:\n    Image|endswith:\n    - \\powershell.exe\n    - \\pwsh.exe\n    - \\mshta.exe\n    - \\wscript.exe\n    - \\cscript.exe\n    - \\cmd.exe\n  selection_original:\n    OriginalFileName:\n    - powershell.exe\n    - pwsh.dll\n    - mshta.exe\n    - wscript.exe\n    - cscript.exe\n    - cmd.exe\nfalsepositives:\n- Unknown\nid: 1228c958-e64e-4e71-92ad-7d429f4138ba\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://www.virustotal.com/gui/file/91ba814a86ddedc7a9d546e26f912c541205b47a853d227756ab1334ade92c3f\nstatus: test\ntags:\n- attack.execution\n- attack.t1059\ntitle: Script Interpreter Execution From Suspicious Folder\n",
                            "sigma:id": "1228c958-e64e-4e71-92ad-7d429f4138ba",
                            "title": "Script Interpreter Execution From Suspicious Folder",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "178e615d-e666-498b-9630-9ed363038101",
                        "lookup_data": {
                            "description": "Detects when a shell program such as the windows Command Prompt or PowerShell is launched with system privileges.",
                            "raw": "author: frack113, Tim Shelton (update fp)\ndate: 2022/12/05\ndescription: Detects when a shell program such as the windows Command Prompt or PowerShell\n  is launched with system privileges.\ndetection:\n  condition: all of selection_* and not 1 of filter_*\n  filter_citrix:\n    Image|endswith: \\cmd.exe\n    ParentImage|endswith: \\CitrixReceiverUpdater.exe\n    ParentImage|startswith: C:\\Windows\\SysWOW64\\config\\systemprofile\\Citrix\\UpdaterBinaries\\\n  filter_dell_update:\n    Image|endswith: \\cmd.exe\n    ParentCommandLine|contains: C:\\ProgramData\\Dell\\UpdateService\\\n    ParentImage|endswith: \\invcol.exe\n    ParentImage|startswith: C:\\Windows\\Temp\n  filter_empty_parent1:\n    CommandLine: 'powershell.exe -ExecutionPolicy Restricted -Command Write-Host ''Final\n      result: 1'';'\n  filter_generic:\n    Image|endswith:\n    - \\cmd.exe\n    - \\powershell.exe\n    ParentImage|startswith:\n    - C:\\Windows\\System32\\\n    - C:\\Program Files (x86)\\\n    - C:\\Program Files\\\n  filter_manageengine:\n    Image|endswith: \\cmd.exe\n    ParentImage: C:\\ManageEngine\\ADManager Plus\\pgsql\\bin\\postgres.exe\n  filter_thor:\n    CommandLine: C:\\WINDOWS\\system32\\cmd.exe /c \"ver\"\n    CurrentDirectory|contains: C:\\WINDOWS\\Temp\\asgard2-agent\\\n    ParentImage|endswith: \\python.exe\n  selection_shell:\n  - Image|endswith:\n    - \\powershell.exe\n    - \\pwsh.exe\n    - \\cmd.exe\n  - OriginalFileName:\n    - PowerShell.EXE\n    - pwsh.dll\n    - Cmd.Exe\n  selection_user:\n    LogonId: '0x3e7'\n    User|contains:\n    - AUTHORI\n    - AUTORI\nfalsepositives:\n- Unknown\nid: 178e615d-e666-498b-9630-9ed363038101\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/24\nreferences:\n- https://github.com/Wh04m1001/SysmonEoP\nstatus: experimental\ntags:\n- attack.privilege_escalation\n- attack.defense_evasion\n- attack.execution\n- attack.t1059\ntitle: Suspicious Elevated System Shell\n",
                            "sigma:id": "178e615d-e666-498b-9630-9ed363038101",
                            "title": "Suspicious Elevated System Shell",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "c601f20d-570a-4cde-a7d6-e17f99cb8e7f",
                        "lookup_data": {
                            "description": "Detects automated lateral movement by Turla group",
                            "raw": "author: Markus Neis\ndate: 2017/11/07\ndescription: Detects automated lateral movement by Turla group\ndetection:\n  condition: selection\n  selection:\n    CommandLine:\n    - net use \\\\\\\\%DomainController%\\C$ \"P@ssw0rd\" *\n    - dir c:\\\\*.doc* /s\n    - dir %TEMP%\\\\*.exe\nfalsepositives:\n- Unknown\nid: c601f20d-570a-4cde-a7d6-e17f99cb8e7f\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://securelist.com/the-epic-turla-operation/65545/\nstatus: test\ntags:\n- attack.g0010\n- attack.execution\n- attack.t1059\n- attack.lateral_movement\n- attack.t1021.002\n- attack.discovery\n- attack.t1083\n- attack.t1135\ntitle: Turla Group Lateral Movement\n",
                            "sigma:id": "c601f20d-570a-4cde-a7d6-e17f99cb8e7f",
                            "title": "Turla Group Lateral Movement",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "a77c1610-fc73-4019-8e29-0f51efc04a51",
                        "lookup_data": {
                            "description": "Detects possible payload obfuscation via the commandline",
                            "raw": "author: frack113\ndate: 2022/02/15\ndescription: Detects possible payload obfuscation via the commandline\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains:\n    - ^^\n    - ',;,'\n    - '%COMSPEC:~'\n    - ' s^et '\n    - ' s^e^t '\n    - ' se^t '\nfalsepositives:\n- Legitimate use\nid: a77c1610-fc73-4019-8e29-0f51efc04a51\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/09/02\nreferences:\n- https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Suspicious Dosfuscation Character in Commandline\n",
                            "sigma:id": "a77c1610-fc73-4019-8e29-0f51efc04a51",
                            "title": "Suspicious Dosfuscation Character in Commandline",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "c4042d54-110d-45dd-a0e1-05c47822c937",
                        "lookup_data": {
                            "description": "Detects python spawning a pretty tty",
                            "raw": "author: Nextron Systems\ndate: 2022/06/03\ndescription: Detects python spawning a pretty tty\ndetection:\n  condition: selection_image and 1 of selection_cli*\n  selection_cli1:\n    CommandLine|contains|all:\n    - import pty\n    - .spawn(\n  selection_cli2:\n    CommandLine|contains: from pty import spawn\n  selection_image:\n    Image|contains:\n    - /python2.\n    - /python3.\nfalsepositives:\n- Unknown\nid: c4042d54-110d-45dd-a0e1-05c47822c937\nlevel: high\nlogsource:\n  category: process_creation\n  product: linux\nreferences:\n- https://www.volexity.com/blog/2022/06/02/zero-day-exploitation-of-atlassian-confluence/\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: Python Spawning Pretty TTY\n",
                            "sigma:id": "c4042d54-110d-45dd-a0e1-05c47822c937",
                            "title": "Python Spawning Pretty TTY",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "c83bf4b5-cdf0-437c-90fa-43d734f7c476",
                        "lookup_data": {
                            "description": "Detects PowerShell script execution via input stream redirect",
                            "raw": "author: Moriarty Meng (idea), Anton Kutepov (rule), oscd.community\ndate: 2020/10/17\ndescription: Detects PowerShell script execution via input stream redirect\ndetection:\n  condition: selection\n  selection:\n    CommandLine|re: \\s-\\s*<\n    Image|endswith:\n    - \\powershell.exe\n    - \\pwsh.exe\nfalsepositives:\n- Unknown\nid: c83bf4b5-cdf0-437c-90fa-43d734f7c476\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://github.com/LOLBAS-Project/LOLBAS/blob/4db780e0f0b2e2bb8cb1fa13e09196da9b9f1834/yml/LOLUtilz/OSBinaries/Powershell.yml\n- https://twitter.com/Moriarty_Meng/status/984380793383370752\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.execution\n- attack.t1059\ntitle: Run PowerShell Script from Redirected Input Stream\n",
                            "sigma:id": "c83bf4b5-cdf0-437c-90fa-43d734f7c476",
                            "title": "Run PowerShell Script from Redirected Input Stream",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "e212d415-0e93-435f-9e1a-f29005bb4723",
                        "lookup_data": {
                            "description": "Detects EnableUnsafeClientMailRules used for Script Execution from Outlook",
                            "raw": "author: Markus Neis\ndate: 2018/12/27\ndescription: Detects EnableUnsafeClientMailRules used for Script Execution from Outlook\ndetection:\n  clientMailRules:\n    CommandLine|contains: EnableUnsafeClientMailRules\n  condition: clientMailRules or outlookExec\n  outlookExec:\n    CommandLine|contains|all:\n    - \\\\\\\\\n    - \\\\\n    - .exe\n    ParentImage|endswith: \\outlook.exe\nfalsepositives:\n- Unknown\nid: e212d415-0e93-435f-9e1a-f29005bb4723\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/01/07\nreferences:\n- https://github.com/sensepost/ruler\n- https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html\nstatus: test\ntags:\n- attack.execution\n- attack.t1059\n- attack.t1202\ntitle: Suspicious Execution from Outlook\n",
                            "sigma:id": "e212d415-0e93-435f-9e1a-f29005bb4723",
                            "title": "Suspicious Execution from Outlook",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5dbae98e-7974-4480-86db-44be950d210f",
                        "lookup_data": {
                            "description": "OSINT - Dans lâ€™Å“il de notre CyberSOC : la campagne malspam Aggah diversifie ses outils",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5dbae98e-7974-4480-86db-44be950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1575969880",
                            "uuid": "5dbae98e-7974-4480-86db-44be950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5cf22f74-759c-4744-90eb-4300950d210f",
                        "lookup_data": {
                            "description": "Linux server infection with coinminers (derived from original post with iptables rules)",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5cf22f74-759c-4744-90eb-4300950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1559381168",
                            "uuid": "5cf22f74-759c-4744-90eb-4300950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "eca49c87-8a75-4f13-9c73-a5a29e845f03",
                        "lookup_data": {
                            "description": "Detects execution of powershell scripts via Runscripthelper.exe",
                            "raw": "author: Victor Sergeev, oscd.community\ndate: 2020/10/09\ndescription: Detects execution of powershell scripts via Runscripthelper.exe\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains: surfacecheck\n    Image|endswith: \\Runscripthelper.exe\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\nid: eca49c87-8a75-4f13-9c73-a5a29e845f03\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/07/11\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/Runscripthelper/\nstatus: test\ntags:\n- attack.execution\n- attack.t1059\n- attack.defense_evasion\n- attack.t1202\ntitle: Suspicious Runscripthelper.exe\n",
                            "sigma:id": "eca49c87-8a75-4f13-9c73-a5a29e845f03",
                            "title": "Suspicious Runscripthelper.exe",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f35c5d71-b489-4e22-a115-f003df287317",
                        "lookup_data": {
                            "description": "Detects process patterns found in Cobalt Strike beacon activity (see reference for more details) and also cases in which a China Chopper like webshell is used to run whoami",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2021/07/27\ndescription: Detects process patterns found in Cobalt Strike beacon activity (see\n  reference for more details) and also cases in which a China Chopper like webshell\n  is used to run whoami\ndetection:\n  condition: 1 of selection_normal_* or (selection_special_conhost and not filter_internet_download_manager)\n  filter_internet_download_manager:\n    ParentCommandLine|contains:\n    - C:\\Program Files (x86)\\Internet Download Manager\\IDMMsgHost.exe\n    - chrome-extension://\n  selection_normal_1:\n    CommandLine|contains: \\cmd.exe /C whoami\n    ParentImage|startswith: C:\\Temp\n  selection_normal_2:\n    CommandLine|contains:\n    - cmd.exe /c echo\n    - '> \\\\\\\\.\\\\pipe'\n    - \\whoami.exe\n    ParentImage|endswith: \\dllhost.exe\n  selection_normal_3:\n    Image|endswith: \\cmd.exe\n    ParentCommandLine|endswith: \\runonce.exe\n    ParentImage|endswith: \\runonce.exe\n  selection_special_conhost:\n    CommandLine|contains: conhost.exe 0xffffffff -ForceV1\n    ParentCommandLine|contains:\n    - /C whoami\n    - cmd.exe /C echo\n    - ' > \\\\\\\\.\\\\pipe'\nfalsepositives:\n- Other programs that cause these patterns (please report)\nid: f35c5d71-b489-4e22-a115-f003df287317\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/11/07\nreferences:\n- https://hausec.com/2021/07/26/cobalt-strike-and-tradecraft/\n- https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1059\ntitle: CobaltStrike Process Patterns\n",
                            "sigma:id": "f35c5d71-b489-4e22-a115-f003df287317",
                            "title": "CobaltStrike Process Patterns",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": [
            {
                "attack_technique": "T1059",
                "display_name": "Command and Scripting Interpreter",
                "atomic_tests": [
                    {
                        "name": "AutoIt Script Execution",
                        "auto_generated_guid": "a9b93f17-31cb-435d-a462-5e838a2a6026",
                        "description": "An adversary may attempt to execute suspicious or malicious script using AutoIt software instead of regular terminal like powershell or cmd. Calculator will popup when the script is executed successfully.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "AutoIt executable file must exist on disk at the specified location (#{autoit_path})\n",
                                "prereq_command": "if(Test-Path \"#{autoit_path}\") {\n    exit 0\n} else {\n    exit 1\n}\n",
                                "get_prereq_command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\n$AutoItURL = \"https://www.autoitscript.com/cgi-bin/getfile.pl?autoit3/autoit-v3-setup.exe\"\n$InstallerPath = \"$PathToAtomicsFolder\\..\\ExternalPayloads\\autoit-v3-setup.exe\"\nInvoke-WebRequest -Uri $AutoItURL -OutFile $InstallerPath\nStart-Process -FilePath $InstallerPath -ArgumentList \"/S\" -Wait\n"
                            }
                        ],
                        "input_arguments": {
                            "script_path": {
                                "description": "AutoIt Script Path",
                                "type": "path",
                                "default": "PathToAtomicsFolder\\T1059\\src\\calc.au3"
                            },
                            "autoit_path": {
                                "description": "AutoIt Executable File Path",
                                "type": "path",
                                "default": "C:\\Program Files (x86)\\AutoIt3\\AutoIt3.exe"
                            }
                        },
                        "executor": {
                            "command": "Start-Process -FilePath \"#{autoit_path}\" -ArgumentList \"#{script_path}\"\n",
                            "name": "powershell"
                        }
                    }
                ]
            }
        ]
    },
    "timestamp": "2025-02-28 12:01:36"
}