{
    "id": "T1550",
    "name": "Use Alternate Authentication Material",
    "description": "Adversaries may use alternate authentication material, such as password hashes, Kerberos tickets, and application access tokens, in order to move laterally within an environment and bypass normal system access controls.\nAuthentication processes generally require a valid identity (e.g., username) along with one or more authentication factors (e.g., password, pin, physical smart card, token generator, etc.). Alternate authentication material is legitimately generated by systems after a user or application successfully authenticates by providing a valid identity and the required authentication factor(s). Alternate authentication material may also be generated during the identity creation process.(Citation: NIST Authentication)(Citation: NIST MFA)\nCaching alternate authentication material allows the system to verify an identity has successfully authenticated without asking the user to reenter authentication factor(s). Because the alternate authentication must be maintained by the system—either in memory or on disk—it may be at risk of being stolen through [Credential Access](TA0006) techniques. By stealing alternate authentication material, adversaries are able to bypass system access controls and authenticate to systems without knowing the plaintext password or any additional authentication factors.",
    "platforms": "Windows, Office 365, SaaS, Google Workspace, IaaS",
    "kill_chain_phases": "Defense Evasion, Lateral Movement",
    "data_sources": "Logon Session: Logon Session Creation, Web Credential: Web Credential Usage, Application Log: Application Log Content, User Account: User Account Authentication, Active Directory: Active Directory Credential Request",
    "detection": "Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services.(Citation: TechNet Audit Policy) Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).",
    "url": "https://attack.mitre.org/techniques/T1550",
    "enrichments": {
        "attack_rule_map": [],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "51a14c76-dd3b-440b-9c20-2bf91d25a814",
                    "905d389b-b853-46d0-9d3d-dea0d3a3cd49",
                    "b45ab1d2-712f-4f01-a751-df3826969807",
                    "f43f5d2f-3f2a-4cc8-b1af-81fde7dbaf0e"
                ],
                "lookup_results": [
                    {
                        "uuid": "51a14c76-dd3b-440b-9c20-2bf91d25a814",
                        "lookup_data": {
                            "mitre-attack-id": "T1550",
                            "mitre-cti:description": "Adversaries may use alternate authentication material, such as password hashes, Kerberos tickets, and application access tokens, in order to move laterally within an environment and bypass normal system access controls. \n\nAuthentication processes generally require a valid identity (e.g., username) along with one or more authentication factors (e.g., password, pin, physical smart card, token generator, etc.). Alternate authentication material is legitimately generated by systems after a user or application successfully authenticates by providing a valid identity and the required authentication factor(s). Alternate authentication material may also be generated during the identity creation process.(Citation: NIST Authentication)(Citation: NIST MFA)\n\nCaching alternate authentication material allows the system to verify an identity has successfully authenticated without asking the user to reenter authentication factor(s). Because the alternate authentication must be maintained by the system—either in memory or on disk—it may be at risk of being stolen through [Credential Access](https://attack.mitre.org/tactics/TA0006) techniques. By stealing alternate authentication material, adversaries are able to bypass system access controls and authenticate to systems without knowing the plaintext password or any additional authentication factors.\n",
                            "mitre-cti:name": "Use Alternate Authentication Material",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'x_mitre_platforms': ['Windows', 'Office 365', 'SaaS', 'Google Workspace', 'IaaS', 'Containers'], 'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'attack-pattern--51a14c76-dd3b-440b-9c20-2bf91d25a814', 'type': 'attack-pattern', 'created': '2020-01-30T16:18:36.873Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'source_name': 'mitre-attack', 'external_id': 'T1550', 'url': 'https://attack.mitre.org/techniques/T1550'}, {'source_name': 'NIST Authentication', 'url': 'https://csrc.nist.gov/glossary/term/authentication', 'description': 'NIST. (n.d.). Authentication. Retrieved January 30, 2020.'}, {'source_name': 'NIST MFA', 'url': 'https://csrc.nist.gov/glossary/term/Multi_Factor-Authentication', 'description': 'NIST. (n.d.). Multi-Factor Authentication (MFA). Retrieved January 30, 2020.'}, {'url': 'https://technet.microsoft.com/en-us/library/dn487457.aspx', 'description': 'Microsoft. (2016, April 15). Audit Policy Recommendations. Retrieved June 3, 2016.', 'source_name': 'TechNet Audit Policy'}], 'modified': '2022-04-01T12:57:34.058Z', 'name': 'Use Alternate Authentication Material', 'description': 'Adversaries may use alternate authentication material, such as password hashes, Kerberos tickets, and application access tokens, in order to move laterally within an environment and bypass normal system access controls. \\n\\nAuthentication processes generally require a valid identity (e.g., username) along with one or more authentication factors (e.g., password, pin, physical smart card, token generator, etc.). Alternate authentication material is legitimately generated by systems after a user or application successfully authenticates by providing a valid identity and the required authentication factor(s). Alternate authentication material may also be generated during the identity creation process.(Citation: NIST Authentication)(Citation: NIST MFA)\\n\\nCaching alternate authentication material allows the system to verify an identity has successfully authenticated without asking the user to reenter authentication factor(s). Because the alternate authentication must be maintained by the system—either in memory or on disk—it may be at risk of being stolen through [Credential Access](https://attack.mitre.org/tactics/TA0006) techniques. By stealing alternate authentication material, adversaries are able to bypass system access controls and authenticate to systems without knowing the plaintext password or any additional authentication factors.\\n', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'defense-evasion'}, {'kill_chain_name': 'mitre-attack', 'phase_name': 'lateral-movement'}], 'x_mitre_detection': 'Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services.(Citation: TechNet Audit Policy) Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).', 'x_mitre_version': '1.2', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'x_mitre_data_sources': ['Active Directory: Active Directory Credential Request', 'User Account: User Account Authentication', 'Web Credential: Web Credential Usage', 'Logon Session: Logon Session Creation', 'Application Log: Application Log Content'], 'x_mitre_defense_bypassed': ['System Access Controls'], 'x_mitre_is_subtechnique': False}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "905d389b-b853-46d0-9d3d-dea0d3a3cd49",
                        "lookup_data": {
                            "description": "Identifies the suspicious use of AssumeRole. Attackers could move laterally and escalate privileges.",
                            "raw": "author: Austin Songer @austinsonger\ndate: 2021/07/24\ndescription: Identifies the suspicious use of AssumeRole. Attackers could move laterally\n  and escalate privileges.\ndetection:\n  condition: selection\n  selection:\n    userIdentity.sessionContext.sessionIssuer.type: Role\n    userIdentity.type: AssumedRole\nfalsepositives:\n- AssumeRole may be done by a system or network administrator. Verify whether the\n  user identity, user agent, and/or hostname should be making changes in your environment.\n- AssumeRole from unfamiliar users or hosts should be investigated. If known behavior\n  is causing false positives, it can be exempted from the rule.\n- Automated processes that uses Terraform may lead to false positives.\nid: 905d389b-b853-46d0-9d3d-dea0d3a3cd49\nlevel: low\nlogsource:\n  product: aws\n  service: cloudtrail\nmodified: 2022/10/09\nreferences:\n- https://github.com/elastic/detection-rules/pull/1214\n- https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html\nstatus: test\ntags:\n- attack.lateral_movement\n- attack.privilege_escalation\n- attack.t1548\n- attack.t1550\n- attack.t1550.001\ntitle: AWS STS AssumeRole Misuse\n",
                            "sigma:id": "905d389b-b853-46d0-9d3d-dea0d3a3cd49",
                            "title": "AWS STS AssumeRole Misuse",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b45ab1d2-712f-4f01-a751-df3826969807",
                        "lookup_data": {
                            "description": "Identifies the suspicious use of GetSessionToken. Tokens could be created and used by attackers to move laterally and escalate privileges.",
                            "raw": "author: Austin Songer @austinsonger\ndate: 2021/07/24\ndescription: Identifies the suspicious use of GetSessionToken. Tokens could be created\n  and used by attackers to move laterally and escalate privileges.\ndetection:\n  condition: selection\n  selection:\n    eventName: GetSessionToken\n    eventSource: sts.amazonaws.com\n    userIdentity.type: IAMUser\nfalsepositives:\n- GetSessionToken may be done by a system or network administrator. Verify whether\n  the user identity, user agent, and/or hostname should be making changes in your\n  environment. GetSessionToken from unfamiliar users or hosts should be investigated.\n  If known behavior is causing false positives, it can be exempted from the rule.\nid: b45ab1d2-712f-4f01-a751-df3826969807\nlevel: low\nlogsource:\n  product: aws\n  service: cloudtrail\nmodified: 2022/10/09\nreferences:\n- https://github.com/elastic/detection-rules/pull/1213\n- https://docs.aws.amazon.com/STS/latest/APIReference/API_GetSessionToken.html\nstatus: test\ntags:\n- attack.lateral_movement\n- attack.privilege_escalation\n- attack.t1548\n- attack.t1550\n- attack.t1550.001\ntitle: AWS STS GetSessionToken Misuse\n",
                            "sigma:id": "b45ab1d2-712f-4f01-a751-df3826969807",
                            "title": "AWS STS GetSessionToken Misuse",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f43f5d2f-3f2a-4cc8-b1af-81fde7dbaf0e",
                        "lookup_data": {
                            "description": "Identifies when suspicious SAML activity has occurred in AWS. An adversary could gain backdoor access via SAML.",
                            "raw": "author: Austin Songer\ndate: 2021/09/22\ndescription: Identifies when suspicious SAML activity has occurred in AWS. An adversary\n  could gain backdoor access via SAML.\ndetection:\n  condition: 1 of selection_*\n  selection_iam:\n    eventName: UpdateSAMLProvider\n    eventSource: iam.amazonaws.com\n  selection_sts:\n    eventName: AssumeRoleWithSAML\n    eventSource: sts.amazonaws.com\nfalsepositives:\n- Automated processes that uses Terraform may lead to false positives.\n- SAML Provider could be updated by a system administrator. Verify whether the user\n  identity, user agent, and/or hostname should be making changes in your environment.\n- SAML Provider being updated from unfamiliar users should be investigated. If known\n  behavior is causing false positives, it can be exempted from the rule.\nid: f43f5d2f-3f2a-4cc8-b1af-81fde7dbaf0e\nlevel: medium\nlogsource:\n  product: aws\n  service: cloudtrail\nmodified: 2022/12/18\nreferences:\n- https://docs.aws.amazon.com/IAM/latest/APIReference/API_UpdateSAMLProvider.html\n- https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1078\n- attack.lateral_movement\n- attack.t1548\n- attack.privilege_escalation\n- attack.t1550\n- attack.t1550.001\ntitle: AWS Suspicious SAML Activity\n",
                            "sigma:id": "f43f5d2f-3f2a-4cc8-b1af-81fde7dbaf0e",
                            "title": "AWS Suspicious SAML Activity",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": []
    },
    "timestamp": "2025-02-28 15:54:20"
}