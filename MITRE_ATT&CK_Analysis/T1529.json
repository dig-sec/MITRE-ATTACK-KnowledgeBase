{
    "id": "T1529",
    "name": "System Shutdown/Reboot",
    "description": "Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems. Operating systems may contain commands to initiate a shutdown/reboot of a machine. In some cases, these commands may also be used to initiate a shutdown/reboot of a remote computer.(Citation: Microsoft Shutdown Oct 2017) Shutting down or rebooting systems may disrupt access to computer resources for legitimate users.\nAdversaries may attempt to shutdown/reboot a system after impacting it in other ways, such as [Disk Structure Wipe](T1561.002) or [Inhibit System Recovery](T1490), to hasten the intended effects on system availability.(Citation: Talos Nyetya June 2017)(Citation: Talos Olympic Destroyer 2018)",
    "platforms": "Linux, macOS, Windows",
    "kill_chain_phases": "Impact",
    "data_sources": "Process: Process Creation, Command: Command Execution, Sensor Health: Host Status",
    "detection": "Use process monitoring to monitor the execution and command line parameters of binaries involved in shutting down or rebooting systems. Windows event logs may also designate activity associated with a shutdown/reboot, ex. Event ID 1074 and 6006.",
    "url": "https://attack.mitre.org/techniques/T1529",
    "enrichments": {
        "attack_rule_map": [
            {
                "tech_id": "T1529",
                "atomic_attack_guid": "622cc1a0-45e7-428c-aed7-c96dd605fbe6",
                "atomic_attack_name": "ESXi - vim-cmd Used to Power Off VMs",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Tunneling Tool Execution",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules-threat-hunting/windows/process_creation/proc_creation_win_susp_exfil_and_tunneling_tool_execution.yml",
                        "remote_content": "title: Tunneling Tool Execution\nid: c75309a3-59f8-4a8d-9c2c-4c927ad50555\nstatus: test\ndescription: Detects the execution of well known tools that can be abused for data exfiltration and tunneling.\nauthor: Daniil Yugoslavskiy, oscd.community\nreferences:\n    - https://www.microsoft.com/en-us/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/\ndate: 2019-10-24\nmodified: 2024-01-18\ntags:\n    - attack.exfiltration\n    - attack.command-and-control\n    - attack.t1041\n    - attack.t1572\n    - attack.t1071.001\n    - detection.threat-hunting\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith:\n            - '\\httptunnel.exe'\n            - '\\plink.exe'\n            - '\\socat.exe'\n            - '\\stunnel.exe'\n    condition: selection\nfalsepositives:\n    - Legitimate administrators using one of these tools\nlevel: medium\n"
                    }
                ],
                "splunk_rules": [
                    {
                        "rule_name": "Windows Protocol Tunneling with Plink",
                        "rule_link": "https://research.splunk.com/endpoint/8aac5e1e-0fab-4437-af0b-c6e60af23eed/"
                    }
                ]
            },
            {
                "tech_id": "T1529",
                "atomic_attack_guid": "189f7d6e-9442-4160-9bc3-5e4104d93ece",
                "atomic_attack_name": "ESXi - Avoslocker enumerates VMs and forcefully kills VMs",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Tunneling Tool Execution",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules-threat-hunting/windows/process_creation/proc_creation_win_susp_exfil_and_tunneling_tool_execution.yml",
                        "remote_content": "title: Tunneling Tool Execution\nid: c75309a3-59f8-4a8d-9c2c-4c927ad50555\nstatus: test\ndescription: Detects the execution of well known tools that can be abused for data exfiltration and tunneling.\nauthor: Daniil Yugoslavskiy, oscd.community\nreferences:\n    - https://www.microsoft.com/en-us/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/\ndate: 2019-10-24\nmodified: 2024-01-18\ntags:\n    - attack.exfiltration\n    - attack.command-and-control\n    - attack.t1041\n    - attack.t1572\n    - attack.t1071.001\n    - detection.threat-hunting\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith:\n            - '\\httptunnel.exe'\n            - '\\plink.exe'\n            - '\\socat.exe'\n            - '\\stunnel.exe'\n    condition: selection\nfalsepositives:\n    - Legitimate administrators using one of these tools\nlevel: medium\n"
                    }
                ],
                "splunk_rules": [
                    {
                        "rule_name": "Windows Protocol Tunneling with Plink",
                        "rule_link": "https://research.splunk.com/endpoint/8aac5e1e-0fab-4437-af0b-c6e60af23eed/"
                    }
                ]
            },
            {
                "tech_id": "T1529",
                "atomic_attack_guid": "987c9b4d-a637-42db-b1cb-e9e242c3991b",
                "atomic_attack_name": "ESXi - Terminates VMs using pkill",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Tunneling Tool Execution",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules-threat-hunting/windows/process_creation/proc_creation_win_susp_exfil_and_tunneling_tool_execution.yml",
                        "remote_content": "title: Tunneling Tool Execution\nid: c75309a3-59f8-4a8d-9c2c-4c927ad50555\nstatus: test\ndescription: Detects the execution of well known tools that can be abused for data exfiltration and tunneling.\nauthor: Daniil Yugoslavskiy, oscd.community\nreferences:\n    - https://www.microsoft.com/en-us/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/\ndate: 2019-10-24\nmodified: 2024-01-18\ntags:\n    - attack.exfiltration\n    - attack.command-and-control\n    - attack.t1041\n    - attack.t1572\n    - attack.t1071.001\n    - detection.threat-hunting\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith:\n            - '\\httptunnel.exe'\n            - '\\plink.exe'\n            - '\\socat.exe'\n            - '\\stunnel.exe'\n    condition: selection\nfalsepositives:\n    - Legitimate administrators using one of these tools\nlevel: medium\n"
                    }
                ],
                "splunk_rules": [
                    {
                        "rule_name": "Windows Protocol Tunneling with Plink",
                        "rule_link": "https://research.splunk.com/endpoint/8aac5e1e-0fab-4437-af0b-c6e60af23eed/"
                    }
                ]
            }
        ],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "34ebb878-1b15-4895-b352-ca2eeb99b274",
                    "761270e6-3a97-4c18-9a44-a844cb5b562b",
                    "4cb57c2f-1f29-41f8-893d-8bed8e1c1d2f",
                    "ff73aa03-0090-4464-83ac-f89e233c02bc",
                    "d94a35f0-7a29-45f6-90a0-80df6159967c",
                    "ec290c06-9b6b-4338-8b6b-095c0f284f10",
                    "3ceb2083-a27f-449a-be33-14ec1b7cc973",
                    "54dd4ef7-f7b2-418e-a191-5def4fbb0033",
                    "40b1fbe2-18ea-4ee7-be47-0294285811de"
                ],
                "lookup_results": [
                    {
                        "uuid": "34ebb878-1b15-4895-b352-ca2eeb99b274",
                        "lookup_data": {
                            "description": "Use of the commandline to shutdown or reboot windows",
                            "raw": "author: frack113\ndate: 2022/01/01\ndescription: Use of the commandline to shutdown or reboot windows\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains:\n    - '/r '\n    - '/s '\n    Image|endswith: \\shutdown.exe\nfalsepositives:\n- Unknown\nid: 34ebb878-1b15-4895-b352-ca2eeb99b274\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1529/T1529.md\n- https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/shutdown\nstatus: test\ntags:\n- attack.impact\n- attack.t1529\ntitle: Suspicious Execution of Shutdown\n",
                            "sigma:id": "34ebb878-1b15-4895-b352-ca2eeb99b274",
                            "title": "Suspicious Execution of Shutdown",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "761270e6-3a97-4c18-9a44-a844cb5b562b",
                        "lookup_data": {
                            "description": "Chiseling In: Lorenz Ransomware Group Cracks MiVoice And Calls Back For Free",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/761270e6-3a97-4c18-9a44-a844cb5b562b.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1666603345",
                            "uuid": "761270e6-3a97-4c18-9a44-a844cb5b562b",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4cb57c2f-1f29-41f8-893d-8bed8e1c1d2f",
                        "lookup_data": {
                            "description": "Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems.",
                            "raw": "author: Igor Fits, oscd.community\ndate: 2020/10/15\ndescription: Adversaries may shutdown/reboot systems to interrupt access to, or aid\n  in the destruction of, those systems.\ndetection:\n  condition: execve and (shutdowncmd or (init and initselection))\n  execve:\n    type: EXECVE\n  init:\n  - init\n  - telinit\n  initselection:\n  - 0\n  - 6\n  shutdowncmd:\n  - shutdown\n  - reboot\n  - halt\n  - poweroff\nfalsepositives:\n- Legitimate administrative activity\nid: 4cb57c2f-1f29-41f8-893d-8bed8e1c1d2f\nlevel: informational\nlogsource:\n  product: linux\n  service: auditd\nmodified: 2022/11/26\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1529/T1529.md\nstatus: test\ntags:\n- attack.impact\n- attack.t1529\ntitle: System Shutdown/Reboot - Linux\n",
                            "sigma:id": "4cb57c2f-1f29-41f8-893d-8bed8e1c1d2f",
                            "title": "System Shutdown/Reboot - Linux",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ff73aa03-0090-4464-83ac-f89e233c02bc",
                        "lookup_data": {
                            "mitre-attack-id": "T1529",
                            "mitre-cti:description": "Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems. Operating systems may contain commands to initiate a shutdown/reboot of a machine or network device. In some cases, these commands may also be used to initiate a shutdown/reboot of a remote computer or network device via [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) (e.g. <code>reload</code>).(Citation: Microsoft Shutdown Oct 2017)(Citation: alert_TA18_106A) Shutting down or rebooting systems may disrupt access to computer resources for legitimate users.\n\nAdversaries may attempt to shutdown/reboot a system after impacting it in other ways, such as [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002) or [Inhibit System Recovery](https://attack.mitre.org/techniques/T1490), to hasten the intended effects on system availability.(Citation: Talos Nyetya June 2017)(Citation: Talos Olympic Destroyer 2018)",
                            "mitre-cti:name": "System Shutdown/Reboot",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'modified': '2022-10-20T18:27:57.587Z', 'name': 'System Shutdown/Reboot', 'description': 'Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems. Operating systems may contain commands to initiate a shutdown/reboot of a machine or network device. In some cases, these commands may also be used to initiate a shutdown/reboot of a remote computer or network device via [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) (e.g. <code>reload</code>).(Citation: Microsoft Shutdown Oct 2017)(Citation: alert_TA18_106A) Shutting down or rebooting systems may disrupt access to computer resources for legitimate users.\\n\\nAdversaries may attempt to shutdown/reboot a system after impacting it in other ways, such as [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002) or [Inhibit System Recovery](https://attack.mitre.org/techniques/T1490), to hasten the intended effects on system availability.(Citation: Talos Nyetya June 2017)(Citation: Talos Olympic Destroyer 2018)', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'impact'}], 'x_mitre_detection': 'Use process monitoring to monitor the execution and command line parameters of binaries involved in shutting down or rebooting systems. Windows event logs may also designate activity associated with a shutdown/reboot, ex. Event ID 1074 and 6006. Unexpected or unauthorized commands from network cli on network devices may also be associated with shutdown/reboot, e.g. the <code>reload</code> command.', 'x_mitre_platforms': ['Linux', 'macOS', 'Windows', 'Network'], 'x_mitre_is_subtechnique': False, 'x_mitre_deprecated': False, 'x_mitre_domains': ['enterprise-attack'], 'x_mitre_version': '1.2', 'x_mitre_contributors': ['Austin Clark, @c2defense'], 'x_mitre_data_sources': ['Process: Process Creation', 'Sensor Health: Host Status', 'Command: Command Execution'], 'x_mitre_impact_type': ['Availability'], 'type': 'attack-pattern', 'id': 'attack-pattern--ff73aa03-0090-4464-83ac-f89e233c02bc', 'created': '2019-10-04T20:42:28.541Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'revoked': False, 'external_references': [{'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/techniques/T1529', 'external_id': 'T1529'}, {'source_name': 'Talos Nyetya June 2017', 'description': 'Chiu, A. (2016, June 27). New Ransomware Variant \"Nyetya\" Compromises Systems Worldwide. Retrieved March 26, 2019.', 'url': 'https://blog.talosintelligence.com/2017/06/worldwide-ransomware-variant.html'}, {'source_name': 'alert_TA18_106A', 'description': 'CISA. (2018, April 20). Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved February 14, 2022.', 'url': 'https://www.cisa.gov/uscert/ncas/alerts/TA18-106A'}, {'source_name': 'Talos Olympic Destroyer 2018', 'description': 'Mercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer Takes Aim At Winter Olympics. Retrieved March 14, 2019.', 'url': 'https://blog.talosintelligence.com/2018/02/olympic-destroyer.html'}, {'source_name': 'Microsoft Shutdown Oct 2017', 'description': 'Microsoft. (2017, October 15). Shutdown. Retrieved October 4, 2019.', 'url': 'https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/shutdown'}], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'x_mitre_attack_spec_version': '2.1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d94a35f0-7a29-45f6-90a0-80df6159967c",
                        "lookup_data": {
                            "description": "Detect a system being shutdown or put into different boot mode",
                            "raw": "author: Austin Clark\ndate: 2019/08/15\ndescription: Detect a system being shutdown or put into different boot mode\ndetection:\n  condition: keywords\n  keywords:\n  - shutdown\n  - config-register 0x2100\n  - config-register 0x2142\nfalsepositives:\n- Legitimate administrators may run these commands, though rarely.\nfields:\n- CmdSet\nid: d94a35f0-7a29-45f6-90a0-80df6159967c\nlevel: medium\nlogsource:\n  product: cisco\n  service: aaa\nmodified: 2023/01/04\nstatus: test\ntags:\n- attack.impact\n- attack.t1495\n- attack.t1529\n- attack.t1565.001\ntitle: Cisco Denial of Service\n",
                            "sigma:id": "d94a35f0-7a29-45f6-90a0-80df6159967c",
                            "title": "Cisco Denial of Service",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ec290c06-9b6b-4338-8b6b-095c0f284f10",
                        "lookup_data": {
                            "description": "Detects the rare use of the command line tool shutdown to logoff a user",
                            "raw": "author: frack113\ndate: 2022/10/01\ndescription: Detects the rare use of the command line tool shutdown to logoff a user\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains: /l\n    Image|endswith: \\shutdown.exe\nfalsepositives:\n- Unknown\nid: ec290c06-9b6b-4338-8b6b-095c0f284f10\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1529/T1529.md\n- https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/shutdown\nstatus: experimental\ntags:\n- attack.impact\n- attack.t1529\ntitle: Suspicious Execution of Shutdown to Log Out\n",
                            "sigma:id": "ec290c06-9b6b-4338-8b6b-095c0f284f10",
                            "title": "Suspicious Execution of Shutdown to Log Out",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "3ceb2083-a27f-449a-be33-14ec1b7cc973",
                        "lookup_data": {
                            "description": "Detects Silence EmpireDNSAgent as described in the Group-IP report",
                            "raw": "author: Alina Stepchenkova, Group-IB, oscd.community\ndate: 2019/11/01\ndescription: Detects Silence EmpireDNSAgent as described in the Group-IP report\ndetection:\n  condition: empire and dnscat\n  dnscat:\n    ScriptBlockText|contains|all:\n    - set type=$LookupType`nserver\n    - $Command | nslookup 2>&1 | Out-String\n    - New-RandomDNSField\n    - '[Convert]::ToString($SYNOptions, 16)'\n    - $Session.Dead = $True\n    - $Session[\"Driver\"] -eq\n  empire:\n    ScriptBlockText|contains|all:\n    - System.Diagnostics.Process\n    - Stop-Computer\n    - Restart-Computer\n    - Exception in execution\n    - $cmdargs\n    - Close-Dnscat2Tunnel\nfalsepositives:\n- Unknown\nid: 3ceb2083-a27f-449a-be33-14ec1b7cc973\nlevel: critical\nlogsource:\n  definition: 'Requirements: Script Block Logging must be enabled'\n  product: windows\n  service: powershell\nmodified: 2022/10/05\nreferences:\n- https://www.group-ib.com/resources/threat-research/silence_2.0.going_global.pdf\nstatus: test\ntags:\n- attack.execution\n- attack.t1059.001\n- attack.command_and_control\n- attack.t1071.004\n- attack.t1572\n- attack.impact\n- attack.t1529\n- attack.g0091\n- attack.s0363\ntitle: Silence.EDA Detection\n",
                            "sigma:id": "3ceb2083-a27f-449a-be33-14ec1b7cc973",
                            "title": "Silence.EDA Detection",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "54dd4ef7-f7b2-418e-a191-5def4fbb0033",
                        "lookup_data": {
                            "description": "Turla: A Galaxy of Opportunity",
                            "link": "http://www.botvrij.eu/data/feed-osint/54dd4ef7-f7b2-418e-a191-5def4fbb0033.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1673286950",
                            "uuid": "54dd4ef7-f7b2-418e-a191-5def4fbb0033",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "40b1fbe2-18ea-4ee7-be47-0294285811de",
                        "lookup_data": {
                            "description": "Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems.",
                            "raw": "author: Igor Fits, Mikhail Larin, oscd.community\ndate: 2020/10/19\ndescription: Adversaries may shutdown/reboot systems to interrupt access to, or aid\n  in the destruction of, those systems.\ndetection:\n  condition: selection\n  selection:\n    Image|endswith:\n    - /shutdown\n    - /reboot\n    - /halt\nfalsepositives:\n- Legitimate administrative activity\nid: 40b1fbe2-18ea-4ee7-be47-0294285811de\nlevel: informational\nlogsource:\n  category: process_creation\n  product: macos\nmodified: 2022/11/26\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1529/T1529.md\nstatus: test\ntags:\n- attack.impact\n- attack.t1529\ntitle: System Shutdown/Reboot - MacOs\n",
                            "sigma:id": "40b1fbe2-18ea-4ee7-be47-0294285811de",
                            "title": "System Shutdown/Reboot - MacOs",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": [
            {
                "attack_technique": "T1529",
                "display_name": "System Shutdown/Reboot",
                "atomic_tests": [
                    {
                        "name": "Shutdown System - Windows",
                        "auto_generated_guid": "ad254fa8-45c0-403b-8c77-e00b3d3e7a64",
                        "description": "This test shuts down a Windows system.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "timeout": {
                                "description": "Timeout period before shutdown (seconds)",
                                "type": "integer",
                                "default": 1
                            }
                        },
                        "executor": {
                            "command": "shutdown /s /t #{timeout}\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Restart System - Windows",
                        "auto_generated_guid": "f4648f0d-bf78-483c-bafc-3ec99cd1c302",
                        "description": "This test restarts a Windows system.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "timeout": {
                                "description": "Timeout period before restart (seconds)",
                                "type": "integer",
                                "default": 1
                            }
                        },
                        "executor": {
                            "command": "shutdown /r /t #{timeout}\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Restart System via `shutdown` - FreeBSD/macOS/Linux",
                        "auto_generated_guid": "6326dbc4-444b-4c04-88f4-27e94d0327cb",
                        "description": "This test restarts a FreeBSD/macOS/Linux system.\n",
                        "supported_platforms": [
                            "linux",
                            "macos"
                        ],
                        "input_arguments": {
                            "timeout": {
                                "description": "Time to restart (can be minutes or specific time)",
                                "type": "string",
                                "default": "now"
                            }
                        },
                        "executor": {
                            "command": "shutdown -r #{timeout}\n",
                            "name": "sh",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Shutdown System via `shutdown` - FreeBSD/macOS/Linux",
                        "auto_generated_guid": "4963a81e-a3ad-4f02-adda-812343b351de",
                        "description": "This test shuts down a FreeBSD/macOS/Linux system using a halt.\n",
                        "supported_platforms": [
                            "linux",
                            "macos"
                        ],
                        "input_arguments": {
                            "timeout": {
                                "description": "Time to shutdown (can be minutes or specific time)",
                                "type": "string",
                                "default": "now"
                            }
                        },
                        "executor": {
                            "command": "shutdown -h #{timeout}\n",
                            "name": "sh",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Restart System via `reboot` - FreeBSD/macOS/Linux",
                        "auto_generated_guid": "47d0b042-a918-40ab-8cf9-150ffe919027",
                        "description": "This test restarts a FreeBSD/macOS/Linux system via `reboot`.\n",
                        "supported_platforms": [
                            "linux",
                            "macos"
                        ],
                        "executor": {
                            "command": "reboot\n",
                            "name": "sh",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Shutdown System via `halt` - FreeBSD/Linux",
                        "auto_generated_guid": "918f70ab-e1ef-49ff-bc57-b27021df84dd",
                        "description": "This test shuts down a FreeBSD/Linux system using `halt`.\n",
                        "supported_platforms": [
                            "linux"
                        ],
                        "executor": {
                            "command": "halt -p\n",
                            "name": "sh",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Reboot System via `halt` - FreeBSD",
                        "auto_generated_guid": "7b1cee42-320f-4890-b056-d65c8b884ba5",
                        "description": "This test restarts a FreeBSD system using `halt`.\n",
                        "supported_platforms": [
                            "linux"
                        ],
                        "executor": {
                            "command": "halt -r\n",
                            "name": "sh",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Reboot System via `halt` - Linux",
                        "auto_generated_guid": "78f92e14-f1e9-4446-b3e9-f1b921f2459e",
                        "description": "This test restarts a Linux system using `halt`.\n",
                        "supported_platforms": [
                            "linux"
                        ],
                        "executor": {
                            "command": "halt --reboot\n",
                            "name": "bash",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Shutdown System via `poweroff` - FreeBSD/Linux",
                        "auto_generated_guid": "73a90cd2-48a2-4ac5-8594-2af35fa909fa",
                        "description": "This test shuts down a FreeBSD/Linux system using `poweroff`.\n",
                        "supported_platforms": [
                            "linux"
                        ],
                        "executor": {
                            "command": "poweroff\n",
                            "name": "sh",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Reboot System via `poweroff` - FreeBSD",
                        "auto_generated_guid": "5a282e50-86ff-438d-8cef-8ae01c9e62e1",
                        "description": "This test restarts a FreeBSD system using `poweroff`.\n",
                        "supported_platforms": [
                            "linux"
                        ],
                        "executor": {
                            "command": "poweroff -r 3\n",
                            "name": "sh",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Reboot System via `poweroff` - Linux",
                        "auto_generated_guid": "61303105-ff60-427b-999e-efb90b314e41",
                        "description": "This test restarts a Linux system using `poweroff`.\n",
                        "supported_platforms": [
                            "linux"
                        ],
                        "executor": {
                            "command": "poweroff --reboot\n",
                            "name": "bash",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Logoff System - Windows",
                        "auto_generated_guid": "3d8c25b5-7ff5-4c9d-b21f-85ebd06654a4",
                        "description": "This test performs a Windows system logoff as seen in [dcrat backdoor capabilities](https://www.mandiant.com/resources/analyzing-dark-crystal-rat-backdoor)\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "shutdown /l \n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "ESXi - Terminates VMs using pkill",
                        "auto_generated_guid": "987c9b4d-a637-42db-b1cb-e9e242c3991b",
                        "description": "In VMWARE ESXi, process names starting with vmx are associated with running VMs. An adversary can use the pkill command to kill all processes with a prefix vmx.\n[Reference](https://www.crowdstrike.com/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/)\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "vm_host": {
                                "description": "Specify the host name of the ESXi Server",
                                "type": "string",
                                "default": "atomic.local"
                            },
                            "vm_user": {
                                "description": "Specify the privilege user account on ESXi Server",
                                "type": "string",
                                "default": "root"
                            },
                            "vm_pass": {
                                "description": "Specify the privilege user password on ESXi Server",
                                "type": "string",
                                "default": "pass"
                            },
                            "plink_file": {
                                "description": "Path to plink",
                                "type": "path",
                                "default": "PathToAtomicsFolder\\..\\ExternalPayloads\\plink.exe"
                            },
                            "cli_script": {
                                "description": "Path to text with commands",
                                "type": "path",
                                "default": "PathToAtomicsFolder\\T1529\\src\\esx_pkill.txt"
                            }
                        },
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "Check if plink is available.\n",
                                "prereq_command": "if (Test-Path \"#{plink_file}\") {exit 0} else {exit 1}\n",
                                "get_prereq_command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://the.earth.li/~sgtatham/putty/latest/w64/plink.exe\" -OutFile \"#{plink_file}\"\n"
                            }
                        ],
                        "executor": {
                            "command": "echo \"\" | \"#{plink_file}\" \"#{vm_host}\" -ssh  -l \"#{vm_user}\" -pw \"#{vm_pass}\" -m \"#{cli_script}\"\n",
                            "name": "command_prompt",
                            "elevation_required": false
                        }
                    },
                    {
                        "name": "ESXi - Avoslocker enumerates VMs and forcefully kills VMs",
                        "auto_generated_guid": "189f7d6e-9442-4160-9bc3-5e4104d93ece",
                        "description": "Avoslocker malware has inbuilt functionality to enumerate the VM instances and uses the esxcli command to forcefully power off them.\n[Reference](https://blogs.vmware.com/security/2022/02/avoslocker-modern-linux-ransomware-threats.html)\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "vm_host": {
                                "description": "Specify the host name of the ESXi Server",
                                "type": "string",
                                "default": "atomic.local"
                            },
                            "vm_user": {
                                "description": "Specify the privilege user account on ESXi Server",
                                "type": "string",
                                "default": "root"
                            },
                            "vm_pass": {
                                "description": "Specify the privilege user password on ESXi Server",
                                "type": "string",
                                "default": "pass"
                            },
                            "plink_file": {
                                "description": "Path to plink",
                                "type": "path",
                                "default": "PathToAtomicsFolder\\..\\ExternalPayloads\\plink.exe"
                            },
                            "cli_script": {
                                "description": "Path to text with commands",
                                "type": "path",
                                "default": "PathToAtomicsFolder\\T1529\\src\\esx_avoslocker_kill_vm.txt"
                            }
                        },
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "Check if plink is available.\n",
                                "prereq_command": "if (Test-Path \"#{plink_file}\") {exit 0} else {exit 1}\n",
                                "get_prereq_command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://the.earth.li/~sgtatham/putty/latest/w64/plink.exe\" -OutFile \"#{plink_file}\"\n"
                            }
                        ],
                        "executor": {
                            "command": "echo \"\" | \"#{plink_file}\" \"#{vm_host}\" -ssh  -l \"#{vm_user}\" -pw \"#{vm_pass}\" -m \"#{cli_script}\"\n",
                            "name": "command_prompt",
                            "elevation_required": false
                        }
                    },
                    {
                        "name": "ESXi - vim-cmd Used to Power Off VMs",
                        "auto_generated_guid": "622cc1a0-45e7-428c-aed7-c96dd605fbe6",
                        "description": "Adversaries may power off VMs to facilitate the deployment of ransomware payloads.\n[Reference](https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/vim-cmd/#power%20off%20vm)\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "vm_host": {
                                "description": "Specify the host name or IP of the ESXi server.",
                                "type": "string",
                                "default": "atomic.local"
                            },
                            "vm_user": {
                                "description": "Specify the privilege user account on the ESXi server.",
                                "type": "string",
                                "default": "root"
                            },
                            "vm_pass": {
                                "description": "Specify the privileged user's password.",
                                "type": "string",
                                "default": "password"
                            },
                            "plink_file": {
                                "description": "Path to Plink",
                                "type": "path",
                                "default": "PathToAtomicsFolder\\..\\ExternalPayloads\\plink.exe"
                            }
                        },
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "Check if we have plink\n",
                                "prereq_command": "if (Test-Path \"#{plink_file}\") {exit 0} else {exit 1}\n",
                                "get_prereq_command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://the.earth.li/~sgtatham/putty/latest/w64/plink.exe\" -OutFile \"#{plink_file}\"\n"
                            }
                        ],
                        "executor": {
                            "command": "echo \"\" | \"#{plink_file}\" -batch \"#{vm_host}\" -ssh -l #{vm_user} -pw \"#{vm_pass}\" \"for i in `vim-cmd vmsvc/getallvms | awk 'NR>1 {print $1}'`; do vim-cmd vmsvc/power.off $i & done\"\n",
                            "name": "command_prompt",
                            "elevation_required": false
                        }
                    }
                ]
            }
        ]
    },
    "timestamp": "2025-02-28 15:03:36"
}