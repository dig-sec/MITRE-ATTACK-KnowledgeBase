{
    "id": "T1204",
    "name": "User Execution",
    "description": "An adversary may rely upon specific actions by a user in order to gain execution. Users may be subjected to social engineering to get them to execute malicious code by, for example, opening a malicious document file or link. These user actions will typically be observed as follow-on behavior from forms of [Phishing](T1566).\nWhile [User Execution](T1204) frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after [Internal Spearphishing](T1534).",
    "platforms": "Linux, Windows, macOS, IaaS, Containers",
    "kill_chain_phases": "Execution",
    "data_sources": "Application Log: Application Log Content, Instance: Instance Start, Instance: Instance Creation, Image: Image Creation, Command: Command Execution, Container: Container Start, Container: Container Creation, Network Traffic: Network Connection Creation, Network Traffic: Network Traffic Content, File: File Creation, Process: Process Creation",
    "detection": "Monitor the execution of and command-line arguments for applications that may be used by an adversary to gain Initial Access that require user interaction. This includes compression applications, such as those for zip files, that can be used to [Deobfuscate/Decode Files or Information](T1140) in payloads.\nAnti-virus can potentially detect malicious documents and files that are downloaded and executed on the user's computer. Endpoint sensing or network sensing can potentially detect malicious events once the file is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning powershell.exe).",
    "url": "https://attack.mitre.org/techniques/T1204",
    "enrichments": {
        "attack_rule_map": [],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "401e5d00-b944-11ea-8f9a-00163ecd60ae",
                    "4b1c186d-8bf2-4297-9cbc-f8f00192770b",
                    "932ac737-33ca-4afd-9869-0d48b391fcc9",
                    "548bf7ad-e19c-4d74-84bf-84ac4e57f505",
                    "7bf1cd5f-1f26-47b9-aed8-0e6275996aa1",
                    "0acaad27-9f02-4136-a243-c357202edd74",
                    "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                    "29fd07fc-9cfd-4331-b7fd-cc18dfa21052",
                    "5eeec9aa-9d88-4ece-9e6f-9d92884ae404",
                    "ba6b9e43-1d45-4d3c-a504-1043a64c8469",
                    "d13c43f0-f66b-4279-8b2c-5912077c1780",
                    "438025f9-5856-4663-83f7-52f878a70a50",
                    "7417e29e-c2e7-4cf6-a2e8-767228c64837",
                    "965fff6c-1d7e-4e25-91fd-cdccd75f7d2c",
                    "b5de2919-b74a-4805-91a7-5049accbaefe",
                    "234dc5df-40b5-49d1-bf53-0d44ce778eca",
                    "8c32eb4d-805f-4fc5-bf60-c4d476c131b5",
                    "5325945e-f1f0-406e-97b8-65104d393fff",
                    "ff0f2b05-09db-4095-b96d-1b75ca24894a",
                    "5d498330-f574-4889-bcc9-c53c950d210f",
                    "5ea0b0dc-45d0-4d5e-bed5-4271950d210f",
                    "5c0abf20-a720-47f4-ae29-5eb60acd0835",
                    "e6ce8457-68b1-485b-9bdd-3c2b5d679aa9",
                    "aa3a6f94-890e-4e22-b634-ffdfd54792cc",
                    "abfb5a93-e695-4ee9-bc10-541290bcd663",
                    "864403a1-36c9-40a2-a982-4c9a45f7d833",
                    "5b9123c0-1480-4e09-877e-4783950d210f",
                    "90217a70-13fc-48e4-b3db-0d836c5824ac",
                    "5ce6aa86-9cd8-4302-9dc9-4a59950d210f",
                    "5f17a0c6-7b04-4f05-9fda-b5d435a8d6a4",
                    "00d0b5ab-1f55-4120-8e83-487c0a7baf19",
                    "a2a3b925-7bb0-433b-b508-db9003263cc4",
                    "678eb5f4-8597-4be6-8be7-905e4234b53a",
                    "fa0c05b6-8ad3-468d-8231-c1cbccb64fba",
                    "4922a5dd-6743-4fc2-8e81-144374280997",
                    "24de4f3b-804c-4165-b442-5a06a2302c7e",
                    "5dee2bc3-47ac-4784-a52a-4da2950d210f",
                    "5e55be1a-3a30-48ae-9934-4199950d210f",
                    "6e4dcdd1-e48b-42f7-b2d8-3b413fc58cb4",
                    "fdd84c68-a1f6-47c9-9477-920584f94905"
                ],
                "lookup_results": [
                    {
                        "uuid": "401e5d00-b944-11ea-8f9a-00163ecd60ae",
                        "lookup_data": {
                            "description": "Detect run not allowed files. Applocker is a very useful tool, especially on servers where unprivileged users have access. For example terminal servers. You need configure applocker and log collect to receive these events.",
                            "raw": "author: Pushkarev Dmitry\ndate: 2020/06/28\ndescription: Detect run not allowed files. Applocker is a very useful tool, especially\n  on servers where unprivileged users have access. For example terminal servers. You\n  need configure applocker and log collect to receive these events.\ndetection:\n  condition: selection\n  selection:\n    EventID:\n    - 8004\n    - 8007\n    - 8022\n    - 8025\nfalsepositives:\n- Need tuning applocker or add exceptions in SIEM\nfields:\n- PolicyName\n- RuleId\n- RuleName\n- TargetUser\n- TargetProcessId\n- FilePath\n- FileHash\n- Fqbn\nid: 401e5d00-b944-11ea-8f9a-00163ecd60ae\nlevel: medium\nlogsource:\n  product: windows\n  service: applocker\nmodified: 2021/11/27\nreferences:\n- https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/applocker/what-is-applocker\n- https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/applocker/using-event-viewer-with-applocker\n- https://nxlog.co/documentation/nxlog-user-guide/applocker.html\nstatus: test\ntags:\n- attack.execution\n- attack.t1204.002\n- attack.t1059.001\n- attack.t1059.003\n- attack.t1059.005\n- attack.t1059.006\n- attack.t1059.007\ntitle: File Was Not Allowed To Run\n",
                            "sigma:id": "401e5d00-b944-11ea-8f9a-00163ecd60ae",
                            "title": "File Was Not Allowed To Run",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4b1c186d-8bf2-4297-9cbc-f8f00192770b",
                        "lookup_data": {
                            "description": "Prynt Stealer Spotted In the Wild - A New Info Stealer Performing Clipper And Keylogger Activities",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/4b1c186d-8bf2-4297-9cbc-f8f00192770b.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1666601854",
                            "uuid": "4b1c186d-8bf2-4297-9cbc-f8f00192770b",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "932ac737-33ca-4afd-9869-0d48b391fcc9",
                        "lookup_data": {
                            "description": "Detects Ursnif C2 traffic.",
                            "raw": "author: Thomas Patzke\ndate: 2019/12/19\ndescription: Detects Ursnif C2 traffic.\ndetection:\n  b64encoding:\n    c-uri|contains:\n    - _2f\n    - _2b\n  condition: b64encoding and urlpatterns\n  urlpatterns:\n    c-uri|contains|all:\n    - .avi\n    - /images/\nfalsepositives:\n- Unknown\nfields:\n- c-ip\n- c-uri\n- sc-bytes\n- c-ua\nid: 932ac737-33ca-4afd-9869-0d48b391fcc9\nlevel: critical\nlogsource:\n  category: proxy\nmodified: 2021/08/09\nreferences:\n- https://www.fortinet.com/blog/threat-research/ursnif-variant-spreading-word-document.html\nstatus: stable\ntags:\n- attack.initial_access\n- attack.t1566.001\n- attack.execution\n- attack.t1204.002\n- attack.command_and_control\n- attack.t1071.001\ntitle: Ursnif Malware C2 URL Pattern\n",
                            "sigma:id": "932ac737-33ca-4afd-9869-0d48b391fcc9",
                            "title": "Ursnif Malware C2 URL Pattern",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "548bf7ad-e19c-4d74-84bf-84ac4e57f505",
                        "lookup_data": {
                            "mitre-attack-id": "T1204",
                            "mitre-cti:description": "Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events. Application whitelisting may be able to prevent the running of executables masquerading as other files.\n\nIf a link is being visited by a user, block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr, .exe, .lnk, .pif, .cpl, etc. Some download scanning devices can open and analyze compressed and encrypted formats, such as zip and RAR that may be used to conceal malicious files in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\n\nIf a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity. Solutions can be signature and behavior based, but adversaries may construct files in a way to avoid these systems.",
                            "mitre-cti:name": "User Execution Mitigation",
                            "mitre-cti:type": "course-of-action",
                            "raw": "{'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'course-of-action--548bf7ad-e19c-4d74-84bf-84ac4e57f505', 'type': 'course-of-action', 'created': '2018-10-17T00:14:20.652Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/mitigations/T1204', 'external_id': 'T1204'}], 'modified': '2019-07-25T12:31:53.804Z', 'name': 'User Execution Mitigation', 'description': 'Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events. Application whitelisting may be able to prevent the running of executables masquerading as other files.\\n\\nIf a link is being visited by a user, block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr, .exe, .lnk, .pif, .cpl, etc. Some download scanning devices can open and analyze compressed and encrypted formats, such as zip and RAR that may be used to conceal malicious files in [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027).\\n\\nIf a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity. Solutions can be signature and behavior based, but adversaries may construct files in a way to avoid these systems.', 'x_mitre_deprecated': True, 'x_mitre_version': '1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "7bf1cd5f-1f26-47b9-aed8-0e6275996aa1",
                        "lookup_data": {
                            "description": "Alert (AA23-025A) - Protecting Against Malicious Use of Remote Monitoring and Management Software",
                            "link": "http://www.botvrij.eu/data/feed-osint/7bf1cd5f-1f26-47b9-aed8-0e6275996aa1.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1674714919",
                            "uuid": "7bf1cd5f-1f26-47b9-aed8-0e6275996aa1",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "0acaad27-9f02-4136-a243-c357202edd74",
                        "lookup_data": {
                            "description": "Detects Ryuk Ransomware command lines",
                            "raw": "author: Vasiliy Burov\ndate: 2019/08/06\ndescription: Detects Ryuk Ransomware command lines\ndetection:\n  condition: all of selection*\n  selection1:\n    CommandLine|contains: stop\n    Image|endswith:\n    - \\net.exe\n    - \\net1.exe\n  selection2:\n    CommandLine|contains:\n    - samss\n    - audioendpointbuilder\n    - unistoresvc_\nfalsepositives:\n- Unlikely\nid: 0acaad27-9f02-4136-a243-c357202edd74\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/02\nreferences:\n- https://research.checkpoint.com/ryuk-ransomware-targeted-campaign-break/\nstatus: stable\ntags:\n- attack.execution\n- attack.t1204\ntitle: Ryuk Ransomware Command Line Activity\n",
                            "sigma:id": "0acaad27-9f02-4136-a243-c357202edd74",
                            "title": "Ryuk Ransomware Command Line Activity",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                        "lookup_data": {
                            "description": "SectorJ04 Groupâ€™s Increased Activity in 2019",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5d6e7aa3-aca4-46cc-b96a-46ac950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1568039252",
                            "uuid": "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "29fd07fc-9cfd-4331-b7fd-cc18dfa21052",
                        "lookup_data": {
                            "description": "Detects specific process characteristics of Maze ransomware word document droppers",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2020/05/08\ndescription: Detects specific process characteristics of Maze ransomware word document\n  droppers\ndetection:\n  condition: 1 of selection*\n  selection1:\n    Image|endswith: .tmp\n    ParentImage|endswith: \\WINWORD.exe\n  selection2:\n    CommandLine|endswith: shadowcopy delete\n    Image|endswith: \\wmic.exe\n    ParentImage|contains: \\Temp\\\n  selection3:\n    CommandLine|contains: \\..\\..\\system32\n    CommandLine|endswith: shadowcopy delete\nfalsepositives:\n- Unlikely\nfields:\n- ComputerName\n- User\n- Image\nid: 29fd07fc-9cfd-4331-b7fd-cc18dfa21052\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/06/27\nreferences:\n- https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html\n- https://app.any.run/tasks/51e7185c-52d7-4efb-ac0d-e86340053473/\n- https://app.any.run/tasks/65a79440-373a-4725-8d74-77db9f2abda4/\nstatus: test\ntags:\n- attack.execution\n- attack.t1204.002\n- attack.t1047\n- attack.impact\n- attack.t1490\ntitle: Maze Ransomware\n",
                            "sigma:id": "29fd07fc-9cfd-4331-b7fd-cc18dfa21052",
                            "title": "Maze Ransomware",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5eeec9aa-9d88-4ece-9e6f-9d92884ae404",
                        "lookup_data": {
                            "description": "Dissecting PlugX to Extract Its Crown Jewels",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5eeec9aa-9d88-4ece-9e6f-9d92884ae404.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1663580963",
                            "uuid": "5eeec9aa-9d88-4ece-9e6f-9d92884ae404",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ba6b9e43-1d45-4d3c-a504-1043a64c8469",
                        "lookup_data": {
                            "description": "Detects static QMS 810 and mimikatz driver name used by Mimikatz as exploited in CVE-2021-1675 and CVE-2021-34527",
                            "raw": "author: Markus Neis, @markus_neis, Florian Roth\ndate: 2021/07/04\ndescription: Detects static QMS 810 and mimikatz driver name used by Mimikatz as exploited\n  in CVE-2021-1675 and CVE-2021-34527\ndetection:\n  condition: selection or selection_alt or (selection_print and selection_kiwi)\n  selection:\n    TargetObject|contains:\n    - \\Control\\Print\\Environments\\Windows x64\\Drivers\\Version-3\\QMS 810\\\n    - \\Control\\Print\\Environments\\Windows x64\\Drivers\\Version-3\\mimikatz\n  selection_alt:\n    TargetObject|contains|all:\n    - legitprinter\n    - \\Control\\Print\\Environments\\Windows\n  selection_kiwi:\n    TargetObject|contains:\n    - Gentil Kiwi\n    - mimikatz printer\n    - Kiwi Legit Printer\n  selection_print:\n    TargetObject|contains:\n    - \\Control\\Print\\Environments\n    - \\CurrentVersion\\Print\\Printers\nfalsepositives:\n- Legitimate installation of printer driver QMS 810, Texas Instruments microLaser\n  printer (unlikely)\nid: ba6b9e43-1d45-4d3c-a504-1043a64c8469\nlevel: critical\nlogsource:\n  category: registry_event\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://github.com/gentilkiwi/mimikatz/commit/c21276072b3f2a47a21e215a46962a17d54b3760\n- https://www.lexjansen.com/sesug/1993/SESUG93035.pdf\n- https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rprn/4464eaf0-f34f-40d5-b970-736437a21913\nstatus: test\ntags:\n- attack.execution\n- attack.t1204\n- cve.2021.1675\n- cve.2021.34527\ntitle: PrinterNightmare Mimimkatz Driver Name\n",
                            "sigma:id": "ba6b9e43-1d45-4d3c-a504-1043a64c8469",
                            "title": "PrinterNightmare Mimimkatz Driver Name",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d13c43f0-f66b-4279-8b2c-5912077c1780",
                        "lookup_data": {
                            "description": "Detects CLR DLL being loaded by an Office Product",
                            "raw": "author: Antonlovesdnb\ndate: 2020/02/19\ndescription: Detects CLR DLL being loaded by an Office Product\ndetection:\n  condition: selection\n  selection:\n    ImageLoaded|contains: \\clr.dll\n    Image|endswith:\n    - \\winword.exe\n    - \\powerpnt.exe\n    - \\excel.exe\n    - \\outlook.exe\nfalsepositives:\n- Alerts on legitimate macro usage as well, will need to filter as appropriate\nid: d13c43f0-f66b-4279-8b2c-5912077c1780\nlevel: high\nlogsource:\n  category: image_load\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nstatus: test\ntags:\n- attack.execution\n- attack.t1204.002\ntitle: CLR DLL Loaded Via Office Applications\n",
                            "sigma:id": "d13c43f0-f66b-4279-8b2c-5912077c1780",
                            "title": "CLR DLL Loaded Via Office Applications",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "438025f9-5856-4663-83f7-52f878a70a50",
                        "lookup_data": {
                            "description": "Detects a Windows command and scripting interpreter executable started from Microsoft Word, Excel, Powerpoint, Publisher and Visio",
                            "raw": "author: Michael Haag, Florian Roth (Nextron Systems), Markus Neis, Elastic, FPT.EagleEye\n  Team\ndate: 2018/04/06\ndescription: Detects a Windows command and scripting interpreter executable started\n  from Microsoft Word, Excel, Powerpoint, Publisher and Visio\ndetection:\n  condition: selection\n  selection:\n    Image|endswith:\n    - \\cmd.exe\n    - \\powershell.exe\n    - \\pwsh.exe\n    - \\wscript.exe\n    - \\cscript.exe\n    - \\sh.exe\n    - \\bash.exe\n    - \\scrcons.exe\n    - \\schtasks.exe\n    - \\regsvr32.exe\n    - \\hh.exe\n    - \\wmic.exe\n    - \\mshta.exe\n    - \\rundll32.exe\n    - \\msiexec.exe\n    - \\forfiles.exe\n    - \\scriptrunner.exe\n    - \\mftrace.exe\n    - \\AppVLP.exe\n    - \\svchost.exe\n    - \\msbuild.exe\n    ParentImage|endswith:\n    - \\WINWORD.EXE\n    - \\EXCEL.EXE\n    - \\POWERPNT.exe\n    - \\MSPUB.exe\n    - \\VISIO.exe\n    - \\MSACCESS.EXE\n    - \\EQNEDT32.EXE\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\n- ParentCommandLine\nid: 438025f9-5856-4663-83f7-52f878a70a50\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/07/14\nreferences:\n- https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100\n- https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\nstatus: test\ntags:\n- attack.execution\n- attack.t1204.002\ntitle: Microsoft Office Product Spawning Windows Shell\n",
                            "sigma:id": "438025f9-5856-4663-83f7-52f878a70a50",
                            "title": "Microsoft Office Product Spawning Windows Shell",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "7417e29e-c2e7-4cf6-a2e8-767228c64837",
                        "lookup_data": {
                            "description": "Detects Kerberos DLL being loaded by an Office Product",
                            "raw": "author: Antonlovesdnb\ndate: 2020/02/19\ndescription: Detects Kerberos DLL being loaded by an Office Product\ndetection:\n  condition: selection\n  selection:\n    ImageLoaded|endswith: \\kerberos.dll\n    Image|endswith:\n    - \\winword.exe\n    - \\powerpnt.exe\n    - \\excel.exe\n    - \\outlook.exe\nfalsepositives:\n- Alerts on legitimate macro usage as well, will need to filter as appropriate\nid: 7417e29e-c2e7-4cf6-a2e8-767228c64837\nlevel: high\nlogsource:\n  category: image_load\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nstatus: test\ntags:\n- attack.execution\n- attack.t1204.002\ntitle: Active Directory Kerberos DLL Loaded Via Office Applications\n",
                            "sigma:id": "7417e29e-c2e7-4cf6-a2e8-767228c64837",
                            "title": "Active Directory Kerberos DLL Loaded Via Office Applications",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "965fff6c-1d7e-4e25-91fd-cdccd75f7d2c",
                        "lookup_data": {
                            "description": "Detects DarkSide Ransomware and helpers",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2021/05/14\ndescription: Detects DarkSide Ransomware and helpers\ndetection:\n  condition: 1 of selection*\n  selection1:\n    CommandLine|contains:\n    - =[char][byte]('0x'+\n    - ' -work worker0 -path '\n  selection2:\n    Image|contains: \\AppData\\Local\\Temp\\\n    ParentCommandLine|contains: DllHost.exe /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}\nfalsepositives:\n- Unknown\n- UAC bypass method used by other malware\nid: 965fff6c-1d7e-4e25-91fd-cdccd75f7d2c\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://www.fireeye.com/blog/threat-research/2021/05/shining-a-light-on-darkside-ransomware-operations.html\n- https://app.any.run/tasks/8b9a571b-bcc1-4783-ba32-df4ba623b9c0/\n- https://www.joesandbox.com/analysis/411752/0/html#7048BB9A06B8F2DD9D24C77F389D7B2B58D2\nstatus: test\ntags:\n- attack.execution\n- attack.t1204\ntitle: DarkSide Ransomware Pattern\n",
                            "sigma:id": "965fff6c-1d7e-4e25-91fd-cdccd75f7d2c",
                            "title": "DarkSide Ransomware Pattern",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b5de2919-b74a-4805-91a7-5049accbaefe",
                        "lookup_data": {
                            "description": "Detects executable downloads from suspicious remote systems",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/03/13\ndescription: Detects executable downloads from suspicious remote systems\ndetection:\n  condition: selection and not filter\n  filter:\n    r-dns|endswith:\n    - .com\n    - .org\n    - .net\n    - .edu\n    - .gov\n    - .uk\n    - .ca\n    - .de\n    - .jp\n    - .fr\n    - .au\n    - .us\n    - .ch\n    - .it\n    - .nl\n    - .se\n    - .no\n    - .es\n  selection:\n    c-uri-extension:\n    - exe\n    - vbs\n    - bat\n    - rar\n    - ps1\n    - doc\n    - docm\n    - xls\n    - xlsm\n    - pptm\n    - rtf\n    - hta\n    - dll\n    - ws\n    - wsf\n    - sct\n    - zip\nfalsepositives:\n- All kind of software downloads\nfields:\n- ClientIP\n- c-uri\nid: b5de2919-b74a-4805-91a7-5049accbaefe\nlevel: low\nlogsource:\n  category: proxy\nmodified: 2023/01/09\nrelated:\n- id: 00d0b5ab-1f55-4120-8e83-487c0a7baf19\n  type: similar\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1566\n- attack.execution\n- attack.t1203\n- attack.t1204.002\ntitle: Download From Suspicious TLD - Whitelist\n",
                            "sigma:id": "b5de2919-b74a-4805-91a7-5049accbaefe",
                            "title": "Download From Suspicious TLD - Whitelist",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "234dc5df-40b5-49d1-bf53-0d44ce778eca",
                        "lookup_data": {
                            "description": "Detects when a built-in utility is used to decode and decrypt a payload after a macOS disk image (DMG) is executed. Malware authors may attempt to evade detection and trick users into executing malicious code by encoding and encrypting their payload and placing it in a disk image file. This behavior is consistent with adware or malware families such as Bundlore and Shlayer.",
                            "raw": "author: Tim Rauch (rule), Elastic (idea)\ndate: 2022/10/17\ndescription: Detects when a built-in utility is used to decode and decrypt a payload\n  after a macOS disk image (DMG) is executed. Malware authors may attempt to evade\n  detection and trick users into executing malicious code by encoding and encrypting\n  their payload and placing it in a disk image file. This behavior is consistent with\n  adware or malware families such as Bundlore and Shlayer.\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - /Volumes/\n    - enc\n    - -base64\n    - ' -d '\n    Image|endswith: /openssl\nfalsepositives:\n- Unknown\nid: 234dc5df-40b5-49d1-bf53-0d44ce778eca\nlevel: medium\nlogsource:\n  category: process_creation\n  product: macos\nreferences:\n- https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-5d42c3d772e04f1e8d0eb60f5233bc79def1ea73105a2d8822f44164f77ef823\nstatus: experimental\ntags:\n- attack.t1059\n- attack.t1204\n- attack.execution\n- attack.t1140\n- attack.defense_evasion\n- attack.s0482\n- attack.s0402\ntitle: Payload Decoded and Decrypted via Built-in Utilities\n",
                            "sigma:id": "234dc5df-40b5-49d1-bf53-0d44ce778eca",
                            "title": "Payload Decoded and Decrypted via Built-in Utilities",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "8c32eb4d-805f-4fc5-bf60-c4d476c131b5",
                        "lookup_data": {
                            "mitre-attack-id": "T1204",
                            "mitre-cti:description": "An adversary may rely upon specific actions by a user in order to gain execution. Users may be subjected to social engineering to get them to execute malicious code by, for example, opening a malicious document file or link. These user actions will typically be observed as follow-on behavior from forms of [Phishing](https://attack.mitre.org/techniques/T1566).\n\nWhile [User Execution](https://attack.mitre.org/techniques/T1204) frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after [Internal Spearphishing](https://attack.mitre.org/techniques/T1534).\n\nAdversaries may also deceive users into performing actions such as enabling [Remote Access Software](https://attack.mitre.org/techniques/T1219), allowing direct control of the system to the adversary, or downloading and executing malware for [User Execution](https://attack.mitre.org/techniques/T1204). For example, tech support scams can be facilitated through [Phishing](https://attack.mitre.org/techniques/T1566), vishing, or various forms of user interaction. Adversaries can use a combination of these methods, such as spoofing and promoting toll-free numbers or call centers that are used to direct victims to malicious websites, to deliver and execute payloads containing malware or [Remote Access Software](https://attack.mitre.org/techniques/T1219).(Citation: Telephone Attack Delivery)",
                            "mitre-cti:name": "User Execution",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'x_mitre_platforms': ['Linux', 'Windows', 'macOS', 'IaaS', 'Containers'], 'x_mitre_domains': ['enterprise-attack'], 'x_mitre_contributors': ['Oleg Skulkin, Group-IB'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'type': 'attack-pattern', 'id': 'attack-pattern--8c32eb4d-805f-4fc5-bf60-c4d476c131b5', 'created': '2018-04-18T17:59:24.739Z', 'x_mitre_version': '1.5', 'external_references': [{'source_name': 'mitre-attack', 'external_id': 'T1204', 'url': 'https://attack.mitre.org/techniques/T1204'}, {'source_name': 'Telephone Attack Delivery', 'url': 'https://www.proofpoint.com/us/blog/threat-insight/caught-beneath-landline-411-telephone-oriented-attack-delivery', 'description': 'Selena Larson, Sam Scholten, Timothy Kromphardt. (2021, November 4). Caught Beneath the Landline: A 411 on Telephone Oriented Attack Delivery. Retrieved January 5, 2022.'}], 'x_mitre_deprecated': False, 'revoked': False, 'description': \"An adversary may rely upon specific actions by a user in order to gain execution. Users may be subjected to social engineering to get them to execute malicious code by, for example, opening a malicious document file or link. These user actions will typically be observed as follow-on behavior from forms of [Phishing](https://attack.mitre.org/techniques/T1566).\\n\\nWhile [User Execution](https://attack.mitre.org/techniques/T1204) frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after [Internal Spearphishing](https://attack.mitre.org/techniques/T1534).\\n\\nAdversaries may also deceive users into performing actions such as enabling [Remote Access Software](https://attack.mitre.org/techniques/T1219), allowing direct control of the system to the adversary, or downloading and executing malware for [User Execution](https://attack.mitre.org/techniques/T1204). For example, tech support scams can be facilitated through [Phishing](https://attack.mitre.org/techniques/T1566), vishing, or various forms of user interaction. Adversaries can use a combination of these methods, such as spoofing and promoting toll-free numbers or call centers that are used to direct victims to malicious websites, to deliver and execute payloads containing malware or [Remote Access Software](https://attack.mitre.org/techniques/T1219).(Citation: Telephone Attack Delivery)\", 'modified': '2022-04-19T20:31:15.373Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'name': 'User Execution', 'x_mitre_detection': \"Monitor the execution of and command-line arguments for applications that may be used by an adversary to gain Initial Access that require user interaction. This includes compression applications, such as those for zip files, that can be used to [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140) in payloads.\\n\\nAnti-virus can potentially detect malicious documents and files that are downloaded and executed on the user's computer. Endpoint sensing or network sensing can potentially detect malicious events once the file is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning powershell.exe).\", 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'execution'}], 'x_mitre_is_subtechnique': False, 'x_mitre_data_sources': ['Container: Container Creation', 'Network Traffic: Network Connection Creation', 'Container: Container Start', 'Instance: Instance Creation', 'Instance: Instance Start', 'Image: Image Creation', 'Process: Process Creation', 'Network Traffic: Network Traffic Content', 'Command: Command Execution', 'Application Log: Application Log Content', 'File: File Creation'], 'x_mitre_remote_support': False, 'x_mitre_attack_spec_version': '2.1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5325945e-f1f0-406e-97b8-65104d393fff",
                        "lookup_data": {
                            "description": "Detects specific process characteristics of Snatch ransomware word document droppers",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2020/08/26\ndescription: Detects specific process characteristics of Snatch ransomware word document\n  droppers\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains:\n    - shutdown /r /f /t 00\n    - net stop SuperBackupMan\nfalsepositives:\n- Scripts that shutdown the system immediately and reboot them in safe mode are unlikely\nfields:\n- ComputerName\n- User\n- Image\nid: 5325945e-f1f0-406e-97b8-65104d393fff\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/\nstatus: stable\ntags:\n- attack.execution\n- attack.t1204\ntitle: Snatch Ransomware\n",
                            "sigma:id": "5325945e-f1f0-406e-97b8-65104d393fff",
                            "title": "Snatch Ransomware",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ff0f2b05-09db-4095-b96d-1b75ca24894a",
                        "lookup_data": {
                            "description": "Detects any assembly DLL being loaded by an Office Product",
                            "raw": "author: Antonlovesdnb\ndate: 2020/02/19\ndescription: Detects any assembly DLL being loaded by an Office Product\ndetection:\n  condition: selection\n  selection:\n    ImageLoaded|startswith: C:\\Windows\\assembly\\\n    Image|endswith:\n    - \\winword.exe\n    - \\powerpnt.exe\n    - \\excel.exe\n    - \\outlook.exe\nfalsepositives:\n- Alerts on legitimate macro usage as well, will need to filter as appropriate\nid: ff0f2b05-09db-4095-b96d-1b75ca24894a\nlevel: high\nlogsource:\n  category: image_load\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nstatus: test\ntags:\n- attack.execution\n- attack.t1204.002\ntitle: dotNET DLL Loaded Via Office Applications\n",
                            "sigma:id": "ff0f2b05-09db-4095-b96d-1b75ca24894a",
                            "title": "dotNET DLL Loaded Via Office Applications",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d498330-f574-4889-bcc9-c53c950d210f",
                        "lookup_data": {
                            "description": "OSINT - Sharpening the Machete",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5d498330-f574-4889-bcc9-c53c950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1566552908",
                            "uuid": "5d498330-f574-4889-bcc9-c53c950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5ea0b0dc-45d0-4d5e-bed5-4271950d210f",
                        "lookup_data": {
                            "description": "Ursnif Campaign f1.pipen.at",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5ea0b0dc-45d0-4d5e-bed5-4271950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1592743551",
                            "uuid": "5ea0b0dc-45d0-4d5e-bed5-4271950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5c0abf20-a720-47f4-ae29-5eb60acd0835",
                        "lookup_data": {
                            "description": "Flash CVE-2018-15982 IOCs",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5c0abf20-a720-47f4-ae29-5eb60acd0835.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1544209363",
                            "uuid": "5c0abf20-a720-47f4-ae29-5eb60acd0835",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "e6ce8457-68b1-485b-9bdd-3c2b5d679aa9",
                        "lookup_data": {
                            "description": "Detects VB DLL's loaded by an office application. Which could indicate the presence of VBA Macros.",
                            "raw": "author: Antonlovesdnb\ndate: 2020/02/19\ndescription: Detects VB DLL's loaded by an office application. Which could indicate\n  the presence of VBA Macros.\ndetection:\n  condition: selection\n  selection:\n    ImageLoaded|endswith:\n    - \\VBE7.DLL\n    - \\VBEUI.DLL\n    - \\VBE7INTL.DLL\n    Image|endswith:\n    - \\winword.exe\n    - \\powerpnt.exe\n    - \\excel.exe\n    - \\outlook.exe\nfalsepositives:\n- Alerts on legitimate macro usage as well, will need to filter as appropriate\nid: e6ce8457-68b1-485b-9bdd-3c2b5d679aa9\nlevel: high\nlogsource:\n  category: image_load\n  product: windows\nmodified: 2023/01/06\nreferences:\n- https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nstatus: test\ntags:\n- attack.execution\n- attack.t1204.002\ntitle: VBA DLL Loaded Via Office Application\n",
                            "sigma:id": "e6ce8457-68b1-485b-9bdd-3c2b5d679aa9",
                            "title": "VBA DLL Loaded Via Office Application",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "aa3a6f94-890e-4e22-b634-ffdfd54792cc",
                        "lookup_data": {
                            "description": "Detects an executable in the users directory started from Microsoft Word, Excel, Powerpoint, Publisher or Visio",
                            "raw": "author: Jason Lynch\ndate: 2019/04/02\ndescription: Detects an executable in the users directory started from Microsoft Word,\n  Excel, Powerpoint, Publisher or Visio\ndetection:\n  condition: selection and not filter\n  filter:\n    Image|endswith: \\Teams.exe\n  selection:\n    Image|endswith: .exe\n    Image|startswith: C:\\users\\\n    ParentImage|endswith:\n    - \\WINWORD.EXE\n    - \\EXCEL.EXE\n    - \\POWERPNT.exe\n    - \\MSPUB.exe\n    - \\VISIO.exe\n    - \\MSACCESS.exe\n    - \\EQNEDT32.exe\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\n- ParentCommandLine\nid: aa3a6f94-890e-4e22-b634-ffdfd54792cc\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/06/02\nreferences:\n- sha256=23160972c6ae07f740800fa28e421a81d7c0ca5d5cab95bc082b4a986fbac57c\n- https://blog.morphisec.com/fin7-not-finished-morphisec-spots-new-campaign\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1204.002\n- attack.g0046\n- car.2013-05-002\ntitle: MS Office Product Spawning Exe in User Dir\n",
                            "sigma:id": "aa3a6f94-890e-4e22-b634-ffdfd54792cc",
                            "title": "MS Office Product Spawning Exe in User Dir",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "abfb5a93-e695-4ee9-bc10-541290bcd663",
                        "lookup_data": {
                            "description": "Aoqin Dragon | Newly-Discovered Chinese-linked APT Has Been Quietly Spying On Organizations For 10 Years",
                            "link": "http://www.botvrij.eu/data/feed-osint/abfb5a93-e695-4ee9-bc10-541290bcd663.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1655839499",
                            "uuid": "abfb5a93-e695-4ee9-bc10-541290bcd663",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "864403a1-36c9-40a2-a982-4c9a45f7d833",
                        "lookup_data": {
                            "description": "Detects Winword starting uncommon sub process FLTLDR.exe as used in exploits for CVE-2017-0261 and CVE-2017-0262",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2018/02/22\ndescription: Detects Winword starting uncommon sub process FLTLDR.exe as used in exploits\n  for CVE-2017-0261 and CVE-2017-0262\ndetection:\n  condition: selection\n  selection:\n    Image|contains: \\FLTLDR.exe\n    ParentImage|endswith: \\WINWORD.EXE\nfalsepositives:\n- Several false positives identified, check for suspicious file names or locations\n  (e.g. Temp folders)\nid: 864403a1-36c9-40a2-a982-4c9a45f7d833\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://www.fireeye.com/blog/threat-research/2017/05/eps-processing-zero-days.html\nstatus: test\ntags:\n- attack.execution\n- attack.t1203\n- attack.t1204.002\n- attack.initial_access\n- attack.t1566.001\ntitle: Exploit for CVE-2017-0261\n",
                            "sigma:id": "864403a1-36c9-40a2-a982-4c9a45f7d833",
                            "title": "Exploit for CVE-2017-0261",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5b9123c0-1480-4e09-877e-4783950d210f",
                        "lookup_data": {
                            "description": "OSINT - Sigma Ransomware Being Distributed Using Fake Craigslist Malspam",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5b9123c0-1480-4e09-877e-4783950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1536755790",
                            "uuid": "5b9123c0-1480-4e09-877e-4783950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "90217a70-13fc-48e4-b3db-0d836c5824ac",
                        "lookup_data": {
                            "description": "Detects any GAC DLL being loaded by an Office Product",
                            "raw": "author: Antonlovesdnb\ndate: 2020/02/19\ndescription: Detects any GAC DLL being loaded by an Office Product\ndetection:\n  condition: selection\n  selection:\n    ImageLoaded|startswith: C:\\Windows\\Microsoft.NET\\assembly\\GAC_MSIL\n    Image|endswith:\n    - \\winword.exe\n    - \\powerpnt.exe\n    - \\excel.exe\n    - \\outlook.exe\nfalsepositives:\n- Alerts on legitimate macro usage as well, will need to filter as appropriate\nid: 90217a70-13fc-48e4-b3db-0d836c5824ac\nlevel: high\nlogsource:\n  category: image_load\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nstatus: test\ntags:\n- attack.execution\n- attack.t1204.002\ntitle: GAC DLL Loaded Via Office Applications\n",
                            "sigma:id": "90217a70-13fc-48e4-b3db-0d836c5824ac",
                            "title": "GAC DLL Loaded Via Office Applications",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5ce6aa86-9cd8-4302-9dc9-4a59950d210f",
                        "lookup_data": {
                            "description": "OSINT - A journey to Zebrocy land",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5ce6aa86-9cd8-4302-9dc9-4a59950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1563528054",
                            "uuid": "5ce6aa86-9cd8-4302-9dc9-4a59950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5f17a0c6-7b04-4f05-9fda-b5d435a8d6a4",
                        "lookup_data": {
                            "description": "FontOnLake: Previously unknown malware family targeting Linux",
                            "link": "http://www.botvrij.eu/data/feed-osint/5f17a0c6-7b04-4f05-9fda-b5d435a8d6a4.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1633682506",
                            "uuid": "5f17a0c6-7b04-4f05-9fda-b5d435a8d6a4",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "00d0b5ab-1f55-4120-8e83-487c0a7baf19",
                        "lookup_data": {
                            "description": "Detects download of certain file types from hosts in suspicious TLDs",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/11/07\ndescription: Detects download of certain file types from hosts in suspicious TLDs\ndetection:\n  condition: selection\n  selection:\n    c-uri-extension:\n    - exe\n    - vbs\n    - bat\n    - rar\n    - ps1\n    - doc\n    - docm\n    - xls\n    - xlsm\n    - pptm\n    - rtf\n    - hta\n    - dll\n    - ws\n    - wsf\n    - sct\n    - zip\n    r-dns|endswith:\n    - .country\n    - .stream\n    - .gdn\n    - .mom\n    - .xin\n    - .kim\n    - .men\n    - .loan\n    - .download\n    - .racing\n    - .online\n    - .science\n    - .ren\n    - .gb\n    - .win\n    - .top\n    - .review\n    - .vip\n    - .party\n    - .tech\n    - .xyz\n    - .date\n    - .faith\n    - .zip\n    - .cricket\n    - .space\n    - .info\n    - .vn\n    - .cm\n    - .am\n    - .cc\n    - .asia\n    - .ws\n    - .tk\n    - .biz\n    - .su\n    - .st\n    - .ro\n    - .ge\n    - .ms\n    - .pk\n    - .nu\n    - .me\n    - .ph\n    - .to\n    - .tt\n    - .name\n    - .tv\n    - .kz\n    - .tc\n    - .mobi\n    - .study\n    - .click\n    - .link\n    - .trade\n    - .accountant\n    - .cf\n    - .gq\n    - .ml\n    - .ga\n    - .pw\nfalsepositives:\n- All kinds of software downloads\nfields:\n- ClientIP\n- c-uri\nid: 00d0b5ab-1f55-4120-8e83-487c0a7baf19\nlevel: low\nlogsource:\n  category: proxy\nmodified: 2023/01/09\nreferences:\n- https://www.symantec.com/connect/blogs/shady-tld-research-gdn-and-our-2016-wrap\n- https://promos.mcafee.com/en-US/PDF/MTMW_Report.pdf\n- https://www.spamhaus.org/statistics/tlds/\n- https://krebsonsecurity.com/2018/06/bad-men-at-work-please-dont-click/\nrelated:\n- id: b5de2919-b74a-4805-91a7-5049accbaefe\n  type: similar\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1566\n- attack.execution\n- attack.t1203\n- attack.t1204.002\ntitle: Download From Suspicious TLD - Blacklist\n",
                            "sigma:id": "00d0b5ab-1f55-4120-8e83-487c0a7baf19",
                            "title": "Download From Suspicious TLD - Blacklist",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "a2a3b925-7bb0-433b-b508-db9003263cc4",
                        "lookup_data": {
                            "description": "Detects DSParse DLL being loaded by an Office Product",
                            "raw": "author: Antonlovesdnb\ndate: 2020/02/19\ndescription: Detects DSParse DLL being loaded by an Office Product\ndetection:\n  condition: selection\n  selection:\n    ImageLoaded|contains: \\dsparse.dll\n    Image|endswith:\n    - \\winword.exe\n    - \\powerpnt.exe\n    - \\excel.exe\n    - \\outlook.exe\nfalsepositives:\n- Alerts on legitimate macro usage as well, will need to filter as appropriate\nid: a2a3b925-7bb0-433b-b508-db9003263cc4\nlevel: high\nlogsource:\n  category: image_load\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nstatus: test\ntags:\n- attack.execution\n- attack.t1204.002\ntitle: Active Directory Parsing DLL Loaded Via Office Applications\n",
                            "sigma:id": "a2a3b925-7bb0-433b-b508-db9003263cc4",
                            "title": "Active Directory Parsing DLL Loaded Via Office Applications",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "678eb5f4-8597-4be6-8be7-905e4234b53a",
                        "lookup_data": {
                            "description": "Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and other sub processes like mshta.exe",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/11/23\ndescription: Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and other\n  sub processes like mshta.exe\ndetection:\n  condition: selection\n  selection:\n    ParentImage|endswith: \\EQNEDT32.EXE\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\nid: 678eb5f4-8597-4be6-8be7-905e4234b53a\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://www.hybrid-analysis.com/sample/2a4ae284c76f868fc51d3bb65da8caa6efacb707f265b25c30f34250b76b7507?environmentId=100\n- https://www.google.com/url?hl=en&q=https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about&source=gmail&ust=1511481120837000&usg=AFQjCNGdL7gVwLXaNSl2Td8ylDYbSJFmPw\nstatus: stable\ntags:\n- attack.execution\n- attack.t1203\n- attack.t1204.002\n- attack.initial_access\n- attack.t1566.001\ntitle: Droppers Exploiting CVE-2017-11882\n",
                            "sigma:id": "678eb5f4-8597-4be6-8be7-905e4234b53a",
                            "title": "Droppers Exploiting CVE-2017-11882",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "fa0c05b6-8ad3-468d-8231-c1cbccb64fba",
                        "lookup_data": {
                            "description": "Detects a highly relevant Antivirus alert that reports a hack tool or other attack tool",
                            "raw": "author: Florian Roth (Nextron Systems), Arnim Rupp\ndate: 2021/08/16\ndescription: Detects a highly relevant Antivirus alert that reports a hack tool or\n  other attack tool\ndetection:\n  condition: selection\n  selection:\n  - Signature|startswith:\n    - HTOOL\n    - HKTL\n    - SecurityTool\n    - Adfind\n    - ATK/\n    - Exploit.Script.CVE\n    - PWS.\n    - PWSX\n  - Signature|contains:\n    - Hacktool\n    - ATK/\n    - Potato\n    - Rozena\n    - Sbelt\n    - Seatbelt\n    - SecurityTool\n    - SharpDump\n    - Sliver\n    - Splinter\n    - Swrort\n    - Impacket\n    - Koadic\n    - Lazagne\n    - Metasploit\n    - Meterpreter\n    - MeteTool\n    - Mimikatz\n    - Mpreter\n    - Nighthawk\n    - PentestPowerShell\n    - PowerSploit\n    - PowerSSH\n    - PshlSpy\n    - PSWTool\n    - PWCrack\n    - Brutel\n    - BruteR\n    - Cobalt\n    - COBEACON\n    - Cometer\n    - DumpCreds\n    - FastReverseProxy\n    - PWDump\nfalsepositives:\n- Unlikely\nfields:\n- FileName\n- User\nid: fa0c05b6-8ad3-468d-8231-c1cbccb64fba\nlevel: high\nlogsource:\n  category: antivirus\nmodified: 2023/02/03\nreferences:\n- https://www.nextron-systems.com/2021/08/16/antivirus-event-analysis-cheat-sheet-v1-8-2/\n- https://www.nextron-systems.com/?s=antivirus\nstatus: stable\ntags:\n- attack.execution\n- attack.t1204\ntitle: Antivirus Hacktool Detection\n",
                            "sigma:id": "fa0c05b6-8ad3-468d-8231-c1cbccb64fba",
                            "title": "Antivirus Hacktool Detection",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4922a5dd-6743-4fc2-8e81-144374280997",
                        "lookup_data": {
                            "description": "Detects a flashplayer update from an unofficial location",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/10/25\ndescription: Detects a flashplayer update from an unofficial location\ndetection:\n  condition: selection and not filter\n  filter:\n    cs-host|endswith: .adobe.com\n  selection:\n  - c-uri|contains: /flash_install.php\n  - c-uri|endswith: /install_flash_player.exe\nfalsepositives:\n- Unknown flash download locations\nid: 4922a5dd-6743-4fc2-8e81-144374280997\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2022/08/08\nreferences:\n- https://gist.github.com/roycewilliams/a723aaf8a6ac3ba4f817847610935cfb\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1189\n- attack.execution\n- attack.t1204.002\n- attack.defense_evasion\n- attack.t1036.005\ntitle: Flash Player Update from Suspicious Location\n",
                            "sigma:id": "4922a5dd-6743-4fc2-8e81-144374280997",
                            "title": "Flash Player Update from Suspicious Location",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "24de4f3b-804c-4165-b442-5a06a2302c7e",
                        "lookup_data": {
                            "description": "The .SettingContent-ms file type was introduced in Windows 10 and allows a user to create \"shortcuts\" to various Windows 10 setting pages. These files are simply XML and contain paths to various Windows 10 settings binaries.",
                            "raw": "author: Sreeman\ndate: 2020/03/13\ndescription: The .SettingContent-ms file type was introduced in Windows 10 and allows\n  a user to create \"shortcuts\" to various Windows 10 setting pages. These files are\n  simply XML and contain paths to various Windows 10 settings binaries.\ndetection:\n  condition: selection and not filter\n  filter:\n    CommandLine|contains: immersivecontrolpanel\n  selection:\n    CommandLine|contains: .SettingContent-ms\nfalsepositives:\n- Unknown\nfields:\n- ParentProcess\n- CommandLine\n- ParentCommandLine\nid: 24de4f3b-804c-4165-b442-5a06a2302c7e\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/04/14\nreferences:\n- https://posts.specterops.io/the-tale-of-settingcontent-ms-files-f1ea253e4d39\nstatus: experimental\ntags:\n- attack.t1204\n- attack.t1566.001\n- attack.execution\n- attack.initial_access\ntitle: Arbitrary Shell Command Execution Via Settingcontent-Ms\n",
                            "sigma:id": "24de4f3b-804c-4165-b442-5a06a2302c7e",
                            "title": "Arbitrary Shell Command Execution Via Settingcontent-Ms",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5dee2bc3-47ac-4784-a52a-4da2950d210f",
                        "lookup_data": {
                            "description": "OSINT - BfV Cyber-Brief Nr. 01/2019 - Hinweis auf aktuelle Angriffskampagne -",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5dee2bc3-47ac-4784-a52a-4da2950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1576068623",
                            "uuid": "5dee2bc3-47ac-4784-a52a-4da2950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5e55be1a-3a30-48ae-9934-4199950d210f",
                        "lookup_data": {
                            "description": "Interesting Recon Script",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5e55be1a-3a30-48ae-9934-4199950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1582912038",
                            "uuid": "5e55be1a-3a30-48ae-9934-4199950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "6e4dcdd1-e48b-42f7-b2d8-3b413fc58cb4",
                        "lookup_data": {
                            "description": "Detects when the macOS Script Editor utility spawns an unusual child process.",
                            "raw": "author: Tim Rauch (rule), Elastic (idea)\ndate: 2022/10/21\ndescription: Detects when the macOS Script Editor utility spawns an unusual child\n  process.\ndetection:\n  condition: all of selection_*\n  selection_img:\n  - Image|endswith:\n    - /curl\n    - /bash\n    - /sh\n    - /zsh\n    - /dash\n    - /fish\n    - /osascript\n    - /mktemp\n    - /chmod\n    - /php\n    - /nohup\n    - /openssl\n    - /plutil\n    - /PlistBuddy\n    - /xattr\n    - /sqlite\n    - /funzip\n    - /popen\n  - Image|contains:\n    - python\n    - perl\n  selection_parent:\n    ParentImage|endswith: /Script Editor\nfalsepositives:\n- Unknown\nid: 6e4dcdd1-e48b-42f7-b2d8-3b413fc58cb4\nlevel: medium\nlogsource:\n  category: process_creation\n  product: macos\nmodified: 2022/12/28\nreferences:\n- https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-7f541fbc4a4a28a92970e8bf53effea5bd934604429112c920affb457f5b2685\n- https://wojciechregula.blog/post/macos-red-teaming-initial-access-via-applescript-url/\nstatus: experimental\ntags:\n- attack.t1566\n- attack.t1566.002\n- attack.initial_access\n- attack.t1059\n- attack.t1059.002\n- attack.t1204\n- attack.t1204.001\n- attack.execution\n- attack.persistence\n- attack.t1553\n- attack.defense_evasion\ntitle: Suspicious Execution via macOS Script Editor\n",
                            "sigma:id": "6e4dcdd1-e48b-42f7-b2d8-3b413fc58cb4",
                            "title": "Suspicious Execution via macOS Script Editor",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "fdd84c68-a1f6-47c9-9477-920584f94905",
                        "lookup_data": {
                            "description": "Detects Winword starting uncommon sub process csc.exe as used in exploits for CVE-2017-8759",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/09/15\ndescription: Detects Winword starting uncommon sub process csc.exe as used in exploits\n  for CVE-2017-8759\ndetection:\n  condition: selection\n  selection:\n    Image|endswith: \\csc.exe\n    ParentImage|endswith: \\WINWORD.EXE\nfalsepositives:\n- Unknown\nid: fdd84c68-a1f6-47c9-9477-920584f94905\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://www.hybrid-analysis.com/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100\n- https://www.reverse.it/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100\nstatus: test\ntags:\n- attack.execution\n- attack.t1203\n- attack.t1204.002\n- attack.initial_access\n- attack.t1566.001\ntitle: Exploit for CVE-2017-8759\n",
                            "sigma:id": "fdd84c68-a1f6-47c9-9477-920584f94905",
                            "title": "Exploit for CVE-2017-8759",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": []
    },
    "timestamp": "2025-02-28 13:54:56"
}