{
    "id": "T1071.001",
    "name": "Web Protocols",
    "description": "Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.\nProtocols such as HTTP and HTTPS that carry web traffic may be very common in environments. HTTP/S packets have many fields and headers in which data can be concealed. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.",
    "platforms": "Linux, macOS, Windows",
    "kill_chain_phases": "Command and Control",
    "data_sources": "Network Traffic: Network Traffic Flow, Network Traffic: Network Traffic Content",
    "detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)\nMonitor for web traffic to/from known-bad or suspicious domains.",
    "url": "https://attack.mitre.org/techniques/T1071/001",
    "enrichments": {
        "attack_rule_map": [
            {
                "tech_id": "T1071.001",
                "atomic_attack_guid": "dc3488b0-08c7-4fea-b585-905c83b48180",
                "atomic_attack_name": "Malicious User Agents - CMD",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Read Contents From Stdin Via Cmd.EXE",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_stdin_redirect.yml",
                        "remote_content": "title: Read Contents From Stdin Via Cmd.EXE\nid: 241e802a-b65e-484f-88cd-c2dc10f9206d\nrelated:\n    - id: 00a4bacd-6db4-46d5-9258-a7d5ebff4003\n      type: obsolete\nstatus: test\ndescription: Detect the use of \"<\" to read and potentially execute a file via cmd.exe\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1059.003/T1059.003.md\n    - https://web.archive.org/web/20220306121156/https://www.x86matthew.com/view_post?id=ntdll_pipe\nauthor: frack113, Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-03-07\ntags:\n    - attack.execution\n    - attack.t1059.003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_cmd:\n        - OriginalFileName: 'Cmd.Exe'\n        - Image|endswith: '\\cmd.exe'\n    selection_cli:\n        CommandLine|contains: '<'\n    condition: all of selection_*\nfalsepositives:\n    - Unknown\nlevel: medium\n"
                    }
                ]
            }
        ],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "a36ce77e-30db-4ea0-8795-644d7af5dfb4",
                    "5468045b-4fcc-4d1a-973c-c9c9578edacb",
                    "304810ed-8853-437f-9e36-c4975c3dfd7e",
                    "932ac737-33ca-4afd-9869-0d48b391fcc9",
                    "7857f021-007f-4928-8b2c-7aedbe64bb82",
                    "953b895e-5cc9-454b-b183-7f3db555452e",
                    "c8557060-9221-4448-8794-96320e6f3e74",
                    "3eaf6218-3bed-4d8a-8707-274096f12a18",
                    "df8b2a25-8bdf-4856-953c-a04372b1c161",
                    "41b42a36-f62c-4c34-bd40-8cb804a34ad8",
                    "7195a772-4b3f-43a4-a210-6a003d65caa1",
                    "d4488827-73af-4f8d-9244-7b7662ef046e",
                    "21e44d78-95e7-421b-a464-ffd8395659c4",
                    "827e941e-4a99-4e2c-a578-bfcec2d40552",
                    "c9b33401-cc6a-4cf6-83bb-57ddcb2407fc",
                    "fa935401-513b-467b-81f4-f9e77aa0dd78",
                    "2ec1f538-1915-4636-8b38-101cb1efce5e",
                    "8ccd35a2-1c7c-468b-b568-ac6cdf80eec3",
                    "abfb5a93-e695-4ee9-bc10-541290bcd663",
                    "3286d37a-00fd-41c2-a624-a672dcd34e60",
                    "c75309a3-59f8-4a8d-9c2c-4c927ad50555",
                    "fb502828-2db0-438e-93e6-801c7548686d",
                    "d8c0c469-2d3e-437a-80a1-a38bfe5998e8",
                    "37325383-740a-403d-b1a2-b2b4ab7992e7",
                    "f35d4a9f-881b-46b7-9d8a-887a40bce133",
                    "5f17a0c6-7b04-4f05-9fda-b5d435a8d6a4",
                    "b923f7d6-ac89-4a50-a71a-89fb846b4aa8",
                    "e09aed7a-09e0-4c9a-90dd-f0d52507347e",
                    "54dd4ef7-f7b2-418e-a191-5def4fbb0033",
                    "2b1ee7e4-89b6-4739-b7bb-b811b6607e5e",
                    "5ba715b6-71b7-44fd-8245-f66893e81b3d",
                    "6ec820f2-e963-4801-9127-d8b2dce4d31b",
                    "9eb68894-7476-4cd6-8752-23b51f5883a7",
                    "5c84856b-55a5-45f1-826f-13f37250cf4e",
                    "758d96ed-9dd4-4009-9270-65f2c3dd30cc",
                    "b86d356d-6093-443d-971c-9b07db583c68",
                    "894a8613-cf12-48b3-8e57-9085f54aa0c3",
                    "fdd1bfb5-f60b-4a35-910e-f36ed3d0b32f",
                    "b494b165-6634-483d-8c47-2026a6c52372",
                    "4bcf0465-4b53-4de4-8c53-fcc5f7d04dfc",
                    "5df8df26-fe0e-4858-94a7-6cf71d9519c9"
                ],
                "lookup_results": [
                    {
                        "uuid": "a36ce77e-30db-4ea0-8795-644d7af5dfb4",
                        "lookup_data": {
                            "description": "Detects download of Ursnif malware done by dropper documents.",
                            "raw": "author: Thomas Patzke\ndate: 2019/12/19\ndescription: Detects download of Ursnif malware done by dropper documents.\ndetection:\n  condition: selection\n  selection:\n    c-uri|contains|all:\n    - /\n    - .php\\?l=\n    c-uri|endswith: .cab\n    sc-status: 200\nfalsepositives:\n- Unknown\nfields:\n- c-ip\n- c-uri\n- sc-bytes\n- c-ua\nid: a36ce77e-30db-4ea0-8795-644d7af5dfb4\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2022/08/15\nstatus: stable\ntags:\n- attack.command_and_control\n- attack.t1071.001\ntitle: Ursnif Malware Download URL Pattern\n",
                            "sigma:id": "a36ce77e-30db-4ea0-8795-644d7af5dfb4",
                            "title": "Ursnif Malware Download URL Pattern",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5468045b-4fcc-4d1a-973c-c9c9578edacb",
                        "lookup_data": {
                            "description": "Detects direct access to raw pastes in different paste services often used by malware in their second stages to download malicious code in encrypted or encoded form",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2019/12/05\ndescription: Detects direct access to raw pastes in different paste services often\n  used by malware in their second stages to download malicious code in encrypted or\n  encoded form\ndetection:\n  condition: selection\n  selection:\n    c-uri|contains:\n    - .paste.ee/r/\n    - .pastebin.com/raw/\n    - .hastebin.com/raw/\n    - .ghostbin.co/paste/*/raw/\n    - pastetext.net/\n    - pastebin.pl/\n    - paste.ee/\nfalsepositives:\n- User activity (e.g. developer that shared and copied code snippets and used the\n  raw link instead of just copy & paste)\nfields:\n- ClientIP\n- c-uri\n- c-useragent\nid: 5468045b-4fcc-4d1a-973c-c9c9578edacb\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2023/01/19\nreferences:\n- https://www.virustotal.com/gui/domain/paste.ee/relations\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1071.001\n- attack.t1102.001\n- attack.t1102.003\n- attack.defense_evasion\ntitle: Raw Paste Service Access\n",
                            "sigma:id": "5468045b-4fcc-4d1a-973c-c9c9578edacb",
                            "title": "Raw Paste Service Access",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "304810ed-8853-437f-9e36-c4975c3dfd7e",
                        "lookup_data": {
                            "description": "Detects Baby Shark C2 Framework communication patterns",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2021/06/09\ndescription: Detects Baby Shark C2 Framework communication patterns\ndetection:\n  condition: selection\n  selection:\n    c-uri|contains: momyshark\\?key=\nfalsepositives:\n- Unknown\nid: 304810ed-8853-437f-9e36-c4975c3dfd7e\nlevel: critical\nlogsource:\n  category: proxy\nmodified: 2022/08/15\nreferences:\n- https://nasbench.medium.com/understanding-detecting-c2-frameworks-babyshark-641be4595845\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1071.001\ntitle: BabyShark Agent Pattern\n",
                            "sigma:id": "304810ed-8853-437f-9e36-c4975c3dfd7e",
                            "title": "BabyShark Agent Pattern",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "932ac737-33ca-4afd-9869-0d48b391fcc9",
                        "lookup_data": {
                            "description": "Detects Ursnif C2 traffic.",
                            "raw": "author: Thomas Patzke\ndate: 2019/12/19\ndescription: Detects Ursnif C2 traffic.\ndetection:\n  b64encoding:\n    c-uri|contains:\n    - _2f\n    - _2b\n  condition: b64encoding and urlpatterns\n  urlpatterns:\n    c-uri|contains|all:\n    - .avi\n    - /images/\nfalsepositives:\n- Unknown\nfields:\n- c-ip\n- c-uri\n- sc-bytes\n- c-ua\nid: 932ac737-33ca-4afd-9869-0d48b391fcc9\nlevel: critical\nlogsource:\n  category: proxy\nmodified: 2021/08/09\nreferences:\n- https://www.fortinet.com/blog/threat-research/ursnif-variant-spreading-word-document.html\nstatus: stable\ntags:\n- attack.initial_access\n- attack.t1566.001\n- attack.execution\n- attack.t1204.002\n- attack.command_and_control\n- attack.t1071.001\ntitle: Ursnif Malware C2 URL Pattern\n",
                            "sigma:id": "932ac737-33ca-4afd-9869-0d48b391fcc9",
                            "title": "Ursnif Malware C2 URL Pattern",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "7857f021-007f-4928-8b2c-7aedbe64bb82",
                        "lookup_data": {
                            "description": "Detects Turla ComRAT patterns",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2020/05/26\ndescription: Detects Turla ComRAT patterns\ndetection:\n  condition: selection\n  selection:\n    c-uri|contains: /index/index.php\\?h=\nfalsepositives:\n- Unknown\nid: 7857f021-007f-4928-8b2c-7aedbe64bb82\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2022/08/15\nreferences:\n- https://www.welivesecurity.com/wp-content/uploads/2020/05/ESET_Turla_ComRAT.pdf\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.command_and_control\n- attack.t1071.001\n- attack.g0010\ntitle: Turla ComRAT\n",
                            "sigma:id": "7857f021-007f-4928-8b2c-7aedbe64bb82",
                            "title": "Turla ComRAT",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "953b895e-5cc9-454b-b183-7f3db555452e",
                        "lookup_data": {
                            "description": "Detects Malleable Amazon Profile",
                            "raw": "author: Markus Neis\ndate: 2019/11/12\ndescription: Detects Malleable Amazon Profile\ndetection:\n  condition: 1 of selection*\n  selection1:\n    c-uri: /s/ref=nb_sb_noss_1/167-3294888-0262949/field-keywords=books\n    c-useragent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\n    cs-cookie|endswith: =csm-hit=s-24KU11BB82RZSYGJ3BDK|1419899012996\n    cs-host: www.amazon.com\n    cs-method: GET\n  selection2:\n    c-uri: /N4215/adj/amzn.us.sr.aps\n    c-useragent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\n    cs-host: www.amazon.com\n    cs-method: POST\nfalsepositives:\n- Unknown\nid: 953b895e-5cc9-454b-b183-7f3db555452e\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2022/07/07\nreferences:\n- https://github.com/rsmudge/Malleable-C2-Profiles/blob/26323784672913923d20c5a638c6ca79459e8529/normal/amazon.profile\n- https://www.hybrid-analysis.com/sample/ee5eca8648e45e2fea9dac0d920ef1a1792d8690c41ee7f20343de1927cc88b9?environmentId=100\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.command_and_control\n- attack.t1071.001\ntitle: CobaltStrike Malleable Amazon Browsing Traffic Profile\n",
                            "sigma:id": "953b895e-5cc9-454b-b183-7f3db555452e",
                            "title": "CobaltStrike Malleable Amazon Browsing Traffic Profile",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "c8557060-9221-4448-8794-96320e6f3e74",
                        "lookup_data": {
                            "description": "Detects Windows PowerShell Web Access",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/03/13\ndescription: Detects Windows PowerShell Web Access\ndetection:\n  condition: selection\n  selection:\n    c-useragent|contains: ' WindowsPowerShell/'\nfalsepositives:\n- Administrative scripts that download files from the Internet\n- Administrative scripts that retrieve certain website contents\nfields:\n- ClientIP\n- c-uri\n- c-useragent\nid: c8557060-9221-4448-8794-96320e6f3e74\nlevel: medium\nlogsource:\n  category: proxy\nmodified: 2021/11/27\nreferences:\n- https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.utility/Invoke-WebRequest\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.command_and_control\n- attack.t1071.001\ntitle: Windows PowerShell User Agent\n",
                            "sigma:id": "c8557060-9221-4448-8794-96320e6f3e74",
                            "title": "Windows PowerShell User Agent",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "3eaf6218-3bed-4d8a-8707-274096f12a18",
                        "lookup_data": {
                            "description": "Detects wannacry killswitch domain dns queries",
                            "raw": "author: Mike Wade\ndate: 2020/09/16\ndescription: Detects wannacry killswitch domain dns queries\ndetection:\n  condition: selection\n  selection:\n    query:\n    - ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.testing\n    - ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.test\n    - ifferfsodp9ifjaposdfjhgosurijfaewrwergwea.com\n    - ayylmaotjhsstasdfasdfasdfasdfasdfasdfasdf.com\n    - iuqssfsodp9ifjaposdfjhgosurijfaewrwergwea.com\nfalsepositives:\n- Analyst testing\nid: 3eaf6218-3bed-4d8a-8707-274096f12a18\nlevel: high\nlogsource:\n  category: dns\nmodified: 2022/03/24\nreferences:\n- https://www.fireeye.com/blog/products-and-services/2017/05/wannacry-ransomware-campaign.html\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1071.001\ntitle: Wannacry Killswitch Domain\n",
                            "sigma:id": "3eaf6218-3bed-4d8a-8707-274096f12a18",
                            "title": "Wannacry Killswitch Domain",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "df8b2a25-8bdf-4856-953c-a04372b1c161",
                        "lookup_data": {
                            "mitre-attack-id": "T1071.001",
                            "mitre-cti:description": "Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \n\nProtocols such as HTTP and HTTPS that carry web traffic may be very common in environments. HTTP/S packets have many fields and headers in which data can be concealed. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. ",
                            "mitre-cti:name": "Web Protocols",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'x_mitre_platforms': ['Linux', 'macOS', 'Windows'], 'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'attack-pattern--df8b2a25-8bdf-4856-953c-a04372b1c161', 'type': 'attack-pattern', 'created': '2020-03-15T16:13:46.151Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'source_name': 'mitre-attack', 'external_id': 'T1071.001', 'url': 'https://attack.mitre.org/techniques/T1071/001'}, {'url': 'https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf', 'description': 'Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.', 'source_name': 'University of Birmingham C2'}], 'modified': '2020-03-26T20:15:35.821Z', 'name': 'Web Protocols', 'description': 'Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. \\n\\nProtocols such as HTTP and HTTPS that carry web traffic may be very common in environments. HTTP/S packets have many fields and headers in which data can be concealed. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. ', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'command-and-control'}], 'x_mitre_detection': 'Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.(Citation: University of Birmingham C2)\\n\\nMonitor for web traffic to/from known-bad or suspicious domains. ', 'x_mitre_is_subtechnique': True, 'x_mitre_version': '1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'x_mitre_data_sources': ['Network Traffic: Network Traffic Flow', 'Network Traffic: Network Traffic Content']}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "41b42a36-f62c-4c34-bd40-8cb804a34ad8",
                        "lookup_data": {
                            "description": "Detects different malformed user agents used in Malleable Profiles used with Cobalt Strike",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2021/05/06\ndescription: Detects different malformed user agents used in Malleable Profiles used\n  with Cobalt Strike\ndetection:\n  condition: 1 of selection*\n  selection1:\n    c-useragent:\n    - Mozilla/4.0 (compatible; MSIE 6.0;Windows NT 5.1)\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2;\n      .NET CLR 3.0.30729; .NET4.0C; .NET4.0E )\n    - Mozilla/5.0 (Windows; U; MSIE 7.0; Windows NT 5.2) Java/1.5.0_08\n  selection2:\n    c-useragent|endswith: ; MANM; MANM)\nfalsepositives:\n- Unknown\nid: 41b42a36-f62c-4c34-bd40-8cb804a34ad8\nlevel: critical\nlogsource:\n  category: proxy\nmodified: 2022/12/25\nreferences:\n- https://github.com/yeyintminthuhtut/Malleable-C2-Profiles-Collection/\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.command_and_control\n- attack.t1071.001\ntitle: CobaltStrike Malformed UAs in Malleable Profiles\n",
                            "sigma:id": "41b42a36-f62c-4c34-bd40-8cb804a34ad8",
                            "title": "CobaltStrike Malformed UAs in Malleable Profiles",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "7195a772-4b3f-43a4-a210-6a003d65caa1",
                        "lookup_data": {
                            "description": "Detects suspicious malformed user agent strings in proxy logs",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/07/08\ndescription: Detects suspicious malformed user agent strings in proxy logs\ndetection:\n  condition: 1 of selection* and not falsepositives\n  falsepositives:\n  - c-useragent: Mozilla/3.0 * Acrobat *\n  - cs-host|endswith:\n    - .acrobat.com\n    - .adobe.com\n    - .adobe.io\n  selection1:\n    c-useragent|startswith:\n    - user-agent\n    - 'Mozilla/3.0 '\n    - 'Mozilla/2.0 '\n    - 'Mozilla/1.0 '\n    - 'Mozilla '\n    - ' Mozilla/'\n    - Mozila/\n    - Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol\n  selection2:\n    c-useragent|contains:\n    - ' (compatible;MSIE '\n    - '.0;Windows NT '\n    - loader\n  selection3:\n    c-useragent:\n    - _\n    - CertUtil URL Agent\n    - Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:60.0)\n    - Mozilla/5.0 (Windows NT 6.3; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0\n    - HTTPS\n    - Erbium-UA-4ce7c27cb4be9d32e333bf032c88235a\n    - x\n    - xxx\nfalsepositives:\n- Unknown\nfields:\n- ClientIP\n- c-uri\n- c-useragent\n- cs-host\nid: 7195a772-4b3f-43a4-a210-6a003d65caa1\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2022/10/31\nreferences:\n- https://github.com/fastly/waf_testbed/blob/8bfc406551f3045e418cbaad7596cff8da331dfc/templates/default/scanners-user-agents.data.erb\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1071.001\ntitle: Suspicious User Agent\n",
                            "sigma:id": "7195a772-4b3f-43a4-a210-6a003d65caa1",
                            "title": "Suspicious User Agent",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d4488827-73af-4f8d-9244-7b7662ef046e",
                        "lookup_data": {
                            "description": "Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.\nCommands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.\n",
                            "raw": "author: frack113\ndate: 2022/01/23\ndescription: 'Adversaries may communicate using application layer protocols associated\n  with web traffic to avoid detection/network filtering by blending in with existing\n  traffic.\n\n  Commands to the remote system, and often the results of those commands, will be\n  embedded within the protocol traffic between the client and server.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    ScriptBlockText|contains|all:\n    - Invoke-WebRequest\n    - '-UserAgent '\nfalsepositives:\n- Unknown\nid: d4488827-73af-4f8d-9244-7b7662ef046e\nlevel: medium\nlogsource:\n  category: ps_script\n  definition: 'Requirements: Script Block Logging must be enabled'\n  product: windows\nmodified: 2023/01/02\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1071.001/T1071.001.md#t1071001---web-protocols\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1071.001\ntitle: Change User Agents with WebRequest\n",
                            "sigma:id": "d4488827-73af-4f8d-9244-7b7662ef046e",
                            "title": "Change User Agents with WebRequest",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "21e44d78-95e7-421b-a464-ffd8395659c4",
                        "lookup_data": {
                            "description": "Detects suspicious empty user agent strings in proxy logs",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/07/08\ndescription: Detects suspicious empty user agent strings in proxy logs\ndetection:\n  condition: selection\n  selection:\n    c-useragent: ''\nfalsepositives:\n- Unknown\nfields:\n- ClientIP\n- c-uri\n- c-useragent\nid: 21e44d78-95e7-421b-a464-ffd8395659c4\nlevel: medium\nlogsource:\n  category: proxy\nmodified: 2021/11/27\nreferences:\n- https://twitter.com/Carlos_Perez/status/883455096645931008\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.command_and_control\n- attack.t1071.001\ntitle: Empty User Agent\n",
                            "sigma:id": "21e44d78-95e7-421b-a464-ffd8395659c4",
                            "title": "Empty User Agent",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "827e941e-4a99-4e2c-a578-bfcec2d40552",
                        "lookup_data": {
                            "description": "Malware analysis report on SparrowDoor malware",
                            "link": "http://www.botvrij.eu/data/feed-osint/827e941e-4a99-4e2c-a578-bfcec2d40552.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1650959349",
                            "uuid": "827e941e-4a99-4e2c-a578-bfcec2d40552",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "c9b33401-cc6a-4cf6-83bb-57ddcb2407fc",
                        "lookup_data": {
                            "description": "Detects Malleable OneDrive Profile",
                            "raw": "author: Markus Neis\ndate: 2019/11/12\ndescription: Detects Malleable OneDrive Profile\ndetection:\n  condition: selection and not filter\n  filter:\n    c-uri|contains: ://onedrive.live.com/\n    c-uri|startswith: http\n  selection:\n    c-uri|endswith: \\?manifest=wac\n    cs-host: onedrive.live.com\n    cs-method: GET\nfalsepositives:\n- Unknown\nid: c9b33401-cc6a-4cf6-83bb-57ddcb2407fc\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2022/08/15\nreferences:\n- https://github.com/rsmudge/Malleable-C2-Profiles/blob/26323784672913923d20c5a638c6ca79459e8529/normal/onedrive_getonly.profile\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.command_and_control\n- attack.t1071.001\ntitle: CobaltStrike Malleable OneDrive Browsing Traffic Profile\n",
                            "sigma:id": "c9b33401-cc6a-4cf6-83bb-57ddcb2407fc",
                            "title": "CobaltStrike Malleable OneDrive Browsing Traffic Profile",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "fa935401-513b-467b-81f4-f9e77aa0dd78",
                        "lookup_data": {
                            "description": "Detects suspicious user agent strings used by crypto miners in proxy logs",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2019/10/21\ndescription: Detects suspicious user agent strings used by crypto miners in proxy\n  logs\ndetection:\n  condition: selection\n  selection:\n    c-useragent|startswith:\n    - 'XMRig '\n    - ccminer\nfalsepositives:\n- Unknown\nfields:\n- ClientIP\n- c-uri\n- c-useragent\nid: fa935401-513b-467b-81f4-f9e77aa0dd78\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2021/11/27\nreferences:\n- https://github.com/xmrig/xmrig/blob/da22b3e6c45825f3ac1f208255126cb8585cd4fc/src/base/kernel/Platform_win.cpp#L65\n- https://github.com/xmrig/xmrig/blob/427b6516e0550200c17ca28675118f0fffcc323f/src/version.h\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1071.001\ntitle: Crypto Miner User Agent\n",
                            "sigma:id": "fa935401-513b-467b-81f4-f9e77aa0dd78",
                            "title": "Crypto Miner User Agent",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "2ec1f538-1915-4636-8b38-101cb1efce5e",
                        "lookup_data": {
                            "description": "A22-108A TraderTraitor North Korean State-Sponsored APT Targets Blockchain Companies",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/2ec1f538-1915-4636-8b38-101cb1efce5e.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1650976786",
                            "uuid": "2ec1f538-1915-4636-8b38-101cb1efce5e",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "8ccd35a2-1c7c-468b-b568-ac6cdf80eec3",
                        "lookup_data": {
                            "description": "Detects Bitsadmin connections to IP addresses instead of FQDN names",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/06/10\ndescription: Detects Bitsadmin connections to IP addresses instead of FQDN names\ndetection:\n  condition: selection\n  selection:\n    c-useragent|startswith: Microsoft BITS/\n    cs-host|endswith:\n    - '1'\n    - '2'\n    - '3'\n    - '4'\n    - '5'\n    - '6'\n    - '7'\n    - '8'\n    - '9'\nfalsepositives:\n- Unknown\nid: 8ccd35a2-1c7c-468b-b568-ac6cdf80eec3\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2022/08/24\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1071.001\n- attack.defense_evasion\n- attack.persistence\n- attack.t1197\n- attack.s0190\ntitle: Bitsadmin to Uncommon IP Server Address\n",
                            "sigma:id": "8ccd35a2-1c7c-468b-b568-ac6cdf80eec3",
                            "title": "Bitsadmin to Uncommon IP Server Address",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "abfb5a93-e695-4ee9-bc10-541290bcd663",
                        "lookup_data": {
                            "description": "Aoqin Dragon | Newly-Discovered Chinese-linked APT Has Been Quietly Spying On Organizations For 10 Years",
                            "link": "http://www.botvrij.eu/data/feed-osint/abfb5a93-e695-4ee9-bc10-541290bcd663.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1655839499",
                            "uuid": "abfb5a93-e695-4ee9-bc10-541290bcd663",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "3286d37a-00fd-41c2-a624-a672dcd34e60",
                        "lookup_data": {
                            "description": "Detects a suspicious curl process start on Windows with set useragent options",
                            "raw": "author: frack113\ndate: 2022/01/23\ndescription: Detects a suspicious curl process start on Windows with set useragent\n  options\ndetection:\n  condition: all of selection_*\n  selection_curl:\n  - Image|endswith: \\curl.exe\n  - Product: The curl executable\n  selection_opt:\n    CommandLine|contains:\n    - ' -A '\n    - ' --user-agent '\nfalsepositives:\n- Scripts created by developers and admins\n- Administrative activity\nfields:\n- CommandLine\n- ParentCommandLine\nid: 3286d37a-00fd-41c2-a624-a672dcd34e60\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://curl.se/docs/manpage.html\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1071.001/T1071.001.md#atomic-test-2---malicious-user-agents---cmd\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1071.001\ntitle: Suspicious Curl Change User Agents\n",
                            "sigma:id": "3286d37a-00fd-41c2-a624-a672dcd34e60",
                            "title": "Suspicious Curl Change User Agents",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "c75309a3-59f8-4a8d-9c2c-4c927ad50555",
                        "lookup_data": {
                            "description": "Execution of well known tools for data exfiltration and tunneling",
                            "raw": "author: Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/24\ndescription: Execution of well known tools for data exfiltration and tunneling\ndetection:\n  condition: selection\n  selection:\n    Image|endswith:\n    - \\plink.exe\n    - \\socat.exe\n    - \\stunnel.exe\n    - \\httptunnel.exe\nfalsepositives:\n- Legitimate Administrator using tools\nid: c75309a3-59f8-4a8d-9c2c-4c927ad50555\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nstatus: test\ntags:\n- attack.exfiltration\n- attack.command_and_control\n- attack.t1041\n- attack.t1572\n- attack.t1071.001\ntitle: Exfiltration and Tunneling Tools Execution\n",
                            "sigma:id": "c75309a3-59f8-4a8d-9c2c-4c927ad50555",
                            "title": "Exfiltration and Tunneling Tools Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "fb502828-2db0-438e-93e6-801c7548686d",
                        "lookup_data": {
                            "description": "Detects HTTP requests used by Chafer malware",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2019/01/31\ndescription: Detects HTTP requests used by Chafer malware\ndetection:\n  condition: selection\n  selection:\n    c-uri|contains: /asp.asp\\?ui=\nfalsepositives:\n- Unknown\nfields:\n- ClientIP\n- c-uri\n- c-useragent\nid: fb502828-2db0-438e-93e6-801c7548686d\nlevel: critical\nlogsource:\n  category: proxy\nmodified: 2022/08/15\nreferences:\n- https://securelist.com/chafer-used-remexi-malware/89538/\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1071.001\ntitle: Chafer Malware URL Pattern\n",
                            "sigma:id": "fb502828-2db0-438e-93e6-801c7548686d",
                            "title": "Chafer Malware URL Pattern",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d8c0c469-2d3e-437a-80a1-a38bfe5998e8",
                        "lookup_data": {
                            "description": "IndigoZebra APT continues to attack Central Asia with evolving tools",
                            "link": "http://www.botvrij.eu/data/feed-osint/d8c0c469-2d3e-437a-80a1-a38bfe5998e8.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1625229668",
                            "uuid": "d8c0c469-2d3e-437a-80a1-a38bfe5998e8",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "37325383-740a-403d-b1a2-b2b4ab7992e7",
                        "lookup_data": {
                            "description": "Detects Malleable (OCSP) Profile with Typo (OSCP) in URL",
                            "raw": "author: Markus Neis\ndate: 2019/11/12\ndescription: Detects Malleable (OCSP) Profile with Typo (OSCP) in URL\ndetection:\n  condition: selection\n  selection:\n    c-uri|contains: /oscp/\n    cs-host: ocsp.verisign.com\nfalsepositives:\n- Unknown\nid: 37325383-740a-403d-b1a2-b2b4ab7992e7\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2021/11/27\nreferences:\n- https://github.com/rsmudge/Malleable-C2-Profiles/blob/26323784672913923d20c5a638c6ca79459e8529/normal/ocsp.profile\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.command_and_control\n- attack.t1071.001\ntitle: CobaltStrike Malleable (OCSP) Profile\n",
                            "sigma:id": "37325383-740a-403d-b1a2-b2b4ab7992e7",
                            "title": "CobaltStrike Malleable (OCSP) Profile",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f35d4a9f-881b-46b7-9d8a-887a40bce133",
                        "lookup_data": {
                            "description": "The SideWalk may be as dangerous as the CROSSWALK",
                            "link": "http://www.botvrij.eu/data/feed-osint/f35d4a9f-881b-46b7-9d8a-887a40bce133.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1630180802",
                            "uuid": "f35d4a9f-881b-46b7-9d8a-887a40bce133",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5f17a0c6-7b04-4f05-9fda-b5d435a8d6a4",
                        "lookup_data": {
                            "description": "FontOnLake: Previously unknown malware family targeting Linux",
                            "link": "http://www.botvrij.eu/data/feed-osint/5f17a0c6-7b04-4f05-9fda-b5d435a8d6a4.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1633682506",
                            "uuid": "5f17a0c6-7b04-4f05-9fda-b5d435a8d6a4",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b923f7d6-ac89-4a50-a71a-89fb846b4aa8",
                        "lookup_data": {
                            "description": "Detects user agent and URI paths used by empire agents",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2020/07/13\ndescription: Detects user agent and URI paths used by empire agents\ndetection:\n  condition: selection\n  selection:\n    c-useragent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\n    cs-method: POST\n    cs-uri:\n    - /admin/get.php\n    - /news.php\n    - /login/process.php\nfalsepositives:\n- Valid requests with this exact user agent to server scripts of the defined names\nfields:\n- c-uri\n- c-ip\nid: b923f7d6-ac89-4a50-a71a-89fb846b4aa8\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2022/08/05\nreferences:\n- https://github.com/BC-SECURITY/Empire\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.command_and_control\n- attack.t1071.001\ntitle: Empire UserAgent URI Combo\n",
                            "sigma:id": "b923f7d6-ac89-4a50-a71a-89fb846b4aa8",
                            "title": "Empire UserAgent URI Combo",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "e09aed7a-09e0-4c9a-90dd-f0d52507347e",
                        "lookup_data": {
                            "description": "Detects WebDav DownloadCradle",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2018/04/06\ndescription: Detects WebDav DownloadCradle\ndetection:\n  condition: selection\n  selection:\n    c-useragent|startswith: Microsoft-WebDAV-MiniRedir/\n    cs-method: GET\nfalsepositives:\n- Administrative scripts that download files from the Internet\n- Administrative scripts that retrieve certain website contents\n- Legitimate WebDAV administration\nfields:\n- ClientIP\n- c-uri\n- c-useragent\n- cs-method\nid: e09aed7a-09e0-4c9a-90dd-f0d52507347e\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2021/11/27\nreferences:\n- https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1071.001\ntitle: Windows WebDAV User Agent\n",
                            "sigma:id": "e09aed7a-09e0-4c9a-90dd-f0d52507347e",
                            "title": "Windows WebDAV User Agent",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "54dd4ef7-f7b2-418e-a191-5def4fbb0033",
                        "lookup_data": {
                            "description": "Turla: A Galaxy of Opportunity",
                            "link": "http://www.botvrij.eu/data/feed-osint/54dd4ef7-f7b2-418e-a191-5def4fbb0033.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1673286950",
                            "uuid": "54dd4ef7-f7b2-418e-a191-5def4fbb0033",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "2b1ee7e4-89b6-4739-b7bb-b811b6607e5e",
                        "lookup_data": {
                            "description": "Detects downloads from PwnDrp web servers developed for red team testing and most likely also used for criminal activity",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2020/04/15\ndescription: Detects downloads from PwnDrp web servers developed for red team testing\n  and most likely also used for criminal activity\ndetection:\n  condition: selection\n  selection:\n    c-uri|contains: /pwndrop/\nfalsepositives:\n- Unknown\nfields:\n- ClientIP\n- c-uri\n- c-useragent\nid: 2b1ee7e4-89b6-4739-b7bb-b811b6607e5e\nlevel: critical\nlogsource:\n  category: proxy\nmodified: 2021/11/27\nreferences:\n- https://breakdev.org/pwndrop/\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1071.001\n- attack.t1102.001\n- attack.t1102.003\ntitle: PwnDrp Access\n",
                            "sigma:id": "2b1ee7e4-89b6-4739-b7bb-b811b6607e5e",
                            "title": "PwnDrp Access",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5ba715b6-71b7-44fd-8245-f66893e81b3d",
                        "lookup_data": {
                            "description": "Detects suspicious user agent string of APT40 Dropbox tool",
                            "raw": "author: Thomas Patzke\ndate: 2019/11/12\ndescription: Detects suspicious user agent string of APT40 Dropbox tool\ndetection:\n  condition: selection\n  selection:\n    c-useragent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like\n      Gecko) Chrome/36.0.1985.143 Safari/537.36\n    r-dns: api.dropbox.com\nfalsepositives:\n- Old browsers\nfields:\n- c-ip\n- c-uri\nid: 5ba715b6-71b7-44fd-8245-f66893e81b3d\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2021/11/27\nreferences:\n- Internal research from Florian Roth\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1071.001\n- attack.exfiltration\n- attack.t1567.002\ntitle: APT40 Dropbox Tool User Agent\n",
                            "sigma:id": "5ba715b6-71b7-44fd-8245-f66893e81b3d",
                            "title": "APT40 Dropbox Tool User Agent",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "6ec820f2-e963-4801-9127-d8b2dce4d31b",
                        "lookup_data": {
                            "description": "Detects suspicious user agent strings used in APT malware in proxy logs",
                            "raw": "author: Florian Roth (Nextron Systems), Markus Neis\ndate: 2019/11/12\ndescription: Detects suspicious user agent strings used in APT malware in proxy logs\ndetection:\n  condition: selection\n  selection:\n    c-useragent:\n    - SJZJ (compatible; MSIE 6.0; Win32)\n    - Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/20.0\n    - 'User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0;\n      SLCC'\n    - Mozilla/4.0 (compatible; MSIE 7.4; Win32;32-bit)\n    - webclient\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/200\n    - Mozilla/4.0 (compatible; MSI 6.0;\n    - Mozilla/5.0 (Windows NT 6.3; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0\n    - Mozilla/5.0 (Windows NT 6.2; WOW64; rv:20.0) Gecko/20100101 Firefox/\n    - Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/2\n    - Mozilla/4.0\n    - Netscape\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Firefox/3.6.13\n      GTB7.1\n    - Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2;\n      .NETCLR 2.0.50727)\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; SV1)\n    - Mozilla/4.0 (compatible; MSIE 11.0; Windows NT 6.1; SV1)\n    - Mozilla/4.0 (compatible; MSIE 8.0; Win32)\n    - Mozilla v5.1 (Windows NT 6.1; rv:6.0.1) Gecko/20100101 Firefox/6.0.1\n    - Mozilla/6.1 (compatible; MSIE 9.0; Windows NT 5.3; Trident/5.0)\n    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322; .NET\n      CLR 2.0.50727; .NET CLR 3.0.04506.30; .NET CLR 3.0.04506.648; InfoPath.1)\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) WinHttp/1.6.3.8 (WinHTTP/5.1) like Gecko\n    - Mozilla v5.1 *\n    - MSIE 8.0\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; SLCC2; .NET CLR 2.0.50727;\n      .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E;\n      InfoPath.2)\n    - Mozilla/4.0 (compatible; RMS)\n    - Mozilla/4.0 (compatible; MSIE 6.0; DynGate)\n    - O/9.27 (W; U; Z)\n    - Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.0; Trident/5.0;  Trident/5.0*\n    - Mozilla/5.0 (Windows NT 9; *\n    - hots scot\n    - Mozilla/5.0 (compatible; MSIE 10.0; Windows NT)\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) Chrome/28.0.1500.95 Safari/537.36\n    - Mozilla/5.0 (Windows NT 6.2; Win32; rv:47.0)\n    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;SV1;\n    - Mozilla/5.0 (X11; Linux i686; rv:22.0) Firefox/22.0\n    - Mozilla/5.0 Chrome/72.0.3626.109 Safari/537.36\n    - Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:FTS_06) Gecko/22.36.35.06 Firefox/2.0\n    - Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\n      Chrome/102.0.5005.63 Safari/537.36 Edg/100.0.1185.39\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2;\n      .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; InfoPath.3; .NET4.0C;\n      .NET4.0E)\nfalsepositives:\n- Old browsers\nfields:\n- ClientIP\n- c-uri\n- c-useragent\nid: 6ec820f2-e963-4801-9127-d8b2dce4d31b\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2022/10/10\nreferences:\n- Internal Research\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1071.001\ntitle: APT User Agent\n",
                            "sigma:id": "6ec820f2-e963-4801-9127-d8b2dce4d31b",
                            "title": "APT User Agent",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "9eb68894-7476-4cd6-8752-23b51f5883a7",
                        "lookup_data": {
                            "description": "Detects Bitsadmin connections to domains with uncommon TLDs",
                            "raw": "author: Florian Roth (Nextron Systems), Tim Shelton\ndate: 2019/03/07\ndescription: Detects Bitsadmin connections to domains with uncommon TLDs\ndetection:\n  condition: selection and not falsepositives\n  falsepositives:\n    r-dns|endswith:\n    - .com\n    - .net\n    - .org\n    - .scdn.co\n    - .sfx.ms\n  selection:\n    c-useragent|startswith: Microsoft BITS/\nfalsepositives:\n- Rare programs that use Bitsadmin and update from regional TLDs e.g. .uk or .ca\nfields:\n- ClientIP\n- c-uri\n- c-useragent\nid: 9eb68894-7476-4cd6-8752-23b51f5883a7\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2022/08/16\nreferences:\n- https://twitter.com/jhencinski/status/1102695118455349248\n- https://isc.sans.edu/forums/diary/Investigating+Microsoft+BITS+Activity/23281/\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1071.001\n- attack.defense_evasion\n- attack.persistence\n- attack.t1197\n- attack.s0190\ntitle: Bitsadmin to Uncommon TLD\n",
                            "sigma:id": "9eb68894-7476-4cd6-8752-23b51f5883a7",
                            "title": "Bitsadmin to Uncommon TLD",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5c84856b-55a5-45f1-826f-13f37250cf4e",
                        "lookup_data": {
                            "description": "Detects suspicious user agent strings used by malware in proxy logs",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/07/08\ndescription: Detects suspicious user agent strings used by malware in proxy logs\ndetection:\n  condition: selection\n  selection:\n    c-useragent:\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Chrome /53.0\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0)\n    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR  1.1.4322)\n    - HttpBrowser/1.0\n    - '*<|>*'\n    - nsis_inetc (mozilla)\n    - Wget/1.9+cvs-stable (Red Hat modified)\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; .NET CLR 1.1.4322)\n    - '*zeroup*'\n    - Mozilla/5.0 (Windows NT 5.1 ; v.*\n    - '* adlib/*'\n    - '* tiny'\n    - '* BGroom *'\n    - '* changhuatong'\n    - '* CholTBAgent'\n    - Mozilla/5.0 WinInet\n    - RookIE/1.0\n    - M\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)\n    - Mozilla/4.0 (compatible;MSIE 7.0;Windows NT 6.0)\n    - backdoorbot\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1\n      (.NET CLR 3.5.30731)\n    - Opera/8.81 (Windows NT 6.0; U; en)\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1\n      (.NET CLR 3.5.30729)\n    - Opera\n    - Mozilla/4.0 (compatible; MSIE 5.0; Windows 98)\n    - Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)\n    - MSIE\n    - '*(Charon; Inferno)'\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/5.0)\n    - Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)\n    - Mozilla/4.0(compatible; MSIE 6.0; Windows NT 5.1)\n    - Mozilla/5.0 (Windows NT 10.0; Win64; x64)\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 10.0; Win64; x64)\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Win64; x64)\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.2; WOW64; Trident/7.0; .NET4.0C;\n      .NET4.0E; InfoPath.3)\n    - Mozilla/5.0 (Windows NT 6.1)\n    - AppleWebkit/587.38 (KHTML, like Gecko)\n    - Chrome/91.0.4472.77\n    - Safari/537.36\n    - Edge/91.0.864.37\n    - Firefox/89.0\n    - Gecko/20100101\n    - '* pxyscand*'\n    - '* asd'\n    - '* mdms'\n    - sample\n    - nocase\n    - Moxilla\n    - Win32 *\n    - '*Microsoft Internet Explorer*'\n    - agent *\n    - AutoIt\n    - IczelionDownLoad\n    - Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 10.0; .NET4.0C; .NET4.0E; Tablet\n      PC 2.0)\n    - record\n    - mozzzzzzzzzzz\n    - Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0\n    - Havana/0.1\n    - antSword/v2.1\n    - rqwrwqrqwrqw\n    - qwrqrwrqwrqwr\n    - rc2.0/client\n    - TakeMyPainBack\nfalsepositives:\n- Unknown\nfields:\n- ClientIP\n- c-uri\n- c-useragent\nid: 5c84856b-55a5-45f1-826f-13f37250cf4e\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2023/01/22\nreferences:\n- http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules\n- http://www.botopedia.org/search?searchword=scan&searchphrase=all\n- https://networkraptor.blogspot.com/2015/01/user-agent-strings.html\n- https://perishablepress.com/blacklist/ua-2013.txt\n- https://www.bluecoat.com/en-gb/security-blog/2015-05-05/know-your-agents\n- https://twitter.com/kladblokje_88/status/1614673320124743681?s=12&t=joEpeVa5d58aHYNGA_To7Q\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1071.001\ntitle: Malware User Agent\n",
                            "sigma:id": "5c84856b-55a5-45f1-826f-13f37250cf4e",
                            "title": "Malware User Agent",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "758d96ed-9dd4-4009-9270-65f2c3dd30cc",
                        "lookup_data": {
                            "description": "Buzzing in the Background: BumbleBee, a New Modular Backdoor Evolved From BookWorm",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/758d96ed-9dd4-4009-9270-65f2c3dd30cc.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1666603410",
                            "uuid": "758d96ed-9dd4-4009-9270-65f2c3dd30cc",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b86d356d-6093-443d-971c-9b07db583c68",
                        "lookup_data": {
                            "description": "Detects a suspicious curl process start on linux with set useragent options",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/09/15\ndescription: Detects a suspicious curl process start on linux with set useragent options\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains:\n    - ' -A '\n    - ' --user-agent '\n    Image|endswith: /curl\nfalsepositives:\n- Scripts created by developers and admins\n- Administrative activity\nid: b86d356d-6093-443d-971c-9b07db583c68\nlevel: medium\nlogsource:\n  category: process_creation\n  product: linux\nreferences:\n- https://curl.se/docs/manpage.html\nrelated:\n- id: 3286d37a-00fd-41c2-a624-a672dcd34e60\n  type: derived\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1071.001\ntitle: Suspicious Curl Change User Agents - Linux\n",
                            "sigma:id": "b86d356d-6093-443d-971c-9b07db583c68",
                            "title": "Suspicious Curl Change User Agents - Linux",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "894a8613-cf12-48b3-8e57-9085f54aa0c3",
                        "lookup_data": {
                            "description": "Detects suspicious User Agent strings that end with an equal sign, which can be a sign of base64 encoded values used as User Agent string",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/07/08\ndescription: Detects suspicious User Agent strings that end with an equal sign, which\n  can be a sign of base64 encoded values used as User Agent string\ndetection:\n  condition: selection\n  selection:\n    c-useragent|endswith:\n    - '='\n    - TW96aWxsY\nfalsepositives:\n- Unknown\nfields:\n- ClientIP\n- c-uri\n- c-useragent\nid: 894a8613-cf12-48b3-8e57-9085f54aa0c3\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2022/11/27\nreferences:\n- https://blogs.jpcert.or.jp/en/2022/07/yamabot.html\nstatus: experimental\ntags:\n- attack.command_and_control\n- attack.t1071.001\ntitle: Suspicious Base64 User Agent\n",
                            "sigma:id": "894a8613-cf12-48b3-8e57-9085f54aa0c3",
                            "title": "Suspicious Base64 User Agent",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "fdd1bfb5-f60b-4a35-910e-f36ed3d0b32f",
                        "lookup_data": {
                            "description": "Detects suspicious user agent strings used by exploit / pentest frameworks like Metasploit in proxy logs",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/07/08\ndescription: Detects suspicious user agent strings used by exploit / pentest frameworks\n  like Metasploit in proxy logs\ndetection:\n  condition: selection\n  selection:\n    c-useragent:\n    - Internet Explorer *\n    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; InfoPath.2)\n    - Mozilla/4.0 (compatible; Metasploit RSPEC)\n    - Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)\n    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Trident/4.0; SIMBAR={7DB0F6DE-8DE7-4841-9084-28FA914B0F2E};\n      SLCC1; .N\n    - Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.13 (KHTML, like\n      Gecko) Chrome/4.0.221.6 Safari/525.13\n    - Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; MAAU)\n    - Mozilla/5.0\n    - Mozilla/4.0 (compatible; SPIPE/1.0\n    - Mozilla/5.0 (Windows NT 6.3; rv:39.0) Gecko/20100101 Firefox/35.0\n    - Sametime Community Agent\n    - X-FORWARDED-FOR\n    - DotDotPwn v2.1\n    - SIPDROID\n    - Mozilla/5.0 (Windows NT 10.0; Win32; x32; rv:60.0)\n    - Mozilla/6.0 (X11; Linux x86_64; rv:24.0) Gecko/20140205     Firefox/27.0 Iceweasel/25.3.0\n    - '*wordpress hash grabber*'\n    - '*exploit*'\nfalsepositives:\n- Unknown\nfields:\n- ClientIP\n- c-uri\n- c-useragent\nid: fdd1bfb5-f60b-4a35-910e-f36ed3d0b32f\nlevel: high\nlogsource:\n  category: proxy\nmodified: 2021/11/27\nreferences:\n- https://blog.didierstevens.com/2015/03/16/quickpost-metasploit-user-agent-strings/\nstatus: test\ntags:\n- attack.command_and_control\n- attack.t1071.001\ntitle: Exploit Framework User Agent\n",
                            "sigma:id": "fdd1bfb5-f60b-4a35-910e-f36ed3d0b32f",
                            "title": "Exploit Framework User Agent",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b494b165-6634-483d-8c47-2026a6c52372",
                        "lookup_data": {
                            "description": "Detects suspicious requests to Telegram API without the usual Telegram User-Agent",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2018/06/05\ndescription: Detects suspicious requests to Telegram API without the usual Telegram\n  User-Agent\ndetection:\n  condition: selection and not filter\n  filter:\n    c-useragent|contains:\n    - Telegram\n    - Bot\n  selection:\n    r-dns: api.telegram.org\nfalsepositives:\n- Legitimate use of Telegram bots in the company\nfields:\n- ClientIP\n- c-uri\n- c-useragent\nid: b494b165-6634-483d-8c47-2026a6c52372\nlevel: medium\nlogsource:\n  category: proxy\nmodified: 2021/11/27\nreferences:\n- https://researchcenter.paloaltonetworks.com/2018/03/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/\n- https://blog.malwarebytes.com/threat-analysis/2016/11/telecrypt-the-ransomware-abusing-telegram-api-defeated/\n- https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.command_and_control\n- attack.t1071.001\n- attack.t1102.002\ntitle: Telegram API Access\n",
                            "sigma:id": "b494b165-6634-483d-8c47-2026a6c52372",
                            "title": "Telegram API Access",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4bcf0465-4b53-4de4-8c53-fcc5f7d04dfc",
                        "lookup_data": {
                            "description": "Unwrapping Ursnifs Gifts - The DFIR Report",
                            "link": "http://www.botvrij.eu/data/feed-osint/4bcf0465-4b53-4de4-8c53-fcc5f7d04dfc.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1674763285",
                            "uuid": "4bcf0465-4b53-4de4-8c53-fcc5f7d04dfc",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5df8df26-fe0e-4858-94a7-6cf71d9519c9",
                        "lookup_data": {
                            "description": "UEFI threats moving to the ESP: Introducing ESPecter bootkit",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5df8df26-fe0e-4858-94a7-6cf71d9519c9.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1637336858",
                            "uuid": "5df8df26-fe0e-4858-94a7-6cf71d9519c9",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": [
            {
                "attack_technique": "T1071.001",
                "display_name": "Application Layer Protocol: Web Protocols",
                "atomic_tests": [
                    {
                        "name": "Malicious User Agents - Powershell",
                        "auto_generated_guid": "81c13829-f6c9-45b8-85a6-053366d55297",
                        "description": "This test simulates an infected host beaconing to command and control. Upon execution, no output will be displayed. \nUse an application such as Wireshark to record the session and observe user agent strings and responses.\n\nInspired by APTSimulator - https://github.com/NextronSystems/APTSimulator/blob/master/test-sets/command-and-control/malicious-user-agents.bat\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "domain": {
                                "description": "Default domain to simulate against",
                                "type": "string",
                                "default": "www.google.com"
                            }
                        },
                        "executor": {
                            "command": "Invoke-WebRequest #{domain} -UserAgent \"HttpBrowser/1.0\" | out-null\nInvoke-WebRequest #{domain} -UserAgent \"Wget/1.9+cvs-stable (Red Hat modified)\" | out-null\nInvoke-WebRequest #{domain} -UserAgent \"Opera/8.81 (Windows NT 6.0; U; en)\" | out-null\nInvoke-WebRequest #{domain} -UserAgent \"*<|>*\" | out-null\n",
                            "name": "powershell"
                        }
                    },
                    {
                        "name": "Malicious User Agents - CMD",
                        "auto_generated_guid": "dc3488b0-08c7-4fea-b585-905c83b48180",
                        "description": "This test simulates an infected host beaconing to command and control. Upon execution, no out put will be displayed. \nUse an application such as Wireshark to record the session and observe user agent strings and responses.\n\nInspired by APTSimulator - https://github.com/NextronSystems/APTSimulator/blob/master/test-sets/command-and-control/malicious-user-agents.bat\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "domain": {
                                "description": "Default domain to simulate against",
                                "type": "string",
                                "default": "www.google.com"
                            },
                            "curl_path": {
                                "description": "path to curl.exe",
                                "type": "path",
                                "default": "C:\\Windows\\System32\\Curl.exe"
                            }
                        },
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "Curl must be installed on system \n",
                                "prereq_command": "if (Test-Path #{curl_path}) {exit 0} else {exit 1}\n",
                                "get_prereq_command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://curl.se/windows/dl-8.6.0_2/curl-8.6.0_2-win32-mingw.zip\" -Outfile \"PathToAtomicsFolder\\..\\ExternalPayloads\\curl.zip\"\nExpand-Archive -Path \"PathToAtomicsFolder\\..\\ExternalPayloads\\curl.zip\" -DestinationPath \"PathToAtomicsFolder\\..\\ExternalPayloads\\curl\"\nCopy-Item \"PathToAtomicsFolder\\..\\ExternalPayloads\\curl\\curl-8.6.0_2-win32-mingw\\bin\\curl.exe\" #{curl_path}\nRemove-Item \"PathToAtomicsFolder\\..\\ExternalPayloads\\curl\"\nRemove-Item \"PathToAtomicsFolder\\..\\ExternalPayloads\\curl.zip\"\n"
                            }
                        ],
                        "executor": {
                            "command": "#{curl_path} -s -A \"HttpBrowser/1.0\" -m3 #{domain} >nul 2>&1\n#{curl_path} -s -A \"Wget/1.9+cvs-stable (Red Hat modified)\" -m3 #{domain} >nul 2>&1\n#{curl_path} -s -A \"Opera/8.81 (Windows NT 6.0; U; en)\" -m3 #{domain} >nul 2>&1\n#{curl_path} -s -A \"*<|>*\" -m3 #{domain} >nul 2>&1\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Malicious User Agents - Nix",
                        "auto_generated_guid": "2d7c471a-e887-4b78-b0dc-b0df1f2e0658",
                        "description": "This test simulates an infected host beaconing to command and control.\nInspired by APTSimulator - https://github.com/NextronSystems/APTSimulator/blob/master/test-sets/command-and-control/malicious-user-agents.bat\n",
                        "supported_platforms": [
                            "linux",
                            "macos"
                        ],
                        "input_arguments": {
                            "domain": {
                                "description": "Default domain to simulate against",
                                "type": "string",
                                "default": "www.google.com"
                            }
                        },
                        "executor": {
                            "command": "curl -s -A \"HttpBrowser/1.0\" -m3 #{domain}\ncurl -s -A \"Wget/1.9+cvs-stable (Red Hat modified)\" -m3 #{domain}\ncurl -s -A \"Opera/8.81 (Windows NT 6.0; U; en)\" -m3 #{domain}\ncurl -s -A \"*<|>*\" -m3 #{domain}\n",
                            "name": "sh"
                        }
                    }
                ]
            }
        ]
    },
    "timestamp": "2025-02-28 12:22:55"
}