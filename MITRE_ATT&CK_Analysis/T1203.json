{
    "id": "T1203",
    "name": "Exploitation for Client Execution",
    "description": "Adversaries may exploit software vulnerabilities in client applications to execute code. Vulnerabilities can exist in software due to unsecure coding practices that can lead to unanticipated behavior. Adversaries can take advantage of certain vulnerabilities through targeted exploitation for the purpose of arbitrary code execution. Oftentimes the most valuable exploits to an offensive toolkit are those that can be used to obtain code execution on a remote system because they can be used to gain access to that system. Users will expect to see files related to the applications they commonly used to do work, so they are a useful target for exploit research and development because of their high utility.\nSeveral types exist:\n#  Browser-based Exploitation #\nWeb browsers are a common target through [Drive-by Compromise](T1189) and [Spearphishing Link](T1566.002). Endpoint systems may be compromised through normal web browsing or from certain users being targeted by links in spearphishing emails to adversary controlled sites used to exploit the web browser. These often do not require an action by the user for the exploit to be executed.\n#  Office Applications #\nCommon office and productivity applications such as Microsoft Office are also targeted through [Phishing](T1566). Malicious files will be transmitted directly as attachments or through links to download them. These require the user to open the document or file for the exploit to run.\n#  Common Third-party Applications #\nOther applications that are commonly seen or are part of the software deployed in a target network may also be used for exploitation. Applications such as Adobe Reader and Flash, which are common in enterprise environments, have been routinely targeted by adversaries attempting to gain access to systems. Depending on the software and nature of the vulnerability, some may be exploited in the browser or require the user to open a file. For instance, some Flash exploits have been delivered as objects within Microsoft Office documents.",
    "platforms": "Linux, Windows, macOS",
    "kill_chain_phases": "Execution",
    "data_sources": "",
    "detection": "Detecting software exploitation may be difficult depending on the tools available. Also look for behavior on the endpoint system that might indicate successful compromise, such as abnormal behavior of the browser or Office processes. This could include suspicious files written to disk, evidence of [Process Injection](T1055) for attempts to hide execution, evidence of Discovery, or other unusual network traffic that may indicate additional tools transferred to the system.",
    "url": "https://attack.mitre.org/techniques/T1203",
    "enrichments": {
        "attack_rule_map": [],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "a66bc059-c370-472c-a0d7-f8fd1bf9d583",
                    "e06ac91d-b9e6-443d-8e5b-af749e7aa6b6",
                    "6eea1bf6-f8d2-488a-a742-e6ef6c1b67db",
                    "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                    "023394c4-29d5-46ab-92b8-6a534c6f447b",
                    "48d91a3a-2363-43ba-a456-ca71ac3da5c2",
                    "ad7085ac-92e4-4b76-8ce2-276d2c0e68ef",
                    "75e33ce3-ae32-4dcc-9aa8-a2a3029d6f84",
                    "5dbe8440-9cdc-4af1-acb7-34b902de0b81",
                    "21541900-27a9-4454-9c4c-3f0a4240344a",
                    "b5de2919-b74a-4805-91a7-5049accbaefe",
                    "f2dcee22-c275-405e-87fd-48630a19dfba",
                    "32b5db62-cb5f-4266-9639-0fa48376ac00",
                    "045b5f9c-49f7-4419-a236-9854fb3c827a",
                    "864403a1-36c9-40a2-a982-4c9a45f7d833",
                    "b06335b3-55ac-4b41-937e-16b7f5d57dfd",
                    "8f88e3f6-2a49-48f5-a5c4-2f7eedf78710",
                    "5e6f46d6-d104-4a35-83e7-965402de0b81",
                    "00d0b5ab-1f55-4120-8e83-487c0a7baf19",
                    "678eb5f4-8597-4be6-8be7-905e4234b53a",
                    "238527ad-3c2c-4e4f-a1f6-92fd63adb864",
                    "cd479ccc-d8f0-4c66-ba7d-e06286f3f887",
                    "ab6b1a39-a9ee-4ab4-b075-e83acf6e346b",
                    "be2dcee9-a7a7-4e38-afd6-21b31ecc3d63",
                    "dcdbc940-0bff-46b2-95f3-2d73f848e33b",
                    "fdd84c68-a1f6-47c9-9477-920584f94905"
                ],
                "lookup_results": [
                    {
                        "uuid": "a66bc059-c370-472c-a0d7-f8fd1bf9d583",
                        "lookup_data": {
                            "description": "Detects network connections from Equation Editor",
                            "raw": "author: Max Altgelt (Nextron Systems)\ndate: 2022/04/14\ndescription: Detects network connections from Equation Editor\ndetection:\n  condition: selection\n  selection:\n    Image|endswith: \\eqnedt32.exe\nfalsepositives:\n- Unknown\nid: a66bc059-c370-472c-a0d7-f8fd1bf9d583\nlevel: high\nlogsource:\n  category: network_connection\n  product: windows\nreferences:\n- https://twitter.com/forensicitguy/status/1513538712986079238\n- https://news.sophos.com/en-us/2019/07/18/a-new-equation-editor-exploit-goes-commercial-as-maldoc-attacks-using-it-spike/\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1203\ntitle: Equation Editor Network Connection\n",
                            "sigma:id": "a66bc059-c370-472c-a0d7-f8fd1bf9d583",
                            "title": "Equation Editor Network Connection",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "e06ac91d-b9e6-443d-8e5b-af749e7aa6b6",
                        "lookup_data": {
                            "description": "Detects URL pattern used by iOS Implant",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2019/08/30\ndescription: Detects URL pattern used by iOS Implant\ndetection:\n  condition: selection\n  selection:\n    c-uri|contains: /list/suc\\?name=\nfalsepositives:\n- Unknown\nfields:\n- ClientIP\n- c-uri\n- c-useragent\nid: e06ac91d-b9e6-443d-8e5b-af749e7aa6b6\nlevel: critical\nlogsource:\n  category: proxy\nmodified: 2022/08/15\nreferences:\n- https://googleprojectzero.blogspot.com/2019/08/implant-teardown.html\n- https://twitter.com/craiu/status/1167358457344925696\nstatus: test\ntags:\n- attack.execution\n- attack.t1203\n- attack.collection\n- attack.t1005\n- attack.t1119\n- attack.credential_access\n- attack.t1528\n- attack.t1552.001\ntitle: iOS Implant URL Pattern\n",
                            "sigma:id": "e06ac91d-b9e6-443d-8e5b-af749e7aa6b6",
                            "title": "iOS Implant URL Pattern",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "6eea1bf6-f8d2-488a-a742-e6ef6c1b67db",
                        "lookup_data": {
                            "description": "Rule to detect the use of the SCX RunAsProvider ExecuteScript to execute any UNIX/Linux script using the /bin/sh shell.\nScript being executed gets created as a temp file in /tmp folder with a scx* prefix.\nThen it is invoked from the following directory /etc/opt/microsoft/scx/conf/tmpdir/.\nThe file in that directory has the same prefix scx*. SCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including\nMicrosoft Operations Manager, Microsoft Azure, and Microsoft Operations Management Suite.\n",
                            "raw": "author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC\ndate: 2021/10/15\ndescription: 'Rule to detect the use of the SCX RunAsProvider ExecuteScript to execute\n  any UNIX/Linux script using the /bin/sh shell.\n\n  Script being executed gets created as a temp file in /tmp folder with a scx* prefix.\n\n  Then it is invoked from the following directory /etc/opt/microsoft/scx/conf/tmpdir/.\n\n  The file in that directory has the same prefix scx*. SCXcore, started as the Microsoft\n  Operations Manager UNIX/Linux Agent, is now used in a host of products including\n\n  Microsoft Operations Manager, Microsoft Azure, and Microsoft Operations Management\n  Suite.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains: /etc/opt/microsoft/scx/conf/tmpdir/scx\n    CurrentDirectory: /var/opt/microsoft/scx/tmp\n    LogonId: 0\n    User: root\nfalsepositives:\n- Legitimate use of SCX RunAsProvider ExecuteScript.\nid: 6eea1bf6-f8d2-488a-a742-e6ef6c1b67db\nlevel: high\nlogsource:\n  category: process_creation\n  product: linux\nmodified: 2022/10/05\nreferences:\n- https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure\n- https://github.com/Azure/Azure-Sentinel/pull/3059\nstatus: experimental\ntags:\n- attack.privilege_escalation\n- attack.initial_access\n- attack.execution\n- attack.t1068\n- attack.t1190\n- attack.t1203\ntitle: OMIGOD SCX RunAsProvider ExecuteScript\n",
                            "sigma:id": "6eea1bf6-f8d2-488a-a742-e6ef6c1b67db",
                            "title": "OMIGOD SCX RunAsProvider ExecuteScript",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                        "lookup_data": {
                            "description": "SectorJ04 Groupâ€™s Increased Activity in 2019",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5d6e7aa3-aca4-46cc-b96a-46ac950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1568039252",
                            "uuid": "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "023394c4-29d5-46ab-92b8-6a534c6f447b",
                        "lookup_data": {
                            "description": "Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2019/10/24\ndescription: Detects suspicious Hangul Word Processor (Hanword) sub processes that\n  could indicate an exploitation\ndetection:\n  condition: selection\n  selection:\n    Image|endswith: \\gbb.exe\n    ParentImage|endswith: \\Hwp.exe\nfalsepositives:\n- Unknown\nid: 023394c4-29d5-46ab-92b8-6a534c6f447b\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://www.securitynewspaper.com/2016/11/23/technical-teardown-exploit-malware-hwp-files/\n- https://www.hybrid-analysis.com/search?query=context:74940dcc5b38f9f9b1a0fea760d344735d7d91b610e6d5bd34533dd0153402c5&from_sample=5db135000388385a7644131f&block_redirect=1\n- https://twitter.com/cyberwar_15/status/1187287262054076416\n- https://blog.alyac.co.kr/1901\n- https://en.wikipedia.org/wiki/Hangul_(word_processor)\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1566.001\n- attack.execution\n- attack.t1203\n- attack.t1059.003\n- attack.g0032\ntitle: Suspicious HWP Sub Processes\n",
                            "sigma:id": "023394c4-29d5-46ab-92b8-6a534c6f447b",
                            "title": "Suspicious HWP Sub Processes",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "48d91a3a-2363-43ba-a456-ca71ac3da5c2",
                        "lookup_data": {
                            "description": "Detects events generated by user-mode applications when they call the CveEventWrite API when a known vulnerability is trying to be exploited.\nMS started using this log in Jan. 2020 with CVE-2020-0601 (a Windows CryptoAPI vulnerability.\nUnfortunately, that is about the only instance of CVEs being written to this log.\n",
                            "raw": "author: Florian Roth (Nextron Systems), Zach Mathis\ndate: 2020/01/15\ndescription: 'Detects events generated by user-mode applications when they call the\n  CveEventWrite API when a known vulnerability is trying to be exploited.\n\n  MS started using this log in Jan. 2020 with CVE-2020-0601 (a Windows CryptoAPI vulnerability.\n\n  Unfortunately, that is about the only instance of CVEs being written to this log.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    EventID: 1\n    Provider_Name:\n    - Microsoft-Windows-Audit-CVE\n    - Audit-CVE\nfalsepositives:\n- Unknown\nid: 48d91a3a-2363-43ba-a456-ca71ac3da5c2\nlevel: critical\nlogsource:\n  product: windows\n  service: application\nmodified: 2022/10/22\nreferences:\n- https://twitter.com/VM_vivisector/status/1217190929330655232\n- https://twitter.com/DidierStevens/status/1217533958096924676\n- https://twitter.com/FlemmingRiis/status/1217147415482060800\n- https://www.youtube.com/watch?v=ebmW42YYveI\n- https://nullsec.us/windows-event-log-audit-cve/\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1203\n- attack.privilege_escalation\n- attack.t1068\n- attack.defense_evasion\n- attack.t1211\n- attack.credential_access\n- attack.t1212\n- attack.lateral_movement\n- attack.t1210\n- attack.impact\n- attack.t1499.004\ntitle: Audit CVE Event\n",
                            "sigma:id": "48d91a3a-2363-43ba-a456-ca71ac3da5c2",
                            "title": "Audit CVE Event",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ad7085ac-92e4-4b76-8ce2-276d2c0e68ef",
                        "lookup_data": {
                            "description": "Detects patterns as noticed in exploitation of Windows CVE-2021-31979 CVE-2021-33771 vulnerability and DevilsTongue malware by threat group Sourgum",
                            "raw": "author: Sittikorn S\ndate: 2021/07/16\ndescription: Detects patterns as noticed in exploitation of Windows CVE-2021-31979\n  CVE-2021-33771 vulnerability and DevilsTongue malware by threat group Sourgum\ndetection:\n  condition: selection\n  selection:\n    TargetFilename|contains:\n    - C:\\Windows\\system32\\physmem.sys\n    - C:\\Windows\\System32\\IME\\IMEJP\\imjpueact.dll\n    - C:\\Windows\\system32\\ime\\IMETC\\IMTCPROT.DLL\n    - C:\\Windows\\system32\\ime\\SHARED\\imecpmeid.dll\n    - C:\\Windows\\system32\\config\\spp\\ServiceState\\Recovery\\pac.dat\n    - C:\\Windows\\system32\\config\\cy-GB\\Setup\\SKB\\InputMethod\\TupTask.dat\n    - C:\\Windows\\system32\\config\\config\\startwus.dat\n    - C:\\Windows\\system32\\ime\\SHARED\\WimBootConfigurations.ini\n    - C:\\Windows\\system32\\ime\\IMEJP\\WimBootConfigurations.ini\n    - C:\\Windows\\system32\\ime\\IMETC\\WimBootConfigurations.ini\nfalsepositives:\n- Unlikely\nid: ad7085ac-92e4-4b76-8ce2-276d2c0e68ef\nlevel: critical\nlogsource:\n  category: file_event\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://www.microsoft.com/security/blog/2021/07/15/protecting-customers-from-a-private-sector-offensive-actor-using-0-day-exploits-and-devilstongue-malware/\n- https://citizenlab.ca/2021/07/hooking-candiru-another-mercenary-spyware-vendor-comes-into-focus/\nstatus: test\ntags:\n- attack.credential_access\n- attack.t1566\n- attack.t1203\n- cve.2021.33771\n- cve.2021.31979\ntitle: CVE-2021-31979 CVE-2021-33771 Exploits by Sourgum\n",
                            "sigma:id": "ad7085ac-92e4-4b76-8ce2-276d2c0e68ef",
                            "title": "CVE-2021-31979 CVE-2021-33771 Exploits by Sourgum",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "75e33ce3-ae32-4dcc-9aa8-a2a3029d6f84",
                        "lookup_data": {
                            "description": "Detects an Excel process that opens suspicious network connections to non-private IP addresses, and attempts to cover CVE-2021-42292.\nYou will likely have to tune this rule for your organization, but it is certainly something you should look for and could have applications for malicious activity beyond CVE-2021-42292.\n",
                            "raw": "author: Christopher Peacock '@securepeacock', SCYTHE '@scythe_io', Florian Roth '@Neo23x0\",\n  Tim Shelton\ndate: 2021/11/10\ndescription: 'Detects an Excel process that opens suspicious network connections to\n  non-private IP addresses, and attempts to cover CVE-2021-42292.\n\n  You will likely have to tune this rule for your organization, but it is certainly\n  something you should look for and could have applications for malicious activity\n  beyond CVE-2021-42292.\n\n  '\ndetection:\n  condition: selection and not filter\n  filter:\n    DestinationIp|startswith:\n    - '10.'\n    - 192.168.\n    - 172.16.\n    - 172.17.\n    - 172.18.\n    - 172.19.\n    - 172.20.\n    - 172.21.\n    - 172.22.\n    - 172.23.\n    - 172.24.\n    - 172.25.\n    - 172.26.\n    - 172.27.\n    - 172.28.\n    - 172.29.\n    - 172.30.\n    - 172.31.\n    - 127.0.0.1\n  selection:\n    DestinationIsIpv6: 'false'\n    Image|endswith: \\excel.exe\n    Initiated: 'true'\nfalsepositives:\n- You may have to tune certain domains out that Excel may call out to, such as microsoft\n  or other business use case domains.\n- Office documents commonly have templates that refer to external addresses, like\n  sharepoint.ourcompany.com may have to be tuned.\n- It is highly recommended to baseline your activity and tune out common business\n  use cases.\nid: 75e33ce3-ae32-4dcc-9aa8-a2a3029d6f84\nlevel: medium\nlogsource:\n  category: network_connection\n  product: windows\nmodified: 2022/06/27\nreferences:\n- https://corelight.com/blog/detecting-cve-2021-42292\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1203\ntitle: Excel Network Connections\n",
                            "sigma:id": "75e33ce3-ae32-4dcc-9aa8-a2a3029d6f84",
                            "title": "Excel Network Connections",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5dbe8440-9cdc-4af1-acb7-34b902de0b81",
                        "lookup_data": {
                            "description": "OSINT - Chrome 0-day exploit CVE-2019-13720 used in Operation WizardOpium",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5dbe8440-9cdc-4af1-acb7-34b902de0b81.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1572768064",
                            "uuid": "5dbe8440-9cdc-4af1-acb7-34b902de0b81",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "21541900-27a9-4454-9c4c-3f0a4240344a",
                        "lookup_data": {
                            "description": "Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand to execute any UNIX/Linux command using the /bin/sh shell.\nSCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including\nMicrosoft Operations Manager, Microsoft Azure, and Microsoft Operations Management Suite.\n",
                            "raw": "author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC\ndate: 2021/10/15\ndescription: 'Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand\n  to execute any UNIX/Linux command using the /bin/sh shell.\n\n  SCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used\n  in a host of products including\n\n  Microsoft Operations Manager, Microsoft Azure, and Microsoft Operations Management\n  Suite.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains: /bin/sh\n    CurrentDirectory: /var/opt/microsoft/scx/tmp\n    LogonId: 0\n    User: root\nfalsepositives:\n- Legitimate use of SCX RunAsProvider Invoke_ExecuteShellCommand.\nid: 21541900-27a9-4454-9c4c-3f0a4240344a\nlevel: high\nlogsource:\n  category: process_creation\n  product: linux\nmodified: 2022/10/05\nreferences:\n- https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure\n- https://github.com/Azure/Azure-Sentinel/pull/3059\nstatus: experimental\ntags:\n- attack.privilege_escalation\n- attack.initial_access\n- attack.execution\n- attack.t1068\n- attack.t1190\n- attack.t1203\ntitle: OMIGOD SCX RunAsProvider ExecuteShellCommand\n",
                            "sigma:id": "21541900-27a9-4454-9c4c-3f0a4240344a",
                            "title": "OMIGOD SCX RunAsProvider ExecuteShellCommand",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b5de2919-b74a-4805-91a7-5049accbaefe",
                        "lookup_data": {
                            "description": "Detects executable downloads from suspicious remote systems",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/03/13\ndescription: Detects executable downloads from suspicious remote systems\ndetection:\n  condition: selection and not filter\n  filter:\n    r-dns|endswith:\n    - .com\n    - .org\n    - .net\n    - .edu\n    - .gov\n    - .uk\n    - .ca\n    - .de\n    - .jp\n    - .fr\n    - .au\n    - .us\n    - .ch\n    - .it\n    - .nl\n    - .se\n    - .no\n    - .es\n  selection:\n    c-uri-extension:\n    - exe\n    - vbs\n    - bat\n    - rar\n    - ps1\n    - doc\n    - docm\n    - xls\n    - xlsm\n    - pptm\n    - rtf\n    - hta\n    - dll\n    - ws\n    - wsf\n    - sct\n    - zip\nfalsepositives:\n- All kind of software downloads\nfields:\n- ClientIP\n- c-uri\nid: b5de2919-b74a-4805-91a7-5049accbaefe\nlevel: low\nlogsource:\n  category: proxy\nmodified: 2023/01/09\nrelated:\n- id: 00d0b5ab-1f55-4120-8e83-487c0a7baf19\n  type: similar\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1566\n- attack.execution\n- attack.t1203\n- attack.t1204.002\ntitle: Download From Suspicious TLD - Whitelist\n",
                            "sigma:id": "b5de2919-b74a-4805-91a7-5049accbaefe",
                            "title": "Download From Suspicious TLD - Whitelist",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f2dcee22-c275-405e-87fd-48630a19dfba",
                        "lookup_data": {
                            "mitre-attack-id": "T1203",
                            "mitre-cti:description": "Browser sandboxes can be used to mitigate some of the impact of exploitation, but sandbox escapes may still exist. (Citation: Windows Blogs Microsoft Edge Sandbox) (Citation: Ars Technica Pwn2Own 2017 VM Escape)\n\nOther types of virtualization and application microsegmentation may also mitigate the impact of client-side exploitation. The risks of additional exploits and weaknesses in implementation may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)\n\nSecurity applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. (Citation: TechNet Moving Beyond EMET) Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. (Citation: Wikipedia Control Flow Integrity) Many of these protections depend on the architecture and target application binary for compatibility.",
                            "mitre-cti:name": "Exploitation for Client Execution Mitigation",
                            "mitre-cti:type": "course-of-action",
                            "raw": "{'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'course-of-action--f2dcee22-c275-405e-87fd-48630a19dfba', 'type': 'course-of-action', 'created': '2018-10-17T00:14:20.652Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/mitigations/T1203', 'external_id': 'T1203'}, {'url': 'https://blogs.windows.com/msedgedev/2017/03/23/strengthening-microsoft-edge-sandbox/', 'description': 'Cowan, C. (2017, March 23). Strengthening the Microsoft Edge Sandbox. Retrieved March 12, 2018.', 'source_name': 'Windows Blogs Microsoft Edge Sandbox'}, {'url': 'https://arstechnica.com/information-technology/2017/03/hack-that-escapes-vm-by-exploiting-edge-browser-fetches-105000-at-pwn2own/', 'description': 'Goodin, D. (2017, March 17). Virtual machine escape fetches $105,000 at Pwn2Own hacking contest - updated. Retrieved March 12, 2018.', 'source_name': 'Ars Technica Pwn2Own 2017 VM Escape'}, {'url': 'https://blogs.technet.microsoft.com/srd/2017/08/09/moving-beyond-emet-ii-windows-defender-exploit-guard/', 'description': 'Nunez, N. (2017, August 9). Moving Beyond EMET II – Windows Defender Exploit Guard. Retrieved March 12, 2018.', 'source_name': 'TechNet Moving Beyond EMET'}, {'url': 'https://en.wikipedia.org/wiki/Control-flow_integrity', 'description': 'Wikipedia. (2018, January 11). Control-flow integrity. Retrieved March 12, 2018.', 'source_name': 'Wikipedia Control Flow Integrity'}], 'modified': '2019-07-24T19:22:39.193Z', 'name': 'Exploitation for Client Execution Mitigation', 'description': 'Browser sandboxes can be used to mitigate some of the impact of exploitation, but sandbox escapes may still exist. (Citation: Windows Blogs Microsoft Edge Sandbox) (Citation: Ars Technica Pwn2Own 2017 VM Escape)\\n\\nOther types of virtualization and application microsegmentation may also mitigate the impact of client-side exploitation. The risks of additional exploits and weaknesses in implementation may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)\\n\\nSecurity applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. (Citation: TechNet Moving Beyond EMET) Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. (Citation: Wikipedia Control Flow Integrity) Many of these protections depend on the architecture and target application binary for compatibility.', 'x_mitre_deprecated': True, 'x_mitre_version': '1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "32b5db62-cb5f-4266-9639-0fa48376ac00",
                        "lookup_data": {
                            "description": "Detects patterns as noticed in exploitation of Windows CVE-2021-31979 CVE-2021-33771 vulnerability and DevilsTongue malware by threat group Sourgum",
                            "raw": "author: Sittikorn S, frack113\ndate: 2021/07/16\ndescription: Detects patterns as noticed in exploitation of Windows CVE-2021-31979\n  CVE-2021-33771 vulnerability and DevilsTongue malware by threat group Sourgum\ndetection:\n  condition: selection and not filter\n  filter:\n    Details|endswith:\n    - system32\\wbem\\wmiutils.dll\n    - system32\\wbem\\wbemsvc.dll\n  selection:\n    EventType: SetValue\n    TargetObject|endswith:\n    - CLSID\\{CF4CC405-E2C5-4DDD-B3CE-5E7582D8C9FA}\\InprocServer32\\(Default)\n    - CLSID\\{7C857801-7381-11CF-884D-00AA004B2E24}\\InProcServer32\\(Default)\nfalsepositives:\n- Unlikely\nid: 32b5db62-cb5f-4266-9639-0fa48376ac00\nlevel: critical\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/08/23\nreferences:\n- https://www.microsoft.com/security/blog/2021/07/15/protecting-customers-from-a-private-sector-offensive-actor-using-0-day-exploits-and-devilstongue-malware/\n- https://citizenlab.ca/2021/07/hooking-candiru-another-mercenary-spyware-vendor-comes-into-focus/\nstatus: experimental\ntags:\n- attack.credential_access\n- attack.t1566\n- attack.t1203\n- cve.2021.33771\n- cve.2021.31979\ntitle: CVE-2021-31979 CVE-2021-33771 Exploits\n",
                            "sigma:id": "32b5db62-cb5f-4266-9639-0fa48376ac00",
                            "title": "CVE-2021-31979 CVE-2021-33771 Exploits",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "045b5f9c-49f7-4419-a236-9854fb3c827a",
                        "lookup_data": {
                            "description": "Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand to execute any UNIX/Linux command using the /bin/sh shell.\nSCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including Microsoft Operations Manager.\nMicrosoft Azure, and Microsoft Operations Management Suite.\n",
                            "raw": "author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2021/09/17\ndescription: 'Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand\n  to execute any UNIX/Linux command using the /bin/sh shell.\n\n  SCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used\n  in a host of products including Microsoft Operations Manager.\n\n  Microsoft Azure, and Microsoft Operations Management Suite.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    comm: sh\n    cwd: /var/opt/microsoft/scx/tmp\n    syscall: execve\n    type: SYSCALL\n    uid: 0\nfalsepositives:\n- Legitimate use of SCX RunAsProvider Invoke_ExecuteShellCommand.\nid: 045b5f9c-49f7-4419-a236-9854fb3c827a\nlevel: high\nlogsource:\n  product: linux\n  service: auditd\nmodified: 2022/11/26\nreferences:\n- https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure\n- https://github.com/Azure/Azure-Sentinel/pull/3059\nstatus: experimental\ntags:\n- attack.privilege_escalation\n- attack.initial_access\n- attack.execution\n- attack.t1068\n- attack.t1190\n- attack.t1203\ntitle: OMIGOD SCX RunAsProvider ExecuteShellCommand - Auditd\n",
                            "sigma:id": "045b5f9c-49f7-4419-a236-9854fb3c827a",
                            "title": "OMIGOD SCX RunAsProvider ExecuteShellCommand - Auditd",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "864403a1-36c9-40a2-a982-4c9a45f7d833",
                        "lookup_data": {
                            "description": "Detects Winword starting uncommon sub process FLTLDR.exe as used in exploits for CVE-2017-0261 and CVE-2017-0262",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2018/02/22\ndescription: Detects Winword starting uncommon sub process FLTLDR.exe as used in exploits\n  for CVE-2017-0261 and CVE-2017-0262\ndetection:\n  condition: selection\n  selection:\n    Image|contains: \\FLTLDR.exe\n    ParentImage|endswith: \\WINWORD.EXE\nfalsepositives:\n- Several false positives identified, check for suspicious file names or locations\n  (e.g. Temp folders)\nid: 864403a1-36c9-40a2-a982-4c9a45f7d833\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://www.fireeye.com/blog/threat-research/2017/05/eps-processing-zero-days.html\nstatus: test\ntags:\n- attack.execution\n- attack.t1203\n- attack.t1204.002\n- attack.initial_access\n- attack.t1566.001\ntitle: Exploit for CVE-2017-0261\n",
                            "sigma:id": "864403a1-36c9-40a2-a982-4c9a45f7d833",
                            "title": "Exploit for CVE-2017-0261",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b06335b3-55ac-4b41-937e-16b7f5d57dfd",
                        "lookup_data": {
                            "description": "Detects possible successful exploitation for vulnerability described in CVE-2021-26858 by looking for \ncreation of non-standard files on disk by Exchange Server’s Unified Messaging service\nwhich could indicate dropping web shells or other malicious content\n",
                            "raw": "author: Bhabesh Raj\ndate: 2021/03/03\ndescription: \"Detects possible successful exploitation for vulnerability described\\\n  \\ in CVE-2021-26858 by looking for \\ncreation of non-standard files on disk by Exchange\\\n  \\ Server\\u2019s Unified Messaging service\\nwhich could indicate dropping web shells\\\n  \\ or other malicious content\\n\"\ndetection:\n  condition: selection and not filter\n  filter:\n    TargetFilename|endswith:\n    - CacheCleanup.bin\n    - .txt\n    - .LOG\n    - .cfg\n    - cleanup.bin\n  selection:\n    Image|endswith: UMWorkerProcess.exe\nfalsepositives:\n- Unknown\nfields:\n- ComputerName\n- TargetFilename\nid: b06335b3-55ac-4b41-937e-16b7f5d57dfd\nlevel: high\nlogsource:\n  category: file_event\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/\nstatus: test\ntags:\n- attack.t1203\n- attack.execution\n- cve.2021.26858\ntitle: CVE-2021-26858 Exchange Exploitation\n",
                            "sigma:id": "b06335b3-55ac-4b41-937e-16b7f5d57dfd",
                            "title": "CVE-2021-26858 Exchange Exploitation",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "8f88e3f6-2a49-48f5-a5c4-2f7eedf78710",
                        "lookup_data": {
                            "description": "Detects a JAVA process running with remote debugging allowing more than just localhost to connect",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2019/01/16\ndescription: Detects a JAVA process running with remote debugging allowing more than\n  just localhost to connect\ndetection:\n  condition: all of selection_* and not exclusion\n  exclusion:\n    CommandLine|contains:\n    - address=127.0.0.1\n    - address=localhost\n  selection_jdwp_transport:\n    CommandLine|contains: transport=dt_socket,address=\n  selection_old_jvm_version:\n    CommandLine|contains:\n    - jre1.\n    - jdk1.\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\n- ParentCommandLine\nid: 8f88e3f6-2a49-48f5-a5c4-2f7eedf78710\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/02/01\nreferences:\n- https://dzone.com/articles/remote-debugging-java-applications-with-jdwp\nstatus: test\ntags:\n- attack.t1203\n- attack.execution\ntitle: Java Running with Remote Debugging\n",
                            "sigma:id": "8f88e3f6-2a49-48f5-a5c4-2f7eedf78710",
                            "title": "Java Running with Remote Debugging",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5e6f46d6-d104-4a35-83e7-965402de0b81",
                        "lookup_data": {
                            "description": "OSINT - new sample of operation lagtime TA428",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5e6f46d6-d104-4a35-83e7-965402de0b81.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1584352112",
                            "uuid": "5e6f46d6-d104-4a35-83e7-965402de0b81",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "00d0b5ab-1f55-4120-8e83-487c0a7baf19",
                        "lookup_data": {
                            "description": "Detects download of certain file types from hosts in suspicious TLDs",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/11/07\ndescription: Detects download of certain file types from hosts in suspicious TLDs\ndetection:\n  condition: selection\n  selection:\n    c-uri-extension:\n    - exe\n    - vbs\n    - bat\n    - rar\n    - ps1\n    - doc\n    - docm\n    - xls\n    - xlsm\n    - pptm\n    - rtf\n    - hta\n    - dll\n    - ws\n    - wsf\n    - sct\n    - zip\n    r-dns|endswith:\n    - .country\n    - .stream\n    - .gdn\n    - .mom\n    - .xin\n    - .kim\n    - .men\n    - .loan\n    - .download\n    - .racing\n    - .online\n    - .science\n    - .ren\n    - .gb\n    - .win\n    - .top\n    - .review\n    - .vip\n    - .party\n    - .tech\n    - .xyz\n    - .date\n    - .faith\n    - .zip\n    - .cricket\n    - .space\n    - .info\n    - .vn\n    - .cm\n    - .am\n    - .cc\n    - .asia\n    - .ws\n    - .tk\n    - .biz\n    - .su\n    - .st\n    - .ro\n    - .ge\n    - .ms\n    - .pk\n    - .nu\n    - .me\n    - .ph\n    - .to\n    - .tt\n    - .name\n    - .tv\n    - .kz\n    - .tc\n    - .mobi\n    - .study\n    - .click\n    - .link\n    - .trade\n    - .accountant\n    - .cf\n    - .gq\n    - .ml\n    - .ga\n    - .pw\nfalsepositives:\n- All kinds of software downloads\nfields:\n- ClientIP\n- c-uri\nid: 00d0b5ab-1f55-4120-8e83-487c0a7baf19\nlevel: low\nlogsource:\n  category: proxy\nmodified: 2023/01/09\nreferences:\n- https://www.symantec.com/connect/blogs/shady-tld-research-gdn-and-our-2016-wrap\n- https://promos.mcafee.com/en-US/PDF/MTMW_Report.pdf\n- https://www.spamhaus.org/statistics/tlds/\n- https://krebsonsecurity.com/2018/06/bad-men-at-work-please-dont-click/\nrelated:\n- id: b5de2919-b74a-4805-91a7-5049accbaefe\n  type: similar\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1566\n- attack.execution\n- attack.t1203\n- attack.t1204.002\ntitle: Download From Suspicious TLD - Blacklist\n",
                            "sigma:id": "00d0b5ab-1f55-4120-8e83-487c0a7baf19",
                            "title": "Download From Suspicious TLD - Blacklist",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "678eb5f4-8597-4be6-8be7-905e4234b53a",
                        "lookup_data": {
                            "description": "Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and other sub processes like mshta.exe",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/11/23\ndescription: Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and other\n  sub processes like mshta.exe\ndetection:\n  condition: selection\n  selection:\n    ParentImage|endswith: \\EQNEDT32.EXE\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\nid: 678eb5f4-8597-4be6-8be7-905e4234b53a\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://www.hybrid-analysis.com/sample/2a4ae284c76f868fc51d3bb65da8caa6efacb707f265b25c30f34250b76b7507?environmentId=100\n- https://www.google.com/url?hl=en&q=https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about&source=gmail&ust=1511481120837000&usg=AFQjCNGdL7gVwLXaNSl2Td8ylDYbSJFmPw\nstatus: stable\ntags:\n- attack.execution\n- attack.t1203\n- attack.t1204.002\n- attack.initial_access\n- attack.t1566.001\ntitle: Droppers Exploiting CVE-2017-11882\n",
                            "sigma:id": "678eb5f4-8597-4be6-8be7-905e4234b53a",
                            "title": "Droppers Exploiting CVE-2017-11882",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "238527ad-3c2c-4e4f-a1f6-92fd63adb864",
                        "lookup_data": {
                            "description": "Detects a highly relevant Antivirus alert that reports an exploitation framework",
                            "raw": "author: Florian Roth (Nextron Systems), Arnim Rupp\ndate: 2018/09/09\ndescription: Detects a highly relevant Antivirus alert that reports an exploitation\n  framework\ndetection:\n  condition: selection\n  selection:\n    Signature|contains:\n    - MeteTool\n    - MPreter\n    - Meterpreter\n    - Metasploit\n    - PowerSploit\n    - CobaltStrike\n    - BruteR\n    - Brutel\n    - Swrort\n    - Rozena\n    - Backdoor.Cobalt\n    - CobaltStr\n    - COBEACON\n    - Cometer\n    - Razy\n    - IISExchgSpawnCMD\n    - Exploit.Script.CVE\n    - Seatbelt\n    - Sbelt\n    - Sliver\nfalsepositives:\n- Unlikely\nfields:\n- FileName\n- User\nid: 238527ad-3c2c-4e4f-a1f6-92fd63adb864\nlevel: critical\nlogsource:\n  category: antivirus\nmodified: 2023/01/13\nreferences:\n- https://www.nextron-systems.com/?s=antivirus\n- https://www.virustotal.com/gui/file/925b0b28472d4d79b4bf92050e38cc2b8f722691c713fc28743ac38551bc3797\n- https://www.virustotal.com/gui/file/8f8daabe1c8ceb5710949283818e16c4aa8059bf2ce345e2f2c90b8692978424\n- https://www.virustotal.com/gui/file/d9669f7e3eb3a9cdf6a750eeb2ba303b5ae148a43e36546896f1d1801e912466\nstatus: stable\ntags:\n- attack.execution\n- attack.t1203\n- attack.command_and_control\n- attack.t1219\ntitle: Antivirus Exploitation Framework Detection\n",
                            "sigma:id": "238527ad-3c2c-4e4f-a1f6-92fd63adb864",
                            "title": "Antivirus Exploitation Framework Detection",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "cd479ccc-d8f0-4c66-ba7d-e06286f3f887",
                        "lookup_data": {
                            "description": "Detects possible successful exploitation for vulnerability described in CVE-2021-26857 by looking for | abnormal subprocesses spawning by Exchange Server's Unified Messaging service",
                            "raw": "author: Bhabesh Raj\ndate: 2021/03/03\ndescription: Detects possible successful exploitation for vulnerability described\n  in CVE-2021-26857 by looking for | abnormal subprocesses spawning by Exchange Server's\n  Unified Messaging service\ndetection:\n  condition: selection and not filter\n  filter:\n    Image|endswith:\n    - wermgr.exe\n    - WerFault.exe\n  selection:\n    ParentImage|endswith: UMWorkerProcess.exe\nfalsepositives:\n- Unknown\nid: cd479ccc-d8f0-4c66-ba7d-e06286f3f887\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/\nstatus: stable\ntags:\n- attack.t1203\n- attack.execution\n- cve.2021.26857\ntitle: CVE-2021-26857 Exchange Exploitation\n",
                            "sigma:id": "cd479ccc-d8f0-4c66-ba7d-e06286f3f887",
                            "title": "CVE-2021-26857 Exchange Exploitation",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ab6b1a39-a9ee-4ab4-b075-e83acf6e346b",
                        "lookup_data": {
                            "description": "Detects the exploitation of OMIGOD (CVE-2021-38647) which allows remote execute (RCE) commands as root with just a single unauthenticated HTTP request.\nVerify, successful, exploitation by viewing the HTTP client (request) body to see what was passed to the server (using PCAP).\nWithin the client body is where the code execution would occur. Additionally, check the endpoint logs to see if suspicious commands or activity occurred within the timeframe of this HTTP request.\n",
                            "raw": "author: Nate Guagenti (neu5ron)\ndate: 2021/09/20\ndescription: 'Detects the exploitation of OMIGOD (CVE-2021-38647) which allows remote\n  execute (RCE) commands as root with just a single unauthenticated HTTP request.\n\n  Verify, successful, exploitation by viewing the HTTP client (request) body to see\n  what was passed to the server (using PCAP).\n\n  Within the client body is where the code execution would occur. Additionally, check\n  the endpoint logs to see if suspicious commands or activity occurred within the\n  timeframe of this HTTP request.\n\n  '\ndetection:\n  auth_header:\n    client_header_names|contains: AUTHORIZATION\n  condition: selection and not auth_header and not too_small_http_client_body\n  selection:\n    method: POST\n    status_code: 200\n    uri: /wsman\n  too_small_http_client_body:\n    request_body_len: 0\nfalsepositives:\n- Exploits that were attempted but unsuccessful.\n- Scanning attempts with the abnormal use of the HTTP POST method with no indication\n  of code execution within the HTTP Client (Request) body. An example would be vulnerability\n  scanners trying to identify unpatched versions while not actually exploiting the\n  vulnerability. See description for investigation tips.\nfields:\n- id.orig_h\n- id.resp_h\n- id.resp_p\n- status_code\n- method\n- uri\n- request_body_len\n- response_body_len\n- user_agent\nid: ab6b1a39-a9ee-4ab4-b075-e83acf6e346b\nlevel: high\nlogsource:\n  definition: Enable the builtin Zeek script that logs all HTTP header names by adding\n    \"@load policy/protocols/http/header-names\" to your local.zeek config file. The\n    script can be seen here for reference https://github.com/zeek/zeek/blob/d957f883df242ef159cfd846884e673addeea7a5/scripts/policy/protocols/http/header-names.zeek\n  product: zeek\n  service: http\nmodified: 2019/09/20\nreferences:\n- https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure\n- https://twitter.com/neu5ron/status/1438987292971053057?s=20\nstatus: stable\ntags:\n- attack.privilege_escalation\n- attack.initial_access\n- attack.execution\n- attack.lateral_movement\n- attack.t1068\n- attack.t1190\n- attack.t1203\n- attack.t1021.006\n- attack.t1210\ntitle: OMIGOD HTTP No Authentication RCE\n",
                            "sigma:id": "ab6b1a39-a9ee-4ab4-b075-e83acf6e346b",
                            "title": "OMIGOD HTTP No Authentication RCE",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "be2dcee9-a7a7-4e38-afd6-21b31ecc3d63",
                        "lookup_data": {
                            "mitre-attack-id": "T1203",
                            "mitre-cti:description": "Adversaries may exploit software vulnerabilities in client applications to execute code. Vulnerabilities can exist in software due to unsecure coding practices that can lead to unanticipated behavior. Adversaries can take advantage of certain vulnerabilities through targeted exploitation for the purpose of arbitrary code execution. Oftentimes the most valuable exploits to an offensive toolkit are those that can be used to obtain code execution on a remote system because they can be used to gain access to that system. Users will expect to see files related to the applications they commonly used to do work, so they are a useful target for exploit research and development because of their high utility.\n\nSeveral types exist:\n\n### Browser-based Exploitation\n\nWeb browsers are a common target through [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) and [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002). Endpoint systems may be compromised through normal web browsing or from certain users being targeted by links in spearphishing emails to adversary controlled sites used to exploit the web browser. These often do not require an action by the user for the exploit to be executed.\n\n### Office Applications\n\nCommon office and productivity applications such as Microsoft Office are also targeted through [Phishing](https://attack.mitre.org/techniques/T1566). Malicious files will be transmitted directly as attachments or through links to download them. These require the user to open the document or file for the exploit to run.\n\n### Common Third-party Applications\n\nOther applications that are commonly seen or are part of the software deployed in a target network may also be used for exploitation. Applications such as Adobe Reader and Flash, which are common in enterprise environments, have been routinely targeted by adversaries attempting to gain access to systems. Depending on the software and nature of the vulnerability, some may be exploited in the browser or require the user to open a file. For instance, some Flash exploits have been delivered as objects within Microsoft Office documents.",
                            "mitre-cti:name": "Exploitation for Client Execution",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'x_mitre_platforms': ['Linux', 'Windows', 'macOS'], 'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'type': 'attack-pattern', 'id': 'attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63', 'created': '2018-04-18T17:59:24.739Z', 'x_mitre_version': '1.4', 'external_references': [{'source_name': 'mitre-attack', 'external_id': 'T1203', 'url': 'https://attack.mitre.org/techniques/T1203'}], 'x_mitre_deprecated': False, 'revoked': False, 'description': 'Adversaries may exploit software vulnerabilities in client applications to execute code. Vulnerabilities can exist in software due to unsecure coding practices that can lead to unanticipated behavior. Adversaries can take advantage of certain vulnerabilities through targeted exploitation for the purpose of arbitrary code execution. Oftentimes the most valuable exploits to an offensive toolkit are those that can be used to obtain code execution on a remote system because they can be used to gain access to that system. Users will expect to see files related to the applications they commonly used to do work, so they are a useful target for exploit research and development because of their high utility.\\n\\nSeveral types exist:\\n\\n### Browser-based Exploitation\\n\\nWeb browsers are a common target through [Drive-by Compromise](https://attack.mitre.org/techniques/T1189) and [Spearphishing Link](https://attack.mitre.org/techniques/T1566/002). Endpoint systems may be compromised through normal web browsing or from certain users being targeted by links in spearphishing emails to adversary controlled sites used to exploit the web browser. These often do not require an action by the user for the exploit to be executed.\\n\\n### Office Applications\\n\\nCommon office and productivity applications such as Microsoft Office are also targeted through [Phishing](https://attack.mitre.org/techniques/T1566). Malicious files will be transmitted directly as attachments or through links to download them. These require the user to open the document or file for the exploit to run.\\n\\n### Common Third-party Applications\\n\\nOther applications that are commonly seen or are part of the software deployed in a target network may also be used for exploitation. Applications such as Adobe Reader and Flash, which are common in enterprise environments, have been routinely targeted by adversaries attempting to gain access to systems. Depending on the software and nature of the vulnerability, some may be exploited in the browser or require the user to open a file. For instance, some Flash exploits have been delivered as objects within Microsoft Office documents.', 'modified': '2022-04-18T18:48:06.141Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'name': 'Exploitation for Client Execution', 'x_mitre_detection': 'Detecting software exploitation may be difficult depending on the tools available. Also look for behavior on the endpoint system that might indicate successful compromise, such as abnormal behavior of the browser or Office processes. This could include suspicious files written to disk, evidence of [Process Injection](https://attack.mitre.org/techniques/T1055) for attempts to hide execution, evidence of Discovery, or other unusual network traffic that may indicate additional tools transferred to the system.', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'execution'}], 'x_mitre_is_subtechnique': False, 'x_mitre_data_sources': ['Process: Process Creation', 'Application Log: Application Log Content'], 'x_mitre_system_requirements': ['Remote exploitation for execution requires a remotely accessible service reachable over the network or other vector of access such as spearphishing or drive-by compromise.'], 'x_mitre_remote_support': False, 'x_mitre_attack_spec_version': '2.1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "dcdbc940-0bff-46b2-95f3-2d73f848e33b",
                        "lookup_data": {
                            "description": "Detects suspicious print spool service (spoolsv.exe) child processes.",
                            "raw": "author: Justin C. (@endisphotic), @dreadphones (detection), Thomas Patzke (Sigma rule)\ndate: 2021/07/11\ndescription: Detects suspicious print spool service (spoolsv.exe) child processes.\ndetection:\n  condition: spoolsv and ( suspicious_unrestricted or (suspicious_net and not suspicious_net_filter)\n    or (suspicious_cmd and not suspicious_cmd_filter) or (suspicious_netsh and not\n    suspicious_netsh_filter) or (suspicious_powershell and not suspicious_powershell_filter)\n    or suspicious_rundll32 )\n  spoolsv:\n    IntegrityLevel: System\n    ParentImage|endswith: \\spoolsv.exe\n  suspicious_cmd:\n    Image|endswith: \\cmd.exe\n  suspicious_cmd_filter:\n    CommandLine|contains:\n    - .spl\n    - route add\n    - program files\n  suspicious_net:\n    Image|endswith:\n    - \\net.exe\n    - \\net1.exe\n  suspicious_net_filter:\n    CommandLine|contains: start\n  suspicious_netsh:\n    Image|endswith: \\netsh.exe\n  suspicious_netsh_filter:\n    CommandLine|contains:\n    - add portopening\n    - rule name\n  suspicious_powershell:\n    Image|endswith:\n    - \\powershell.exe\n    - \\pwsh.exe\n  suspicious_powershell_filter:\n    CommandLine|contains: .spl\n  suspicious_rundll32:\n    CommandLine|endswith: rundll32.exe\n    Image|endswith: \\rundll32.exe\n  suspicious_unrestricted:\n    Image|endswith:\n    - \\gpupdate.exe\n    - \\whoami.exe\n    - \\nltest.exe\n    - \\taskkill.exe\n    - \\wmic.exe\n    - \\taskmgr.exe\n    - \\sc.exe\n    - \\findstr.exe\n    - \\curl.exe\n    - \\wget.exe\n    - \\certutil.exe\n    - \\bitsadmin.exe\n    - \\accesschk.exe\n    - \\wevtutil.exe\n    - \\bcdedit.exe\n    - \\fsutil.exe\n    - \\cipher.exe\n    - \\schtasks.exe\n    - \\write.exe\n    - \\wuauclt.exe\n    - \\systeminfo.exe\n    - \\reg.exe\n    - \\query.exe\nfalsepositives:\n- Unknown\nfields:\n- Image\n- CommandLine\nid: dcdbc940-0bff-46b2-95f3-2d73f848e33b\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/21\nreferences:\n- https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/efa17a600b43c897b4b7463cc8541daa1987eeb4/Exploits/Print%20Spooler%20RCE/Suspicious%20Spoolsv%20Child%20Process.md\nstatus: test\ntags:\n- attack.execution\n- attack.t1203\n- attack.privilege_escalation\n- attack.t1068\ntitle: Suspicious Spool Service Child Process\n",
                            "sigma:id": "dcdbc940-0bff-46b2-95f3-2d73f848e33b",
                            "title": "Suspicious Spool Service Child Process",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "fdd84c68-a1f6-47c9-9477-920584f94905",
                        "lookup_data": {
                            "description": "Detects Winword starting uncommon sub process csc.exe as used in exploits for CVE-2017-8759",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/09/15\ndescription: Detects Winword starting uncommon sub process csc.exe as used in exploits\n  for CVE-2017-8759\ndetection:\n  condition: selection\n  selection:\n    Image|endswith: \\csc.exe\n    ParentImage|endswith: \\WINWORD.EXE\nfalsepositives:\n- Unknown\nid: fdd84c68-a1f6-47c9-9477-920584f94905\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://www.hybrid-analysis.com/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100\n- https://www.reverse.it/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100\nstatus: test\ntags:\n- attack.execution\n- attack.t1203\n- attack.t1204.002\n- attack.initial_access\n- attack.t1566.001\ntitle: Exploit for CVE-2017-8759\n",
                            "sigma:id": "fdd84c68-a1f6-47c9-9477-920584f94905",
                            "title": "Exploit for CVE-2017-8759",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": []
    },
    "timestamp": "2025-02-28 13:54:02"
}