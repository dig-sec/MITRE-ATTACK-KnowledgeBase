{
    "id": "T1036.003",
    "name": "Rename System Utilities",
    "description": "Adversaries may rename legitimate system utilities to try to evade security mechanisms concerning the usage of those utilities. Security monitoring and control mechanisms may be in place for system utilities adversaries are capable of abusing. (Citation: LOLBAS Main Site) It may be possible to bypass those security mechanisms by renaming the utility prior to utilization (ex: rename `rundll32.exe`). (Citation: Elastic Masquerade Ball) An alternative case occurs when a legitimate utility is copied or moved to a different directory and renamed to avoid detections based on system utilities executing from non-standard paths. (Citation: F-Secure CozyDuke)",
    "platforms": "Linux, macOS, Windows",
    "kill_chain_phases": "Defense Evasion",
    "data_sources": "File: File Modification, Process: Process Metadata, Command: Command Execution, File: File Metadata",
    "detection": "If file names are mismatched between the file name on disk and that of the binary's PE metadata, this is a likely indicator that a binary was renamed after it was compiled. Collecting and comparing disk and resource filenames for binaries by looking to see if the InternalName, OriginalFilename, and/or ProductName match what is expected could provide useful leads, but may not always be indicative of malicious activity. (Citation: Elastic Masquerade Ball) Do not focus on the possible names a file could have, but instead on the command-line arguments that are known to be used and are distinct because it will have a better rate of detection.(Citation: Twitter ItsReallyNick Masquerading Update)",
    "url": "https://attack.mitre.org/techniques/T1036/003",
    "enrichments": {
        "attack_rule_map": [
            {
                "tech_id": "T1036.003",
                "atomic_attack_guid": "24136435-c91a-4ede-9da1-8b284a1c1a23",
                "atomic_attack_name": "Masquerading - wscript.exe running as svchost.exe",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "LOL-Binary Copied From System Directory",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_copy_system_dir_lolbin.yml",
                        "remote_content": "title: LOL-Binary Copied From System Directory\nid: f5d19838-41b5-476c-98d8-ba8af4929ee2\nrelated:\n    - id: fff9d2b7-e11c-4a69-93d3-40ef66189767\n      type: derived\nstatus: test\ndescription: |\n    Detects a suspicious copy operation that tries to copy a known LOLBIN from system (System32, SysWOW64, WinSxS) directories to another on disk in order to bypass detections based on locations.\nreferences:\n    - https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120\n    - https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html\n    - https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-08-29\ntags:\n    - attack.defense-evasion\n    - attack.t1036.003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_tools_cmd:\n        Image|endswith: '\\cmd.exe'\n        CommandLine|contains: 'copy '\n    selection_tools_pwsh:\n        Image|endswith:\n            - '\\powershell.exe'\n            - '\\pwsh.exe'\n        CommandLine|contains:\n            - 'copy-item'\n            - ' copy '\n            - 'cpi '\n            - ' cp '\n    selection_tools_other:\n        - Image|endswith:\n              - '\\robocopy.exe'\n              - '\\xcopy.exe'\n        - OriginalFileName:\n              - 'robocopy.exe'\n              - 'XCOPY.EXE'\n    selection_target_path:\n        CommandLine|contains:\n            - '\\System32'\n            - '\\SysWOW64'\n            - '\\WinSxS'\n    selection_target_lolbin:\n        CommandLine|contains:\n            # Note: add more binaries to increase coverage\n            - '\\bitsadmin.exe'\n            - '\\calc.exe'\n            - '\\certutil.exe'\n            - '\\cmdl32.exe'\n            - '\\cscript.exe'\n            - '\\mshta.exe'\n            - '\\rundll32.exe'\n            - '\\wscript.exe'\n    condition: 1 of selection_tools_* and all of selection_target_*\nfalsepositives:\n    - Unknown\nlevel: high\n"
                    },
                    {
                        "rule_name": "Suspicious Copy From or To System Directory",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_copy_system_dir.yml",
                        "remote_content": "title: Suspicious Copy From or To System Directory\nid: fff9d2b7-e11c-4a69-93d3-40ef66189767\nrelated:\n    - id: 855bc8b5-2ae8-402e-a9ed-b889e6df1900\n      type: derived\nstatus: test\ndescription: |\n    Detects a suspicious copy operation that tries to copy a program from system (System32, SysWOW64, WinSxS) directories to another on disk.\n    Often used to move LOLBINs such as 'certutil' or 'desktopimgdownldr' to a different location with a different name in order to bypass detections based on locations.\nreferences:\n    - https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120\n    - https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html\n    - https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/\nauthor: Florian Roth (Nextron Systems), Markus Neis, Tim Shelton (HAWK.IO), Nasreddine Bencherchali (Nextron Systems)\ndate: 2020-07-03\nmodified: 2023-08-29\ntags:\n    - attack.defense-evasion\n    - attack.t1036.003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_cmd:\n        Image|endswith: '\\cmd.exe'\n        CommandLine|contains: 'copy '\n    selection_pwsh:\n        Image|endswith:\n            - '\\powershell.exe'\n            - '\\pwsh.exe'\n        CommandLine|contains:\n            - 'copy-item'\n            - ' copy '\n            - 'cpi '\n            - ' cp '\n    selection_other:\n        - Image|endswith:\n              - '\\robocopy.exe'\n              - '\\xcopy.exe'\n        - OriginalFileName:\n              - 'robocopy.exe'\n              - 'XCOPY.EXE'\n    target:\n        CommandLine|contains:\n            - '\\System32'\n            - '\\SysWOW64'\n            - '\\WinSxS'\n    condition: 1 of selection_* and target\nfalsepositives:\n    - Depend on scripts and administrative tools used in the monitored environment (For example an admin scripts like https://www.itexperience.net/sccm-batch-files-and-32-bits-processes-on-64-bits-os/)\n    - When cmd.exe and xcopy.exe are called directly #  C:\\Windows\\System32\\cmd.exe /c copy file1 file2\n    - When the command contains the keywords but not in the correct order\nlevel: medium\n"
                    }
                ],
                "splunk_rules": [
                    {
                        "rule_name": "CMD Carry Out String Command Parameter",
                        "rule_link": "https://research.splunk.com/endpoint/54a6ed00-3256-11ec-b031-acde48001122/"
                    }
                ]
            },
            {
                "tech_id": "T1036.003",
                "atomic_attack_guid": "83810c46-f45e-4485-9ab6-8ed0e9e6ed7f",
                "atomic_attack_name": "Malicious process Masquerading as LSM.exe",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Suspicious Copy From or To System Directory",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_copy_system_dir.yml",
                        "remote_content": "title: Suspicious Copy From or To System Directory\nid: fff9d2b7-e11c-4a69-93d3-40ef66189767\nrelated:\n    - id: 855bc8b5-2ae8-402e-a9ed-b889e6df1900\n      type: derived\nstatus: test\ndescription: |\n    Detects a suspicious copy operation that tries to copy a program from system (System32, SysWOW64, WinSxS) directories to another on disk.\n    Often used to move LOLBINs such as 'certutil' or 'desktopimgdownldr' to a different location with a different name in order to bypass detections based on locations.\nreferences:\n    - https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120\n    - https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html\n    - https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/\nauthor: Florian Roth (Nextron Systems), Markus Neis, Tim Shelton (HAWK.IO), Nasreddine Bencherchali (Nextron Systems)\ndate: 2020-07-03\nmodified: 2023-08-29\ntags:\n    - attack.defense-evasion\n    - attack.t1036.003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_cmd:\n        Image|endswith: '\\cmd.exe'\n        CommandLine|contains: 'copy '\n    selection_pwsh:\n        Image|endswith:\n            - '\\powershell.exe'\n            - '\\pwsh.exe'\n        CommandLine|contains:\n            - 'copy-item'\n            - ' copy '\n            - 'cpi '\n            - ' cp '\n    selection_other:\n        - Image|endswith:\n              - '\\robocopy.exe'\n              - '\\xcopy.exe'\n        - OriginalFileName:\n              - 'robocopy.exe'\n              - 'XCOPY.EXE'\n    target:\n        CommandLine|contains:\n            - '\\System32'\n            - '\\SysWOW64'\n            - '\\WinSxS'\n    condition: 1 of selection_* and target\nfalsepositives:\n    - Depend on scripts and administrative tools used in the monitored environment (For example an admin scripts like https://www.itexperience.net/sccm-batch-files-and-32-bits-processes-on-64-bits-os/)\n    - When cmd.exe and xcopy.exe are called directly #  C:\\Windows\\System32\\cmd.exe /c copy file1 file2\n    - When the command contains the keywords but not in the correct order\nlevel: medium\n"
                    }
                ]
            },
            {
                "tech_id": "T1036.003",
                "atomic_attack_guid": "ac9d0fc3-8aa8-4ab5-b11f-682cd63b40aa",
                "atomic_attack_name": "Masquerading - powershell.exe running as taskhostw.exe",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Suspicious Copy From or To System Directory",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_copy_system_dir.yml",
                        "remote_content": "title: Suspicious Copy From or To System Directory\nid: fff9d2b7-e11c-4a69-93d3-40ef66189767\nrelated:\n    - id: 855bc8b5-2ae8-402e-a9ed-b889e6df1900\n      type: derived\nstatus: test\ndescription: |\n    Detects a suspicious copy operation that tries to copy a program from system (System32, SysWOW64, WinSxS) directories to another on disk.\n    Often used to move LOLBINs such as 'certutil' or 'desktopimgdownldr' to a different location with a different name in order to bypass detections based on locations.\nreferences:\n    - https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120\n    - https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html\n    - https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/\nauthor: Florian Roth (Nextron Systems), Markus Neis, Tim Shelton (HAWK.IO), Nasreddine Bencherchali (Nextron Systems)\ndate: 2020-07-03\nmodified: 2023-08-29\ntags:\n    - attack.defense-evasion\n    - attack.t1036.003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_cmd:\n        Image|endswith: '\\cmd.exe'\n        CommandLine|contains: 'copy '\n    selection_pwsh:\n        Image|endswith:\n            - '\\powershell.exe'\n            - '\\pwsh.exe'\n        CommandLine|contains:\n            - 'copy-item'\n            - ' copy '\n            - 'cpi '\n            - ' cp '\n    selection_other:\n        - Image|endswith:\n              - '\\robocopy.exe'\n              - '\\xcopy.exe'\n        - OriginalFileName:\n              - 'robocopy.exe'\n              - 'XCOPY.EXE'\n    target:\n        CommandLine|contains:\n            - '\\System32'\n            - '\\SysWOW64'\n            - '\\WinSxS'\n    condition: 1 of selection_* and target\nfalsepositives:\n    - Depend on scripts and administrative tools used in the monitored environment (For example an admin scripts like https://www.itexperience.net/sccm-batch-files-and-32-bits-processes-on-64-bits-os/)\n    - When cmd.exe and xcopy.exe are called directly #  C:\\Windows\\System32\\cmd.exe /c copy file1 file2\n    - When the command contains the keywords but not in the correct order\nlevel: medium\n"
                    }
                ]
            },
            {
                "tech_id": "T1036.003",
                "atomic_attack_guid": "3a2a578b-0a01-46e4-92e3-62e2859b42f0",
                "atomic_attack_name": "Masquerading - cscript.exe running as notepad.exe",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "LOL-Binary Copied From System Directory",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_copy_system_dir_lolbin.yml",
                        "remote_content": "title: LOL-Binary Copied From System Directory\nid: f5d19838-41b5-476c-98d8-ba8af4929ee2\nrelated:\n    - id: fff9d2b7-e11c-4a69-93d3-40ef66189767\n      type: derived\nstatus: test\ndescription: |\n    Detects a suspicious copy operation that tries to copy a known LOLBIN from system (System32, SysWOW64, WinSxS) directories to another on disk in order to bypass detections based on locations.\nreferences:\n    - https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120\n    - https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html\n    - https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-08-29\ntags:\n    - attack.defense-evasion\n    - attack.t1036.003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_tools_cmd:\n        Image|endswith: '\\cmd.exe'\n        CommandLine|contains: 'copy '\n    selection_tools_pwsh:\n        Image|endswith:\n            - '\\powershell.exe'\n            - '\\pwsh.exe'\n        CommandLine|contains:\n            - 'copy-item'\n            - ' copy '\n            - 'cpi '\n            - ' cp '\n    selection_tools_other:\n        - Image|endswith:\n              - '\\robocopy.exe'\n              - '\\xcopy.exe'\n        - OriginalFileName:\n              - 'robocopy.exe'\n              - 'XCOPY.EXE'\n    selection_target_path:\n        CommandLine|contains:\n            - '\\System32'\n            - '\\SysWOW64'\n            - '\\WinSxS'\n    selection_target_lolbin:\n        CommandLine|contains:\n            # Note: add more binaries to increase coverage\n            - '\\bitsadmin.exe'\n            - '\\calc.exe'\n            - '\\certutil.exe'\n            - '\\cmdl32.exe'\n            - '\\cscript.exe'\n            - '\\mshta.exe'\n            - '\\rundll32.exe'\n            - '\\wscript.exe'\n    condition: 1 of selection_tools_* and all of selection_target_*\nfalsepositives:\n    - Unknown\nlevel: high\n"
                    },
                    {
                        "rule_name": "Suspicious Copy From or To System Directory",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_copy_system_dir.yml",
                        "remote_content": "title: Suspicious Copy From or To System Directory\nid: fff9d2b7-e11c-4a69-93d3-40ef66189767\nrelated:\n    - id: 855bc8b5-2ae8-402e-a9ed-b889e6df1900\n      type: derived\nstatus: test\ndescription: |\n    Detects a suspicious copy operation that tries to copy a program from system (System32, SysWOW64, WinSxS) directories to another on disk.\n    Often used to move LOLBINs such as 'certutil' or 'desktopimgdownldr' to a different location with a different name in order to bypass detections based on locations.\nreferences:\n    - https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120\n    - https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html\n    - https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/\nauthor: Florian Roth (Nextron Systems), Markus Neis, Tim Shelton (HAWK.IO), Nasreddine Bencherchali (Nextron Systems)\ndate: 2020-07-03\nmodified: 2023-08-29\ntags:\n    - attack.defense-evasion\n    - attack.t1036.003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_cmd:\n        Image|endswith: '\\cmd.exe'\n        CommandLine|contains: 'copy '\n    selection_pwsh:\n        Image|endswith:\n            - '\\powershell.exe'\n            - '\\pwsh.exe'\n        CommandLine|contains:\n            - 'copy-item'\n            - ' copy '\n            - 'cpi '\n            - ' cp '\n    selection_other:\n        - Image|endswith:\n              - '\\robocopy.exe'\n              - '\\xcopy.exe'\n        - OriginalFileName:\n              - 'robocopy.exe'\n              - 'XCOPY.EXE'\n    target:\n        CommandLine|contains:\n            - '\\System32'\n            - '\\SysWOW64'\n            - '\\WinSxS'\n    condition: 1 of selection_* and target\nfalsepositives:\n    - Depend on scripts and administrative tools used in the monitored environment (For example an admin scripts like https://www.itexperience.net/sccm-batch-files-and-32-bits-processes-on-64-bits-os/)\n    - When cmd.exe and xcopy.exe are called directly #  C:\\Windows\\System32\\cmd.exe /c copy file1 file2\n    - When the command contains the keywords but not in the correct order\nlevel: medium\n"
                    }
                ]
            },
            {
                "tech_id": "T1036.003",
                "atomic_attack_guid": "5ba5a3d1-cf3c-4499-968a-a93155d1f717",
                "atomic_attack_name": "Masquerading as Windows LSASS process",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Suspicious Copy From or To System Directory",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_copy_system_dir.yml",
                        "remote_content": "title: Suspicious Copy From or To System Directory\nid: fff9d2b7-e11c-4a69-93d3-40ef66189767\nrelated:\n    - id: 855bc8b5-2ae8-402e-a9ed-b889e6df1900\n      type: derived\nstatus: test\ndescription: |\n    Detects a suspicious copy operation that tries to copy a program from system (System32, SysWOW64, WinSxS) directories to another on disk.\n    Often used to move LOLBINs such as 'certutil' or 'desktopimgdownldr' to a different location with a different name in order to bypass detections based on locations.\nreferences:\n    - https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120\n    - https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html\n    - https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/\nauthor: Florian Roth (Nextron Systems), Markus Neis, Tim Shelton (HAWK.IO), Nasreddine Bencherchali (Nextron Systems)\ndate: 2020-07-03\nmodified: 2023-08-29\ntags:\n    - attack.defense-evasion\n    - attack.t1036.003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_cmd:\n        Image|endswith: '\\cmd.exe'\n        CommandLine|contains: 'copy '\n    selection_pwsh:\n        Image|endswith:\n            - '\\powershell.exe'\n            - '\\pwsh.exe'\n        CommandLine|contains:\n            - 'copy-item'\n            - ' copy '\n            - 'cpi '\n            - ' cp '\n    selection_other:\n        - Image|endswith:\n              - '\\robocopy.exe'\n              - '\\xcopy.exe'\n        - OriginalFileName:\n              - 'robocopy.exe'\n              - 'XCOPY.EXE'\n    target:\n        CommandLine|contains:\n            - '\\System32'\n            - '\\SysWOW64'\n            - '\\WinSxS'\n    condition: 1 of selection_* and target\nfalsepositives:\n    - Depend on scripts and administrative tools used in the monitored environment (For example an admin scripts like https://www.itexperience.net/sccm-batch-files-and-32-bits-processes-on-64-bits-os/)\n    - When cmd.exe and xcopy.exe are called directly #  C:\\Windows\\System32\\cmd.exe /c copy file1 file2\n    - When the command contains the keywords but not in the correct order\nlevel: medium\n"
                    }
                ]
            }
        ],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "a7a7e0e5-1d57-49df-9c58-9fe5bc0346a2",
                    "edd8a48c-1b9f-4ba1-83aa-490338cd1ccb",
                    "36480ae1-a1cb-4eaa-a0d6-29801d7e9142",
                    "bd1c6866-65fc-44b2-be51-5588fcff82b9",
                    "2ddef153-167b-4e89-86b6-757a9e65dcac",
                    "4eec988f-7bf0-49f1-8675-1e6a510b3a2a",
                    "99c840f2-2012-46fd-9141-c761987550ef",
                    "9d4548fa-bba0-4e88-bd66-5d5bf516cda0",
                    "6e30c82f-a9f8-4aab-b79c-7c12bce6f248",
                    "96036718-71cc-4027-a538-d1587e0006a7",
                    "0c92f2e6-f08f-4b73-9216-ecb0ca634689",
                    "18da1007-3f26-470f-875d-f77faf1cab31",
                    "0ba1da6d-b6ce-4366-828c-18826c9de23e",
                    "0718cd72-f316-4aa2-988f-838ea8533277",
                    "4a0b2c7e-7cb2-495d-8b63-5f268e7bfd67",
                    "fff9d2b7-e11c-4a69-93d3-40ef66189767",
                    "7b0666ad-3e38-4e3d-9bab-78b06de85f7b",
                    "d059842b-6b9d-4ed1-b5c3-5b89143c6ede",
                    "8518ed3d-f7c9-4601-a26c-f361a4256a0c",
                    "d178a2d7-129a-4ba4-8ee6-d6e1fecd5d20",
                    "5b80a791-ad9b-4b75-bcc1-ad4e1e89c200",
                    "bd5b58a4-a52d-4a29-bc0d-3f1d3968eb6b",
                    "5df8df26-fe0e-4858-94a7-6cf71d9519c9",
                    "8a4519e8-e64a-40b6-ae85-ba8ad2177559"
                ],
                "lookup_results": [
                    {
                        "uuid": "a7a7e0e5-1d57-49df-9c58-9fe5bc0346a2",
                        "lookup_data": {
                            "description": "Detects the execution of a renamed PsExec often used by attackers or malware",
                            "raw": "author: Florian Roth\ndate: 2019/05/21\ndescription: Detects the execution of a renamed PsExec often used by attackers or\n  malware\ndetection:\n  condition: selection and not filter\n  filter:\n    Image|endswith:\n    - \\PsExec.exe\n    - \\PsExec64.exe\n  selection:\n    Description: Execute processes remotely\n    Product: Sysinternals PsExec\nfalsepositives:\n- Software that illegaly integrates PsExec in a renamed form\n- Administrators that have renamed PsExec and no one knows why\nid: a7a7e0e5-1d57-49df-9c58-9fe5bc0346a2\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2020/09/06\nreferences:\n- https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-digital-threats/megacortex-ransomware-spotted-attacking-enterprise-networks\nstatus: experimental\ntags:\n- car.2013-05-009\n- attack.defense_evasion\n- attack.t1036\n- attack.t1036.003\ntitle: Renamed PsExec\n",
                            "sigma:id": "a7a7e0e5-1d57-49df-9c58-9fe5bc0346a2",
                            "title": "Renamed PsExec",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "edd8a48c-1b9f-4ba1-83aa-490338cd1ccb",
                        "lookup_data": {
                            "description": "Detects renamed jusched.exe used by cobalt group",
                            "raw": "author: Markus Neis, Swisscom\ndate: 2019/06/04\ndescription: Detects renamed jusched.exe used by cobalt group\ndetection:\n  condition: selection and not filter\n  filter:\n    Image|endswith: \\jusched.exe\n  selection:\n    Description:\n    - Java Update Scheduler\n    - Java(TM) Update Scheduler\nfalsepositives:\n- Unknown\nid: edd8a48c-1b9f-4ba1-83aa-490338cd1ccb\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/18\nreferences:\n- https://www.bitdefender.com/files/News/CaseStudies/study/262/Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf\nstatus: test\ntags:\n- attack.execution\n- attack.defense_evasion\n- attack.t1036.003\ntitle: Renamed jusched.exe\n",
                            "sigma:id": "edd8a48c-1b9f-4ba1-83aa-490338cd1ccb",
                            "title": "Renamed jusched.exe",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "36480ae1-a1cb-4eaa-a0d6-29801d7e9142",
                        "lookup_data": {
                            "description": "Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.",
                            "raw": "author: Matthew Green - @mgreen27, Ecco, James Pemberton / @4A616D6573, oscd.community\n  (improvements), Andreas Hunkeler (@Karneades)\ndate: 2019/06/15\ndescription: Detects the execution of a renamed binary often used by attackers or\n  malware leveraging new Sysmon OriginalFileName datapoint.\ndetection:\n  condition: selection and not filter\n  filter:\n    Image|endswith:\n    - \\cmd.exe\n    - \\conhost.exe\n    - \\7z.exe\n    - \\WinRAR.exe\n    - \\wevtutil.exe\n    - \\net.exe\n    - \\net1.exe\n    - \\netsh.exe\n    - \\InstallUtil.exe\n  selection:\n    OriginalFileName:\n    - Cmd.Exe\n    - CONHOST.EXE\n    - 7z.exe\n    - WinRAR.exe\n    - wevtutil.exe\n    - net.exe\n    - net1.exe\n    - netsh.exe\n    - InstallUtil.exe\nfalsepositives:\n- Custom applications use renamed binaries adding slight change to binary name. Typically\n  this is easy to spot and add to whitelist\n- PsExec installed via Windows Store doesn't contain original filename field (False\n  negative)\nid: 36480ae1-a1cb-4eaa-a0d6-29801d7e9142\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/18\nreferences:\n- https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html\n- https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html\nrelated:\n- id: 0ba1da6d-b6ce-4366-828c-18826c9de23e\n  type: similar\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1036.003\ntitle: Potential Defense Evasion Via Binary Rename\n",
                            "sigma:id": "36480ae1-a1cb-4eaa-a0d6-29801d7e9142",
                            "title": "Potential Defense Evasion Via Binary Rename",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "bd1c6866-65fc-44b2-be51-5588fcff82b9",
                        "lookup_data": {
                            "description": "Detects process creation with a renamed Msdt.exe",
                            "raw": "author: pH-T (Nextron Systems)\ndate: 2022/06/03\ndescription: Detects process creation with a renamed Msdt.exe\ndetection:\n  condition: selection and not 1 of filter*\n  filter_realmsdt:\n    Image|endswith: \\msdt.exe\n  selection:\n    OriginalFileName: msdt.exe\nfalsepositives:\n- Unlikely\nid: bd1c6866-65fc-44b2-be51-5588fcff82b9\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/Msdt/\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1036.003\ntitle: Renamed Msdt.exe\n",
                            "sigma:id": "bd1c6866-65fc-44b2-be51-5588fcff82b9",
                            "title": "Renamed Msdt.exe",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "2ddef153-167b-4e89-86b6-757a9e65dcac",
                        "lookup_data": {
                            "description": "Detects usage of bitsadmin downloading a file to a suspicious target folder",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/06/28\ndescription: Detects usage of bitsadmin downloading a file to a suspicious target\n  folder\ndetection:\n  condition: all of selection_*\n  selection_flags:\n    CommandLine|contains:\n    - ' /transfer '\n    - ' /create '\n    - ' /addfile '\n  selection_folder:\n    CommandLine|contains:\n    - C:\\Users\\Public\\\n    - '%public%'\n    - \\Desktop\\\n    - C:\\Temp\n    - C:\\Perflogs\n    - C:\\Windows\\\n  selection_img:\n  - Image|endswith: \\bitsadmin.exe\n  - OriginalFileName: bitsadmin.exe\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\n- ParentCommandLine\nid: 2ddef153-167b-4e89-86b6-757a9e65dcac\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/31\nreferences:\n- https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin\n- https://isc.sans.edu/diary/22264\n- https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/\n- https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.persistence\n- attack.t1197\n- attack.s0190\n- attack.t1036.003\ntitle: Bitsadmin Download to Suspicious Target Folder\n",
                            "sigma:id": "2ddef153-167b-4e89-86b6-757a9e65dcac",
                            "title": "Bitsadmin Download to Suspicious Target Folder",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4eec988f-7bf0-49f1-8675-1e6a510b3a2a",
                        "lookup_data": {
                            "description": "Detect changes to the \"PendingFileRenameOperations\" registry key from uncommon or suspicious images lcoations to stage currently used files for rename after reboot.",
                            "raw": "author: frack113\ndate: 2023/01/27\ndescription: Detect changes to the \"PendingFileRenameOperations\" registry key from\n  uncommon or suspicious images lcoations to stage currently used files for rename\n  after reboot.\ndetection:\n  condition: selection_main and 1 of selection_susp_*\n  selection_main:\n    EventType: SetValue\n    TargetObject|contains: \\CurrentControlSet\\Control\\Session Manager\\PendingFileRenameOperations\n  selection_susp_images:\n    Image|endswith:\n    - \\reg.exe\n    - \\regedit.exe\n  selection_susp_paths:\n    Image|contains:\n    - \\AppData\\Local\\Temp\\\n    - \\Users\\Public\\\nfalsepositives:\n- Installers and updaters may set currently in use files for rename after a reboot.\nid: 4eec988f-7bf0-49f1-8675-1e6a510b3a2a\nlevel: medium\nlogsource:\n  category: registry_set\n  product: windows\nreferences:\n- https://any.run/report/3ecd4763ffc944fdc67a9027e459cd4f448b1a8d1b36147977afaf86bbf2a261/64b0ba45-e7ce-423b-9a1d-5b4ea59521e6\n- https://devblogs.microsoft.com/scripting/determine-pending-reboot-statuspowershell-style-part-1/\n- https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc960241(v=technet.10)?redirectedfrom=MSDN\n- https://www.trendmicro.com/en_us/research/21/j/purplefox-adds-new-backdoor-that-uses-websockets.html\n- https://www.trendmicro.com/en_us/research/19/i/purple-fox-fileless-malware-with-rookit-component-delivered-by-rig-exploit-kit-now-abuses-powershell.html\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1036.003\ntitle: Potential PendingFileRenameOperations Tamper\n",
                            "sigma:id": "4eec988f-7bf0-49f1-8675-1e6a510b3a2a",
                            "title": "Potential PendingFileRenameOperations Tamper",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "99c840f2-2012-46fd-9141-c761987550ef",
                        "lookup_data": {
                            "description": "Detects usage of bitsadmin downloading a file using an URL that contains an IP",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/06/28\ndescription: Detects usage of bitsadmin downloading a file using an URL that contains\n  an IP\ndetection:\n  condition: all of selection_* and not filter\n  filter:\n    CommandLine|contains:\n    - https://7-\n    - http://7-\n  selection_extension:\n    CommandLine|contains:\n    - http://1\n    - http://2\n    - http://3\n    - http://4\n    - http://5\n    - http://6\n    - http://7\n    - http://8\n    - http://9\n    - https://1\n    - https://2\n    - https://3\n    - https://4\n    - https://5\n    - https://6\n    - https://7\n    - https://8\n    - https://9\n  selection_flags:\n    CommandLine|contains:\n    - ' /transfer '\n    - ' /create '\n    - ' /addfile '\n  selection_img:\n  - Image|endswith: \\bitsadmin.exe\n  - OriginalFileName: bitsadmin.exe\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\n- ParentCommandLine\nid: 99c840f2-2012-46fd-9141-c761987550ef\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/13\nreferences:\n- https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin\n- https://isc.sans.edu/diary/22264\n- https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/\n- https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/\nrelated:\n- id: 90f138c1-f578-4ac3-8c49-eecfd847c8b7\n  type: similar\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.persistence\n- attack.t1197\n- attack.s0190\n- attack.t1036.003\ntitle: Bitsadmin Download File from IP\n",
                            "sigma:id": "99c840f2-2012-46fd-9141-c761987550ef",
                            "title": "Bitsadmin Download File from IP",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "9d4548fa-bba0-4e88-bd66-5d5bf516cda0",
                        "lookup_data": {
                            "description": "Masquerading occurs when the name or location of an executable, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation.\nSeveral different variations of this technique have been observed.\n",
                            "raw": "author: Timur Zinniatullin, oscd.community\ndate: 2019/10/21\ndescription: 'Masquerading occurs when the name or location of an executable, legitimate\n  or malicious, is manipulated or abused for the sake of evading defenses and observation.\n\n  Several different variations of this technique have been observed.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    a0: cp\n    a1: -i\n    a2: /bin/sh\n    a3|endswith: /crond\n    type: execve\nid: 9d4548fa-bba0-4e88-bd66-5d5bf516cda0\nlevel: medium\nlogsource:\n  product: linux\n  service: auditd\nmodified: 2021/11/27\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/8a82e9b66a5b4f4bc5b91089e9f24e0544f20ad7/atomics/T1036.003/T1036.003.md#atomic-test-2---masquerading-as-linux-crond-process\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1036.003\ntitle: Masquerading as Linux Crond Process\n",
                            "sigma:id": "9d4548fa-bba0-4e88-bd66-5d5bf516cda0",
                            "title": "Masquerading as Linux Crond Process",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "6e30c82f-a9f8-4aab-b79c-7c12bce6f248",
                        "lookup_data": {
                            "description": "Detects usage of bitsadmin downloading a file to uncommon target folder",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/06/28\ndescription: Detects usage of bitsadmin downloading a file to uncommon target folder\ndetection:\n  condition: all of selection_*\n  selection_flags:\n    CommandLine|contains:\n    - ' /transfer '\n    - ' /create '\n    - ' /addfile '\n  selection_folder:\n    CommandLine|contains:\n    - C:\\Windows\\Temp\\\n    - '%temp%'\n    - '%tmp%'\n    - C:\\ProgramData\\\n    - '%ProgramData%'\n    - \\AppData\\Local\\\n    - '%AppData%'\n  selection_img:\n  - Image|endswith: \\bitsadmin.exe\n  - OriginalFileName: bitsadmin.exe\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\n- ParentCommandLine\nid: 6e30c82f-a9f8-4aab-b79c-7c12bce6f248\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/11/11\nreferences:\n- https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin\n- https://isc.sans.edu/diary/22264\n- https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/\n- https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.persistence\n- attack.t1197\n- attack.s0190\n- attack.t1036.003\ntitle: Bitsadmin Download to Uncommon Target Folder\n",
                            "sigma:id": "6e30c82f-a9f8-4aab-b79c-7c12bce6f248",
                            "title": "Bitsadmin Download to Uncommon Target Folder",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "96036718-71cc-4027-a538-d1587e0006a7",
                        "lookup_data": {
                            "description": "Detect suspicious parent processes of well-known Windows processes",
                            "raw": "author: vburov\ndate: 2019/02/23\ndescription: Detect suspicious parent processes of well-known Windows processes\ndetection:\n  condition: selection and not 1 of filter_*\n  filter_msmpeng:\n    ParentImage|contains:\n    - \\Windows Defender\\\n    - \\Microsoft Security Client\\\n    ParentImage|endswith: \\MsMpEng.exe\n  filter_null:\n  - ParentImage: null\n  - ParentImage: '-'\n  filter_sys:\n  - ParentImage|endswith:\n    - \\SavService.exe\n    - \\ngen.exe\n  - ParentImage|contains:\n    - \\System32\\\n    - \\SysWOW64\\\n  selection:\n    Image|endswith:\n    - \\svchost.exe\n    - \\taskhost.exe\n    - \\lsm.exe\n    - \\lsass.exe\n    - \\services.exe\n    - \\lsaiso.exe\n    - \\csrss.exe\n    - \\wininit.exe\n    - \\winlogon.exe\nfalsepositives:\n- Some security products seem to spawn these\nid: 96036718-71cc-4027-a538-d1587e0006a7\nlevel: low\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/02/14\nreferences:\n- https://securitybytes.io/blue-team-fundamentals-part-two-windows-processes-759fe15965e2\n- https://www.carbonblack.com/2014/06/10/screenshot-demo-hunt-evil-faster-than-ever-with-carbon-black/\n- https://www.13cubed.com/downloads/windows_process_genealogy_v2.pdf\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1036.003\n- attack.t1036.005\ntitle: Windows Processes Suspicious Parent Directory\n",
                            "sigma:id": "96036718-71cc-4027-a538-d1587e0006a7",
                            "title": "Windows Processes Suspicious Parent Directory",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "0c92f2e6-f08f-4b73-9216-ecb0ca634689",
                        "lookup_data": {
                            "description": "Detects the use of rcedit to potentially alter executable PE metadata properties, which could conceal efforts to rename system utilities for defense evasion.",
                            "raw": "author: Micah Babinski\ndate: 2022/12/11\ndescription: Detects the use of rcedit to potentially alter executable PE metadata\n  properties, which could conceal efforts to rename system utilities for defense evasion.\ndetection:\n  condition: all of selection_*\n  selection_attributes:\n    CommandLine|contains:\n    - OriginalFileName\n    - CompanyName\n    - FileDescription\n    - ProductName\n    - ProductVersion\n    - LegalCopyright\n  selection_flags:\n    CommandLine|contains: --set-\n  selection_img:\n  - Image|endswith:\n    - \\rcedit-x64.exe\n    - \\rcedit-x86.exe\n  - Description: Edit resources of exe\n  - Product: rcedit\nfalsepositives:\n- Legitimate use of the tool by administrators or users to update metadata of a binary\nid: 0c92f2e6-f08f-4b73-9216-ecb0ca634689\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://security.stackexchange.com/questions/210843/is-it-possible-to-change-original-filename-of-an-exe\n- https://www.virustotal.com/gui/file/02e8e8c5d430d8b768980f517b62d7792d690982b9ba0f7e04163cbc1a6e7915\n- https://github.com/electron/rcedit\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1036.003\n- attack.t1036\n- attack.t1027.005\n- attack.t1027\ntitle: Potential PE Metadata Tamper Using Rcedit\n",
                            "sigma:id": "0c92f2e6-f08f-4b73-9216-ecb0ca634689",
                            "title": "Potential PE Metadata Tamper Using Rcedit",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "18da1007-3f26-470f-875d-f77faf1cab31",
                        "lookup_data": {
                            "description": "Detects renamed SysInternals tool execution with a binary named ps.exe as used by Dragonfly APT group and documented in TA17-293A report",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/10/22\ndescription: Detects renamed SysInternals tool execution with a binary named ps.exe\n  as used by Dragonfly APT group and documented in TA17-293A report\ndetection:\n  condition: selection\n  selection:\n    CommandLine: ps.exe -accepteula\nfalsepositives:\n- Renamed SysInternals tool\nid: 18da1007-3f26-470f-875d-f77faf1cab31\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://www.us-cert.gov/ncas/alerts/TA17-293A\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.g0035\n- attack.t1036.003\n- car.2013-05-009\ntitle: Ps.exe Renamed SysInternals Tool\n",
                            "sigma:id": "18da1007-3f26-470f-875d-f77faf1cab31",
                            "title": "Ps.exe Renamed SysInternals Tool",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "0ba1da6d-b6ce-4366-828c-18826c9de23e",
                        "lookup_data": {
                            "description": "Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.",
                            "raw": "author: Matthew Green - @mgreen27, Florian Roth (Nextron Systems), frack113\ndate: 2019/06/15\ndescription: Detects the execution of a renamed binary often used by attackers or\n  malware leveraging new Sysmon OriginalFileName datapoint.\ndetection:\n  condition: selection and not filter\n  filter:\n    Image|endswith:\n    - \\powershell.exe\n    - \\pwsh.exe\n    - \\powershell_ise.exe\n    - \\psexec.exe\n    - \\psexec64.exe\n    - \\PSEXESVC.exe\n    - \\cscript.exe\n    - \\wscript.exe\n    - \\mshta.exe\n    - \\regsvr32.exe\n    - \\wmic.exe\n    - \\certutil.exe\n    - \\rundll32.exe\n    - \\cmstp.exe\n    - \\msiexec.exe\n  selection:\n  - Description: Execute processes remotely\n  - Product: Sysinternals PsExec\n  - Description|startswith:\n    - Windows PowerShell\n    - pwsh\n  - OriginalFileName:\n    - powershell.exe\n    - pwsh.dll\n    - powershell_ise.exe\n    - psexec.exe\n    - psexec.c\n    - psexesvc.exe\n    - cscript.exe\n    - wscript.exe\n    - mshta.exe\n    - regsvr32.exe\n    - wmic.exe\n    - certutil.exe\n    - rundll32.exe\n    - cmstp.exe\n    - msiexec.exe\nfalsepositives:\n- Custom applications use renamed binaries adding slight change to binary name. Typically\n  this is easy to spot and add to whitelist\nid: 0ba1da6d-b6ce-4366-828c-18826c9de23e\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/23\nreferences:\n- https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html\n- https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html\n- https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-digital-threats/megacortex-ransomware-spotted-attacking-enterprise-networks\n- https://twitter.com/christophetd/status/1164506034720952320\n- https://threatresearch.ext.hp.com/svcready-a-new-loader-reveals-itself/\nrelated:\n- id: 36480ae1-a1cb-4eaa-a0d6-29801d7e9142\n  type: similar\n- id: 2569ed8c-1147-498a-9b8c-2ad3656b10ed\n  type: derived\n- id: a7a7e0e5-1d57-49df-9c58-9fe5bc0346a2\n  type: obsoletes\n- id: d178a2d7-129a-4ba4-8ee6-d6e1fecd5d20\n  type: obsoletes\n- id: d4d2574f-ac17-4d9e-b986-aeeae0dc8fe2\n  type: obsoletes\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1036.003\n- car.2013-05-009\ntitle: Potential Defense Evasion Via Rename Of Highly Relevant Binaries\n",
                            "sigma:id": "0ba1da6d-b6ce-4366-828c-18826c9de23e",
                            "title": "Potential Defense Evasion Via Rename Of Highly Relevant Binaries",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "0718cd72-f316-4aa2-988f-838ea8533277",
                        "lookup_data": {
                            "description": "Powershell use PassThru option to start in background",
                            "raw": "author: frack113\ndate: 2022/01/15\ndescription: Powershell use PassThru option to start in background\ndetection:\n  condition: selection\n  selection:\n    ScriptBlockText|contains|all:\n    - Start-Process\n    - '-PassThru '\n    - '-FilePath '\nfalsepositives:\n- Legitimate PowerShell scripts\nid: 0718cd72-f316-4aa2-988f-838ea8533277\nlevel: medium\nlogsource:\n  category: ps_script\n  definition: 'Requirements: Script Block Logging must be enabled'\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1036.003/T1036.003.md\n- https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/Start-Process?view=powershell-5.1&viewFallbackFrom=powershell-7\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1036.003\ntitle: Suspicious Start-Process PassThru\n",
                            "sigma:id": "0718cd72-f316-4aa2-988f-838ea8533277",
                            "title": "Suspicious Start-Process PassThru",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4a0b2c7e-7cb2-495d-8b63-5f268e7bfd67",
                        "lookup_data": {
                            "description": "Detects the execution of a renamed ProcDump executable often used by attackers or malware",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2019/11/18\ndescription: Detects the execution of a renamed ProcDump executable often used by\n  attackers or malware\ndetection:\n  condition: (selection_org or all of selection_args_*) and not filter\n  filter:\n    Image|endswith:\n    - \\procdump.exe\n    - \\procdump64.exe\n  selection_args_ma:\n    CommandLine|contains:\n    - ' -ma '\n    - ' /ma '\n  selection_args_other:\n    CommandLine|contains:\n    - ' -accepteula '\n    - ' /accepteula '\n  selection_org:\n    OriginalFileName: procdump\nfalsepositives:\n- Procdump illegaly bundled with legitimate software\n- Administrators who rename binaries (should be investigated)\nid: 4a0b2c7e-7cb2-495d-8b63-5f268e7bfd67\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/08\nreferences:\n- https://docs.microsoft.com/en-us/sysinternals/downloads/procdump\nrelated:\n- id: 03795938-1387-481b-9f4c-3f6241e604fe\n  type: obsoletes\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1036.003\ntitle: Renamed ProcDump Execution\n",
                            "sigma:id": "4a0b2c7e-7cb2-495d-8b63-5f268e7bfd67",
                            "title": "Renamed ProcDump Execution",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "fff9d2b7-e11c-4a69-93d3-40ef66189767",
                        "lookup_data": {
                            "description": "Detects a suspicious copy operation that tries to copy a program from a system (System32 or SysWOW64) directory to another on disk.\nOften used to move LOLBINs such as 'certutil' or 'desktopimgdownldr' to a different location with a different name in order to bypass detections based on locations\n",
                            "raw": "author: Florian Roth (Nextron Systems), Markus Neis, Tim Shelton (HAWK.IO), Nasreddine\n  Bencherchali (Nextron Systems)\ndate: 2020/07/03\ndescription: 'Detects a suspicious copy operation that tries to copy a program from\n  a system (System32 or SysWOW64) directory to another on disk.\n\n  Often used to move LOLBINs such as ''certutil'' or ''desktopimgdownldr'' to a different\n  location with a different name in order to bypass detections based on locations\n\n  '\ndetection:\n  condition: 1 of selection* and target\n  selection_cmd:\n    CommandLine|contains: 'copy '\n    Image|endswith: \\cmd.exe\n  selection_other:\n  - Image|endswith:\n    - \\robocopy.exe\n    - \\xcopy.exe\n  - OriginalFileName:\n    - robocopy.exe\n    - XCOPY.EXE\n  selection_pwsh:\n    CommandLine|contains:\n    - copy-item\n    - ' copy '\n    - 'cpi '\n    - ' cp '\n    Image|endswith:\n    - \\powershell.exe\n    - \\pwsh.exe\n  target:\n    CommandLine|contains:\n    - \\System32\n    - \\SysWOW64\nfalsepositives:\n- Depend on scripts and administrative tools used in the monitored environment (For\n  example an admin scripts like https://www.itexperience.net/sccm-batch-files-and-32-bits-processes-on-64-bits-os/)\n- When cmd.exe and xcopy.exe are called directly\n- When the command contains the keywords but not in the correct order\nfields:\n- CommandLine\n- ParentCommandLine\nid: fff9d2b7-e11c-4a69-93d3-40ef66189767\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/31\nreferences:\n- https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120\n- https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html\nrelated:\n- id: 855bc8b5-2ae8-402e-a9ed-b889e6df1900\n  type: derived\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1036.003\ntitle: Suspicious Copy From or To System32\n",
                            "sigma:id": "fff9d2b7-e11c-4a69-93d3-40ef66189767",
                            "title": "Suspicious Copy From or To System32",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "7b0666ad-3e38-4e3d-9bab-78b06de85f7b",
                        "lookup_data": {
                            "description": "Detects execution of renamed paexec via imphash and executable product string",
                            "raw": "author: Jason Lynch\ndate: 2019/04/17\ndescription: Detects execution of renamed paexec via imphash and executable product\n  string\ndetection:\n  condition: all of selection* and not filter1\n  filter1:\n    Image|contains: paexec\n  selection1:\n    Product|contains: PAExec\n  selection2:\n  - Imphash:\n    - 11D40A7B7876288F919AB819CC2D9802\n    - 6444f8a34e99b8f7d9647de66aabe516\n    - dfd6aa3f7b2b1035b76b718f1ddc689f\n    - 1a6cca4d5460b1710a12dea39e4a592c\n  - Hashes|contains:\n    - IMPHASH=11D40A7B7876288F919AB819CC2D9802\n    - IMPHASH=6444f8a34e99b8f7d9647de66aabe516\n    - IMPHASH=dfd6aa3f7b2b1035b76b718f1ddc689f\n    - IMPHASH=1a6cca4d5460b1710a12dea39e4a592c\nfalsepositives:\n- Unknown imphashes\nid: 7b0666ad-3e38-4e3d-9bab-78b06de85f7b\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/03/04\nreferences:\n- sha256=01a461ad68d11b5b5096f45eb54df9ba62c5af413fa9eb544eacb598373a26bc\n- https://summit.fireeye.com/content/dam/fireeye-www/summit/cds-2018/presentations/cds18-technical-s05-att&cking-fin7.pdf\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1036.003\n- attack.g0046\n- car.2013-05-009\n- attack.execution\n- attack.t1569.002\ntitle: Execution of Renamed PaExec\n",
                            "sigma:id": "7b0666ad-3e38-4e3d-9bab-78b06de85f7b",
                            "title": "Execution of Renamed PaExec",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d059842b-6b9d-4ed1-b5c3-5b89143c6ede",
                        "lookup_data": {
                            "description": "Detects usage of bitsadmin downloading a file",
                            "raw": "author: Michael Haag, FPT.EagleEye\ndate: 2017/03/09\ndescription: Detects usage of bitsadmin downloading a file\ndetection:\n  condition: (selection1 and susp_flag_2 and http_flag) or (selection1 and susp_flag_1)\n    or selection2\n  http_flag:\n    CommandLine|contains: http\n  selection1:\n  - Image|endswith: \\bitsadmin.exe\n  - OriginalFileName: bitsadmin.exe\n  selection2:\n    CommandLine|contains: copy bitsadmin.exe\n  susp_flag_1:\n    CommandLine|contains: ' /transfer '\n  susp_flag_2:\n    CommandLine|contains:\n    - ' /create '\n    - ' /addfile '\nfalsepositives:\n- Some legitimate apps use this, but limited.\nfields:\n- CommandLine\n- ParentCommandLine\nid: d059842b-6b9d-4ed1-b5c3-5b89143c6ede\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/11/11\nreferences:\n- https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin\n- https://isc.sans.edu/diary/22264\n- https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.persistence\n- attack.t1197\n- attack.s0190\n- attack.t1036.003\ntitle: Bitsadmin Download\n",
                            "sigma:id": "d059842b-6b9d-4ed1-b5c3-5b89143c6ede",
                            "title": "Bitsadmin Download",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "8518ed3d-f7c9-4601-a26c-f361a4256a0c",
                        "lookup_data": {
                            "description": "Detects usage of bitsadmin downloading a file from a suspicious domain",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/06/28\ndescription: Detects usage of bitsadmin downloading a file from a suspicious domain\ndetection:\n  condition: all of selection_*\n  selection_domain:\n    CommandLine|contains:\n    - raw.githubusercontent.com\n    - gist.githubusercontent.com\n    - pastebin.com\n    - cdn.discordapp.com/attachments/\n    - mediafire.com\n    - mega.nz\n    - ddns.net\n    - .paste.ee\n    - .hastebin.com\n    - .ghostbin.co/\n    - ufile.io\n    - storage.googleapis.com\n    - anonfiles.com\n    - send.exploit.in\n    - transfer.sh\n    - privatlab.net\n    - privatlab.com\n    - sendspace.com\n    - pastetext.net\n    - pastebin.pl\n    - paste.ee\n  selection_flags:\n    CommandLine|contains:\n    - ' /transfer '\n    - ' /create '\n    - ' /addfile '\n  selection_img:\n  - Image|endswith: \\bitsadmin.exe\n  - OriginalFileName: bitsadmin.exe\nfalsepositives:\n- Some legitimate apps use this, but limited.\nfields:\n- CommandLine\n- ParentCommandLine\nid: 8518ed3d-f7c9-4601-a26c-f361a4256a0c\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/19\nreferences:\n- https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin\n- https://isc.sans.edu/diary/22264\n- https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/\n- https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker\n- https://www.cisa.gov/uscert/ncas/alerts/aa22-321a\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.persistence\n- attack.t1197\n- attack.s0190\n- attack.t1036.003\ntitle: Bitsadmin Download from Suspicious Domain\n",
                            "sigma:id": "8518ed3d-f7c9-4601-a26c-f361a4256a0c",
                            "title": "Bitsadmin Download from Suspicious Domain",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d178a2d7-129a-4ba4-8ee6-d6e1fecd5d20",
                        "lookup_data": {
                            "description": "Detects the execution of a renamed PowerShell often used by attackers or malware",
                            "raw": "author: Florian Roth\ndate: 2019/08/22\ndescription: Detects the execution of a renamed PowerShell often used by attackers\n  or malware\ndetection:\n  condition: selection and not filter\n  filter:\n    Image|endswith:\n    - \\powershell.exe\n    - \\powershell_ise.exe\n  selection:\n    Company: Microsoft Corporation\n    Description: Windows PowerShell\nfalsepositives:\n- Unknown\nid: d178a2d7-129a-4ba4-8ee6-d6e1fecd5d20\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2020/09/06\nreferences:\n- https://twitter.com/christophetd/status/1164506034720952320\nstatus: experimental\ntags:\n- car.2013-05-009\n- attack.defense_evasion\n- attack.t1036\n- attack.t1036.003\ntitle: Renamed PowerShell\n",
                            "sigma:id": "d178a2d7-129a-4ba4-8ee6-d6e1fecd5d20",
                            "title": "Renamed PowerShell",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5b80a791-ad9b-4b75-bcc1-ad4e1e89c200",
                        "lookup_data": {
                            "description": "Detects usage of bitsadmin downloading a file with a suspicious extension",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/06/28\ndescription: Detects usage of bitsadmin downloading a file with a suspicious extension\ndetection:\n  condition: all of selection_*\n  selection_extension:\n    CommandLine|contains:\n    - .asax\n    - .ashx\n    - .asmx\n    - .asp\n    - .aspx\n    - .bat\n    - .cfm\n    - .cgi\n    - .chm\n    - .cmd\n    - .gif\n    - .jpeg\n    - .jpg\n    - .jsp\n    - .jspx\n    - .png\n    - .ps1\n    - .psm1\n    - .scf\n    - .sct\n    - .txt\n    - .vbe\n    - .vbs\n    - .war\n    - .wsf\n    - .wsh\n    - .zip\n    - .rar\n    - .dll\n  selection_flags:\n    CommandLine|contains:\n    - ' /transfer '\n    - ' /create '\n    - ' /addfile '\n  selection_img:\n  - Image|endswith: \\bitsadmin.exe\n  - OriginalFileName: bitsadmin.exe\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\n- ParentCommandLine\nid: 5b80a791-ad9b-4b75-bcc1-ad4e1e89c200\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/11/11\nreferences:\n- https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin\n- https://isc.sans.edu/diary/22264\n- https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.persistence\n- attack.t1197\n- attack.s0190\n- attack.t1036.003\ntitle: Bitsadmin Download File with Suspicious Extension\n",
                            "sigma:id": "5b80a791-ad9b-4b75-bcc1-ad4e1e89c200",
                            "title": "Bitsadmin Download File with Suspicious Extension",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "bd5b58a4-a52d-4a29-bc0d-3f1d3968eb6b",
                        "lookup_data": {
                            "mitre-attack-id": "T1036.003",
                            "mitre-cti:description": "Adversaries may rename legitimate system utilities to try to evade security mechanisms concerning the usage of those utilities. Security monitoring and control mechanisms may be in place for system utilities adversaries are capable of abusing. (Citation: LOLBAS Main Site) It may be possible to bypass those security mechanisms by renaming the utility prior to utilization (ex: rename <code>rundll32.exe</code>). (Citation: Elastic Masquerade Ball) An alternative case occurs when a legitimate utility is copied or moved to a different directory and renamed to avoid detections based on system utilities executing from non-standard paths. (Citation: F-Secure CozyDuke)",
                            "mitre-cti:name": "Rename System Utilities",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'x_mitre_platforms': ['Linux', 'macOS', 'Windows'], 'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'attack-pattern--bd5b58a4-a52d-4a29-bc0d-3f1d3968eb6b', 'type': 'attack-pattern', 'created': '2020-02-10T20:03:11.691Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'source_name': 'mitre-attack', 'external_id': 'T1036.003', 'url': 'https://attack.mitre.org/techniques/T1036/003'}, {'source_name': 'LOLBAS Main Site', 'url': 'https://lolbas-project.github.io/', 'description': 'LOLBAS. (n.d.). Living Off The Land Binaries and Scripts (and also Libraries). Retrieved February 10, 2020.'}, {'source_name': 'Elastic Masquerade Ball', 'description': 'Ewing, P. (2016, October 31). How to Hunt: The Masquerade Ball. Retrieved October 31, 2016.', 'url': 'http://pages.endgame.com/rs/627-YBU-612/images/EndgameJournal_The%20Masquerade%20Ball_Pages_R2.pdf'}, {'source_name': 'F-Secure CozyDuke', 'description': 'F-Secure Labs. (2015, April 22). CozyDuke: Malware Analysis. Retrieved December 10, 2015.', 'url': 'https://www.f-secure.com/documents/996508/1030745/CozyDuke'}, {'source_name': 'Twitter ItsReallyNick Masquerading Update', 'url': 'https://twitter.com/ItsReallyNick/status/1055321652777619457', 'description': 'Carr, N.. (2018, October 25). Nick Carr Status Update Masquerading. Retrieved April 22, 2019.'}], 'modified': '2020-11-23T17:03:38.941Z', 'name': 'Rename System Utilities', 'description': 'Adversaries may rename legitimate system utilities to try to evade security mechanisms concerning the usage of those utilities. Security monitoring and control mechanisms may be in place for system utilities adversaries are capable of abusing. (Citation: LOLBAS Main Site) It may be possible to bypass those security mechanisms by renaming the utility prior to utilization (ex: rename <code>rundll32.exe</code>). (Citation: Elastic Masquerade Ball) An alternative case occurs when a legitimate utility is copied or moved to a different directory and renamed to avoid detections based on system utilities executing from non-standard paths. (Citation: F-Secure CozyDuke)', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'defense-evasion'}], 'x_mitre_detection': \"If file names are mismatched between the file name on disk and that of the binary's PE metadata, this is a likely indicator that a binary was renamed after it was compiled. Collecting and comparing disk and resource filenames for binaries by looking to see if the InternalName, OriginalFilename, and/or ProductName match what is expected could provide useful leads, but may not always be indicative of malicious activity. (Citation: Elastic Masquerade Ball) Do not focus on the possible names a file could have, but instead on the command-line arguments that are known to be used and are distinct because it will have a better rate of detection.(Citation: Twitter ItsReallyNick Masquerading Update)\", 'x_mitre_is_subtechnique': True, 'x_mitre_version': '1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'x_mitre_data_sources': ['Process: Process Metadata', 'File: File Modification', 'Command: Command Execution', 'File: File Metadata']}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5df8df26-fe0e-4858-94a7-6cf71d9519c9",
                        "lookup_data": {
                            "description": "UEFI threats moving to the ESP: Introducing ESPecter bootkit",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5df8df26-fe0e-4858-94a7-6cf71d9519c9.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1637336858",
                            "uuid": "5df8df26-fe0e-4858-94a7-6cf71d9519c9",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "8a4519e8-e64a-40b6-ae85-ba8ad2177559",
                        "lookup_data": {
                            "description": "Detects process creation with a renamed BrowserCore.exe (used to extract Azure tokens)",
                            "raw": "author: Max Altgelt (Nextron Systems)\ndate: 2022/06/02\ndescription: Detects process creation with a renamed BrowserCore.exe (used to extract\n  Azure tokens)\ndetection:\n  condition: selection and not 1 of filter*\n  filter_realbrowsercore:\n    Image|endswith: \\BrowserCore.exe\n  selection:\n    OriginalFileName: BrowserCore.exe\nfalsepositives:\n- Unknown\nid: 8a4519e8-e64a-40b6-ae85-ba8ad2177559\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://twitter.com/mariuszbit/status/1531631015139102720\nstatus: experimental\ntags:\n- attack.t1528\n- attack.t1036.003\ntitle: Process Creation with Renamed BrowserCore.exe\n",
                            "sigma:id": "8a4519e8-e64a-40b6-ae85-ba8ad2177559",
                            "title": "Process Creation with Renamed BrowserCore.exe",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": [
            {
                "attack_technique": "T1036.003",
                "display_name": "Masquerading: Rename System Utilities",
                "atomic_tests": [
                    {
                        "name": "Masquerading as Windows LSASS process",
                        "auto_generated_guid": "5ba5a3d1-cf3c-4499-968a-a93155d1f717",
                        "description": "Copies cmd.exe, renames it, and launches it to masquerade as an instance of lsass.exe.\n\nUpon execution, cmd will be launched by powershell. If using Invoke-AtomicTest, The test will hang until the 120 second timeout cancels the session\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "copy %SystemRoot%\\System32\\cmd.exe %SystemRoot%\\Temp\\lsass.exe\n%SystemRoot%\\Temp\\lsass.exe /B\n",
                            "cleanup_command": "del /Q /F %SystemRoot%\\Temp\\lsass.exe >nul 2>&1\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Masquerading as FreeBSD or Linux crond process.",
                        "auto_generated_guid": "a315bfff-7a98-403b-b442-2ea1b255e556",
                        "description": "Copies sh process, renames it as crond, and executes it to masquerade as the cron daemon.\n\nUpon successful execution, sh is renamed to `crond` and executed.\n",
                        "supported_platforms": [
                            "linux"
                        ],
                        "executor": {
                            "command": "cp /bin/sh /tmp/crond;\necho 'sleep 5' | /tmp/crond\n",
                            "cleanup_command": "rm /tmp/crond\n",
                            "name": "sh"
                        }
                    },
                    {
                        "name": "Masquerading - cscript.exe running as notepad.exe",
                        "auto_generated_guid": "3a2a578b-0a01-46e4-92e3-62e2859b42f0",
                        "description": "Copies cscript.exe, renames it, and launches it to masquerade as an instance of notepad.exe.\n\nUpon successful execution, cscript.exe is renamed as notepad.exe and executed from non-standard path.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "copy %SystemRoot%\\System32\\cscript.exe %APPDATA%\\notepad.exe /Y\ncmd.exe /c %APPDATA%\\notepad.exe /B\n",
                            "cleanup_command": "del /Q /F %APPDATA%\\notepad.exe >nul 2>&1\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Masquerading - wscript.exe running as svchost.exe",
                        "auto_generated_guid": "24136435-c91a-4ede-9da1-8b284a1c1a23",
                        "description": "Copies wscript.exe, renames it, and launches it to masquerade as an instance of svchost.exe.\n\nUpon execution, no windows will remain open but wscript will have been renamed to svchost and ran out of the temp folder\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "Wscript file to execute must exist on disk\n",
                                "prereq_command": "if (Test-Path \"PathToAtomicsFolder\\..\\ExternalPayloads\\T1036.003\\src\\T1036.003_masquerading.vbs\") {exit 0} else {exit 1}\n",
                                "get_prereq_command": "New-Item -Type Directory (split-path \"PathToAtomicsFolder\\..\\ExternalPayloads\\T1036.003\\src\\T1036.003_masquerading.vbs\") -ErrorAction ignore | Out-Null\nInvoke-WebRequest \"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1036.003/src/T1036.003_masquerading.vbs\" -OutFile \"PathToAtomicsFolder\\..\\ExternalPayloads\\T1036.003\\src\\T1036.003_masquerading.vbs\"\n"
                            }
                        ],
                        "executor": {
                            "command": "copy %SystemRoot%\\System32\\wscript.exe %APPDATA%\\svchost.exe /Y\ncmd.exe /c %APPDATA%\\svchost.exe \"PathToAtomicsFolder\\..\\ExternalPayloads\\T1036.003\\src\\T1036.003_masquerading.vbs\"\n",
                            "cleanup_command": "del /Q /F %APPDATA%\\svchost.exe >nul 2>&1\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Masquerading - powershell.exe running as taskhostw.exe",
                        "auto_generated_guid": "ac9d0fc3-8aa8-4ab5-b11f-682cd63b40aa",
                        "description": "Copies powershell.exe, renames it, and launches it to masquerade as an instance of taskhostw.exe.\n\nUpon successful execution, powershell.exe is renamed as taskhostw.exe and executed from non-standard path.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "copy %windir%\\System32\\windowspowershell\\v1.0\\powershell.exe %APPDATA%\\taskhostw.exe /Y\ncmd.exe /K %APPDATA%\\taskhostw.exe\n",
                            "cleanup_command": "del /Q /F %APPDATA%\\taskhostw.exe >nul 2>&1\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Masquerading - non-windows exe running as windows exe",
                        "auto_generated_guid": "bc15c13f-d121-4b1f-8c7d-28d95854d086",
                        "description": "Copies an exe, renames it as a windows exe, and launches it to masquerade as a real windows exe\n\nUpon successful execution, powershell will execute T1036.003.exe as svchost.exe from on a non-standard path.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "outputfile": {
                                "description": "path of file to execute",
                                "type": "path",
                                "default": "($env:TEMP + \"\\svchost.exe\")"
                            },
                            "inputfile": {
                                "description": "path of file to copy",
                                "type": "path",
                                "default": "PathToAtomicsFolder\\T1036.003\\bin\\T1036.003.exe"
                            }
                        },
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "Exe file to copy must exist on disk at specified location (#{inputfile})\n",
                                "prereq_command": "if (Test-Path \"#{inputfile}\") {exit 0} else {exit 1}\n",
                                "get_prereq_command": "New-Item -Type Directory (split-path \"#{inputfile}\") -ErrorAction ignore | Out-Null\nInvoke-WebRequest \"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1036.003/bin/T1036.003.exe\" -OutFile \"#{inputfile}\"\n"
                            }
                        ],
                        "executor": {
                            "command": "copy \"#{inputfile}\" #{outputfile}\ntry { $myT1036_003 = (Start-Process -PassThru -FilePath #{outputfile}).Id }\ncatch { $_; exit $_.Exception.HResult}\nStop-Process -ID $myT1036_003\n",
                            "cleanup_command": "Remove-Item #{outputfile} -Force -ErrorAction Ignore\n",
                            "name": "powershell"
                        }
                    },
                    {
                        "name": "Masquerading - windows exe running as different windows exe",
                        "auto_generated_guid": "c3d24a39-2bfe-4c6a-b064-90cd73896cb0",
                        "description": "Copies a windows exe, renames it as another windows exe, and launches it to masquerade as second windows exe\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "outputfile": {
                                "description": "path of file to execute",
                                "type": "path",
                                "default": "($env:TEMP + \"\\svchost.exe\")"
                            },
                            "inputfile": {
                                "description": "path of file to copy",
                                "type": "path",
                                "default": "$env:ComSpec"
                            }
                        },
                        "executor": {
                            "command": "copy \"#{inputfile}\" #{outputfile}\n$myT1036_003 = (Start-Process -PassThru -FilePath #{outputfile}).Id\nStop-Process -ID $myT1036_003\n",
                            "cleanup_command": "Remove-Item #{outputfile} -Force -ErrorAction Ignore\n",
                            "name": "powershell"
                        }
                    },
                    {
                        "name": "Malicious process Masquerading as LSM.exe",
                        "auto_generated_guid": "83810c46-f45e-4485-9ab6-8ed0e9e6ed7f",
                        "description": "Detect LSM running from an incorrect directory and an incorrect service account\nThis works by copying cmd.exe to a file, naming it lsm.exe, then copying a file to the C:\\ folder.\n\nUpon successful execution, cmd.exe will be renamed as lsm.exe and executed from non-standard path.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "copy C:\\Windows\\System32\\cmd.exe C:\\lsm.exe\nC:\\lsm.exe /c echo T1036.003 > C:\\T1036.003.txt\n",
                            "cleanup_command": "del C:\\T1036.003.txt >nul 2>&1\ndel C:\\lsm.exe >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    }
                ]
            }
        ]
    },
    "timestamp": "2025-02-28 11:17:39"
}