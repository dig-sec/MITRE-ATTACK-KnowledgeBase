{
    "id": "T1212",
    "name": "Exploitation for Credential Access",
    "description": "Adversaries may exploit software vulnerabilities in an attempt to collect credentials. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code.Â Credentialing and authentication mechanisms may be targeted for exploitation by adversaries as a means to gain access to useful credentials or circumvent the process to gain access to systems. One example of this is MS14-068, which targets Kerberos and can be used to forge Kerberos tickets using domain user permissions.(Citation: Technet MS14-068)(Citation: ADSecurity Detecting Forged Tickets) Exploitation for credential access may also result in Privilege Escalation depending on the process targeted or credentials obtained.",
    "platforms": "Linux, Windows, macOS",
    "kill_chain_phases": "Credential Access",
    "data_sources": "",
    "detection": "Detecting software exploitation may be difficult depending on the tools available. Software exploits may not always succeed or may cause the exploited process to become unstable or crash. Also look for behavior on the system that might indicate successful compromise, such as abnormal behavior of processes. Credential resources obtained through exploitation may be detectable in use if they are not normally used or seen.",
    "url": "https://attack.mitre.org/techniques/T1212",
    "enrichments": {
        "attack_rule_map": [],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "1edd77db-0669-4fef-9598-165bda82826d",
                    "48d91a3a-2363-43ba-a456-ca71ac3da5c2",
                    "440a56bf-7873-4439-940a-1c8a671073c2",
                    "7818b381-5eb1-4641-bea5-ef9e4cfb5951",
                    "18739897-21b1-41da-8ee4-5b786915a676",
                    "9c306d8d-cde7-4b4c-b6e8-d0bb16caca36",
                    "5e04e696-4e74-4be0-a8e1-4cee02de0b81",
                    "06160d81-62be-46e5-aa37-4b9c645ffa31",
                    "bb76d96b-821c-47cf-944b-7ce377864492",
                    "f7644214-0eb0-4ace-9455-331ec4c09253"
                ],
                "lookup_results": [
                    {
                        "uuid": "1edd77db-0669-4fef-9598-165bda82826d",
                        "lookup_data": {
                            "description": "Detects suspicious session with two users present",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2020/07/03\ndescription: Detects suspicious session with two users present\ndetection:\n  condition: selection\n  selection:\n  - (2 users now present)\nfalsepositives:\n- Unknown\nid: 1edd77db-0669-4fef-9598-165bda82826d\nlevel: high\nlogsource:\n  product: linux\n  service: guacamole\nmodified: 2021/11/27\nreferences:\n- https://research.checkpoint.com/2020/apache-guacamole-rce/\nstatus: test\ntags:\n- attack.credential_access\n- attack.t1212\ntitle: Guacamole Two Users Sharing Session Anomaly\n",
                            "sigma:id": "1edd77db-0669-4fef-9598-165bda82826d",
                            "title": "Guacamole Two Users Sharing Session Anomaly",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "48d91a3a-2363-43ba-a456-ca71ac3da5c2",
                        "lookup_data": {
                            "description": "Detects events generated by user-mode applications when they call the CveEventWrite API when a known vulnerability is trying to be exploited.\nMS started using this log in Jan. 2020 with CVE-2020-0601 (a Windows CryptoAPI vulnerability.\nUnfortunately, that is about the only instance of CVEs being written to this log.\n",
                            "raw": "author: Florian Roth (Nextron Systems), Zach Mathis\ndate: 2020/01/15\ndescription: 'Detects events generated by user-mode applications when they call the\n  CveEventWrite API when a known vulnerability is trying to be exploited.\n\n  MS started using this log in Jan. 2020 with CVE-2020-0601 (a Windows CryptoAPI vulnerability.\n\n  Unfortunately, that is about the only instance of CVEs being written to this log.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    EventID: 1\n    Provider_Name:\n    - Microsoft-Windows-Audit-CVE\n    - Audit-CVE\nfalsepositives:\n- Unknown\nid: 48d91a3a-2363-43ba-a456-ca71ac3da5c2\nlevel: critical\nlogsource:\n  product: windows\n  service: application\nmodified: 2022/10/22\nreferences:\n- https://twitter.com/VM_vivisector/status/1217190929330655232\n- https://twitter.com/DidierStevens/status/1217533958096924676\n- https://twitter.com/FlemmingRiis/status/1217147415482060800\n- https://www.youtube.com/watch?v=ebmW42YYveI\n- https://nullsec.us/windows-event-log-audit-cve/\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1203\n- attack.privilege_escalation\n- attack.t1068\n- attack.defense_evasion\n- attack.t1211\n- attack.credential_access\n- attack.t1212\n- attack.lateral_movement\n- attack.t1210\n- attack.impact\n- attack.t1499.004\ntitle: Audit CVE Event\n",
                            "sigma:id": "48d91a3a-2363-43ba-a456-ca71ac3da5c2",
                            "title": "Audit CVE Event",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "440a56bf-7873-4439-940a-1c8a671073c2",
                        "lookup_data": {
                            "description": "Detects artefacts associated with activity group GALLIUM - Microsoft Threat Intelligence Center indicators released in December 2019.",
                            "raw": "author: Tim Burrell\ndate: 2020/02/07\ndescription: Detects artefacts associated with activity group GALLIUM - Microsoft\n  Threat Intelligence Center indicators released in December 2019.\ndetection:\n  condition: selection\n  selection:\n    sha1:\n    - 53a44c2396d15c3a03723fa5e5db54cafd527635\n    - 9c5e496921e3bc882dc40694f1dcc3746a75db19\n    - aeb573accfd95758550cf30bf04f389a92922844\n    - 79ef78a797403a4ed1a616c68e07fff868a8650a\n    - 4f6f38b4cec35e895d91c052b1f5a83d665c2196\n    - 1e8c2cac2e4ce7cbd33c3858eb2e24531cb8a84d\n    - e841a63e47361a572db9a7334af459ddca11347a\n    - c28f606df28a9bc8df75a4d5e5837fc5522dd34d\n    - 2e94b305d6812a9f96e6781c888e48c7fb157b6b\n    - dd44133716b8a241957b912fa6a02efde3ce3025\n    - 8793bf166cb89eb55f0593404e4e933ab605e803\n    - a39b57032dbb2335499a51e13470a7cd5d86b138\n    - 41cc2b15c662bc001c0eb92f6cc222934f0beeea\n    - d209430d6af54792371174e70e27dd11d3def7a7\n    - 1c6452026c56efd2c94cea7e0f671eb55515edb0\n    - c6b41d3afdcdcaf9f442bbe772f5da871801fd5a\n    - 4923d460e22fbbf165bbbaba168e5a46b8157d9f\n    - f201504bd96e81d0d350c3a8332593ee1c9e09de\n    - ddd2db1127632a2a52943a2fe516a2e7d05d70d2\nfalsepositives:\n- Unknown\nid: 440a56bf-7873-4439-940a-1c8a671073c2\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://www.microsoft.com/security/blog/2019/12/12/gallium-targeting-global-telecom/\n- https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn800669(v=ws.11)\nstatus: test\ntags:\n- attack.credential_access\n- attack.t1212\n- attack.command_and_control\n- attack.t1071\ntitle: GALLIUM Sha1 Artefacts\n",
                            "sigma:id": "440a56bf-7873-4439-940a-1c8a671073c2",
                            "title": "GALLIUM Sha1 Artefacts",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "7818b381-5eb1-4641-bea5-ef9e4cfb5951",
                        "lookup_data": {
                            "description": "Detects a possible remote NTLM hash change through SAMR API SamiChangePasswordUser() or SamSetInformationUser().\n\"Audit User Account Management\" in \"Advanced Audit Policy Configuration\" has to be enabled in your local security policy / GPO to see this events.\n",
                            "raw": "author: Dimitrios Slamaris\ndate: 2017/06/09\ndescription: 'Detects a possible remote NTLM hash change through SAMR API SamiChangePasswordUser()\n  or SamSetInformationUser().\n\n  \"Audit User Account Management\" in \"Advanced Audit Policy Configuration\" has to\n  be enabled in your local security policy / GPO to see this events.\n\n  '\ndetection:\n  condition: ( passwordchanged and not passwordchanged_filter ) | near samrpipe\n  passwordchanged:\n    EventID: 4738\n  passwordchanged_filter:\n    PasswordLastSet: null\n  samrpipe:\n    EventID: 5145\n    RelativeTargetName: samr\n  timeframe: 15s\nid: 7818b381-5eb1-4641-bea5-ef9e4cfb5951\nlevel: medium\nlogsource:\n  product: windows\n  service: security\nmodified: 2021/11/27\nstatus: test\ntags:\n- attack.credential_access\n- attack.t1212\ntitle: Possible Remote Password Change Through SAMR\n",
                            "sigma:id": "7818b381-5eb1-4641-bea5-ef9e4cfb5951",
                            "title": "Possible Remote Password Change Through SAMR",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "18739897-21b1-41da-8ee4-5b786915a676",
                        "lookup_data": {
                            "description": "Detects artefacts associated with activity group GALLIUM - Microsoft Threat Intelligence Center indicators released in December 2019.",
                            "raw": "author: Tim Burrell\ndate: 2020/02/07\ndescription: Detects artefacts associated with activity group GALLIUM - Microsoft\n  Threat Intelligence Center indicators released in December 2019.\ndetection:\n  condition: legitimate_executable and not legitimate_process_path\n  legitimate_executable:\n    sha1: e570585edc69f9074cb5e8a790708336bd45ca0f\n  legitimate_process_path:\n    Image|contains:\n    - :\\Program Files(x86)\\\n    - :\\Program Files\\\nfalsepositives:\n- Unknown\nid: 18739897-21b1-41da-8ee4-5b786915a676\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://www.microsoft.com/security/blog/2019/12/12/gallium-targeting-global-telecom/\n- https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn800669(v=ws.11)\nrelated:\n- id: 440a56bf-7873-4439-940a-1c8a671073c2\n  type: derived\nstatus: test\ntags:\n- attack.credential_access\n- attack.t1212\n- attack.command_and_control\n- attack.t1071\ntitle: GALLIUM Artefacts\n",
                            "sigma:id": "18739897-21b1-41da-8ee4-5b786915a676",
                            "title": "GALLIUM Artefacts",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "9c306d8d-cde7-4b4c-b6e8-d0bb16caca36",
                        "lookup_data": {
                            "mitre-attack-id": "T1212",
                            "mitre-cti:description": "Adversaries may exploit software vulnerabilities in an attempt to collect credentials. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code.Â Credentialing and authentication mechanisms may be targeted for exploitation by adversaries as a means to gain access to useful credentials or circumvent the process to gain access to systems. One example of this is MS14-068, which targets Kerberos and can be used to forge Kerberos tickets using domain user permissions.(Citation: Technet MS14-068)(Citation: ADSecurity Detecting Forged Tickets) Exploitation for credential access may also result in Privilege Escalation depending on the process targeted or credentials obtained.",
                            "mitre-cti:name": "Exploitation for Credential Access",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'x_mitre_platforms': ['Linux', 'Windows', 'macOS'], 'x_mitre_domains': ['enterprise-attack'], 'x_mitre_contributors': ['John Lambert, Microsoft Threat Intelligence Center'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'type': 'attack-pattern', 'id': 'attack-pattern--9c306d8d-cde7-4b4c-b6e8-d0bb16caca36', 'created': '2018-04-18T17:59:24.739Z', 'x_mitre_version': '1.4', 'external_references': [{'source_name': 'mitre-attack', 'external_id': 'T1212', 'url': 'https://attack.mitre.org/techniques/T1212'}, {'source_name': 'ADSecurity Detecting Forged Tickets', 'url': 'https://adsecurity.org/?p=1515', 'description': 'Metcalf, S. (2015, May 03). Detecting Forged Kerberos Ticket (Golden Ticket & Silver Ticket) Use in Active Directory. Retrieved December 23, 2015.'}, {'source_name': 'Technet MS14-068', 'url': 'https://technet.microsoft.com/en-us/library/security/ms14-068.aspx', 'description': 'Microsoft. (2014, November 18). Vulnerability in Kerberos Could Allow Elevation of Privilege (3011780). Retrieved December 23, 2015.'}], 'x_mitre_deprecated': False, 'revoked': False, 'description': 'Adversaries may exploit software vulnerabilities in an attempt to collect credentials. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code.\\xa0Credentialing and authentication mechanisms may be targeted for exploitation by adversaries as a means to gain access to useful credentials or circumvent the process to gain access to systems. One example of this is MS14-068, which targets Kerberos and can be used to forge Kerberos tickets using domain user permissions.(Citation: Technet MS14-068)(Citation: ADSecurity Detecting Forged Tickets) Exploitation for credential access may also result in Privilege Escalation depending on the process targeted or credentials obtained.', 'modified': '2022-04-28T16:06:49.447Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'name': 'Exploitation for Credential Access', 'x_mitre_detection': 'Detecting software exploitation may be difficult depending on the tools available. Software exploits may not always succeed or may cause the exploited process to become unstable or crash. Also look for behavior on the system that might indicate successful compromise, such as abnormal behavior of processes. Credential resources obtained through exploitation may be detectable in use if they are not normally used or seen.', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'credential-access'}], 'x_mitre_is_subtechnique': False, 'x_mitre_data_sources': ['Application Log: Application Log Content', 'User Account: User Account Authentication', 'Process: Process Creation'], 'x_mitre_attack_spec_version': '2.1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5e04e696-4e74-4be0-a8e1-4cee02de0b81",
                        "lookup_data": {
                            "description": "OSINT - LetÃ¢â¬â¢s play (again) with Predator the thief Ã¢â¬â Fumik0_'s box",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5e04e696-4e74-4be0-a8e1-4cee02de0b81.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1577379958",
                            "uuid": "5e04e696-4e74-4be0-a8e1-4cee02de0b81",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "06160d81-62be-46e5-aa37-4b9c645ffa31",
                        "lookup_data": {
                            "mitre-attack-id": "T1212",
                            "mitre-cti:description": "Update software regularly by employing patch management for internal enterprise endpoints and servers. Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization. Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing, if available. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of exploitation. The risks of additional exploits and weaknesses in implementation may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)\n\nSecurity applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. (Citation: TechNet Moving Beyond EMET) Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. (Citation: Wikipedia Control Flow Integrity) Many of these protections depend on the architecture and target application binary for compatibility and may not work for software targeted for defense evasion.",
                            "mitre-cti:name": "Exploitation for Credential Access Mitigation",
                            "mitre-cti:type": "course-of-action",
                            "raw": "{'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'course-of-action--06160d81-62be-46e5-aa37-4b9c645ffa31', 'type': 'course-of-action', 'created': '2018-10-17T00:14:20.652Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/mitigations/T1212', 'external_id': 'T1212'}, {'url': 'https://arstechnica.com/information-technology/2017/03/hack-that-escapes-vm-by-exploiting-edge-browser-fetches-105000-at-pwn2own/', 'description': 'Goodin, D. (2017, March 17). Virtual machine escape fetches $105,000 at Pwn2Own hacking contest - updated. Retrieved March 12, 2018.', 'source_name': 'Ars Technica Pwn2Own 2017 VM Escape'}, {'url': 'https://blogs.technet.microsoft.com/srd/2017/08/09/moving-beyond-emet-ii-windows-defender-exploit-guard/', 'description': 'Nunez, N. (2017, August 9). Moving Beyond EMET II â Windows Defender Exploit Guard. Retrieved March 12, 2018.', 'source_name': 'TechNet Moving Beyond EMET'}, {'url': 'https://en.wikipedia.org/wiki/Control-flow_integrity', 'description': 'Wikipedia. (2018, January 11). Control-flow integrity. Retrieved March 12, 2018.', 'source_name': 'Wikipedia Control Flow Integrity'}], 'modified': '2019-07-24T19:23:33.259Z', 'name': 'Exploitation for Credential Access Mitigation', 'description': 'Update software regularly by employing patch management for internal enterprise endpoints and servers. Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization. Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing, if available. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of exploitation. The risks of additional exploits and weaknesses in implementation may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)\\n\\nSecurity applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. (Citation: TechNet Moving Beyond EMET) Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. (Citation: Wikipedia Control Flow Integrity) Many of these protections depend on the architecture and target application binary for compatibility and may not work for software targeted for defense evasion.', 'x_mitre_deprecated': True, 'x_mitre_version': '1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "bb76d96b-821c-47cf-944b-7ce377864492",
                        "lookup_data": {
                            "description": "Detects a privilege elevation attempt by coercing NTLM authentication on the Printer Spooler service",
                            "raw": "author: Elastic (idea), Tobias Michalski (Nextron Systems)\ndate: 2022/05/04\ndescription: Detects a privilege elevation attempt by coercing NTLM authentication\n  on the Printer Spooler service\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains:\n    - spoolss\n    - srvsvc\n    - /print/pipe/\n    CommandLine|contains|all:\n    - C:\\windows\\system32\\davclnt.dll,DavSetCookie\n    - http\n    Image|endswith: \\rundll32.exe\nfalsepositives:\n- Unknown\nid: bb76d96b-821c-47cf-944b-7ce377864492\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/02\nreferences:\n- https://twitter.com/med0x2e/status/1520402518685200384\n- https://github.com/elastic/detection-rules/blob/dd224fb3f81d0b4bf8593c5f02a029d647ba2b2d/rules/windows/credential_access_relay_ntlm_auth_via_http_spoolss.toml\nstatus: experimental\ntags:\n- attack.privilege_escalation\n- attack.credential_access\n- attack.t1212\ntitle: Suspicious NTLM Authentication on the Printer Spooler Service\n",
                            "sigma:id": "bb76d96b-821c-47cf-944b-7ce377864492",
                            "title": "Suspicious NTLM Authentication on the Printer Spooler Service",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f7644214-0eb0-4ace-9455-331ec4c09253",
                        "lookup_data": {
                            "description": "This method triggers on rare Kerberos Failure Codes caused by manipulations of Kerberos messages",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/02/10\ndescription: This method triggers on rare Kerberos Failure Codes caused by manipulations\n  of Kerberos messages\ndetection:\n  condition: selection\n  selection:\n    EventID:\n    - 675\n    - 4768\n    - 4769\n    - 4771\n    FailureCode:\n    - '0x9'\n    - '0xA'\n    - '0xB'\n    - '0xF'\n    - '0x10'\n    - '0x11'\n    - '0x13'\n    - '0x14'\n    - '0x1A'\n    - '0x1F'\n    - '0x21'\n    - '0x22'\n    - '0x23'\n    - '0x24'\n    - '0x26'\n    - '0x27'\n    - '0x28'\n    - '0x29'\n    - '0x2C'\n    - '0x2D'\n    - '0x2E'\n    - '0x2F'\n    - '0x31'\n    - '0x32'\n    - '0x3E'\n    - '0x3F'\n    - '0x40'\n    - '0x41'\n    - '0x43'\n    - '0x44'\nfalsepositives:\n- Faulty legacy applications\nid: f7644214-0eb0-4ace-9455-331ec4c09253\nlevel: high\nlogsource:\n  product: windows\n  service: security\nmodified: 2021/11/27\nstatus: test\ntags:\n- attack.credential_access\n- attack.t1212\ntitle: Kerberos Manipulation\n",
                            "sigma:id": "f7644214-0eb0-4ace-9455-331ec4c09253",
                            "title": "Kerberos Manipulation",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": []
    },
    "timestamp": "2025-02-28 14:03:13"
}