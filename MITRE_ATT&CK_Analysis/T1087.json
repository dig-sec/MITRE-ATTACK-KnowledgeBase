{
    "id": "T1087",
    "name": "Account Discovery",
    "description": "Adversaries may attempt to get a listing of accounts on a system or within an environment. This information can help adversaries determine which accounts exist to aid in follow-on behavior.",
    "platforms": "Windows, Azure AD, Office 365, SaaS, IaaS, Linux, macOS, Google Workspace",
    "kill_chain_phases": "Discovery",
    "data_sources": "User Account: User Account Metadata, Command: Command Execution, Process: Process Creation, File: File Access",
    "detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](T1047) and [PowerShell](T1059.001).\nMonitor for processes that can be used to enumerate user accounts, such as `net.exe` and `net1.exe`, especially when executed in quick succession.(Citation: Elastic - Koadiac Detection with EQL)",
    "url": "https://attack.mitre.org/techniques/T1087",
    "enrichments": {
        "attack_rule_map": [],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "4b1c186d-8bf2-4297-9cbc-f8f00192770b",
                    "24549159-ac1b-479c-8175-d42aea947cae",
                    "ab6bffca-beff-4baa-af11-6733f296d57a",
                    "2887e914-ce96-435f-8105-593937e90757",
                    "65f77b1e-8e79-45bf-bb67-5988a8ce45a5",
                    "89819aa4-bbd6-46bc-88ec-c7f7fe30efa6",
                    "5c125ad1-a1a8-495e-ae07-48bd950d210f",
                    "e6313acd-208c-44fc-a0ff-db85d572e90e",
                    "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                    "5d9b5933-964c-433c-b84f-4c680a2fe004",
                    "98b53e78-ebaf-46f8-be06-421aafd176d9",
                    "5e78dc2c-afc8-411f-94a5-40bb950d210f",
                    "f376c8a7-a2d0-4ddc-aa0c-16c17236d962",
                    "d95de845-b83c-4a9a-8a6a-4fc802ebf6c0",
                    "bed2a484-9348-4143-8a8a-b801c979301c",
                    "72b74d71-8169-42aa-92e0-e7b04b9f5a08",
                    "968eef52-9cff-4454-8992-1e74b9cbad6c",
                    "02030f2f-6199-49ec-b258-ea71b07e03dc",
                    "35ba1d85-724d-42a3-889f-2e2362bcaf23",
                    "aae1243f-d8af-40d8-ab20-33fc6d0c55bc",
                    "04d9079e-3905-4b70-ad37-6bdf11304965",
                    "66a0bdc6-ee04-441a-9125-99d2eb547942",
                    "619b020f-0fd7-4f23-87db-3f51ef837a34",
                    "fa3c117a-bc0d-416e-a31b-0c0e80653efb",
                    "502b42de-4306-40b4-9596-6f590c81f073",
                    "4ebc877f-4612-45cb-b3a5-8e3834db36c9",
                    "38646daa-e78f-4ace-9de0-55547b2d30da",
                    "5c49bc54-9929-48ca-b581-7018219b5a97",
                    "7d0d0329-0ef1-4e84-a9f5-49500f9d7c6c",
                    "cd072b25-a418-4f98-8ebc-5093fb38fe1a",
                    "5e55be1a-3a30-48ae-9934-4199950d210f"
                ],
                "lookup_results": [
                    {
                        "uuid": "4b1c186d-8bf2-4297-9cbc-f8f00192770b",
                        "lookup_data": {
                            "description": "Prynt Stealer Spotted In the Wild - A New Info Stealer Performing Clipper And Keylogger Activities",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/4b1c186d-8bf2-4297-9cbc-f8f00192770b.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1666601854",
                            "uuid": "4b1c186d-8bf2-4297-9cbc-f8f00192770b",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "24549159-ac1b-479c-8175-d42aea947cae",
                        "lookup_data": {
                            "description": "This events that are generated when using the hacktool Ruler by Sensepost",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2017/05/31\ndescription: This events that are generated when using the hacktool Ruler by Sensepost\ndetection:\n  condition: (1 of selection*)\n  selection1:\n    EventID: 4776\n    Workstation: RULER\n  selection2:\n    EventID:\n    - 4624\n    - 4625\n    WorkstationName: RULER\nfalsepositives:\n- Go utilities that use staaldraad awesome NTLM library\nid: 24549159-ac1b-479c-8175-d42aea947cae\nlevel: high\nlogsource:\n  product: windows\n  service: security\nmodified: 2022/10/09\nreferences:\n- https://github.com/sensepost/ruler\n- https://github.com/sensepost/ruler/issues/47\n- https://github.com/staaldraad/go-ntlm/blob/cd032d41aa8ce5751c07cb7945400c0f5c81e2eb/ntlm/ntlmv1.go#L427\n- https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4776\n- https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4624\nstatus: test\ntags:\n- attack.discovery\n- attack.execution\n- attack.t1087\n- attack.t1114\n- attack.t1059\n- attack.t1550.002\ntitle: Hacktool Ruler\n",
                            "sigma:id": "24549159-ac1b-479c-8175-d42aea947cae",
                            "title": "Hacktool Ruler",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ab6bffca-beff-4baa-af11-6733f296d57a",
                        "lookup_data": {
                            "description": "Detects access to a domain user from a non-machine account",
                            "raw": "author: Maxime Thiebaut (@0xThiebaut)\ndate: 2020/03/30\ndescription: Detects access to a domain user from a non-machine account\ndetection:\n  condition: selection and not filter\n  filter:\n  - SubjectUserName|endswith: $\n  - SubjectUserName|startswith: MSOL_\n  selection:\n    EventID: 4662\n    ObjectType|contains: bf967aba-0de6-11d0-a285-00aa003049e2\nfalsepositives:\n- Administrators configuring new users.\nid: ab6bffca-beff-4baa-af11-6733f296d57a\nlevel: medium\nlogsource:\n  definition: Requires the \"Read all properties\" permission on the user object to\n    be audited for the \"Everyone\" principal\n  product: windows\n  service: security\nmodified: 2022/10/09\nreferences:\n- https://www.specterops.io/assets/resources/an_ace_up_the_sleeve.pdf\n- http://www.stuffithoughtiknew.com/2019/02/detecting-bloodhound.html\n- https://docs.microsoft.com/en-us/windows/win32/adschema/attributes-all\nstatus: test\ntags:\n- attack.discovery\n- attack.t1087.002\ntitle: AD User Enumeration\n",
                            "sigma:id": "ab6bffca-beff-4baa-af11-6733f296d57a",
                            "title": "AD User Enumeration",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "2887e914-ce96-435f-8105-593937e90757",
                        "lookup_data": {
                            "description": "Detects execution of a set of builtin commands often used in recon stages by different attack groups",
                            "raw": "author: Florian Roth (Nextron Systems), Markus Neis\ndate: 2018/08/22\ndescription: Detects execution of a set of builtin commands often used in recon stages\n  by different attack groups\ndetection:\n  condition: selection | count() by CommandLine > 4\n  selection:\n  - CommandLine:\n    - tasklist\n    - net time\n    - systeminfo\n    - whoami\n    - nbtstat\n    - net start\n    - qprocess\n    - nslookup\n    - hostname.exe\n    - netstat -an\n  - CommandLine|endswith:\n    - \\net1 start\n    - \\net1 user /domain\n    - \\net1 group /domain\n    - \\net1 group \"domain admins\" /domain\n    - \\net1 group \"Exchange Trusted Subsystem\" /domain\n    - \\net1 accounts /domain\n    - \\net1 user net localgroup administrators\n  timeframe: 15s\nfalsepositives:\n- False positives depend on scripts and administrative tools used in the monitored\n  environment\nid: 2887e914-ce96-435f-8105-593937e90757\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/10/05\nreferences:\n- https://twitter.com/haroonmeer/status/939099379834658817\n- https://twitter.com/c_APT_ure/status/939475433711722497\n- https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.html\nstatus: test\ntags:\n- attack.discovery\n- attack.t1087\n- attack.t1082\n- car.2016-03-001\ntitle: Reconnaissance Activity Using BuiltIn Commands\n",
                            "sigma:id": "2887e914-ce96-435f-8105-593937e90757",
                            "title": "Reconnaissance Activity Using BuiltIn Commands",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "65f77b1e-8e79-45bf-bb67-5988a8ce45a5",
                        "lookup_data": {
                            "description": "Detects remote RPC calls useb by SharpHound to map remote connections and local group membership.",
                            "raw": "author: Sagie Dulce, Dekel Paz\ndate: 2022/01/01\ndescription: Detects remote RPC calls useb by SharpHound to map remote connections\n  and local group membership.\ndetection:\n  condition: selection\n  selection:\n    EventID: 3\n    EventLog: RPCFW\n    InterfaceUuid: 6bffd098-a112-3610-9833-46c3f87e345a\n    OpNum: 2\nfalsepositives:\n- Unknown\nid: 65f77b1e-8e79-45bf-bb67-5988a8ce45a5\nlevel: high\nlogsource:\n  category: application\n  definition: 'Requirements: install and apply the RPC Firewall to all processes with\n    \"audit:true action:block uuid:6bffd098-a112-3610-9833-46c3f87e345a opnum:2'\n  product: rpc_firewall\nmodified: 2022/01/01\nreferences:\n- https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-wkst/55118c55-2122-4ef9-8664-0c1ff9e168f3\n- https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/ddd4608fe8684fcf2fcf9b48c5f0b3c28097f8a3/documents/MS-WKST.md\n- https://github.com/zeronetworks/rpcfirewall\n- https://zeronetworks.com/blog/stopping_lateral_movement_via_the_rpc_firewall/\nstatus: test\ntags:\n- attack.t1087\n- attack.discovery\ntitle: SharpHound Recon Account Discovery\n",
                            "sigma:id": "65f77b1e-8e79-45bf-bb67-5988a8ce45a5",
                            "title": "SharpHound Recon Account Discovery",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "89819aa4-bbd6-46bc-88ec-c7f7fe30efa6",
                        "lookup_data": {
                            "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks",
                            "raw": "author: Sean Metcalf, Florian Roth, Bartlomiej Czyz @bczyz1, oscd.community, Nasreddine\n  Bencherchali, Tim Shelton, Mustafa Kaan Demir, Georg Lauenstein, Max Altgelt, Tobias\n  Michalski, Austin Songer\ndate: 2017/03/05\ndescription: Detects Commandlet names from well-known PowerShell exploitation frameworks\ndetection:\n  condition: selection and not 1 of filter_*\n  filter_1:\n    ScriptBlockText|contains:\n    - Get-SystemDriveInfo\n    - C:\\ProgramData\\Amazon\\EC2-Windows\\Launch\\Module\\\n  filter_2:\n    ScriptBlockText|startswith: '# Copyright 2016 Amazon.com, Inc. or its affiliates.\n      All Rights Reserved'\n  selection:\n    ScriptBlockText|contains:\n    - Add-Exfiltration\n    - Add-Persistence\n    - Add-RegBackdoor\n    - Add-RemoteRegBackdoor\n    - Add-ScrnSaveBackdoor\n    - Check-VM\n    - ConvertTo-Rc4ByteStream\n    - Decrypt-Hash\n    - Do-Exfiltration\n    - Enabled-DuplicateToken\n    - Exploit-Jboss\n    - Find-Fruit\n    - Find-GPOLocation\n    - Find-TrustedDocuments\n    - Get-ApplicationHost\n    - Get-ChromeDump\n    - Get-ClipboardContents\n    - Get-FoxDump\n    - Get-GPPPassword\n    - Get-IndexedItem\n    - Get-Keystrokes\n    - Get-LSASecret\n    - Get-PassHashes\n    - Get-RegAlwaysInstallElevated\n    - Get-RegAutoLogon\n    - Get-RemoteBootKey\n    - Get-RemoteCachedCredential\n    - Get-RemoteLocalAccountHash\n    - Get-RemoteLSAKey\n    - Get-RemoteMachineAccountHash\n    - Get-RemoteNLKMKey\n    - Get-RickAstley\n    - Get-Screenshot\n    - Get-SecurityPackages\n    - Get-ServiceFilePermission\n    - Get-ServicePermission\n    - Get-ServiceUnquoted\n    - Get-SiteListPassword\n    - Get-System\n    - Get-TimedScreenshot\n    - Get-UnattendedInstallFile\n    - Get-Unconstrained\n    - Get-USBKeystrokes\n    - Get-VaultCredential\n    - Get-VulnAutoRun\n    - Get-VulnSchTask\n    - Gupt-Backdoor\n    - HTTP-Login\n    - Install-ServiceBinary\n    - Install-SSP\n    - Invoke-ACLScanner\n    - Invoke-ADSBackdoor\n    - Invoke-AllChecks\n    - Invoke-ARPScan\n    - Invoke-AzureHound\n    - Invoke-BackdoorLNK\n    - Invoke-BadPotato\n    - Invoke-BetterSafetyKatz\n    - Invoke-BypassUAC\n    - Invoke-Carbuncle\n    - Invoke-Certify\n    - Invoke-ConPtyShell\n    - Invoke-CredentialInjection\n    - Invoke-DAFT\n    - Invoke-DCSync\n    - Invoke-DinvokeKatz\n    - Invoke-DllInjection\n    - Invoke-DomainPasswordSpray\n    - Invoke-DowngradeAccount\n    - Invoke-EgressCheck\n    - Invoke-Eyewitness\n    - Invoke-FakeLogonScreen\n    - Invoke-Farmer\n    - Invoke-Get-RBCD-Threaded\n    - Invoke-Gopher\n    - Invoke-Grouper\n    - Invoke-HandleKatz\n    - Invoke-ImpersonatedProcess\n    - Invoke-ImpersonateSystem\n    - Invoke-InteractiveSystemPowerShell\n    - Invoke-Internalmonologue\n    - Invoke-Inveigh\n    - Invoke-InveighRelay\n    - Invoke-KrbRelay\n    - Invoke-LdapSignCheck\n    - Invoke-Lockless\n    - Invoke-MalSCCM\n    - Invoke-Mimikatz\n    - Invoke-Mimikittenz\n    - Invoke-MITM6\n    - Invoke-NanoDump\n    - Invoke-NetRipper\n    - Invoke-Nightmare\n    - Invoke-NinjaCopy\n    - Invoke-OfficeScrape\n    - Invoke-OxidResolver\n    - Invoke-P0wnedshell\n    - Invoke-Paranoia\n    - Invoke-PortScan\n    - Invoke-PoshRatHttp\n    - Invoke-PostExfil\n    - Invoke-PowerDump\n    - Invoke-PowerShellTCP\n    - Invoke-PowerShellWMI\n    - Invoke-PPLDump\n    - Invoke-PsExec\n    - Invoke-PSInject\n    - Invoke-PsUaCme\n    - Invoke-ReflectivePEInjection\n    - Invoke-ReverseDNSLookup\n    - Invoke-Rubeus\n    - Invoke-RunAs\n    - Invoke-SafetyKatz\n    - Invoke-SauronEye\n    - Invoke-SCShell\n    - Invoke-Seatbelt\n    - Invoke-ServiceAbuse\n    - Invoke-ShadowSpray\n    - Invoke-Sharp\n    - Invoke-Shellcode\n    - Invoke-SMBScanner\n    - Invoke-Snaffler\n    - Invoke-Spoolsample\n    - Invoke-SpraySinglePassword\n    - Invoke-SSHCommand\n    - Invoke-StandIn\n    - Invoke-StickyNotesExtract\n    - Invoke-SystemCommand\n    - Invoke-Tasksbackdoor\n    - Invoke-Tater\n    - Invoke-Thunderfox\n    - Invoke-ThunderStruck\n    - Invoke-TokenManipulation\n    - Invoke-Tokenvator\n    - Invoke-TotalExec\n    - Invoke-UrbanBishop\n    - Invoke-UserHunter\n    - Invoke-VoiceTroll\n    - Invoke-Whisker\n    - Invoke-WinEnum\n    - Invoke-winPEAS\n    - Invoke-WireTap\n    - Invoke-WmiCommand\n    - Invoke-WScriptBypassUAC\n    - Invoke-Zerologon\n    - MailRaider\n    - New-HoneyHash\n    - New-InMemoryModule\n    - Out-Minidump\n    - Port-Scan\n    - PowerBreach\n    - 'powercat '\n    - PowerUp\n    - PowerView\n    - Remove-Update\n    - Set-MacAttribute\n    - Set-Wallpaper\n    - Show-TargetScreen\n    - Start-CaptureServer\n    - Start-WebcamRecorder\n    - VolumeShadowCopyTools\nfalsepositives:\n- Unknown\nid: 89819aa4-bbd6-46bc-88ec-c7f7fe30efa6\nlevel: high\nlogsource:\n  category: ps_script\n  definition: 'Requirements: Script Block Logging must be enabled'\n  product: windows\nmodified: 2023/01/23\nreferences:\n- https://adsecurity.org/?p=2921\n- https://github.com/S3cur3Th1sSh1t/PowerSharpPack/tree/master/PowerSharpBinaries\n- https://github.com/BC-SECURITY/Invoke-ZeroLogon/blob/111d17c7fec486d9bb23387e2e828b09a26075e4/Invoke-ZeroLogon.ps1\n- https://github.com/xorrior/RandomPS-Scripts/blob/848c919bfce4e2d67b626cbcf4404341cfe3d3b6/Get-DXWebcamVideo.ps1\n- https://github.com/rvrsh3ll/Misc-Powershell-Scripts/blob/6f23bb41f9675d7e2d32bacccff75e931ae00554/OfficeMemScraper.ps1\n- https://github.com/dafthack/DomainPasswordSpray/blob/b13d64a5834694aa73fd2aea9911a83027c465a7/DomainPasswordSpray.ps1\n- https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/\n- https://research.nccgroup.com/2022/06/06/shining-the-light-on-black-basta/\n- https://github.com/calebstewart/CVE-2021-1675\n- https://github.com/BloodHoundAD/BloodHound/blob/0927441f67161cc6dc08a53c63ceb8e333f55874/Collectors/AzureHound.ps1\n- https://bloodhound.readthedocs.io/en/latest/data-collection/azurehound.html\n- https://github.com/HarmJ0y/DAMP\n- https://github.com/samratashok/nishang\n- https://github.com/DarkCoderSc/PowerRunAsSystem/\n- https://github.com/besimorhino/powercat\nrelated:\n- id: 7d0d0329-0ef1-4e84-a9f5-49500f9d7c6c\n  type: similar\n- id: 02030f2f-6199-49ec-b258-ea71b07e03dc\n  type: similar\n- id: 6d3f1399-a81c-4409-aff3-1ecfe9330baf\n  type: obsoletes\n- id: 83083ac6-1816-4e76-97d7-59af9a9ae46e\n  type: obsoletes\nstatus: test\ntags:\n- attack.execution\n- attack.discovery\n- attack.t1482\n- attack.t1087\n- attack.t1087.001\n- attack.t1087.002\n- attack.t1069.001\n- attack.t1069.002\n- attack.t1069\n- attack.t1059.001\ntitle: Malicious PowerShell Commandlets - ScriptBlock\n",
                            "sigma:id": "89819aa4-bbd6-46bc-88ec-c7f7fe30efa6",
                            "title": "Malicious PowerShell Commandlets - ScriptBlock",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5c125ad1-a1a8-495e-ae07-48bd950d210f",
                        "lookup_data": {
                            "description": "OSINT - â€˜Operation Sharpshooterâ€™ Targets Global Defense, Critical Infrastructure",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5c125ad1-a1a8-495e-ae07-48bd950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1544734085",
                            "uuid": "5c125ad1-a1a8-495e-ae07-48bd950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "e6313acd-208c-44fc-a0ff-db85d572e90e",
                        "lookup_data": {
                            "description": "Detects a set of suspicious network related commands often used in recon stages",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/02/07\ndescription: Detects a set of suspicious network related commands often used in recon\n  stages\ndetection:\n  condition: 1 of selection*\n  selection_nslookup:\n    CommandLine|contains|all:\n    - nslookup\n    - _ldap._tcp.dc._msdcs.\nfalsepositives:\n- False positives depend on scripts and administrative tools used in the monitored\n  environment\nid: e6313acd-208c-44fc-a0ff-db85d572e90e\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/\nstatus: test\ntags:\n- attack.discovery\n- attack.t1087\n- attack.t1082\n- car.2016-03-001\ntitle: Network Reconnaissance Activity\n",
                            "sigma:id": "e6313acd-208c-44fc-a0ff-db85d572e90e",
                            "title": "Network Reconnaissance Activity",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                        "lookup_data": {
                            "description": "SectorJ04 Groupâ€™s Increased Activity in 2019",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5d6e7aa3-aca4-46cc-b96a-46ac950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1568039252",
                            "uuid": "5d6e7aa3-aca4-46cc-b96a-46ac950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5d9b5933-964c-433c-b84f-4c680a2fe004",
                        "lookup_data": {
                            "description": "Emotet in Depth TTP 10-07-19",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5d9b5933-964c-433c-b84f-4c680a2fe004.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1621850615",
                            "uuid": "5d9b5933-964c-433c-b84f-4c680a2fe004",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "98b53e78-ebaf-46f8-be06-421aafd176d9",
                        "lookup_data": {
                            "description": "WinPEAS is a script that search for possible paths to escalate privileges on Windows hosts. The checks are explained on book.hacktricks.xyz",
                            "raw": "author: Georg Lauenstein\ndate: 2022/09/19\ndescription: WinPEAS is a script that search for possible paths to escalate privileges\n  on Windows hosts. The checks are explained on book.hacktricks.xyz\ndetection:\n  condition: 1 of selection*\n  selection_basic:\n    Image|endswith:\n    - \\winPEASany.exe\n    - \\winPEASany_ofs.exe\n    - \\winPEASx64.exe\n    - \\winPEASx64_ofs.exe\n    - \\winPEASx86.exe\n    - \\winPEASx86_ofs.exe\n  selection_option:\n  - CommandLine|endswith:\n    - serviceinfo\n    - applicationsinfo\n    - windowscreds\n    - 'browserinfo '\n    - fileanalysis\n  - CommandLine|contains: '.exe browserinfo '\n  selection_pe:\n    OriginalFileName: winPEAS.exe\nfalsepositives:\n- Other programs that use the same command line flags\nid: 98b53e78-ebaf-46f8-be06-421aafd176d9\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/carlospolop/PEASS-ng\n- https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation\nstatus: experimental\ntags:\n- attack.privilege_escalation\n- attack.t1082\n- attack.t1087\n- attack.t1046\ntitle: Detect Execution of winPEAS\n",
                            "sigma:id": "98b53e78-ebaf-46f8-be06-421aafd176d9",
                            "title": "Detect Execution of winPEAS",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5e78dc2c-afc8-411f-94a5-40bb950d210f",
                        "lookup_data": {
                            "description": "Trickbot to Ryuk in Two Hours",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5e78dc2c-afc8-411f-94a5-40bb950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1585237597",
                            "uuid": "5e78dc2c-afc8-411f-94a5-40bb950d210f",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "f376c8a7-a2d0-4ddc-aa0c-16c17236d962",
                        "lookup_data": {
                            "description": "Detects command line parameters used by Bloodhound and Sharphound hack tools",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2019/12/20\ndescription: Detects command line parameters used by Bloodhound and Sharphound hack\n  tools\ndetection:\n  condition: 1 of selection*\n  selection1:\n    Image|contains:\n    - \\Bloodhound.exe\n    - \\SharpHound.exe\n  selection2:\n    CommandLine|contains:\n    - ' -CollectionMethod All '\n    - ' --CollectionMethods Session '\n    - ' --Loop --Loopduration '\n    - ' --PortScanTimeout '\n    - '.exe -c All -d '\n    - Invoke-Bloodhound\n    - Get-BloodHoundData\n  selection3:\n    CommandLine|contains|all:\n    - ' -JsonFolder '\n    - ' -ZipFileName '\n  selection4:\n    CommandLine|contains|all:\n    - ' DCOnly '\n    - ' --NoSaveCache '\n  selection5:\n  - Product|contains: SharpHound\n  - Description|contains: SharpHound\n  - Company|contains:\n    - SpecterOps\n    - evil corp\nfalsepositives:\n- Other programs that use these command line option and accepts an 'All' parameter\nid: f376c8a7-a2d0-4ddc-aa0c-16c17236d962\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/08/12\nreferences:\n- https://github.com/BloodHoundAD/BloodHound\n- https://github.com/BloodHoundAD/SharpHound\nstatus: test\ntags:\n- attack.discovery\n- attack.t1087.001\n- attack.t1087.002\n- attack.t1482\n- attack.t1069.001\n- attack.t1069.002\n- attack.execution\n- attack.t1059.001\ntitle: Bloodhound and Sharphound Hack Tool\n",
                            "sigma:id": "f376c8a7-a2d0-4ddc-aa0c-16c17236d962",
                            "title": "Bloodhound and Sharphound Hack Tool",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "d95de845-b83c-4a9a-8a6a-4fc802ebf6c0",
                        "lookup_data": {
                            "description": "Detects suspicious reconnaissance command line activity on Windows systems using Net.EXE",
                            "raw": "analysis:\n  recommendation: Check if the user that executed the commands is suspicious (e.g.\n    service accounts, LOCAL_SYSTEM)\nauthor: Florian Roth (Nextron Systems), omkar72, @svch0st, Nasreddine Bencherchali\n  (Nextron Systems)\ndate: 2019/01/16\ndescription: Detects suspicious reconnaissance command line activity on Windows systems\n  using Net.EXE\ndetection:\n  condition: selection_img and (all of selection_group_* or all of selection_accounts_*)\n  selection_accounts_flags:\n    CommandLine|contains: ' /do'\n  selection_accounts_root:\n    CommandLine|contains: ' accounts '\n  selection_group_flags:\n    CommandLine|contains:\n    - domain admins\n    - ' administrator'\n    - ' administrateur'\n    - enterprise admins\n    - Exchange Trusted Subsystem\n    - Remote Desktop Users\n    - \"Utilisateurs du Bureau \\xE0 distance\"\n    - Usuarios de escritorio remoto\n    - ' /do'\n  selection_group_root:\n    CommandLine|contains:\n    - ' group '\n    - ' localgroup '\n  selection_img:\n  - Image|endswith:\n    - \\net.exe\n    - \\net1.exe\n  - OriginalFileName:\n    - net.exe\n    - net1.exe\nfalsepositives:\n- Inventory tool runs\n- Administrative activity\nfields:\n- CommandLine\n- ParentCommandLine\nid: d95de845-b83c-4a9a-8a6a-4fc802ebf6c0\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/02/01\nreferences:\n- https://redcanary.com/blog/how-one-hospital-thwarted-a-ryuk-ransomware-outbreak/\n- https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/\n- https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/\nstatus: experimental\ntags:\n- attack.discovery\n- attack.t1087.001\n- attack.t1087.002\ntitle: Suspicious Group And Account Reconnaissance Activity Using Net.EXE\n",
                            "sigma:id": "d95de845-b83c-4a9a-8a6a-4fc802ebf6c0",
                            "title": "Suspicious Group And Account Reconnaissance Activity Using Net.EXE",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "bed2a484-9348-4143-8a8a-b801c979301c",
                        "lookup_data": {
                            "description": "Detects certain command line parameters often used during reconnaissance activity via web shells",
                            "raw": "author: Florian Roth (Nextron Systems), Jonhnathan Ribeiro, Anton Kutepov, oscd.community\ndate: 2017/01/01\ndescription: Detects certain command line parameters often used during reconnaissance\n  activity via web shells\ndetection:\n  condition: 1 of selection* and 1 of susp*\n  selection_webserver_characteristics_tomcat1:\n    ParentImage|contains:\n    - -tomcat-\n    - \\tomcat\n    ParentImage|endswith:\n    - \\java.exe\n    - \\javaw.exe\n  selection_webserver_characteristics_tomcat2:\n    CommandLine|contains:\n    - catalina.jar\n    - CATALINA_HOME\n    ParentImage|endswith:\n    - \\java.exe\n    - \\javaw.exe\n  selection_webserver_image:\n    ParentImage|endswith:\n    - \\w3wp.exe\n    - \\php-cgi.exe\n    - \\nginx.exe\n    - \\httpd.exe\n    - \\caddy.exe\n    - \\ws_tomcatservice.exe\n  susp_change_dir:\n    CommandLine|contains:\n    - '&cd&echo'\n    - 'cd /d '\n  susp_misc_discovery_binaries:\n  - Image|endswith:\n    - \\whoami.exe\n    - \\systeminfo.exe\n    - \\quser.exe\n    - \\ipconfig.exe\n    - \\pathping.exe\n    - \\tracert.exe\n    - \\netstat.exe\n    - \\schtasks.exe\n    - \\vssadmin.exe\n    - \\wevtutil.exe\n    - \\tasklist.exe\n  - OriginalFileName:\n    - whoami.exe\n    - sysinfo.exe\n    - quser.exe\n    - ipconfig.exe\n    - pathping.exe\n    - tracert.exe\n    - netstat.exe\n    - schtasks.exe\n    - VSSADMIN.EXE\n    - wevtutil.exe\n    - tasklist.exe\n  susp_misc_discovery_commands:\n    CommandLine|contains:\n    - ' Test-NetConnection '\n    - dir \\\n  susp_net_utility:\n    CommandLine|contains:\n    - ' user '\n    - ' use '\n    - ' group '\n    OriginalFileName:\n    - net.exe\n    - net1.exe\n  susp_ping_utility:\n    CommandLine|contains: ' -n '\n    OriginalFileName: ping.exe\n  susp_wmic_utility:\n    CommandLine|contains: ' /node:'\n    OriginalFileName: wmic.exe\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\n- ParentCommandLine\nid: bed2a484-9348-4143-8a8a-b801c979301c\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/05/13\nreferences:\n- https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-ii.html\n- https://unit42.paloaltonetworks.com/bumblebee-webshell-xhunt-campaign/\nstatus: experimental\ntags:\n- attack.persistence\n- attack.t1505.003\n- attack.t1018\n- attack.t1033\n- attack.t1087\ntitle: Webshell Detection With Command Line Keywords\n",
                            "sigma:id": "bed2a484-9348-4143-8a8a-b801c979301c",
                            "title": "Webshell Detection With Command Line Keywords",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "72b74d71-8169-42aa-92e0-e7b04b9f5a08",
                        "lookup_data": {
                            "capec": "CAPEC-575",
                            "mitre-attack-id": "T1087",
                            "mitre-cti:description": "Adversaries may attempt to get a listing of accounts on a system or within an environment. This information can help adversaries determine which accounts exist to aid in follow-on behavior.",
                            "mitre-cti:name": "Account Discovery",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'x_mitre_platforms': ['Windows', 'Azure AD', 'Office 365', 'SaaS', 'IaaS', 'Linux', 'macOS', 'Google Workspace'], 'x_mitre_domains': ['enterprise-attack'], 'x_mitre_contributors': ['Daniel Stepanic, Elastic', 'Microsoft Threat Intelligence Center (MSTIC)', 'Travis Smith, Tripwire'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'attack-pattern--72b74d71-8169-42aa-92e0-e7b04b9f5a08', 'type': 'attack-pattern', 'created': '2017-05-31T21:31:06.988Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'source_name': 'mitre-attack', 'external_id': 'T1087', 'url': 'https://attack.mitre.org/techniques/T1087'}, {'external_id': 'CAPEC-575', 'source_name': 'capec', 'url': 'https://capec.mitre.org/data/definitions/575.html'}, {'source_name': 'Elastic - Koadiac Detection with EQL', 'url': 'https://www.elastic.co/blog/embracing-offensive-tooling-building-detections-against-koadic-using-eql', 'description': 'Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 30, 2020.'}], 'modified': '2021-10-13T14:05:15.038Z', 'name': 'Account Discovery', 'description': 'Adversaries may attempt to get a listing of accounts on a system or within an environment. This information can help adversaries determine which accounts exist to aid in follow-on behavior.', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'discovery'}], 'x_mitre_detection': 'System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\\n\\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\\n\\nMonitor for processes that can be used to enumerate user accounts, such as <code>net.exe</code> and <code>net1.exe</code>, especially when executed in quick succession.(Citation: Elastic - Koadiac Detection with EQL)', 'x_mitre_version': '2.3', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'x_mitre_data_sources': ['File: File Access', 'Command: Command Execution', 'Process: Process Creation'], 'x_mitre_permissions_required': ['User'], 'x_mitre_is_subtechnique': False}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "968eef52-9cff-4454-8992-1e74b9cbad6c",
                        "lookup_data": {
                            "description": "Detects activity as \"net user administrator /domain\" and \"net group domain admins /domain\"",
                            "raw": "author: Florian Roth (Nextron Systems), Jack Croock (method), Jonhnathan Ribeiro (improvements),\n  oscd.community\ndate: 2017/03/07\ndescription: Detects activity as \"net user administrator /domain\" and \"net group domain\n  admins /domain\"\ndetection:\n  condition: selection\n  selection:\n    AccessMask: '0x2d'\n    EventID: 4661\n    ObjectName|endswith:\n    - '-500'\n    - '-512'\n    ObjectName|startswith: S-1-5-21-\n    ObjectType:\n    - SAM_USER\n    - SAM_GROUP\nfalsepositives:\n- Administrator activity\nid: 968eef52-9cff-4454-8992-1e74b9cbad6c\nlevel: high\nlogsource:\n  definition: The volume of Event ID 4661 is high on Domain Controllers and therefore\n    \"Audit SAM\" and \"Audit Kernel Object\" advanced audit policy settings are not configured\n    in the recommendations for server systems\n  product: windows\n  service: security\nmodified: 2022/08/22\nreferences:\n- https://findingbad.blogspot.de/2017/01/hunting-what-does-it-look-like.html\nstatus: test\ntags:\n- attack.discovery\n- attack.t1087.002\n- attack.t1069.002\n- attack.s0039\ntitle: Reconnaissance Activity\n",
                            "sigma:id": "968eef52-9cff-4454-8992-1e74b9cbad6c",
                            "title": "Reconnaissance Activity",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "02030f2f-6199-49ec-b258-ea71b07e03dc",
                        "lookup_data": {
                            "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023/01/02\ndescription: Detects Commandlet names from well-known PowerShell exploitation frameworks\ndetection:\n  condition: selection\n  selection:\n    CommandLine|contains:\n    - Add-Exfiltration\n    - Add-Persistence\n    - Add-RegBackdoor\n    - Add-RemoteRegBackdoor\n    - Add-ScrnSaveBackdoor\n    - Check-VM\n    - ConvertTo-Rc4ByteStream\n    - Decrypt-Hash\n    - Do-Exfiltration\n    - Enabled-DuplicateToken\n    - Exploit-Jboss\n    - Find-Fruit\n    - Find-GPOLocation\n    - Find-TrustedDocuments\n    - Get-ApplicationHost\n    - Get-ChromeDump\n    - Get-ClipboardContents\n    - Get-FoxDump\n    - Get-GPPPassword\n    - Get-IndexedItem\n    - Get-Keystrokes\n    - Get-LSASecret\n    - Get-PassHashes\n    - Get-RegAlwaysInstallElevated\n    - Get-RegAutoLogon\n    - Get-RemoteBootKey\n    - Get-RemoteCachedCredential\n    - Get-RemoteLocalAccountHash\n    - Get-RemoteLSAKey\n    - Get-RemoteMachineAccountHash\n    - Get-RemoteNLKMKey\n    - Get-RickAstley\n    - Get-Screenshot\n    - Get-SecurityPackages\n    - Get-ServiceFilePermission\n    - Get-ServicePermission\n    - Get-ServiceUnquoted\n    - Get-SiteListPassword\n    - Get-System\n    - Get-TimedScreenshot\n    - Get-UnattendedInstallFile\n    - Get-Unconstrained\n    - Get-USBKeystrokes\n    - Get-VaultCredential\n    - Get-VulnAutoRun\n    - Get-VulnSchTask\n    - Gupt-Backdoor\n    - HTTP-Login\n    - Install-ServiceBinary\n    - Install-SSP\n    - Invoke-ACLScanner\n    - Invoke-ADSBackdoor\n    - Invoke-AllChecks\n    - Invoke-ARPScan\n    - Invoke-AzureHound\n    - Invoke-BackdoorLNK\n    - Invoke-BadPotato\n    - Invoke-BetterSafetyKatz\n    - Invoke-BypassUAC\n    - Invoke-Carbuncle\n    - Invoke-Certify\n    - Invoke-ConPtyShell\n    - Invoke-CredentialInjection\n    - Invoke-DAFT\n    - Invoke-DCSync\n    - Invoke-DinvokeKatz\n    - Invoke-DllInjection\n    - Invoke-DomainPasswordSpray\n    - Invoke-DowngradeAccount\n    - Invoke-EgressCheck\n    - Invoke-Eyewitness\n    - Invoke-FakeLogonScreen\n    - Invoke-Farmer\n    - Invoke-Get-RBCD-Threaded\n    - Invoke-Gopher\n    - Invoke-Grouper\n    - Invoke-HandleKatz\n    - Invoke-ImpersonatedProcess\n    - Invoke-ImpersonateSystem\n    - Invoke-InteractiveSystemPowerShell\n    - Invoke-Internalmonologue\n    - Invoke-Inveigh\n    - Invoke-InveighRelay\n    - Invoke-KrbRelay\n    - Invoke-LdapSignCheck\n    - Invoke-Lockless\n    - Invoke-MalSCCM\n    - Invoke-Mimikatz\n    - Invoke-Mimikittenz\n    - Invoke-MITM6\n    - Invoke-NanoDump\n    - Invoke-NetRipper\n    - Invoke-Nightmare\n    - Invoke-NinjaCopy\n    - Invoke-OfficeScrape\n    - Invoke-OxidResolver\n    - Invoke-P0wnedshell\n    - Invoke-Paranoia\n    - Invoke-PortScan\n    - Invoke-PoshRatHttp\n    - Invoke-PostExfil\n    - Invoke-PowerDump\n    - Invoke-PowerShellTCP\n    - Invoke-PowerShellWMI\n    - Invoke-PPLDump\n    - Invoke-PsExec\n    - Invoke-PSInject\n    - Invoke-PsUaCme\n    - Invoke-ReflectivePEInjection\n    - Invoke-ReverseDNSLookup\n    - Invoke-Rubeus\n    - Invoke-RunAs\n    - Invoke-SafetyKatz\n    - Invoke-SauronEye\n    - Invoke-SCShell\n    - Invoke-Seatbelt\n    - Invoke-ServiceAbuse\n    - Invoke-ShadowSpray\n    - Invoke-Sharp\n    - Invoke-Shellcode\n    - Invoke-SMBScanner\n    - Invoke-Snaffler\n    - Invoke-Spoolsample\n    - Invoke-SpraySinglePassword\n    - Invoke-SSHCommand\n    - Invoke-StandIn\n    - Invoke-StickyNotesExtract\n    - Invoke-SystemCommand\n    - Invoke-Tasksbackdoor\n    - Invoke-Tater\n    - Invoke-Thunderfox\n    - Invoke-ThunderStruck\n    - Invoke-TokenManipulation\n    - Invoke-Tokenvator\n    - Invoke-TotalExec\n    - Invoke-UrbanBishop\n    - Invoke-UserHunter\n    - Invoke-VoiceTroll\n    - Invoke-Whisker\n    - Invoke-WinEnum\n    - Invoke-winPEAS\n    - Invoke-WireTap\n    - Invoke-WmiCommand\n    - Invoke-WScriptBypassUAC\n    - Invoke-Zerologon\n    - MailRaider\n    - New-HoneyHash\n    - New-InMemoryModule\n    - Out-Minidump\n    - Port-Scan\n    - PowerBreach\n    - 'powercat '\n    - PowerUp\n    - PowerView\n    - Remove-Update\n    - Set-MacAttribute\n    - Set-Wallpaper\n    - Show-TargetScreen\n    - Start-CaptureServer\n    - Start-WebcamRecorder\n    - VolumeShadowCopyTools\nfalsepositives:\n- Unknown\nid: 02030f2f-6199-49ec-b258-ea71b07e03dc\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/23\nreferences:\n- https://adsecurity.org/?p=2921\n- https://github.com/S3cur3Th1sSh1t/PowerSharpPack/tree/master/PowerSharpBinaries\n- https://github.com/BC-SECURITY/Invoke-ZeroLogon/blob/111d17c7fec486d9bb23387e2e828b09a26075e4/Invoke-ZeroLogon.ps1\n- https://github.com/xorrior/RandomPS-Scripts/blob/848c919bfce4e2d67b626cbcf4404341cfe3d3b6/Get-DXWebcamVideo.ps1\n- https://github.com/rvrsh3ll/Misc-Powershell-Scripts/blob/6f23bb41f9675d7e2d32bacccff75e931ae00554/OfficeMemScraper.ps1\n- https://github.com/dafthack/DomainPasswordSpray/blob/b13d64a5834694aa73fd2aea9911a83027c465a7/DomainPasswordSpray.ps1\n- https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/\n- https://research.nccgroup.com/2022/06/06/shining-the-light-on-black-basta/\n- https://github.com/calebstewart/CVE-2021-1675\n- https://github.com/BloodHoundAD/BloodHound/blob/0927441f67161cc6dc08a53c63ceb8e333f55874/Collectors/AzureHound.ps1\n- https://bloodhound.readthedocs.io/en/latest/data-collection/azurehound.html\n- https://github.com/HarmJ0y/DAMP\n- https://github.com/samratashok/nishang\n- https://github.com/DarkCoderSc/PowerRunAsSystem/\n- https://github.com/besimorhino/powercat\nrelated:\n- id: 89819aa4-bbd6-46bc-88ec-c7f7fe30efa6\n  type: derived\n- id: 7d0d0329-0ef1-4e84-a9f5-49500f9d7c6c\n  type: similar\nstatus: experimental\ntags:\n- attack.execution\n- attack.discovery\n- attack.t1482\n- attack.t1087\n- attack.t1087.001\n- attack.t1087.002\n- attack.t1069.001\n- attack.t1069.002\n- attack.t1069\n- attack.t1059.001\ntitle: Malicious PowerShell Commandlets - ProcessCreation\n",
                            "sigma:id": "02030f2f-6199-49ec-b258-ea71b07e03dc",
                            "title": "Malicious PowerShell Commandlets - ProcessCreation",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "35ba1d85-724d-42a3-889f-2e2362bcaf23",
                        "lookup_data": {
                            "description": "Detect priv users or groups recon based on 4661 eventid and known privileged users or groups SIDs",
                            "raw": "author: Samir Bousseaden\ndate: 2019/04/03\ndescription: Detect priv users or groups recon based on 4661 eventid and known privileged\n  users or groups SIDs\ndetection:\n  condition: selection and selection_object and not filter\n  filter:\n    SubjectUserName|endswith: $\n  selection:\n    EventID: 4661\n    ObjectType:\n    - SAM_USER\n    - SAM_GROUP\n  selection_object:\n  - ObjectName|endswith:\n    - '-512'\n    - '-502'\n    - '-500'\n    - '-505'\n    - '-519'\n    - '-520'\n    - '-544'\n    - '-551'\n    - '-555'\n  - ObjectName|contains: admin\nfalsepositives:\n- If source account name is not an admin then its super suspicious\nid: 35ba1d85-724d-42a3-889f-2e2362bcaf23\nlevel: high\nlogsource:\n  definition: 'Requirements: enable Object Access SAM on your Domain Controllers'\n  product: windows\n  service: security\nmodified: 2022/07/13\nreferences:\n- https://blog.menasec.net/2019/02/threat-hunting-5-detecting-enumeration.html\nstatus: experimental\ntags:\n- attack.discovery\n- attack.t1087.002\ntitle: AD Privileged Users or Groups Reconnaissance\n",
                            "sigma:id": "35ba1d85-724d-42a3-889f-2e2362bcaf23",
                            "title": "AD Privileged Users or Groups Reconnaissance",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "aae1243f-d8af-40d8-ab20-33fc6d0c55bc",
                        "lookup_data": {
                            "description": "Detects usage of the PsLogList utility to dump event log in order to extract admin accounts and perform account discovery or delete events logs",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2021/12/18\ndescription: Detects usage of the PsLogList utility to dump event log in order to\n  extract admin accounts and perform account discovery or delete events logs\ndetection:\n  condition: all of selection_*\n  selection_cli_eventlog:\n    CommandLine|contains:\n    - ' security'\n    - ' application'\n    - ' system'\n  selection_cli_flags:\n    CommandLine|contains:\n    - ' -d'\n    - ' /d'\n    - ' -x'\n    - ' /x'\n    - ' -s'\n    - ' /s'\n    - ' -c'\n    - ' /c'\n    - ' -g'\n    - ' /g'\n  selection_img:\n  - OriginalFileName: psloglist.exe\n  - Image|endswith:\n    - \\psloglist.exe\n    - \\psloglist64.exe\nfalsepositives:\n- Another tool that uses the command line switches of PsLogList\n- Legitimate use of PsLogList by an administrator\nid: aae1243f-d8af-40d8-ab20-33fc6d0c55bc\nlevel: medium\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/16\nreferences:\n- https://research.nccgroup.com/2021/01/12/abusing-cloud-services-to-fly-under-the-radar/\n- https://www.cybereason.com/blog/deadringer-exposing-chinese-threat-actors-targeting-major-telcos\n- https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Sysinternals/PsLogList\n- https://twitter.com/EricaZelic/status/1614075109827874817\nstatus: experimental\ntags:\n- attack.discovery\n- attack.t1087\n- attack.t1087.001\n- attack.t1087.002\ntitle: Suspicious Use of PsLogList\n",
                            "sigma:id": "aae1243f-d8af-40d8-ab20-33fc6d0c55bc",
                            "title": "Suspicious Use of PsLogList",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "04d9079e-3905-4b70-ad37-6bdf11304965",
                        "lookup_data": {
                            "description": "Detects CrackMapExecWin Activity as Described by NCSC",
                            "raw": "author: Markus Neis\ndate: 2018/04/08\ndescription: Detects CrackMapExecWin Activity as Described by NCSC\ndetection:\n  condition: selection\n  selection:\n    Image|endswith: \\crackmapexec.exe\nfalsepositives:\n- Unknown\nid: 04d9079e-3905-4b70-ad37-6bdf11304965\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2021/11/27\nreferences:\n- https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control\n- https://attack.mitre.org/software/S0488/\nstatus: test\ntags:\n- attack.g0035\n- attack.credential_access\n- attack.discovery\n- attack.t1110\n- attack.t1087\ntitle: CrackMapExecWin\n",
                            "sigma:id": "04d9079e-3905-4b70-ad37-6bdf11304965",
                            "title": "CrackMapExecWin",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "66a0bdc6-ee04-441a-9125-99d2eb547942",
                        "lookup_data": {
                            "description": "Domain user and group enumeration via network reconnaissance.\nSeen in APT 29 and other common tactics and actors. Detects a set of RPC (remote procedure calls) used to enumerate a domain controller.\nThe rule was created based off the datasets and hackathon from https://github.com/OTRF/detection-hackathon-apt29\n",
                            "raw": "author: Nate Guagenti (@neu5ron), Open Threat Research (OTR)\ndate: 2020/05/03\ndescription: 'Domain user and group enumeration via network reconnaissance.\n\n  Seen in APT 29 and other common tactics and actors. Detects a set of RPC (remote\n  procedure calls) used to enumerate a domain controller.\n\n  The rule was created based off the datasets and hackathon from https://github.com/OTRF/detection-hackathon-apt29\n\n  '\ndetection:\n  condition: selection | count(operation) by src_ip > 4\n  selection:\n    operation:\n    - LsarLookupNames3\n    - LsarLookupSids3\n    - SamrGetGroupsForUser\n    - SamrLookupIdsInDomain\n    - SamrLookupNamesInDomain\n    - SamrQuerySecurityObject\n    - SamrQueryInformationGroup\n  timeframe: 30s\nfalsepositives:\n- Devices that may do authentication like a VPN or a firewall that looksup IPs to\n  username\n- False positives depend on scripts and administrative tools used in the monitored\n  environment\nid: 66a0bdc6-ee04-441a-9125-99d2eb547942\nlevel: medium\nlogsource:\n  product: zeek\n  service: dce_rpc\nmodified: 2022/12/25\nreferences:\n- https://github.com/OTRF/detection-hackathon-apt29\n- https://github.com/OTRF/detection-hackathon-apt29/issues/37\nstatus: test\ntags:\n- attack.discovery\n- attack.t1087.002\n- attack.t1082\ntitle: Domain User Enumeration Network Recon 01\n",
                            "sigma:id": "66a0bdc6-ee04-441a-9125-99d2eb547942",
                            "title": "Domain User Enumeration Network Recon 01",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "619b020f-0fd7-4f23-87db-3f51ef837a34",
                        "lookup_data": {
                            "description": "Detects enumeration of the global catalog (that can be performed using BloodHound or others AD reconnaissance tools). Adjust Threshold according to domain width.",
                            "raw": "author: Chakib Gzenayi (@Chak092), Hosni Mribah\ndate: 2020/05/11\ndescription: Detects enumeration of the global catalog (that can be performed using\n  BloodHound or others AD reconnaissance tools). Adjust Threshold according to domain\n  width.\ndetection:\n  condition: selection | count() by SourceAddress > 2000\n  selection:\n    DestPort:\n    - 3268\n    - 3269\n    EventID: 5156\n  timeframe: 1h\nfalsepositives:\n- Exclude known DCs.\nid: 619b020f-0fd7-4f23-87db-3f51ef837a34\nlevel: medium\nlogsource:\n  definition: The advanced audit policy setting \"Windows Filtering Platform > Filtering\n    Platform Connection\" must be configured for Success\n  product: windows\n  service: security\nmodified: 2022/08/15\nreferences:\n- https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-5156\nstatus: experimental\ntags:\n- attack.discovery\n- attack.t1087.002\ntitle: Enumeration via the Global Catalog\n",
                            "sigma:id": "619b020f-0fd7-4f23-87db-3f51ef837a34",
                            "title": "Enumeration via the Global Catalog",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "fa3c117a-bc0d-416e-a31b-0c0e80653efb",
                        "lookup_data": {
                            "description": "Detects patterns found in process executions cause by China Chopper like tiny (ASPX) webshells",
                            "raw": "author: Florian Roth (Nextron Systems), MSTI (query)\ndate: 2022/10/01\ndescription: Detects patterns found in process executions cause by China Chopper like\n  tiny (ASPX) webshells\ndetection:\n  condition: all of selection*\n  selection_cmdline:\n    CommandLine|contains:\n    - '&ipconfig&echo'\n    - '&quser&echo'\n    - '&whoami&echo'\n    - '&c:&echo'\n    - '&cd&echo'\n    - '&dir&echo'\n    - '&echo [E]'\n    - '&echo [S]'\n  selection_origin:\n  - Image|endswith: \\w3wp.exe\n  - ParentImage|endswith: \\w3wp.exe\nfalsepositives:\n- Unknown\nid: fa3c117a-bc0d-416e-a31b-0c0e80653efb\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://www.microsoft.com/security/blog/2022/09/30/analyzing-attacks-using-the-exchange-vulnerabilities-cve-2022-41040-and-cve-2022-41082/\nstatus: experimental\ntags:\n- attack.persistence\n- attack.t1505.003\n- attack.t1018\n- attack.t1033\n- attack.t1087\ntitle: Chopper Webshell Process Pattern\n",
                            "sigma:id": "fa3c117a-bc0d-416e-a31b-0c0e80653efb",
                            "title": "Chopper Webshell Process Pattern",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "502b42de-4306-40b4-9596-6f590c81f073",
                        "lookup_data": {
                            "description": "Local accounts, System Owner/User discovery using operating systems utilities",
                            "raw": "author: Timur Zinniatullin, Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/21\ndescription: Local accounts, System Owner/User discovery using operating systems utilities\ndetection:\n  condition: (selection_cmd and not filter_cmd) or (selection_net and not filter_net)\n    or 1 of selection_other_*\n  filter_cmd:\n    CommandLine|contains: ' rmdir '\n  filter_net:\n    CommandLine|contains:\n    - /domain\n    - /add\n    - /delete\n    - /active\n    - /expires\n    - /passwordreq\n    - /scriptpath\n    - /times\n    - /workstations\n  selection_cmd:\n    CommandLine|contains|all:\n    - ' /c'\n    - 'dir '\n    - \\Users\\\n    Image|endswith: \\cmd.exe\n  selection_net:\n    CommandLine|contains: user\n    Image|endswith:\n    - \\net.exe\n    - \\net1.exe\n  selection_other_cmdkey:\n    CommandLine|contains: ' /l'\n    Image|endswith: \\cmdkey.exe\n  selection_other_img:\n    Image|endswith:\n    - \\whoami.exe\n    - \\quser.exe\n    - \\qwinsta.exe\n  selection_other_wmi:\n    CommandLine|contains|all:\n    - useraccount\n    - get\n    Image|endswith: \\wmic.exe\nfalsepositives:\n- Legitimate administrator or user enumerates local users for legitimate reason\nid: 502b42de-4306-40b4-9596-6f590c81f073\nlevel: low\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/03\nreferences:\n- https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1033/T1033.md\nstatus: test\ntags:\n- attack.discovery\n- attack.t1033\n- attack.t1087.001\ntitle: Local Accounts Discovery\n",
                            "sigma:id": "502b42de-4306-40b4-9596-6f590c81f073",
                            "title": "Local Accounts Discovery",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "4ebc877f-4612-45cb-b3a5-8e3834db36c9",
                        "lookup_data": {
                            "description": "Detects certain parent child patterns found in cases in which a webshell is used to perform certain credential dumping or exfiltration activities on a compromised system",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2022/03/17\ndescription: Detects certain parent child patterns found in cases in which a webshell\n  is used to perform certain credential dumping or exfiltration activities on a compromised\n  system\ndetection:\n  condition: 1 of selection_webserver* and 1 of selection_child*\n  selection_child_1:\n    CommandLine|contains|all:\n    - rundll32\n    - comsvcs\n  selection_child_2:\n    CommandLine|contains|all:\n    - ' -hp'\n    - ' a '\n    - ' -m'\n  selection_child_3:\n    CommandLine|contains|all:\n    - net\n    - ' user '\n    - ' /add'\n  selection_child_4:\n    CommandLine|contains|all:\n    - net\n    - ' localgroup '\n    - ' administrators '\n    - /add\n  selection_child_5:\n    Image|endswith:\n    - \\ntdsutil.exe\n    - \\ldifde.exe\n    - \\adfind.exe\n    - \\procdump.exe\n    - \\Nanodump.exe\n    - \\vssadmin.exe\n    - \\fsutil.exe\n  selection_child_6:\n    CommandLine|contains:\n    - ' -NoP '\n    - ' -W Hidden '\n    - ' -decode '\n    - ' /decode '\n    - 'reg save '\n    - .downloadstring(\n    - .downloadfile(\n    - FromBase64String\n    - ' /ticket:'\n    - ' sekurlsa'\n    - .dmp full\n    - process call create\n    - whoami /priv\n  selection_webserver_characteristics_tomcat1:\n    ParentImage|contains:\n    - -tomcat-\n    - \\tomcat\n    ParentImage|endswith:\n    - \\java.exe\n    - \\javaw.exe\n  selection_webserver_characteristics_tomcat2:\n    CommandLine|contains:\n    - catalina.jar\n    - CATALINA_HOME\n    ParentImage|endswith:\n    - \\java.exe\n    - \\javaw.exe\n  selection_webserver_image:\n    ParentImage|endswith:\n    - \\w3wp.exe\n    - \\php-cgi.exe\n    - \\nginx.exe\n    - \\httpd.exe\n    - \\caddy.exe\n    - \\ws_tomcatservice.exe\nfalsepositives:\n- Unlikely\nid: 4ebc877f-4612-45cb-b3a5-8e3834db36c9\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/08/04\nreferences:\n- https://youtu.be/7aemGhaE9ds?t=641\nstatus: experimental\ntags:\n- attack.persistence\n- attack.t1505.003\n- attack.t1018\n- attack.t1033\n- attack.t1087\ntitle: Webshell Hacking Activity Patterns\n",
                            "sigma:id": "4ebc877f-4612-45cb-b3a5-8e3834db36c9",
                            "title": "Webshell Hacking Activity Patterns",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "38646daa-e78f-4ace-9de0-55547b2d30da",
                        "lookup_data": {
                            "description": "Detects the execution of the PUA/Recon tool Seatbelt via PE information of command line parameters",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2022/10/18\ndescription: Detects the execution of the PUA/Recon tool Seatbelt via PE information\n  of command line parameters\ndetection:\n  condition: selection or all of group_*\n  group_list:\n    CommandLine|contains:\n    - ' -group=misc'\n    - ' -group=remote'\n    - ' -group=chromium'\n    - ' -group=slack'\n    - ' -group=system'\n    - ' -group=user'\n    - ' -group=all'\n  group_output:\n    CommandLine|contains: ' -outputfile='\n  selection:\n  - Image|endswith: \\Seatbelt.exe\n  - OriginalFileName: Seatbelt.exe\n  - Description: Seatbelt\n  - CommandLine|contains:\n    - ' DpapiMasterKeys'\n    - ' InterestingProcesses'\n    - ' InterestingFiles'\n    - ' CertificateThumbprints'\n    - ' ChromiumBookmarks'\n    - ' ChromiumHistory'\n    - ' ChromiumPresence'\n    - ' CloudCredentials'\n    - ' CredEnum'\n    - ' CredGuard'\n    - ' FirefoxHistory'\n    - ' ProcessCreationEvents'\nfalsepositives:\n- Unlikely\nid: 38646daa-e78f-4ace-9de0-55547b2d30da\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nreferences:\n- https://github.com/GhostPack/Seatbelt\n- https://www.bluetangle.dev/2022/08/fastening-seatbelt-on-threat-hunting.html\nstatus: experimental\ntags:\n- attack.discovery\n- attack.t1526\n- attack.t1087\n- attack.t1083\ntitle: Seatbelt PUA Tool\n",
                            "sigma:id": "38646daa-e78f-4ace-9de0-55547b2d30da",
                            "title": "Seatbelt PUA Tool",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5c49bc54-9929-48ca-b581-7018219b5a97",
                        "lookup_data": {
                            "mitre-attack-id": "T1087",
                            "mitre-cti:description": "Prevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located <code>HKLM\\ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators</code>. It can be disabled through GPO: Computer Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: E numerate administrator accounts on elevation. (Citation: UCF STIG Elevation Account Enumeration)\n\nIdentify unnecessary system utilities or potentially malicious software that may be used to acquire information about system and domain accounts, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)",
                            "mitre-cti:name": "Account Discovery Mitigation",
                            "mitre-cti:type": "course-of-action",
                            "raw": "{'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'course-of-action--5c49bc54-9929-48ca-b581-7018219b5a97', 'type': 'course-of-action', 'created': '2018-10-17T00:14:20.652Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'external_id': 'T1087', 'url': 'https://attack.mitre.org/mitigations/T1087', 'source_name': 'mitre-attack'}, {'url': 'https://www.stigviewer.com/stig/microsoft_windows_server_2012_member_server/2013-07-25/finding/WN12-CC-000077', 'description': 'UCF. (n.d.). The system must require username and password to elevate a running application.. Retrieved December 18, 2017.', 'source_name': 'UCF STIG Elevation Account Enumeration'}, {'url': 'http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599', 'description': 'Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.', 'source_name': 'Beechey 2010'}, {'url': 'https://blogs.jpcert.or.jp/en/2016/01/windows-commands-abused-by-attackers.html', 'description': 'Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.', 'source_name': 'Windows Commands JPCERT'}, {'url': 'https://apps.nsa.gov/iaarchive/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm', 'description': 'NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.', 'source_name': 'NSA MS AppLocker'}, {'url': 'http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx', 'description': 'Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.', 'source_name': 'Corio 2008'}, {'url': 'https://technet.microsoft.com/en-us/library/ee791851.aspx', 'description': 'Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.', 'source_name': 'TechNet Applocker vs SRP'}], 'modified': '2021-08-23T20:25:18.116Z', 'name': 'Account Discovery Mitigation', 'description': 'Prevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located <code>HKLM\\\\ SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\CredUI\\\\EnumerateAdministrators</code>. It can be disabled through GPO: Computer Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: E numerate administrator accounts on elevation. (Citation: UCF STIG Elevation Account Enumeration)\\n\\nIdentify unnecessary system utilities or potentially malicious software that may be used to acquire information about system and domain accounts, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)', 'x_mitre_deprecated': True, 'x_mitre_version': '1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "7d0d0329-0ef1-4e84-a9f5-49500f9d7c6c",
                        "lookup_data": {
                            "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks",
                            "raw": "author: Nasreddine Bencherchali (Nextron Systems)\ndate: 2023/01/20\ndescription: Detects Commandlet names from well-known PowerShell exploitation frameworks\ndetection:\n  condition: selection\n  selection:\n    Payload|contains:\n    - Add-Exfiltration\n    - Add-Persistence\n    - Add-RegBackdoor\n    - Add-RemoteRegBackdoor\n    - Add-ScrnSaveBackdoor\n    - Check-VM\n    - ConvertTo-Rc4ByteStream\n    - Decrypt-Hash\n    - Do-Exfiltration\n    - Enabled-DuplicateToken\n    - Exploit-Jboss\n    - Find-Fruit\n    - Find-GPOLocation\n    - Find-TrustedDocuments\n    - Get-ApplicationHost\n    - Get-ChromeDump\n    - Get-ClipboardContents\n    - Get-FoxDump\n    - Get-GPPPassword\n    - Get-IndexedItem\n    - Get-Keystrokes\n    - Get-LSASecret\n    - Get-PassHashes\n    - Get-RegAlwaysInstallElevated\n    - Get-RegAutoLogon\n    - Get-RemoteBootKey\n    - Get-RemoteCachedCredential\n    - Get-RemoteLocalAccountHash\n    - Get-RemoteLSAKey\n    - Get-RemoteMachineAccountHash\n    - Get-RemoteNLKMKey\n    - Get-RickAstley\n    - Get-Screenshot\n    - Get-SecurityPackages\n    - Get-ServiceFilePermission\n    - Get-ServicePermission\n    - Get-ServiceUnquoted\n    - Get-SiteListPassword\n    - Get-System\n    - Get-TimedScreenshot\n    - Get-UnattendedInstallFile\n    - Get-Unconstrained\n    - Get-USBKeystrokes\n    - Get-VaultCredential\n    - Get-VulnAutoRun\n    - Get-VulnSchTask\n    - Gupt-Backdoor\n    - HTTP-Login\n    - Install-ServiceBinary\n    - Install-SSP\n    - Invoke-ACLScanner\n    - Invoke-ADSBackdoor\n    - Invoke-AllChecks\n    - Invoke-ARPScan\n    - Invoke-AzureHound\n    - Invoke-BackdoorLNK\n    - Invoke-BadPotato\n    - Invoke-BetterSafetyKatz\n    - Invoke-BypassUAC\n    - Invoke-Carbuncle\n    - Invoke-Certify\n    - Invoke-ConPtyShell\n    - Invoke-CredentialInjection\n    - Invoke-DAFT\n    - Invoke-DCSync\n    - Invoke-DinvokeKatz\n    - Invoke-DllInjection\n    - Invoke-DomainPasswordSpray\n    - Invoke-DowngradeAccount\n    - Invoke-EgressCheck\n    - Invoke-Eyewitness\n    - Invoke-FakeLogonScreen\n    - Invoke-Farmer\n    - Invoke-Get-RBCD-Threaded\n    - Invoke-Gopher\n    - Invoke-Grouper\n    - Invoke-HandleKatz\n    - Invoke-ImpersonatedProcess\n    - Invoke-ImpersonateSystem\n    - Invoke-InteractiveSystemPowerShell\n    - Invoke-Internalmonologue\n    - Invoke-Inveigh\n    - Invoke-InveighRelay\n    - Invoke-KrbRelay\n    - Invoke-LdapSignCheck\n    - Invoke-Lockless\n    - Invoke-MalSCCM\n    - Invoke-Mimikatz\n    - Invoke-Mimikittenz\n    - Invoke-MITM6\n    - Invoke-NanoDump\n    - Invoke-NetRipper\n    - Invoke-Nightmare\n    - Invoke-NinjaCopy\n    - Invoke-OfficeScrape\n    - Invoke-OxidResolver\n    - Invoke-P0wnedshell\n    - Invoke-Paranoia\n    - Invoke-PortScan\n    - Invoke-PoshRatHttp\n    - Invoke-PostExfil\n    - Invoke-PowerDump\n    - Invoke-PowerShellTCP\n    - Invoke-PowerShellWMI\n    - Invoke-PPLDump\n    - Invoke-PsExec\n    - Invoke-PSInject\n    - Invoke-PsUaCme\n    - Invoke-ReflectivePEInjection\n    - Invoke-ReverseDNSLookup\n    - Invoke-Rubeus\n    - Invoke-RunAs\n    - Invoke-SafetyKatz\n    - Invoke-SauronEye\n    - Invoke-SCShell\n    - Invoke-Seatbelt\n    - Invoke-ServiceAbuse\n    - Invoke-ShadowSpray\n    - Invoke-Sharp\n    - Invoke-Shellcode\n    - Invoke-SMBScanner\n    - Invoke-Snaffler\n    - Invoke-Spoolsample\n    - Invoke-SpraySinglePassword\n    - Invoke-SSHCommand\n    - Invoke-StandIn\n    - Invoke-StickyNotesExtract\n    - Invoke-SystemCommand\n    - Invoke-Tasksbackdoor\n    - Invoke-Tater\n    - Invoke-Thunderfox\n    - Invoke-ThunderStruck\n    - Invoke-TokenManipulation\n    - Invoke-Tokenvator\n    - Invoke-TotalExec\n    - Invoke-UrbanBishop\n    - Invoke-UserHunter\n    - Invoke-VoiceTroll\n    - Invoke-Whisker\n    - Invoke-WinEnum\n    - Invoke-winPEAS\n    - Invoke-WireTap\n    - Invoke-WmiCommand\n    - Invoke-WScriptBypassUAC\n    - Invoke-Zerologon\n    - MailRaider\n    - New-HoneyHash\n    - New-InMemoryModule\n    - Out-Minidump\n    - Port-Scan\n    - PowerBreach\n    - 'powercat '\n    - PowerUp\n    - PowerView\n    - Remove-Update\n    - Set-MacAttribute\n    - Set-Wallpaper\n    - Show-TargetScreen\n    - Start-CaptureServer\n    - Start-WebcamRecorder\n    - VolumeShadowCopyTools\nfalsepositives:\n- Unknown\nid: 7d0d0329-0ef1-4e84-a9f5-49500f9d7c6c\nlevel: high\nlogsource:\n  category: ps_module\n  definition: 'Requirements: PowerShell Module Logging must be enabled'\n  product: windows\nmodified: 2023/01/23\nreferences:\n- https://adsecurity.org/?p=2921\n- https://github.com/S3cur3Th1sSh1t/PowerSharpPack/tree/master/PowerSharpBinaries\n- https://github.com/BC-SECURITY/Invoke-ZeroLogon/blob/111d17c7fec486d9bb23387e2e828b09a26075e4/Invoke-ZeroLogon.ps1\n- https://github.com/xorrior/RandomPS-Scripts/blob/848c919bfce4e2d67b626cbcf4404341cfe3d3b6/Get-DXWebcamVideo.ps1\n- https://github.com/rvrsh3ll/Misc-Powershell-Scripts/blob/6f23bb41f9675d7e2d32bacccff75e931ae00554/OfficeMemScraper.ps1\n- https://github.com/dafthack/DomainPasswordSpray/blob/b13d64a5834694aa73fd2aea9911a83027c465a7/DomainPasswordSpray.ps1\n- https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/\n- https://research.nccgroup.com/2022/06/06/shining-the-light-on-black-basta/\n- https://github.com/calebstewart/CVE-2021-1675\n- https://github.com/BloodHoundAD/BloodHound/blob/0927441f67161cc6dc08a53c63ceb8e333f55874/Collectors/AzureHound.ps1\n- https://bloodhound.readthedocs.io/en/latest/data-collection/azurehound.html\n- https://github.com/HarmJ0y/DAMP\n- https://github.com/samratashok/nishang\n- https://github.com/DarkCoderSc/PowerRunAsSystem/\n- https://github.com/besimorhino/powercat\nrelated:\n- id: 89819aa4-bbd6-46bc-88ec-c7f7fe30efa6\n  type: similar\n- id: 02030f2f-6199-49ec-b258-ea71b07e03dc\n  type: similar\nstatus: test\ntags:\n- attack.execution\n- attack.discovery\n- attack.t1482\n- attack.t1087\n- attack.t1087.001\n- attack.t1087.002\n- attack.t1069.001\n- attack.t1069.002\n- attack.t1069\n- attack.t1059.001\ntitle: Malicious PowerShell Commandlets - PoshModule\n",
                            "sigma:id": "7d0d0329-0ef1-4e84-a9f5-49500f9d7c6c",
                            "title": "Malicious PowerShell Commandlets - PoshModule",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "cd072b25-a418-4f98-8ebc-5093fb38fe1a",
                        "lookup_data": {
                            "description": "Collect pertinent data from the configuration files",
                            "raw": "author: Austin Clark\ndate: 2019/08/11\ndescription: Collect pertinent data from the configuration files\ndetection:\n  condition: keywords\n  keywords:\n  - show running-config\n  - show startup-config\n  - show archive config\n  - more\nfalsepositives:\n- Commonly run by administrators\nfields:\n- src\n- CmdSet\n- User\n- Privilege_Level\n- Remote_Address\nid: cd072b25-a418-4f98-8ebc-5093fb38fe1a\nlevel: low\nlogsource:\n  product: cisco\n  service: aaa\nmodified: 2023/01/04\nstatus: test\ntags:\n- attack.discovery\n- attack.credential_access\n- attack.collection\n- attack.t1087.001\n- attack.t1552.001\n- attack.t1005\ntitle: Cisco Collect Data\n",
                            "sigma:id": "cd072b25-a418-4f98-8ebc-5093fb38fe1a",
                            "title": "Cisco Collect Data",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "5e55be1a-3a30-48ae-9934-4199950d210f",
                        "lookup_data": {
                            "description": "Interesting Recon Script",
                            "link": "https://www.circl.lu/doc/misp/feed-osint/5e55be1a-3a30-48ae-9934-4199950d210f.json",
                            "misp:feed": "https://www.circl.lu/doc/misp/feed-osint",
                            "timestamp": "1582912038",
                            "uuid": "5e55be1a-3a30-48ae-9934-4199950d210f",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": []
    },
    "timestamp": "2025-02-28 12:37:54"
}