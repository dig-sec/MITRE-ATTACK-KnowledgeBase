{
    "id": "T1210",
    "name": "Exploitation of Remote Services",
    "description": "Adversaries may exploit remote services to gain unauthorized access to internal systems once inside of a network. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. A common goal for post-compromise exploitation of remote services is for lateral movement to enable access to a remote system.\nAn adversary may need to determine if the remote system is in a vulnerable state, which may be done through [Network Service Scanning](T1046) or other Discovery methods looking for common, vulnerable software that may be deployed in the network, the lack of certain patches that may indicate vulnerabilities,  or security software that may be used to detect or contain remote exploitation. Servers are likely a high value target for lateral movement exploitation, but endpoint systems may also be at risk if they provide an advantage or access to additional resources.\nThere are several well-known vulnerabilities that exist in common services such as SMB (Citation: CIS Multiple SMB Vulnerabilities) and RDP (Citation: NVD CVE-2017-0176) as well as applications that may be used within internal networks such as MySQL (Citation: NVD CVE-2016-6662) and web server services. (Citation: NVD CVE-2014-7169)\nDepending on the permissions level of the vulnerable remote service an adversary may achieve [Exploitation for Privilege Escalation](T1068) as a result of lateral movement exploitation as well.",
    "platforms": "Linux, Windows, macOS",
    "kill_chain_phases": "Lateral Movement",
    "data_sources": "Application Log: Application Log Content, Network Traffic: Network Traffic Content",
    "detection": "Detecting software exploitation may be difficult depending on the tools available. Software exploits may not always succeed or may cause the exploited process to become unstable or crash. Also look for behavior on the endpoint system that might indicate successful compromise, such as abnormal behavior of the processes. This could include suspicious files written to disk, evidence of [Process Injection](T1055) for attempts to hide execution, evidence of Discovery, or other unusual network traffic that may indicate additional tools transferred to the system.",
    "url": "https://attack.mitre.org/techniques/T1210",
    "enrichments": {
        "attack_rule_map": [],
        "cycat": {
            "cycat": {
                "cycat_related_uuids": [
                    "14b63e6b-7531-4476-9e60-02cc5db48b62",
                    "48d91a3a-2363-43ba-a456-ca71ac3da5c2",
                    "9db0cf3a-a3c9-4012-8268-123b9db6fd82",
                    "41d40bff-377a-43e2-8e1b-2e543069e079",
                    "aaa5b30d-f418-420b-83a0-299cb6024885",
                    "ab6b1a39-a9ee-4ab4-b075-e83acf6e346b",
                    "1012f107-b8f1-4271-af30-5aed2de89b39",
                    "c92f1896-d1d2-43c3-92d5-7a5b35c217bb",
                    "18f37338-b9bd-4117-a039-280c81f7a596",
                    "8400629e-79a9-4737-b387-5db940ab2367"
                ],
                "lookup_results": [
                    {
                        "uuid": "14b63e6b-7531-4476-9e60-02cc5db48b62",
                        "lookup_data": {
                            "mitre-attack-id": "T1210",
                            "mitre-cti:description": "Segment networks and systems appropriately to reduce access to critical systems and services to controlled methods. Minimize available services to only those that are necessary. Regularly scan the internal network for available services to identify new and potentially vulnerable services. Minimize permissions and access for service accounts to limit impact of exploitation.\n\nUpdate software regularly by employing patch management for internal enterprise endpoints and servers. Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization. Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing, if available. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of exploitation. The risks of additional exploits and weaknesses in implementation may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)\n\nSecurity applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. (Citation: TechNet Moving Beyond EMET) Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. (Citation: Wikipedia Control Flow Integrity) Many of these protections depend on the architecture and target application binary for compatibility and may not work for all software or services targeted.",
                            "mitre-cti:name": "Exploitation of Remote Services Mitigation",
                            "mitre-cti:type": "course-of-action",
                            "raw": "{'x_mitre_domains': ['enterprise-attack'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'course-of-action--14b63e6b-7531-4476-9e60-02cc5db48b62', 'type': 'course-of-action', 'created': '2018-10-17T00:14:20.652Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'source_name': 'mitre-attack', 'url': 'https://attack.mitre.org/mitigations/T1210', 'external_id': 'T1210'}, {'source_name': 'Ars Technica Pwn2Own 2017 VM Escape', 'description': 'Goodin, D. (2017, March 17). Virtual machine escape fetches $105,000 at Pwn2Own hacking contest - updated. Retrieved March 12, 2018.', 'url': 'https://arstechnica.com/information-technology/2017/03/hack-that-escapes-vm-by-exploiting-edge-browser-fetches-105000-at-pwn2own/'}, {'source_name': 'TechNet Moving Beyond EMET', 'description': 'Nunez, N. (2017, August 9). Moving Beyond EMET II – Windows Defender Exploit Guard. Retrieved March 12, 2018.', 'url': 'https://blogs.technet.microsoft.com/srd/2017/08/09/moving-beyond-emet-ii-windows-defender-exploit-guard/'}, {'source_name': 'Wikipedia Control Flow Integrity', 'description': 'Wikipedia. (2018, January 11). Control-flow integrity. Retrieved March 12, 2018.', 'url': 'https://en.wikipedia.org/wiki/Control-flow_integrity'}], 'modified': '2019-07-24T19:26:53.547Z', 'name': 'Exploitation of Remote Services Mitigation', 'description': 'Segment networks and systems appropriately to reduce access to critical systems and services to controlled methods. Minimize available services to only those that are necessary. Regularly scan the internal network for available services to identify new and potentially vulnerable services. Minimize permissions and access for service accounts to limit impact of exploitation.\\n\\nUpdate software regularly by employing patch management for internal enterprise endpoints and servers. Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization. Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing, if available. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of exploitation. The risks of additional exploits and weaknesses in implementation may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)\\n\\nSecurity applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. (Citation: TechNet Moving Beyond EMET) Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. (Citation: Wikipedia Control Flow Integrity) Many of these protections depend on the architecture and target application binary for compatibility and may not work for all software or services targeted.', 'x_mitre_deprecated': True, 'x_mitre_version': '1.0', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5'}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "48d91a3a-2363-43ba-a456-ca71ac3da5c2",
                        "lookup_data": {
                            "description": "Detects events generated by user-mode applications when they call the CveEventWrite API when a known vulnerability is trying to be exploited.\nMS started using this log in Jan. 2020 with CVE-2020-0601 (a Windows CryptoAPI vulnerability.\nUnfortunately, that is about the only instance of CVEs being written to this log.\n",
                            "raw": "author: Florian Roth (Nextron Systems), Zach Mathis\ndate: 2020/01/15\ndescription: 'Detects events generated by user-mode applications when they call the\n  CveEventWrite API when a known vulnerability is trying to be exploited.\n\n  MS started using this log in Jan. 2020 with CVE-2020-0601 (a Windows CryptoAPI vulnerability.\n\n  Unfortunately, that is about the only instance of CVEs being written to this log.\n\n  '\ndetection:\n  condition: selection\n  selection:\n    EventID: 1\n    Provider_Name:\n    - Microsoft-Windows-Audit-CVE\n    - Audit-CVE\nfalsepositives:\n- Unknown\nid: 48d91a3a-2363-43ba-a456-ca71ac3da5c2\nlevel: critical\nlogsource:\n  product: windows\n  service: application\nmodified: 2022/10/22\nreferences:\n- https://twitter.com/VM_vivisector/status/1217190929330655232\n- https://twitter.com/DidierStevens/status/1217533958096924676\n- https://twitter.com/FlemmingRiis/status/1217147415482060800\n- https://www.youtube.com/watch?v=ebmW42YYveI\n- https://nullsec.us/windows-event-log-audit-cve/\nstatus: experimental\ntags:\n- attack.execution\n- attack.t1203\n- attack.privilege_escalation\n- attack.t1068\n- attack.defense_evasion\n- attack.t1211\n- attack.credential_access\n- attack.t1212\n- attack.lateral_movement\n- attack.t1210\n- attack.impact\n- attack.t1499.004\ntitle: Audit CVE Event\n",
                            "sigma:id": "48d91a3a-2363-43ba-a456-ca71ac3da5c2",
                            "title": "Audit CVE Event",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "9db0cf3a-a3c9-4012-8268-123b9db6fd82",
                        "lookup_data": {
                            "mitre-attack-id": "T1210",
                            "mitre-cti:description": "Adversaries may exploit remote services to gain unauthorized access to internal systems once inside of a network. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. A common goal for post-compromise exploitation of remote services is for lateral movement to enable access to a remote system.\n\nAn adversary may need to determine if the remote system is in a vulnerable state, which may be done through [Network Service Discovery](https://attack.mitre.org/techniques/T1046) or other Discovery methods looking for common, vulnerable software that may be deployed in the network, the lack of certain patches that may indicate vulnerabilities,  or security software that may be used to detect or contain remote exploitation. Servers are likely a high value target for lateral movement exploitation, but endpoint systems may also be at risk if they provide an advantage or access to additional resources.\n\nThere are several well-known vulnerabilities that exist in common services such as SMB (Citation: CIS Multiple SMB Vulnerabilities) and RDP (Citation: NVD CVE-2017-0176) as well as applications that may be used within internal networks such as MySQL (Citation: NVD CVE-2016-6662) and web server services.(Citation: NVD CVE-2014-7169)\n\nDepending on the permissions level of the vulnerable remote service an adversary may achieve [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068) as a result of lateral movement exploitation as well.",
                            "mitre-cti:name": "Exploitation of Remote Services",
                            "mitre-cti:type": "attack-pattern",
                            "raw": "{'x_mitre_platforms': ['Linux', 'Windows', 'macOS'], 'x_mitre_domains': ['enterprise-attack'], 'x_mitre_contributors': ['ExtraHop'], 'object_marking_refs': ['marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168'], 'id': 'attack-pattern--9db0cf3a-a3c9-4012-8268-123b9db6fd82', 'type': 'attack-pattern', 'created': '2018-04-18T17:59:24.739Z', 'created_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'external_references': [{'source_name': 'mitre-attack', 'external_id': 'T1210', 'url': 'https://attack.mitre.org/techniques/T1210'}, {'url': 'https://www.cisecurity.org/advisory/multiple-vulnerabilities-in-microsoft-windows-smb-server-could-allow-for-remote-code-execution/', 'description': 'CIS. (2017, May 15). Multiple Vulnerabilities in Microsoft Windows SMB Server Could Allow for Remote Code Execution. Retrieved April 3, 2018.', 'source_name': 'CIS Multiple SMB Vulnerabilities'}, {'url': 'https://nvd.nist.gov/vuln/detail/CVE-2017-0176', 'description': 'National Vulnerability Database. (2017, June 22). CVE-2017-0176 Detail. Retrieved April 3, 2018.', 'source_name': 'NVD CVE-2017-0176'}, {'url': 'https://nvd.nist.gov/vuln/detail/CVE-2016-6662', 'description': 'National Vulnerability Database. (2017, February 2). CVE-2016-6662 Detail. Retrieved April 3, 2018.', 'source_name': 'NVD CVE-2016-6662'}, {'url': 'https://nvd.nist.gov/vuln/detail/CVE-2014-7169', 'description': 'National Vulnerability Database. (2017, September 24). CVE-2014-7169 Detail. Retrieved April 3, 2018.', 'source_name': 'NVD CVE-2014-7169'}], 'modified': '2022-02-24T15:06:46.006Z', 'name': 'Exploitation of Remote Services', 'description': 'Adversaries may exploit remote services to gain unauthorized access to internal systems once inside of a network. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code.\\xa0A common goal for post-compromise exploitation of remote services is for lateral movement to enable access to a remote system.\\n\\nAn adversary may need to determine if the remote system is in a vulnerable state, which may be done through [Network Service Discovery](https://attack.mitre.org/techniques/T1046) or other Discovery methods looking for common, vulnerable software that may be deployed in the network, the lack of certain patches that may indicate vulnerabilities,  or security software that may be used to detect or contain remote exploitation. Servers are likely a high value target for lateral movement exploitation, but endpoint systems may also be at risk if they provide an advantage or access to additional resources.\\n\\nThere are several well-known vulnerabilities that exist in common services such as SMB (Citation: CIS Multiple SMB Vulnerabilities) and RDP (Citation: NVD CVE-2017-0176) as well as applications that may be used within internal networks such as MySQL (Citation: NVD CVE-2016-6662) and web server services.(Citation: NVD CVE-2014-7169)\\n\\nDepending on the permissions level of the vulnerable remote service an adversary may achieve [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068) as a result of lateral movement exploitation as well.', 'kill_chain_phases': [{'kill_chain_name': 'mitre-attack', 'phase_name': 'lateral-movement'}], 'x_mitre_detection': 'Detecting software exploitation may be difficult depending on the tools available. Software exploits may not always succeed or may cause the exploited process to become unstable or crash. Also look for behavior on the endpoint system that might indicate successful compromise, such as abnormal behavior of the processes. This could include suspicious files written to disk, evidence of [Process Injection](https://attack.mitre.org/techniques/T1055) for attempts to hide execution, evidence of [Discovery](https://attack.mitre.org/tactics/TA0007), or other unusual network traffic that may indicate additional tools transferred to the system.', 'x_mitre_version': '1.1', 'x_mitre_modified_by_ref': 'identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5', 'x_mitre_data_sources': ['Application Log: Application Log Content', 'Network Traffic: Network Traffic Content'], 'x_mitre_permissions_required': ['User'], 'x_mitre_system_requirements': ['Unpatched software or otherwise vulnerable target. Depending on the target and goal, the system and exploitable service may need to be remotely accessible from the internal network.'], 'x_mitre_is_subtechnique': False}",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "41d40bff-377a-43e2-8e1b-2e543069e079",
                        "lookup_data": {
                            "description": "Detects WannaCry ransomware activity",
                            "raw": "author: Florian Roth (Nextron Systems), Tom U. @c_APT_ure (collection), oscd.community,\n  Jonhnathan Ribeiro\ndate: 2019/01/16\ndescription: Detects WannaCry ransomware activity\ndetection:\n  condition: 1 of selection*\n  selection1:\n  - Image|endswith:\n    - \\tasksche.exe\n    - \\mssecsvc.exe\n    - \\taskdl.exe\n    - \\taskhsvc.exe\n    - \\taskse.exe\n    - \\111.exe\n    - \\lhdfrgui.exe\n    - \\linuxnew.exe\n    - \\wannacry.exe\n  - Image|contains: WanaDecryptor\n  selection2:\n  - CommandLine|contains|all:\n    - icacls\n    - /grant\n    - Everyone:F\n    - /T\n    - /C\n    - /Q\n  - CommandLine|contains|all:\n    - bcdedit\n    - /set\n    - '{default}'\n    - recoveryenabled\n    - 'no'\n  - CommandLine|contains|all:\n    - wbadmin\n    - delete\n    - catalog\n    - -quiet\n  - CommandLine|contains: '@Please_Read_Me@.txt'\nfalsepositives:\n- Unknown\nfields:\n- CommandLine\n- ParentCommandLine\nid: 41d40bff-377a-43e2-8e1b-2e543069e079\nlevel: critical\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2022/02/24\nreferences:\n- https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100\nstatus: test\ntags:\n- attack.lateral_movement\n- attack.t1210\n- attack.discovery\n- attack.t1083\n- attack.defense_evasion\n- attack.t1222.001\n- attack.impact\n- attack.t1486\n- attack.t1490\ntitle: WannaCry Ransomware\n",
                            "sigma:id": "41d40bff-377a-43e2-8e1b-2e543069e079",
                            "title": "WannaCry Ransomware",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "aaa5b30d-f418-420b-83a0-299cb6024885",
                        "lookup_data": {
                            "description": "Detect suspicious error on protocol RDP, potential CVE-2019-0708",
                            "raw": "author: Lionel PRAT, Christophe BROCAS, @atc_project (improvements)\ndate: 2019/05/24\ndescription: Detect suspicious error on protocol RDP, potential CVE-2019-0708\ndetection:\n  condition: selection\n  selection:\n    EventID:\n    - 56\n    - 50\n    Provider_Name: TermDD\nfalsepositives:\n- Bad connections or network interruptions\nid: aaa5b30d-f418-420b-83a0-299cb6024885\nlevel: medium\nlogsource:\n  product: windows\n  service: system\nmodified: 2022/12/25\nreferences:\n- https://github.com/zerosum0x0/CVE-2019-0708\n- https://github.com/Ekultek/BlueKeep\nstatus: test\ntags:\n- attack.lateral_movement\n- attack.t1210\n- car.2013-07-002\ntitle: Potential RDP Exploit CVE-2019-0708\n",
                            "sigma:id": "aaa5b30d-f418-420b-83a0-299cb6024885",
                            "title": "Potential RDP Exploit CVE-2019-0708",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "ab6b1a39-a9ee-4ab4-b075-e83acf6e346b",
                        "lookup_data": {
                            "description": "Detects the exploitation of OMIGOD (CVE-2021-38647) which allows remote execute (RCE) commands as root with just a single unauthenticated HTTP request.\nVerify, successful, exploitation by viewing the HTTP client (request) body to see what was passed to the server (using PCAP).\nWithin the client body is where the code execution would occur. Additionally, check the endpoint logs to see if suspicious commands or activity occurred within the timeframe of this HTTP request.\n",
                            "raw": "author: Nate Guagenti (neu5ron)\ndate: 2021/09/20\ndescription: 'Detects the exploitation of OMIGOD (CVE-2021-38647) which allows remote\n  execute (RCE) commands as root with just a single unauthenticated HTTP request.\n\n  Verify, successful, exploitation by viewing the HTTP client (request) body to see\n  what was passed to the server (using PCAP).\n\n  Within the client body is where the code execution would occur. Additionally, check\n  the endpoint logs to see if suspicious commands or activity occurred within the\n  timeframe of this HTTP request.\n\n  '\ndetection:\n  auth_header:\n    client_header_names|contains: AUTHORIZATION\n  condition: selection and not auth_header and not too_small_http_client_body\n  selection:\n    method: POST\n    status_code: 200\n    uri: /wsman\n  too_small_http_client_body:\n    request_body_len: 0\nfalsepositives:\n- Exploits that were attempted but unsuccessful.\n- Scanning attempts with the abnormal use of the HTTP POST method with no indication\n  of code execution within the HTTP Client (Request) body. An example would be vulnerability\n  scanners trying to identify unpatched versions while not actually exploiting the\n  vulnerability. See description for investigation tips.\nfields:\n- id.orig_h\n- id.resp_h\n- id.resp_p\n- status_code\n- method\n- uri\n- request_body_len\n- response_body_len\n- user_agent\nid: ab6b1a39-a9ee-4ab4-b075-e83acf6e346b\nlevel: high\nlogsource:\n  definition: Enable the builtin Zeek script that logs all HTTP header names by adding\n    \"@load policy/protocols/http/header-names\" to your local.zeek config file. The\n    script can be seen here for reference https://github.com/zeek/zeek/blob/d957f883df242ef159cfd846884e673addeea7a5/scripts/policy/protocols/http/header-names.zeek\n  product: zeek\n  service: http\nmodified: 2019/09/20\nreferences:\n- https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure\n- https://twitter.com/neu5ron/status/1438987292971053057?s=20\nstatus: stable\ntags:\n- attack.privilege_escalation\n- attack.initial_access\n- attack.execution\n- attack.lateral_movement\n- attack.t1068\n- attack.t1190\n- attack.t1203\n- attack.t1021.006\n- attack.t1210\ntitle: OMIGOD HTTP No Authentication RCE\n",
                            "sigma:id": "ab6b1a39-a9ee-4ab4-b075-e83acf6e346b",
                            "title": "OMIGOD HTTP No Authentication RCE",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "1012f107-b8f1-4271-af30-5aed2de89b39",
                        "lookup_data": {
                            "description": "Detects a process spawned by the terminal service server process (this could be an indicator for an exploitation of CVE-2019-0708)",
                            "raw": "author: Florian Roth (Nextron Systems)\ndate: 2019/05/22\ndescription: Detects a process spawned by the terminal service server process (this\n  could be an indicator for an exploitation of CVE-2019-0708)\ndetection:\n  condition: selection and not 1 of filter*\n  filter:\n    Image|endswith:\n    - \\rdpclip.exe\n    - :\\Windows\\System32\\csrss.exe\n    - :\\Windows\\System32\\wininit.exe\n    - :\\Windows\\System32\\winlogon.exe\n  filter_null:\n    Image: null\n  selection:\n    ParentCommandLine|contains|all:\n    - \\svchost.exe\n    - termsvcs\nfalsepositives:\n- Unknown\nid: 1012f107-b8f1-4271-af30-5aed2de89b39\nlevel: high\nlogsource:\n  category: process_creation\n  product: windows\nmodified: 2023/01/25\nreferences:\n- https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/rdp-stands-for-really-do-patch-understanding-the-wormable-rdp-vulnerability-cve-2019-0708/\nstatus: test\ntags:\n- attack.initial_access\n- attack.t1190\n- attack.lateral_movement\n- attack.t1210\n- car.2013-07-002\ntitle: Terminal Service Process Spawn\n",
                            "sigma:id": "1012f107-b8f1-4271-af30-5aed2de89b39",
                            "title": "Terminal Service Process Spawn",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "c92f1896-d1d2-43c3-92d5-7a5b35c217bb",
                        "lookup_data": {
                            "description": "Detects log entries that appear in exploitation attempts against MS Exchange RCE CVE-2021-42321",
                            "raw": "author: Florian Roth (Nextron Systems), @testanull\ndate: 2021/11/18\ndescription: Detects log entries that appear in exploitation attempts against MS Exchange\n  RCE CVE-2021-42321\ndetection:\n  condition: selection\n  selection:\n    Data|contains:\n    - 'Cmdlet failed. Cmdlet Get-App, '\n    - 'Task Get-App throwing unhandled exception: System.InvalidCastException:'\n    EventID:\n    - 6\n    - 8\nfalsepositives:\n- Unknown, please report false positives via https://github.com/SigmaHQ/sigma/issues\nid: c92f1896-d1d2-43c3-92d5-7a5b35c217bb\nlevel: high\nlogsource:\n  product: windows\n  service: msexchange-management\nmodified: 2022/07/12\nreferences:\n- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-42321\nstatus: experimental\ntags:\n- attack.lateral_movement\n- attack.t1210\ntitle: Possible Exploitation of Exchange RCE CVE-2021-42321\n",
                            "sigma:id": "c92f1896-d1d2-43c3-92d5-7a5b35c217bb",
                            "title": "Possible Exploitation of Exchange RCE CVE-2021-42321",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "18f37338-b9bd-4117-a039-280c81f7a596",
                        "lookup_data": {
                            "description": "This rule is designed to detect attempts to exploit Zerologon (CVE-2020-1472) vulnerability using mimikatz zerologon module or other exploits from machine with \"kali\" hostname.",
                            "raw": "author: Demyan Sokolin @_drd0c, Teymur Kheirkhabarov @HeirhabarovT, oscd.community\ndate: 2020/10/13\ndescription: This rule is designed to detect attempts to exploit Zerologon (CVE-2020-1472)\n  vulnerability using mimikatz zerologon module or other exploits from machine with\n  \"kali\" hostname.\ndetection:\n  condition: selection and keywords\n  keywords:\n  - kali\n  - mimikatz\n  selection:\n    EventID:\n    - 5805\n    - 5723\nid: 18f37338-b9bd-4117-a039-280c81f7a596\nlevel: critical\nlogsource:\n  product: windows\n  service: system\nmodified: 2021/05/30\nreferences:\n- https://www.secura.com/blog/zero-logon\n- https://bi-zone.medium.com/hunting-for-zerologon-f65c61586382\nstatus: stable\ntags:\n- attack.t1210\n- attack.lateral_movement\ntitle: Zerologon Exploitation Using Well-known Tools\n",
                            "sigma:id": "18f37338-b9bd-4117-a039-280c81f7a596",
                            "title": "Zerologon Exploitation Using Well-known Tools",
                            "_cycat_type": "Item"
                        }
                    },
                    {
                        "uuid": "8400629e-79a9-4737-b387-5db940ab2367",
                        "lookup_data": {
                            "description": "Detects the use of a scanner by zerosum0x0 that discovers targets vulnerable to  CVE-2019-0708 RDP RCE aka BlueKeep",
                            "raw": "author: Florian Roth (Nextron Systems), Adam Bradbury (idea)\ndate: 2019/06/02\ndescription: Detects the use of a scanner by zerosum0x0 that discovers targets vulnerable\n  to  CVE-2019-0708 RDP RCE aka BlueKeep\ndetection:\n  condition: selection\n  selection:\n    EventID: 4625\n    TargetUserName: AAAAAAA\nfalsepositives:\n- Unlikely\nid: 8400629e-79a9-4737-b387-5db940ab2367\nlevel: high\nlogsource:\n  product: windows\n  service: security\nmodified: 2022/12/25\nreferences:\n- https://twitter.com/AdamTheAnalyst/status/1134394070045003776\n- https://github.com/zerosum0x0/CVE-2019-0708\nstatus: test\ntags:\n- attack.lateral_movement\n- attack.t1210\n- car.2013-07-002\ntitle: Scanner PoC for CVE-2019-0708 RDP RCE Vuln\n",
                            "sigma:id": "8400629e-79a9-4737-b387-5db940ab2367",
                            "title": "Scanner PoC for CVE-2019-0708 RDP RCE Vuln",
                            "_cycat_type": "Item"
                        }
                    }
                ]
            }
        },
        "atomics": []
    },
    "timestamp": "2025-02-28 14:01:17"
}